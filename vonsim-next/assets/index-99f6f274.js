var CD=Object.defineProperty;var ED=(t,e,n)=>e in t?CD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var se=(t,e,n)=>(ED(t,typeof e!="symbol"?e+"":e,n),n),Fg=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var P=(t,e,n)=>(Fg(t,e,"read from private field"),n?n.call(t):e.get(t)),Ee=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},J=(t,e,n,r)=>(Fg(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n);var it=(t,e,n)=>(Fg(t,e,"access private method"),n);function AD(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var PD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Cu(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var cA={exports:{}},Rm={},dA={exports:{}},Ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vd=Symbol.for("react.element"),TD=Symbol.for("react.portal"),$D=Symbol.for("react.fragment"),ND=Symbol.for("react.strict_mode"),OD=Symbol.for("react.profiler"),_D=Symbol.for("react.provider"),RD=Symbol.for("react.context"),MD=Symbol.for("react.forward_ref"),DD=Symbol.for("react.suspense"),ID=Symbol.for("react.memo"),LD=Symbol.for("react.lazy"),cS=Symbol.iterator;function BD(t){return t===null||typeof t!="object"?null:(t=cS&&t[cS]||t["@@iterator"],typeof t=="function"?t:null)}var hA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fA=Object.assign,pA={};function Eu(t,e,n){this.props=t,this.context=e,this.refs=pA,this.updater=n||hA}Eu.prototype.isReactComponent={};Eu.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Eu.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function mA(){}mA.prototype=Eu.prototype;function ib(t,e,n){this.props=t,this.context=e,this.refs=pA,this.updater=n||hA}var sb=ib.prototype=new mA;sb.constructor=ib;fA(sb,Eu.prototype);sb.isPureReactComponent=!0;var dS=Array.isArray,gA=Object.prototype.hasOwnProperty,ob={current:null},yA={key:!0,ref:!0,__self:!0,__source:!0};function vA(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)gA.call(e,r)&&!yA.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Vd,type:t,key:s,ref:o,props:i,_owner:ob.current}}function jD(t,e){return{$$typeof:Vd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ab(t){return typeof t=="object"&&t!==null&&t.$$typeof===Vd}function zD(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var hS=/\/+/g;function Ug(t,e){return typeof t=="object"&&t!==null&&t.key!=null?zD(""+t.key):e.toString(36)}function bf(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Vd:case TD:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Ug(o,0):r,dS(i)?(n="",t!=null&&(n=t.replace(hS,"$&/")+"/"),bf(i,e,n,"",function(u){return u})):i!=null&&(ab(i)&&(i=jD(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(hS,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",dS(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Ug(s,a);o+=bf(s,e,n,l,i)}else if(l=BD(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Ug(s,a++),o+=bf(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function fh(t,e,n){if(t==null)return t;var r=[],i=0;return bf(t,r,"","",function(s){return e.call(n,s,i++)}),r}function FD(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Bn={current:null},xf={transition:null},UD={ReactCurrentDispatcher:Bn,ReactCurrentBatchConfig:xf,ReactCurrentOwner:ob};Ve.Children={map:fh,forEach:function(t,e,n){fh(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return fh(t,function(){e++}),e},toArray:function(t){return fh(t,function(e){return e})||[]},only:function(t){if(!ab(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ve.Component=Eu;Ve.Fragment=$D;Ve.Profiler=OD;Ve.PureComponent=ib;Ve.StrictMode=ND;Ve.Suspense=DD;Ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UD;Ve.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=fA({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=ob.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)gA.call(e,l)&&!yA.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Vd,type:t.type,key:i,ref:s,props:r,_owner:o}};Ve.createContext=function(t){return t={$$typeof:RD,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:_D,_context:t},t.Consumer=t};Ve.createElement=vA;Ve.createFactory=function(t){var e=vA.bind(null,t);return e.type=t,e};Ve.createRef=function(){return{current:null}};Ve.forwardRef=function(t){return{$$typeof:MD,render:t}};Ve.isValidElement=ab;Ve.lazy=function(t){return{$$typeof:LD,_payload:{_status:-1,_result:t},_init:FD}};Ve.memo=function(t,e){return{$$typeof:ID,type:t,compare:e===void 0?null:e}};Ve.startTransition=function(t){var e=xf.transition;xf.transition={};try{t()}finally{xf.transition=e}};Ve.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ve.useCallback=function(t,e){return Bn.current.useCallback(t,e)};Ve.useContext=function(t){return Bn.current.useContext(t)};Ve.useDebugValue=function(){};Ve.useDeferredValue=function(t){return Bn.current.useDeferredValue(t)};Ve.useEffect=function(t,e){return Bn.current.useEffect(t,e)};Ve.useId=function(){return Bn.current.useId()};Ve.useImperativeHandle=function(t,e,n){return Bn.current.useImperativeHandle(t,e,n)};Ve.useInsertionEffect=function(t,e){return Bn.current.useInsertionEffect(t,e)};Ve.useLayoutEffect=function(t,e){return Bn.current.useLayoutEffect(t,e)};Ve.useMemo=function(t,e){return Bn.current.useMemo(t,e)};Ve.useReducer=function(t,e,n){return Bn.current.useReducer(t,e,n)};Ve.useRef=function(t){return Bn.current.useRef(t)};Ve.useState=function(t){return Bn.current.useState(t)};Ve.useSyncExternalStore=function(t,e,n){return Bn.current.useSyncExternalStore(t,e,n)};Ve.useTransition=function(){return Bn.current.useTransition()};Ve.version="18.2.0";dA.exports=Ve;var m=dA.exports;const Lt=Cu(m),lb=AD({__proto__:null,default:Lt},[m]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VD=m,HD=Symbol.for("react.element"),WD=Symbol.for("react.fragment"),GD=Object.prototype.hasOwnProperty,KD=VD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,XD={key:!0,ref:!0,__self:!0,__source:!0};function wA(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)GD.call(e,r)&&!XD.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:HD,type:t,key:s,ref:o,props:i,_owner:KD.current}}Rm.Fragment=WD;Rm.jsx=wA;Rm.jsxs=wA;cA.exports=Rm;var x=cA.exports;var _y={},bA={exports:{}},xr={},xA={exports:{}},SA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,_){var V=F.length;F.push(_);e:for(;0<V;){var Z=V-1>>>1,ne=F[Z];if(0<i(ne,_))F[Z]=_,F[V]=ne,V=Z;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var _=F[0],V=F.pop();if(V!==_){F[0]=V;e:for(var Z=0,ne=F.length,me=ne>>>1;Z<me;){var H=2*(Z+1)-1,L=F[H],W=H+1,k=F[W];if(0>i(L,V))W<ne&&0>i(k,L)?(F[Z]=k,F[W]=V,Z=W):(F[Z]=L,F[H]=V,Z=H);else if(W<ne&&0>i(k,V))F[Z]=k,F[W]=V,Z=W;else break e}}return _}function i(F,_){var V=F.sortIndex-_.sortIndex;return V!==0?V:F.id-_.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],c=1,d=null,h=3,f=!1,p=!1,g=!1,b=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(F){for(var _=n(u);_!==null;){if(_.callback===null)r(u);else if(_.startTime<=F)r(u),_.sortIndex=_.expirationTime,e(l,_);else break;_=n(u)}}function S(F){if(g=!1,w(F),!p)if(n(l)!==null)p=!0,K(C);else{var _=n(u);_!==null&&ee(S,_.startTime-F)}}function C(F,_){p=!1,g&&(g=!1,y(A),A=-1),f=!0;var V=h;try{for(w(_),d=n(l);d!==null&&(!(d.expirationTime>_)||F&&!O());){var Z=d.callback;if(typeof Z=="function"){d.callback=null,h=d.priorityLevel;var ne=Z(d.expirationTime<=_);_=t.unstable_now(),typeof ne=="function"?d.callback=ne:d===n(l)&&r(l),w(_)}else r(l);d=n(l)}if(d!==null)var me=!0;else{var H=n(u);H!==null&&ee(S,H.startTime-_),me=!1}return me}finally{d=null,h=V,f=!1}}var E=!1,T=null,A=-1,N=5,R=-1;function O(){return!(t.unstable_now()-R<N)}function j(){if(T!==null){var F=t.unstable_now();R=F;var _=!0;try{_=T(!0,F)}finally{_?z():(E=!1,T=null)}}else E=!1}var z;if(typeof v=="function")z=function(){v(j)};else if(typeof MessageChannel<"u"){var I=new MessageChannel,G=I.port2;I.port1.onmessage=j,z=function(){G.postMessage(null)}}else z=function(){b(j,0)};function K(F){T=F,E||(E=!0,z())}function ee(F,_){A=b(function(){F(t.unstable_now())},_)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,K(C))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(F){switch(h){case 1:case 2:case 3:var _=3;break;default:_=h}var V=h;h=_;try{return F()}finally{h=V}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,_){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var V=h;h=F;try{return _()}finally{h=V}},t.unstable_scheduleCallback=function(F,_,V){var Z=t.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?Z+V:Z):V=Z,F){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=V+ne,F={id:c++,callback:_,priorityLevel:F,startTime:V,expirationTime:ne,sortIndex:-1},V>Z?(F.sortIndex=V,e(u,F),n(l)===null&&F===n(u)&&(g?(y(A),A=-1):g=!0,ee(S,V-Z))):(F.sortIndex=ne,e(l,F),p||f||(p=!0,K(C))),F},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(F){var _=h;return function(){var V=h;h=_;try{return F.apply(this,arguments)}finally{h=V}}}})(SA);xA.exports=SA;var ZD=xA.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kA=m,wr=ZD;function ie(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var CA=new Set,jc={};function Ua(t,e){Ql(t,e),Ql(t+"Capture",e)}function Ql(t,e){for(jc[t]=e,t=0;t<e.length;t++)CA.add(e[t])}var Es=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ry=Object.prototype.hasOwnProperty,JD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,fS={},pS={};function YD(t){return Ry.call(pS,t)?!0:Ry.call(fS,t)?!1:JD.test(t)?pS[t]=!0:(fS[t]=!0,!1)}function qD(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function QD(t,e,n,r){if(e===null||typeof e>"u"||qD(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function jn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var cn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){cn[t]=new jn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];cn[e]=new jn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){cn[t]=new jn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){cn[t]=new jn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){cn[t]=new jn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){cn[t]=new jn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){cn[t]=new jn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){cn[t]=new jn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){cn[t]=new jn(t,5,!1,t.toLowerCase(),null,!1,!1)});var ub=/[\-:]([a-z])/g;function cb(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ub,cb);cn[e]=new jn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ub,cb);cn[e]=new jn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ub,cb);cn[e]=new jn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){cn[t]=new jn(t,1,!1,t.toLowerCase(),null,!1,!1)});cn.xlinkHref=new jn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){cn[t]=new jn(t,1,!1,t.toLowerCase(),null,!0,!0)});function db(t,e,n,r){var i=cn.hasOwnProperty(e)?cn[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(QD(e,n,i,r)&&(n=null),r||i===null?YD(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ms=kA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ph=Symbol.for("react.element"),dl=Symbol.for("react.portal"),hl=Symbol.for("react.fragment"),hb=Symbol.for("react.strict_mode"),My=Symbol.for("react.profiler"),EA=Symbol.for("react.provider"),AA=Symbol.for("react.context"),fb=Symbol.for("react.forward_ref"),Dy=Symbol.for("react.suspense"),Iy=Symbol.for("react.suspense_list"),pb=Symbol.for("react.memo"),Gs=Symbol.for("react.lazy"),PA=Symbol.for("react.offscreen"),mS=Symbol.iterator;function Bu(t){return t===null||typeof t!="object"?null:(t=mS&&t[mS]||t["@@iterator"],typeof t=="function"?t:null)}var Ot=Object.assign,Vg;function oc(t){if(Vg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Vg=e&&e[1]||""}return`
`+Vg+t}var Hg=!1;function Wg(t,e){if(!t||Hg)return"";Hg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Hg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?oc(t):""}function e3(t){switch(t.tag){case 5:return oc(t.type);case 16:return oc("Lazy");case 13:return oc("Suspense");case 19:return oc("SuspenseList");case 0:case 2:case 15:return t=Wg(t.type,!1),t;case 11:return t=Wg(t.type.render,!1),t;case 1:return t=Wg(t.type,!0),t;default:return""}}function Ly(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case hl:return"Fragment";case dl:return"Portal";case My:return"Profiler";case hb:return"StrictMode";case Dy:return"Suspense";case Iy:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case AA:return(t.displayName||"Context")+".Consumer";case EA:return(t._context.displayName||"Context")+".Provider";case fb:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case pb:return e=t.displayName||null,e!==null?e:Ly(t.type)||"Memo";case Gs:e=t._payload,t=t._init;try{return Ly(t(e))}catch{}}return null}function t3(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ly(e);case 8:return e===hb?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function To(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function TA(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function n3(t){var e=TA(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function mh(t){t._valueTracker||(t._valueTracker=n3(t))}function $A(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=TA(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ip(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function By(t,e){var n=e.checked;return Ot({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function gS(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=To(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function NA(t,e){e=e.checked,e!=null&&db(t,"checked",e,!1)}function jy(t,e){NA(t,e);var n=To(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?zy(t,e.type,n):e.hasOwnProperty("defaultValue")&&zy(t,e.type,To(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function yS(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function zy(t,e,n){(e!=="number"||ip(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ac=Array.isArray;function Tl(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+To(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Fy(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ie(91));return Ot({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function vS(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ie(92));if(ac(n)){if(1<n.length)throw Error(ie(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:To(n)}}function OA(t,e){var n=To(e.value),r=To(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function wS(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function _A(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Uy(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?_A(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var gh,RA=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(gh=gh||document.createElement("div"),gh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=gh.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function zc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var vc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},r3=["Webkit","ms","Moz","O"];Object.keys(vc).forEach(function(t){r3.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),vc[e]=vc[t]})});function MA(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||vc.hasOwnProperty(t)&&vc[t]?(""+e).trim():e+"px"}function DA(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=MA(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var i3=Ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vy(t,e){if(e){if(i3[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ie(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ie(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ie(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ie(62))}}function Hy(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wy=null;function mb(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Gy=null,$l=null,Nl=null;function bS(t){if(t=Gd(t)){if(typeof Gy!="function")throw Error(ie(280));var e=t.stateNode;e&&(e=Bm(e),Gy(t.stateNode,t.type,e))}}function IA(t){$l?Nl?Nl.push(t):Nl=[t]:$l=t}function LA(){if($l){var t=$l,e=Nl;if(Nl=$l=null,bS(t),e)for(t=0;t<e.length;t++)bS(e[t])}}function BA(t,e){return t(e)}function jA(){}var Gg=!1;function zA(t,e,n){if(Gg)return t(e,n);Gg=!0;try{return BA(t,e,n)}finally{Gg=!1,($l!==null||Nl!==null)&&(jA(),LA())}}function Fc(t,e){var n=t.stateNode;if(n===null)return null;var r=Bm(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ie(231,e,typeof n));return n}var Ky=!1;if(Es)try{var ju={};Object.defineProperty(ju,"passive",{get:function(){Ky=!0}}),window.addEventListener("test",ju,ju),window.removeEventListener("test",ju,ju)}catch{Ky=!1}function s3(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var wc=!1,sp=null,op=!1,Xy=null,o3={onError:function(t){wc=!0,sp=t}};function a3(t,e,n,r,i,s,o,a,l){wc=!1,sp=null,s3.apply(o3,arguments)}function l3(t,e,n,r,i,s,o,a,l){if(a3.apply(this,arguments),wc){if(wc){var u=sp;wc=!1,sp=null}else throw Error(ie(198));op||(op=!0,Xy=u)}}function Va(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function FA(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function xS(t){if(Va(t)!==t)throw Error(ie(188))}function u3(t){var e=t.alternate;if(!e){if(e=Va(t),e===null)throw Error(ie(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return xS(i),t;if(s===r)return xS(i),e;s=s.sibling}throw Error(ie(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(ie(189))}}if(n.alternate!==r)throw Error(ie(190))}if(n.tag!==3)throw Error(ie(188));return n.stateNode.current===n?t:e}function UA(t){return t=u3(t),t!==null?VA(t):null}function VA(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=VA(t);if(e!==null)return e;t=t.sibling}return null}var HA=wr.unstable_scheduleCallback,SS=wr.unstable_cancelCallback,c3=wr.unstable_shouldYield,d3=wr.unstable_requestPaint,It=wr.unstable_now,h3=wr.unstable_getCurrentPriorityLevel,gb=wr.unstable_ImmediatePriority,WA=wr.unstable_UserBlockingPriority,ap=wr.unstable_NormalPriority,f3=wr.unstable_LowPriority,GA=wr.unstable_IdlePriority,Mm=null,Ui=null;function p3(t){if(Ui&&typeof Ui.onCommitFiberRoot=="function")try{Ui.onCommitFiberRoot(Mm,t,void 0,(t.current.flags&128)===128)}catch{}}var li=Math.clz32?Math.clz32:y3,m3=Math.log,g3=Math.LN2;function y3(t){return t>>>=0,t===0?32:31-(m3(t)/g3|0)|0}var yh=64,vh=4194304;function lc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function lp(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=lc(a):(s&=o,s!==0&&(r=lc(s)))}else o=n&~i,o!==0?r=lc(o):s!==0&&(r=lc(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-li(e),i=1<<n,r|=t[n],e&=~i;return r}function v3(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function w3(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-li(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=v3(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Zy(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function KA(){var t=yh;return yh<<=1,!(yh&4194240)&&(yh=64),t}function Kg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Hd(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-li(e),t[e]=n}function b3(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-li(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function yb(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-li(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var tt=0;function XA(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ZA,vb,JA,YA,qA,Jy=!1,wh=[],yo=null,vo=null,wo=null,Uc=new Map,Vc=new Map,qs=[],x3="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function kS(t,e){switch(t){case"focusin":case"focusout":yo=null;break;case"dragenter":case"dragleave":vo=null;break;case"mouseover":case"mouseout":wo=null;break;case"pointerover":case"pointerout":Uc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vc.delete(e.pointerId)}}function zu(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Gd(e),e!==null&&vb(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function S3(t,e,n,r,i){switch(e){case"focusin":return yo=zu(yo,t,e,n,r,i),!0;case"dragenter":return vo=zu(vo,t,e,n,r,i),!0;case"mouseover":return wo=zu(wo,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Uc.set(s,zu(Uc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Vc.set(s,zu(Vc.get(s)||null,t,e,n,r,i)),!0}return!1}function QA(t){var e=da(t.target);if(e!==null){var n=Va(e);if(n!==null){if(e=n.tag,e===13){if(e=FA(n),e!==null){t.blockedOn=e,qA(t.priority,function(){JA(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Sf(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Yy(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Wy=r,n.target.dispatchEvent(r),Wy=null}else return e=Gd(n),e!==null&&vb(e),t.blockedOn=n,!1;e.shift()}return!0}function CS(t,e,n){Sf(t)&&n.delete(e)}function k3(){Jy=!1,yo!==null&&Sf(yo)&&(yo=null),vo!==null&&Sf(vo)&&(vo=null),wo!==null&&Sf(wo)&&(wo=null),Uc.forEach(CS),Vc.forEach(CS)}function Fu(t,e){t.blockedOn===e&&(t.blockedOn=null,Jy||(Jy=!0,wr.unstable_scheduleCallback(wr.unstable_NormalPriority,k3)))}function Hc(t){function e(i){return Fu(i,t)}if(0<wh.length){Fu(wh[0],t);for(var n=1;n<wh.length;n++){var r=wh[n];r.blockedOn===t&&(r.blockedOn=null)}}for(yo!==null&&Fu(yo,t),vo!==null&&Fu(vo,t),wo!==null&&Fu(wo,t),Uc.forEach(e),Vc.forEach(e),n=0;n<qs.length;n++)r=qs[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<qs.length&&(n=qs[0],n.blockedOn===null);)QA(n),n.blockedOn===null&&qs.shift()}var Ol=Ms.ReactCurrentBatchConfig,up=!0;function C3(t,e,n,r){var i=tt,s=Ol.transition;Ol.transition=null;try{tt=1,wb(t,e,n,r)}finally{tt=i,Ol.transition=s}}function E3(t,e,n,r){var i=tt,s=Ol.transition;Ol.transition=null;try{tt=4,wb(t,e,n,r)}finally{tt=i,Ol.transition=s}}function wb(t,e,n,r){if(up){var i=Yy(t,e,n,r);if(i===null)r0(t,e,r,cp,n),kS(t,r);else if(S3(i,t,e,n,r))r.stopPropagation();else if(kS(t,r),e&4&&-1<x3.indexOf(t)){for(;i!==null;){var s=Gd(i);if(s!==null&&ZA(s),s=Yy(t,e,n,r),s===null&&r0(t,e,r,cp,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else r0(t,e,r,null,n)}}var cp=null;function Yy(t,e,n,r){if(cp=null,t=mb(r),t=da(t),t!==null)if(e=Va(t),e===null)t=null;else if(n=e.tag,n===13){if(t=FA(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return cp=t,null}function eP(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(h3()){case gb:return 1;case WA:return 4;case ap:case f3:return 16;case GA:return 536870912;default:return 16}default:return 16}}var lo=null,bb=null,kf=null;function tP(){if(kf)return kf;var t,e=bb,n=e.length,r,i="value"in lo?lo.value:lo.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return kf=i.slice(t,1<r?1-r:void 0)}function Cf(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function bh(){return!0}function ES(){return!1}function Sr(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?bh:ES,this.isPropagationStopped=ES,this}return Ot(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=bh)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=bh)},persist:function(){},isPersistent:bh}),e}var Au={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xb=Sr(Au),Wd=Ot({},Au,{view:0,detail:0}),A3=Sr(Wd),Xg,Zg,Uu,Dm=Ot({},Wd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Sb,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Uu&&(Uu&&t.type==="mousemove"?(Xg=t.screenX-Uu.screenX,Zg=t.screenY-Uu.screenY):Zg=Xg=0,Uu=t),Xg)},movementY:function(t){return"movementY"in t?t.movementY:Zg}}),AS=Sr(Dm),P3=Ot({},Dm,{dataTransfer:0}),T3=Sr(P3),$3=Ot({},Wd,{relatedTarget:0}),Jg=Sr($3),N3=Ot({},Au,{animationName:0,elapsedTime:0,pseudoElement:0}),O3=Sr(N3),_3=Ot({},Au,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),R3=Sr(_3),M3=Ot({},Au,{data:0}),PS=Sr(M3),D3={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},I3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},L3={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function B3(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=L3[t])?!!e[t]:!1}function Sb(){return B3}var j3=Ot({},Wd,{key:function(t){if(t.key){var e=D3[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Cf(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?I3[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Sb,charCode:function(t){return t.type==="keypress"?Cf(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Cf(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),z3=Sr(j3),F3=Ot({},Dm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),TS=Sr(F3),U3=Ot({},Wd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Sb}),V3=Sr(U3),H3=Ot({},Au,{propertyName:0,elapsedTime:0,pseudoElement:0}),W3=Sr(H3),G3=Ot({},Dm,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),K3=Sr(G3),X3=[9,13,27,32],kb=Es&&"CompositionEvent"in window,bc=null;Es&&"documentMode"in document&&(bc=document.documentMode);var Z3=Es&&"TextEvent"in window&&!bc,nP=Es&&(!kb||bc&&8<bc&&11>=bc),$S=String.fromCharCode(32),NS=!1;function rP(t,e){switch(t){case"keyup":return X3.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function iP(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var fl=!1;function J3(t,e){switch(t){case"compositionend":return iP(e);case"keypress":return e.which!==32?null:(NS=!0,$S);case"textInput":return t=e.data,t===$S&&NS?null:t;default:return null}}function Y3(t,e){if(fl)return t==="compositionend"||!kb&&rP(t,e)?(t=tP(),kf=bb=lo=null,fl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return nP&&e.locale!=="ko"?null:e.data;default:return null}}var q3={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function OS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!q3[t.type]:e==="textarea"}function sP(t,e,n,r){IA(r),e=dp(e,"onChange"),0<e.length&&(n=new xb("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var xc=null,Wc=null;function Q3(t){gP(t,0)}function Im(t){var e=gl(t);if($A(e))return t}function eI(t,e){if(t==="change")return e}var oP=!1;if(Es){var Yg;if(Es){var qg="oninput"in document;if(!qg){var _S=document.createElement("div");_S.setAttribute("oninput","return;"),qg=typeof _S.oninput=="function"}Yg=qg}else Yg=!1;oP=Yg&&(!document.documentMode||9<document.documentMode)}function RS(){xc&&(xc.detachEvent("onpropertychange",aP),Wc=xc=null)}function aP(t){if(t.propertyName==="value"&&Im(Wc)){var e=[];sP(e,Wc,t,mb(t)),zA(Q3,e)}}function tI(t,e,n){t==="focusin"?(RS(),xc=e,Wc=n,xc.attachEvent("onpropertychange",aP)):t==="focusout"&&RS()}function nI(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Im(Wc)}function rI(t,e){if(t==="click")return Im(e)}function iI(t,e){if(t==="input"||t==="change")return Im(e)}function sI(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var pi=typeof Object.is=="function"?Object.is:sI;function Gc(t,e){if(pi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Ry.call(e,i)||!pi(t[i],e[i]))return!1}return!0}function MS(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function DS(t,e){var n=MS(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=MS(n)}}function lP(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?lP(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function uP(){for(var t=window,e=ip();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ip(t.document)}return e}function Cb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function oI(t){var e=uP(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&lP(n.ownerDocument.documentElement,n)){if(r!==null&&Cb(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=DS(n,s);var o=DS(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var aI=Es&&"documentMode"in document&&11>=document.documentMode,pl=null,qy=null,Sc=null,Qy=!1;function IS(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Qy||pl==null||pl!==ip(r)||(r=pl,"selectionStart"in r&&Cb(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Sc&&Gc(Sc,r)||(Sc=r,r=dp(qy,"onSelect"),0<r.length&&(e=new xb("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=pl)))}function xh(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ml={animationend:xh("Animation","AnimationEnd"),animationiteration:xh("Animation","AnimationIteration"),animationstart:xh("Animation","AnimationStart"),transitionend:xh("Transition","TransitionEnd")},Qg={},cP={};Es&&(cP=document.createElement("div").style,"AnimationEvent"in window||(delete ml.animationend.animation,delete ml.animationiteration.animation,delete ml.animationstart.animation),"TransitionEvent"in window||delete ml.transitionend.transition);function Lm(t){if(Qg[t])return Qg[t];if(!ml[t])return t;var e=ml[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in cP)return Qg[t]=e[n];return t}var dP=Lm("animationend"),hP=Lm("animationiteration"),fP=Lm("animationstart"),pP=Lm("transitionend"),mP=new Map,LS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Uo(t,e){mP.set(t,e),Ua(e,[t])}for(var e0=0;e0<LS.length;e0++){var t0=LS[e0],lI=t0.toLowerCase(),uI=t0[0].toUpperCase()+t0.slice(1);Uo(lI,"on"+uI)}Uo(dP,"onAnimationEnd");Uo(hP,"onAnimationIteration");Uo(fP,"onAnimationStart");Uo("dblclick","onDoubleClick");Uo("focusin","onFocus");Uo("focusout","onBlur");Uo(pP,"onTransitionEnd");Ql("onMouseEnter",["mouseout","mouseover"]);Ql("onMouseLeave",["mouseout","mouseover"]);Ql("onPointerEnter",["pointerout","pointerover"]);Ql("onPointerLeave",["pointerout","pointerover"]);Ua("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ua("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ua("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ua("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ua("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ua("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cI=new Set("cancel close invalid load scroll toggle".split(" ").concat(uc));function BS(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,l3(r,e,void 0,t),t.currentTarget=null}function gP(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;BS(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;BS(i,a,u),s=l}}}if(op)throw t=Xy,op=!1,Xy=null,t}function ft(t,e){var n=e[iv];n===void 0&&(n=e[iv]=new Set);var r=t+"__bubble";n.has(r)||(yP(e,t,2,!1),n.add(r))}function n0(t,e,n){var r=0;e&&(r|=4),yP(n,t,r,e)}var Sh="_reactListening"+Math.random().toString(36).slice(2);function Kc(t){if(!t[Sh]){t[Sh]=!0,CA.forEach(function(n){n!=="selectionchange"&&(cI.has(n)||n0(n,!1,t),n0(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Sh]||(e[Sh]=!0,n0("selectionchange",!1,e))}}function yP(t,e,n,r){switch(eP(e)){case 1:var i=C3;break;case 4:i=E3;break;default:i=wb}n=i.bind(null,e,n,t),i=void 0,!Ky||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function r0(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=da(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}zA(function(){var u=s,c=mb(n),d=[];e:{var h=mP.get(t);if(h!==void 0){var f=xb,p=t;switch(t){case"keypress":if(Cf(n)===0)break e;case"keydown":case"keyup":f=z3;break;case"focusin":p="focus",f=Jg;break;case"focusout":p="blur",f=Jg;break;case"beforeblur":case"afterblur":f=Jg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=AS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=T3;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=V3;break;case dP:case hP:case fP:f=O3;break;case pP:f=W3;break;case"scroll":f=A3;break;case"wheel":f=K3;break;case"copy":case"cut":case"paste":f=R3;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=TS}var g=(e&4)!==0,b=!g&&t==="scroll",y=g?h!==null?h+"Capture":null:h;g=[];for(var v=u,w;v!==null;){w=v;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,y!==null&&(S=Fc(v,y),S!=null&&g.push(Xc(v,S,w)))),b)break;v=v.return}0<g.length&&(h=new f(h,p,null,n,c),d.push({event:h,listeners:g}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==Wy&&(p=n.relatedTarget||n.fromElement)&&(da(p)||p[As]))break e;if((f||h)&&(h=c.window===c?c:(h=c.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=u,p=p?da(p):null,p!==null&&(b=Va(p),p!==b||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=u),f!==p)){if(g=AS,S="onMouseLeave",y="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(g=TS,S="onPointerLeave",y="onPointerEnter",v="pointer"),b=f==null?h:gl(f),w=p==null?h:gl(p),h=new g(S,v+"leave",f,n,c),h.target=b,h.relatedTarget=w,S=null,da(c)===u&&(g=new g(y,v+"enter",p,n,c),g.target=w,g.relatedTarget=b,S=g),b=S,f&&p)t:{for(g=f,y=p,v=0,w=g;w;w=qa(w))v++;for(w=0,S=y;S;S=qa(S))w++;for(;0<v-w;)g=qa(g),v--;for(;0<w-v;)y=qa(y),w--;for(;v--;){if(g===y||y!==null&&g===y.alternate)break t;g=qa(g),y=qa(y)}g=null}else g=null;f!==null&&jS(d,h,f,g,!1),p!==null&&b!==null&&jS(d,b,p,g,!0)}}e:{if(h=u?gl(u):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var C=eI;else if(OS(h))if(oP)C=iI;else{C=nI;var E=tI}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(C=rI);if(C&&(C=C(t,u))){sP(d,C,n,c);break e}E&&E(t,h,u),t==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&zy(h,"number",h.value)}switch(E=u?gl(u):window,t){case"focusin":(OS(E)||E.contentEditable==="true")&&(pl=E,qy=u,Sc=null);break;case"focusout":Sc=qy=pl=null;break;case"mousedown":Qy=!0;break;case"contextmenu":case"mouseup":case"dragend":Qy=!1,IS(d,n,c);break;case"selectionchange":if(aI)break;case"keydown":case"keyup":IS(d,n,c)}var T;if(kb)e:{switch(t){case"compositionstart":var A="onCompositionStart";break e;case"compositionend":A="onCompositionEnd";break e;case"compositionupdate":A="onCompositionUpdate";break e}A=void 0}else fl?rP(t,n)&&(A="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(A="onCompositionStart");A&&(nP&&n.locale!=="ko"&&(fl||A!=="onCompositionStart"?A==="onCompositionEnd"&&fl&&(T=tP()):(lo=c,bb="value"in lo?lo.value:lo.textContent,fl=!0)),E=dp(u,A),0<E.length&&(A=new PS(A,t,null,n,c),d.push({event:A,listeners:E}),T?A.data=T:(T=iP(n),T!==null&&(A.data=T)))),(T=Z3?J3(t,n):Y3(t,n))&&(u=dp(u,"onBeforeInput"),0<u.length&&(c=new PS("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=T))}gP(d,e)})}function Xc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function dp(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Fc(t,n),s!=null&&r.unshift(Xc(t,s,i)),s=Fc(t,e),s!=null&&r.push(Xc(t,s,i))),t=t.return}return r}function qa(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function jS(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=Fc(n,s),l!=null&&o.unshift(Xc(n,l,a))):i||(l=Fc(n,s),l!=null&&o.push(Xc(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var dI=/\r\n?/g,hI=/\u0000|\uFFFD/g;function zS(t){return(typeof t=="string"?t:""+t).replace(dI,`
`).replace(hI,"")}function kh(t,e,n){if(e=zS(e),zS(t)!==e&&n)throw Error(ie(425))}function hp(){}var ev=null,tv=null;function nv(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var rv=typeof setTimeout=="function"?setTimeout:void 0,fI=typeof clearTimeout=="function"?clearTimeout:void 0,FS=typeof Promise=="function"?Promise:void 0,pI=typeof queueMicrotask=="function"?queueMicrotask:typeof FS<"u"?function(t){return FS.resolve(null).then(t).catch(mI)}:rv;function mI(t){setTimeout(function(){throw t})}function i0(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Hc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Hc(e)}function bo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function US(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Pu=Math.random().toString(36).slice(2),Di="__reactFiber$"+Pu,Zc="__reactProps$"+Pu,As="__reactContainer$"+Pu,iv="__reactEvents$"+Pu,gI="__reactListeners$"+Pu,yI="__reactHandles$"+Pu;function da(t){var e=t[Di];if(e)return e;for(var n=t.parentNode;n;){if(e=n[As]||n[Di]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=US(t);t!==null;){if(n=t[Di])return n;t=US(t)}return e}t=n,n=t.parentNode}return null}function Gd(t){return t=t[Di]||t[As],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function gl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ie(33))}function Bm(t){return t[Zc]||null}var sv=[],yl=-1;function Vo(t){return{current:t}}function vt(t){0>yl||(t.current=sv[yl],sv[yl]=null,yl--)}function ct(t,e){yl++,sv[yl]=t.current,t.current=e}var $o={},Sn=Vo($o),Qn=Vo(!1),Aa=$o;function eu(t,e){var n=t.type.contextTypes;if(!n)return $o;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function er(t){return t=t.childContextTypes,t!=null}function fp(){vt(Qn),vt(Sn)}function VS(t,e,n){if(Sn.current!==$o)throw Error(ie(168));ct(Sn,e),ct(Qn,n)}function vP(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ie(108,t3(t)||"Unknown",i));return Ot({},n,r)}function pp(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||$o,Aa=Sn.current,ct(Sn,t),ct(Qn,Qn.current),!0}function HS(t,e,n){var r=t.stateNode;if(!r)throw Error(ie(169));n?(t=vP(t,e,Aa),r.__reactInternalMemoizedMergedChildContext=t,vt(Qn),vt(Sn),ct(Sn,t)):vt(Qn),ct(Qn,n)}var ts=null,jm=!1,s0=!1;function wP(t){ts===null?ts=[t]:ts.push(t)}function vI(t){jm=!0,wP(t)}function Ho(){if(!s0&&ts!==null){s0=!0;var t=0,e=tt;try{var n=ts;for(tt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ts=null,jm=!1}catch(i){throw ts!==null&&(ts=ts.slice(t+1)),HA(gb,Ho),i}finally{tt=e,s0=!1}}return null}var vl=[],wl=0,mp=null,gp=0,_r=[],Rr=0,Pa=null,fs=1,ps="";function na(t,e){vl[wl++]=gp,vl[wl++]=mp,mp=t,gp=e}function bP(t,e,n){_r[Rr++]=fs,_r[Rr++]=ps,_r[Rr++]=Pa,Pa=t;var r=fs;t=ps;var i=32-li(r)-1;r&=~(1<<i),n+=1;var s=32-li(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,fs=1<<32-li(e)+i|n<<i|r,ps=s+t}else fs=1<<s|n<<i|r,ps=t}function Eb(t){t.return!==null&&(na(t,1),bP(t,1,0))}function Ab(t){for(;t===mp;)mp=vl[--wl],vl[wl]=null,gp=vl[--wl],vl[wl]=null;for(;t===Pa;)Pa=_r[--Rr],_r[Rr]=null,ps=_r[--Rr],_r[Rr]=null,fs=_r[--Rr],_r[Rr]=null}var vr=null,pr=null,xt=!1,ni=null;function xP(t,e){var n=Ir(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function WS(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,vr=t,pr=bo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,vr=t,pr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Pa!==null?{id:fs,overflow:ps}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ir(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,vr=t,pr=null,!0):!1;default:return!1}}function ov(t){return(t.mode&1)!==0&&(t.flags&128)===0}function av(t){if(xt){var e=pr;if(e){var n=e;if(!WS(t,e)){if(ov(t))throw Error(ie(418));e=bo(n.nextSibling);var r=vr;e&&WS(t,e)?xP(r,n):(t.flags=t.flags&-4097|2,xt=!1,vr=t)}}else{if(ov(t))throw Error(ie(418));t.flags=t.flags&-4097|2,xt=!1,vr=t}}}function GS(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;vr=t}function Ch(t){if(t!==vr)return!1;if(!xt)return GS(t),xt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!nv(t.type,t.memoizedProps)),e&&(e=pr)){if(ov(t))throw SP(),Error(ie(418));for(;e;)xP(t,e),e=bo(e.nextSibling)}if(GS(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ie(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){pr=bo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}pr=null}}else pr=vr?bo(t.stateNode.nextSibling):null;return!0}function SP(){for(var t=pr;t;)t=bo(t.nextSibling)}function tu(){pr=vr=null,xt=!1}function Pb(t){ni===null?ni=[t]:ni.push(t)}var wI=Ms.ReactCurrentBatchConfig;function Yr(t,e){if(t&&t.defaultProps){e=Ot({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var yp=Vo(null),vp=null,bl=null,Tb=null;function $b(){Tb=bl=vp=null}function Nb(t){var e=yp.current;vt(yp),t._currentValue=e}function lv(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function _l(t,e){vp=t,Tb=bl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Yn=!0),t.firstContext=null)}function Hr(t){var e=t._currentValue;if(Tb!==t)if(t={context:t,memoizedValue:e,next:null},bl===null){if(vp===null)throw Error(ie(308));bl=t,vp.dependencies={lanes:0,firstContext:t}}else bl=bl.next=t;return e}var ha=null;function Ob(t){ha===null?ha=[t]:ha.push(t)}function kP(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Ob(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ps(t,r)}function Ps(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ks=!1;function _b(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function CP(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ys(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function xo(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Xe&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ps(t,n)}return i=r.interleaved,i===null?(e.next=e,Ob(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ps(t,n)}function Ef(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yb(t,n)}}function KS(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function wp(t,e,n,r){var i=t.updateQueue;Ks=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==o&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;o=0,c=u=l=null,a=s;do{var h=a.lane,f=a.eventTime;if((r&h)===h){c!==null&&(c=c.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,g=a;switch(h=e,f=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=Ot({},d,h);break e;case 2:Ks=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=f,l=d):c=c.next=f,o|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(1);if(c===null&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);$a|=o,t.lanes=o,t.memoizedState=d}}function XS(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ie(191,i));i.call(r)}}}var EP=new kA.Component().refs;function uv(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ot({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var zm={isMounted:function(t){return(t=t._reactInternals)?Va(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Rn(),i=ko(t),s=ys(r,i);s.payload=e,n!=null&&(s.callback=n),e=xo(t,s,i),e!==null&&(ui(e,t,i,r),Ef(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Rn(),i=ko(t),s=ys(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=xo(t,s,i),e!==null&&(ui(e,t,i,r),Ef(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Rn(),r=ko(t),i=ys(n,r);i.tag=2,e!=null&&(i.callback=e),e=xo(t,i,r),e!==null&&(ui(e,t,r,n),Ef(e,t,r))}};function ZS(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Gc(n,r)||!Gc(i,s):!0}function AP(t,e,n){var r=!1,i=$o,s=e.contextType;return typeof s=="object"&&s!==null?s=Hr(s):(i=er(e)?Aa:Sn.current,r=e.contextTypes,s=(r=r!=null)?eu(t,i):$o),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=zm,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function JS(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&zm.enqueueReplaceState(e,e.state,null)}function cv(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=EP,_b(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Hr(s):(s=er(e)?Aa:Sn.current,i.context=eu(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(uv(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&zm.enqueueReplaceState(i,i.state,null),wp(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Vu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ie(309));var r=n.stateNode}if(!r)throw Error(ie(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;a===EP&&(a=i.refs={}),o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(ie(284));if(!n._owner)throw Error(ie(290,t))}return t}function Eh(t,e){throw t=Object.prototype.toString.call(e),Error(ie(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function YS(t){var e=t._init;return e(t._payload)}function PP(t){function e(y,v){if(t){var w=y.deletions;w===null?(y.deletions=[v],y.flags|=16):w.push(v)}}function n(y,v){if(!t)return null;for(;v!==null;)e(y,v),v=v.sibling;return null}function r(y,v){for(y=new Map;v!==null;)v.key!==null?y.set(v.key,v):y.set(v.index,v),v=v.sibling;return y}function i(y,v){return y=Co(y,v),y.index=0,y.sibling=null,y}function s(y,v,w){return y.index=w,t?(w=y.alternate,w!==null?(w=w.index,w<v?(y.flags|=2,v):w):(y.flags|=2,v)):(y.flags|=1048576,v)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,v,w,S){return v===null||v.tag!==6?(v=h0(w,y.mode,S),v.return=y,v):(v=i(v,w),v.return=y,v)}function l(y,v,w,S){var C=w.type;return C===hl?c(y,v,w.props.children,S,w.key):v!==null&&(v.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Gs&&YS(C)===v.type)?(S=i(v,w.props),S.ref=Vu(y,v,w),S.return=y,S):(S=Of(w.type,w.key,w.props,null,y.mode,S),S.ref=Vu(y,v,w),S.return=y,S)}function u(y,v,w,S){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=f0(w,y.mode,S),v.return=y,v):(v=i(v,w.children||[]),v.return=y,v)}function c(y,v,w,S,C){return v===null||v.tag!==7?(v=ba(w,y.mode,S,C),v.return=y,v):(v=i(v,w),v.return=y,v)}function d(y,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=h0(""+v,y.mode,w),v.return=y,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ph:return w=Of(v.type,v.key,v.props,null,y.mode,w),w.ref=Vu(y,null,v),w.return=y,w;case dl:return v=f0(v,y.mode,w),v.return=y,v;case Gs:var S=v._init;return d(y,S(v._payload),w)}if(ac(v)||Bu(v))return v=ba(v,y.mode,w,null),v.return=y,v;Eh(y,v)}return null}function h(y,v,w,S){var C=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return C!==null?null:a(y,v,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ph:return w.key===C?l(y,v,w,S):null;case dl:return w.key===C?u(y,v,w,S):null;case Gs:return C=w._init,h(y,v,C(w._payload),S)}if(ac(w)||Bu(w))return C!==null?null:c(y,v,w,S,null);Eh(y,w)}return null}function f(y,v,w,S,C){if(typeof S=="string"&&S!==""||typeof S=="number")return y=y.get(w)||null,a(v,y,""+S,C);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ph:return y=y.get(S.key===null?w:S.key)||null,l(v,y,S,C);case dl:return y=y.get(S.key===null?w:S.key)||null,u(v,y,S,C);case Gs:var E=S._init;return f(y,v,w,E(S._payload),C)}if(ac(S)||Bu(S))return y=y.get(w)||null,c(v,y,S,C,null);Eh(v,S)}return null}function p(y,v,w,S){for(var C=null,E=null,T=v,A=v=0,N=null;T!==null&&A<w.length;A++){T.index>A?(N=T,T=null):N=T.sibling;var R=h(y,T,w[A],S);if(R===null){T===null&&(T=N);break}t&&T&&R.alternate===null&&e(y,T),v=s(R,v,A),E===null?C=R:E.sibling=R,E=R,T=N}if(A===w.length)return n(y,T),xt&&na(y,A),C;if(T===null){for(;A<w.length;A++)T=d(y,w[A],S),T!==null&&(v=s(T,v,A),E===null?C=T:E.sibling=T,E=T);return xt&&na(y,A),C}for(T=r(y,T);A<w.length;A++)N=f(T,y,A,w[A],S),N!==null&&(t&&N.alternate!==null&&T.delete(N.key===null?A:N.key),v=s(N,v,A),E===null?C=N:E.sibling=N,E=N);return t&&T.forEach(function(O){return e(y,O)}),xt&&na(y,A),C}function g(y,v,w,S){var C=Bu(w);if(typeof C!="function")throw Error(ie(150));if(w=C.call(w),w==null)throw Error(ie(151));for(var E=C=null,T=v,A=v=0,N=null,R=w.next();T!==null&&!R.done;A++,R=w.next()){T.index>A?(N=T,T=null):N=T.sibling;var O=h(y,T,R.value,S);if(O===null){T===null&&(T=N);break}t&&T&&O.alternate===null&&e(y,T),v=s(O,v,A),E===null?C=O:E.sibling=O,E=O,T=N}if(R.done)return n(y,T),xt&&na(y,A),C;if(T===null){for(;!R.done;A++,R=w.next())R=d(y,R.value,S),R!==null&&(v=s(R,v,A),E===null?C=R:E.sibling=R,E=R);return xt&&na(y,A),C}for(T=r(y,T);!R.done;A++,R=w.next())R=f(T,y,A,R.value,S),R!==null&&(t&&R.alternate!==null&&T.delete(R.key===null?A:R.key),v=s(R,v,A),E===null?C=R:E.sibling=R,E=R);return t&&T.forEach(function(j){return e(y,j)}),xt&&na(y,A),C}function b(y,v,w,S){if(typeof w=="object"&&w!==null&&w.type===hl&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case ph:e:{for(var C=w.key,E=v;E!==null;){if(E.key===C){if(C=w.type,C===hl){if(E.tag===7){n(y,E.sibling),v=i(E,w.props.children),v.return=y,y=v;break e}}else if(E.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Gs&&YS(C)===E.type){n(y,E.sibling),v=i(E,w.props),v.ref=Vu(y,E,w),v.return=y,y=v;break e}n(y,E);break}else e(y,E);E=E.sibling}w.type===hl?(v=ba(w.props.children,y.mode,S,w.key),v.return=y,y=v):(S=Of(w.type,w.key,w.props,null,y.mode,S),S.ref=Vu(y,v,w),S.return=y,y=S)}return o(y);case dl:e:{for(E=w.key;v!==null;){if(v.key===E)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(y,v.sibling),v=i(v,w.children||[]),v.return=y,y=v;break e}else{n(y,v);break}else e(y,v);v=v.sibling}v=f0(w,y.mode,S),v.return=y,y=v}return o(y);case Gs:return E=w._init,b(y,v,E(w._payload),S)}if(ac(w))return p(y,v,w,S);if(Bu(w))return g(y,v,w,S);Eh(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(y,v.sibling),v=i(v,w),v.return=y,y=v):(n(y,v),v=h0(w,y.mode,S),v.return=y,y=v),o(y)):n(y,v)}return b}var nu=PP(!0),TP=PP(!1),Kd={},Vi=Vo(Kd),Jc=Vo(Kd),Yc=Vo(Kd);function fa(t){if(t===Kd)throw Error(ie(174));return t}function Rb(t,e){switch(ct(Yc,e),ct(Jc,t),ct(Vi,Kd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Uy(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Uy(e,t)}vt(Vi),ct(Vi,e)}function ru(){vt(Vi),vt(Jc),vt(Yc)}function $P(t){fa(Yc.current);var e=fa(Vi.current),n=Uy(e,t.type);e!==n&&(ct(Jc,t),ct(Vi,n))}function Mb(t){Jc.current===t&&(vt(Vi),vt(Jc))}var Pt=Vo(0);function bp(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var o0=[];function Db(){for(var t=0;t<o0.length;t++)o0[t]._workInProgressVersionPrimary=null;o0.length=0}var Af=Ms.ReactCurrentDispatcher,a0=Ms.ReactCurrentBatchConfig,Ta=0,$t=null,Ft=null,Zt=null,xp=!1,kc=!1,qc=0,bI=0;function fn(){throw Error(ie(321))}function Ib(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!pi(t[n],e[n]))return!1;return!0}function Lb(t,e,n,r,i,s){if(Ta=s,$t=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Af.current=t===null||t.memoizedState===null?CI:EI,t=n(r,i),kc){s=0;do{if(kc=!1,qc=0,25<=s)throw Error(ie(301));s+=1,Zt=Ft=null,e.updateQueue=null,Af.current=AI,t=n(r,i)}while(kc)}if(Af.current=Sp,e=Ft!==null&&Ft.next!==null,Ta=0,Zt=Ft=$t=null,xp=!1,e)throw Error(ie(300));return t}function Bb(){var t=qc!==0;return qc=0,t}function Ai(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zt===null?$t.memoizedState=Zt=t:Zt=Zt.next=t,Zt}function Wr(){if(Ft===null){var t=$t.alternate;t=t!==null?t.memoizedState:null}else t=Ft.next;var e=Zt===null?$t.memoizedState:Zt.next;if(e!==null)Zt=e,Ft=t;else{if(t===null)throw Error(ie(310));Ft=t,t={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},Zt===null?$t.memoizedState=Zt=t:Zt=Zt.next=t}return Zt}function Qc(t,e){return typeof e=="function"?e(t):e}function l0(t){var e=Wr(),n=e.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=t;var r=Ft,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var c=u.lane;if((Ta&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,o=r):l=l.next=d,$t.lanes|=c,$a|=c}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,pi(r,e.memoizedState)||(Yn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,$t.lanes|=s,$a|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function u0(t){var e=Wr(),n=e.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);pi(s,e.memoizedState)||(Yn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function NP(){}function OP(t,e){var n=$t,r=Wr(),i=e(),s=!pi(r.memoizedState,i);if(s&&(r.memoizedState=i,Yn=!0),r=r.queue,jb(MP.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Zt!==null&&Zt.memoizedState.tag&1){if(n.flags|=2048,ed(9,RP.bind(null,n,r,i,e),void 0,null),Yt===null)throw Error(ie(349));Ta&30||_P(n,e,i)}return i}function _P(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=$t.updateQueue,e===null?(e={lastEffect:null,stores:null},$t.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function RP(t,e,n,r){e.value=n,e.getSnapshot=r,DP(e)&&IP(t)}function MP(t,e,n){return n(function(){DP(e)&&IP(t)})}function DP(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!pi(t,n)}catch{return!0}}function IP(t){var e=Ps(t,1);e!==null&&ui(e,t,1,-1)}function qS(t){var e=Ai();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Qc,lastRenderedState:t},e.queue=t,t=t.dispatch=kI.bind(null,$t,t),[e.memoizedState,t]}function ed(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=$t.updateQueue,e===null?(e={lastEffect:null,stores:null},$t.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function LP(){return Wr().memoizedState}function Pf(t,e,n,r){var i=Ai();$t.flags|=t,i.memoizedState=ed(1|e,n,void 0,r===void 0?null:r)}function Fm(t,e,n,r){var i=Wr();r=r===void 0?null:r;var s=void 0;if(Ft!==null){var o=Ft.memoizedState;if(s=o.destroy,r!==null&&Ib(r,o.deps)){i.memoizedState=ed(e,n,s,r);return}}$t.flags|=t,i.memoizedState=ed(1|e,n,s,r)}function QS(t,e){return Pf(8390656,8,t,e)}function jb(t,e){return Fm(2048,8,t,e)}function BP(t,e){return Fm(4,2,t,e)}function jP(t,e){return Fm(4,4,t,e)}function zP(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function FP(t,e,n){return n=n!=null?n.concat([t]):null,Fm(4,4,zP.bind(null,e,t),n)}function zb(){}function UP(t,e){var n=Wr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ib(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function VP(t,e){var n=Wr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ib(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function HP(t,e,n){return Ta&21?(pi(n,e)||(n=KA(),$t.lanes|=n,$a|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Yn=!0),t.memoizedState=n)}function xI(t,e){var n=tt;tt=n!==0&&4>n?n:4,t(!0);var r=a0.transition;a0.transition={};try{t(!1),e()}finally{tt=n,a0.transition=r}}function WP(){return Wr().memoizedState}function SI(t,e,n){var r=ko(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},GP(t))KP(e,n);else if(n=kP(t,e,n,r),n!==null){var i=Rn();ui(n,t,r,i),XP(n,e,r)}}function kI(t,e,n){var r=ko(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(GP(t))KP(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,pi(a,o)){var l=e.interleaved;l===null?(i.next=i,Ob(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=kP(t,e,i,r),n!==null&&(i=Rn(),ui(n,t,r,i),XP(n,e,r))}}function GP(t){var e=t.alternate;return t===$t||e!==null&&e===$t}function KP(t,e){kc=xp=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function XP(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,yb(t,n)}}var Sp={readContext:Hr,useCallback:fn,useContext:fn,useEffect:fn,useImperativeHandle:fn,useInsertionEffect:fn,useLayoutEffect:fn,useMemo:fn,useReducer:fn,useRef:fn,useState:fn,useDebugValue:fn,useDeferredValue:fn,useTransition:fn,useMutableSource:fn,useSyncExternalStore:fn,useId:fn,unstable_isNewReconciler:!1},CI={readContext:Hr,useCallback:function(t,e){return Ai().memoizedState=[t,e===void 0?null:e],t},useContext:Hr,useEffect:QS,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Pf(4194308,4,zP.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Pf(4194308,4,t,e)},useInsertionEffect:function(t,e){return Pf(4,2,t,e)},useMemo:function(t,e){var n=Ai();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Ai();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=SI.bind(null,$t,t),[r.memoizedState,t]},useRef:function(t){var e=Ai();return t={current:t},e.memoizedState=t},useState:qS,useDebugValue:zb,useDeferredValue:function(t){return Ai().memoizedState=t},useTransition:function(){var t=qS(!1),e=t[0];return t=xI.bind(null,t[1]),Ai().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=$t,i=Ai();if(xt){if(n===void 0)throw Error(ie(407));n=n()}else{if(n=e(),Yt===null)throw Error(ie(349));Ta&30||_P(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,QS(MP.bind(null,r,s,t),[t]),r.flags|=2048,ed(9,RP.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Ai(),e=Yt.identifierPrefix;if(xt){var n=ps,r=fs;n=(r&~(1<<32-li(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=qc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=bI++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},EI={readContext:Hr,useCallback:UP,useContext:Hr,useEffect:jb,useImperativeHandle:FP,useInsertionEffect:BP,useLayoutEffect:jP,useMemo:VP,useReducer:l0,useRef:LP,useState:function(){return l0(Qc)},useDebugValue:zb,useDeferredValue:function(t){var e=Wr();return HP(e,Ft.memoizedState,t)},useTransition:function(){var t=l0(Qc)[0],e=Wr().memoizedState;return[t,e]},useMutableSource:NP,useSyncExternalStore:OP,useId:WP,unstable_isNewReconciler:!1},AI={readContext:Hr,useCallback:UP,useContext:Hr,useEffect:jb,useImperativeHandle:FP,useInsertionEffect:BP,useLayoutEffect:jP,useMemo:VP,useReducer:u0,useRef:LP,useState:function(){return u0(Qc)},useDebugValue:zb,useDeferredValue:function(t){var e=Wr();return Ft===null?e.memoizedState=t:HP(e,Ft.memoizedState,t)},useTransition:function(){var t=u0(Qc)[0],e=Wr().memoizedState;return[t,e]},useMutableSource:NP,useSyncExternalStore:OP,useId:WP,unstable_isNewReconciler:!1};function iu(t,e){try{var n="",r=e;do n+=e3(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function c0(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function dv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var PI=typeof WeakMap=="function"?WeakMap:Map;function ZP(t,e,n){n=ys(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Cp||(Cp=!0,xv=r),dv(t,e)},n}function JP(t,e,n){n=ys(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){dv(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){dv(t,e),typeof r!="function"&&(So===null?So=new Set([this]):So.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function ek(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new PI;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=FI.bind(null,t,e,n),e.then(t,t))}function tk(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function nk(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ys(-1,1),e.tag=2,xo(n,e,1))),n.lanes|=1),t)}var TI=Ms.ReactCurrentOwner,Yn=!1;function Tn(t,e,n,r){e.child=t===null?TP(e,null,n,r):nu(e,t.child,n,r)}function rk(t,e,n,r,i){n=n.render;var s=e.ref;return _l(e,i),r=Lb(t,e,n,r,s,i),n=Bb(),t!==null&&!Yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ts(t,e,i)):(xt&&n&&Eb(e),e.flags|=1,Tn(t,e,r,i),e.child)}function ik(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Xb(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,YP(t,e,s,r,i)):(t=Of(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Gc,n(o,r)&&t.ref===e.ref)return Ts(t,e,i)}return e.flags|=1,t=Co(s,r),t.ref=e.ref,t.return=e,e.child=t}function YP(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Gc(s,r)&&t.ref===e.ref)if(Yn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Yn=!0);else return e.lanes=t.lanes,Ts(t,e,i)}return hv(t,e,n,r,i)}function qP(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ct(Sl,ur),ur|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ct(Sl,ur),ur|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ct(Sl,ur),ur|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,ct(Sl,ur),ur|=r;return Tn(t,e,i,n),e.child}function QP(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function hv(t,e,n,r,i){var s=er(n)?Aa:Sn.current;return s=eu(e,s),_l(e,i),n=Lb(t,e,n,r,s,i),r=Bb(),t!==null&&!Yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Ts(t,e,i)):(xt&&r&&Eb(e),e.flags|=1,Tn(t,e,n,i),e.child)}function sk(t,e,n,r,i){if(er(n)){var s=!0;pp(e)}else s=!1;if(_l(e,i),e.stateNode===null)Tf(t,e),AP(e,n,r),cv(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Hr(u):(u=er(n)?Aa:Sn.current,u=eu(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&JS(e,o,r,u),Ks=!1;var h=e.memoizedState;o.state=h,wp(e,r,o,i),l=e.memoizedState,a!==r||h!==l||Qn.current||Ks?(typeof c=="function"&&(uv(e,n,c,r),l=e.memoizedState),(a=Ks||ZS(e,n,a,r,h,l,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,CP(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Yr(e.type,a),o.props=u,d=e.pendingProps,h=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Hr(l):(l=er(n)?Aa:Sn.current,l=eu(e,l));var f=n.getDerivedStateFromProps;(c=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||h!==l)&&JS(e,o,r,l),Ks=!1,h=e.memoizedState,o.state=h,wp(e,r,o,i);var p=e.memoizedState;a!==d||h!==p||Qn.current||Ks?(typeof f=="function"&&(uv(e,n,f,r),p=e.memoizedState),(u=Ks||ZS(e,n,u,r,h,p,l)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,p,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,p,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),o.props=r,o.state=p,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return fv(t,e,n,r,s,i)}function fv(t,e,n,r,i,s){QP(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&HS(e,n,!1),Ts(t,e,s);r=e.stateNode,TI.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=nu(e,t.child,null,s),e.child=nu(e,null,a,s)):Tn(t,e,a,s),e.memoizedState=r.state,i&&HS(e,n,!0),e.child}function eT(t){var e=t.stateNode;e.pendingContext?VS(t,e.pendingContext,e.pendingContext!==e.context):e.context&&VS(t,e.context,!1),Rb(t,e.containerInfo)}function ok(t,e,n,r,i){return tu(),Pb(i),e.flags|=256,Tn(t,e,n,r),e.child}var pv={dehydrated:null,treeContext:null,retryLane:0};function mv(t){return{baseLanes:t,cachePool:null,transitions:null}}function tT(t,e,n){var r=e.pendingProps,i=Pt.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ct(Pt,i&1),t===null)return av(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Hm(o,r,0,null),t=ba(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=mv(n),e.memoizedState=pv,t):Fb(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return $I(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Co(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Co(a,s):(s=ba(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?mv(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=pv,r}return s=t.child,t=s.sibling,r=Co(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Fb(t,e){return e=Hm({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ah(t,e,n,r){return r!==null&&Pb(r),nu(e,t.child,null,n),t=Fb(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function $I(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=c0(Error(ie(422))),Ah(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Hm({mode:"visible",children:r.children},i,0,null),s=ba(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&nu(e,t.child,null,o),e.child.memoizedState=mv(o),e.memoizedState=pv,s);if(!(e.mode&1))return Ah(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(ie(419)),r=c0(s,r,void 0),Ah(t,e,o,r)}if(a=(o&t.childLanes)!==0,Yn||a){if(r=Yt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ps(t,i),ui(r,t,i,-1))}return Kb(),r=c0(Error(ie(421))),Ah(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=UI.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,pr=bo(i.nextSibling),vr=e,xt=!0,ni=null,t!==null&&(_r[Rr++]=fs,_r[Rr++]=ps,_r[Rr++]=Pa,fs=t.id,ps=t.overflow,Pa=e),e=Fb(e,r.children),e.flags|=4096,e)}function ak(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),lv(t.return,e,n)}function d0(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function nT(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Tn(t,e,r.children,n),r=Pt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ak(t,n,e);else if(t.tag===19)ak(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ct(Pt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&bp(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),d0(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&bp(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}d0(e,!0,n,null,s);break;case"together":d0(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Tf(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ts(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),$a|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ie(153));if(e.child!==null){for(t=e.child,n=Co(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Co(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function NI(t,e,n){switch(e.tag){case 3:eT(e),tu();break;case 5:$P(e);break;case 1:er(e.type)&&pp(e);break;case 4:Rb(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ct(yp,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ct(Pt,Pt.current&1),e.flags|=128,null):n&e.child.childLanes?tT(t,e,n):(ct(Pt,Pt.current&1),t=Ts(t,e,n),t!==null?t.sibling:null);ct(Pt,Pt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return nT(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ct(Pt,Pt.current),r)break;return null;case 22:case 23:return e.lanes=0,qP(t,e,n)}return Ts(t,e,n)}var rT,gv,iT,sT;rT=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};gv=function(){};iT=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,fa(Vi.current);var s=null;switch(n){case"input":i=By(t,i),r=By(t,r),s=[];break;case"select":i=Ot({},i,{value:void 0}),r=Ot({},r,{value:void 0}),s=[];break;case"textarea":i=Fy(t,i),r=Fy(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=hp)}Vy(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(jc.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(jc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&ft("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};sT=function(t,e,n,r){n!==r&&(e.flags|=4)};function Hu(t,e){if(!xt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function pn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function OI(t,e,n){var r=e.pendingProps;switch(Ab(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pn(e),null;case 1:return er(e.type)&&fp(),pn(e),null;case 3:return r=e.stateNode,ru(),vt(Qn),vt(Sn),Db(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ch(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ni!==null&&(Cv(ni),ni=null))),gv(t,e),pn(e),null;case 5:Mb(e);var i=fa(Yc.current);if(n=e.type,t!==null&&e.stateNode!=null)iT(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ie(166));return pn(e),null}if(t=fa(Vi.current),Ch(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Di]=e,r[Zc]=s,t=(e.mode&1)!==0,n){case"dialog":ft("cancel",r),ft("close",r);break;case"iframe":case"object":case"embed":ft("load",r);break;case"video":case"audio":for(i=0;i<uc.length;i++)ft(uc[i],r);break;case"source":ft("error",r);break;case"img":case"image":case"link":ft("error",r),ft("load",r);break;case"details":ft("toggle",r);break;case"input":gS(r,s),ft("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ft("invalid",r);break;case"textarea":vS(r,s),ft("invalid",r)}Vy(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&kh(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&kh(r.textContent,a,t),i=["children",""+a]):jc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ft("scroll",r)}switch(n){case"input":mh(r),yS(r,s,!0);break;case"textarea":mh(r),wS(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=hp)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=_A(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Di]=e,t[Zc]=r,rT(t,e,!1,!1),e.stateNode=t;e:{switch(o=Hy(n,r),n){case"dialog":ft("cancel",t),ft("close",t),i=r;break;case"iframe":case"object":case"embed":ft("load",t),i=r;break;case"video":case"audio":for(i=0;i<uc.length;i++)ft(uc[i],t);i=r;break;case"source":ft("error",t),i=r;break;case"img":case"image":case"link":ft("error",t),ft("load",t),i=r;break;case"details":ft("toggle",t),i=r;break;case"input":gS(t,r),i=By(t,r),ft("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Ot({},r,{value:void 0}),ft("invalid",t);break;case"textarea":vS(t,r),i=Fy(t,r),ft("invalid",t);break;default:i=r}Vy(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?DA(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&RA(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&zc(t,l):typeof l=="number"&&zc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(jc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ft("scroll",t):l!=null&&db(t,s,l,o))}switch(n){case"input":mh(t),yS(t,r,!1);break;case"textarea":mh(t),wS(t);break;case"option":r.value!=null&&t.setAttribute("value",""+To(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Tl(t,!!r.multiple,s,!1):r.defaultValue!=null&&Tl(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=hp)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return pn(e),null;case 6:if(t&&e.stateNode!=null)sT(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ie(166));if(n=fa(Yc.current),fa(Vi.current),Ch(e)){if(r=e.stateNode,n=e.memoizedProps,r[Di]=e,(s=r.nodeValue!==n)&&(t=vr,t!==null))switch(t.tag){case 3:kh(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&kh(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Di]=e,e.stateNode=r}return pn(e),null;case 13:if(vt(Pt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(xt&&pr!==null&&e.mode&1&&!(e.flags&128))SP(),tu(),e.flags|=98560,s=!1;else if(s=Ch(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ie(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ie(317));s[Di]=e}else tu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;pn(e),s=!1}else ni!==null&&(Cv(ni),ni=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Pt.current&1?Wt===0&&(Wt=3):Kb())),e.updateQueue!==null&&(e.flags|=4),pn(e),null);case 4:return ru(),gv(t,e),t===null&&Kc(e.stateNode.containerInfo),pn(e),null;case 10:return Nb(e.type._context),pn(e),null;case 17:return er(e.type)&&fp(),pn(e),null;case 19:if(vt(Pt),s=e.memoizedState,s===null)return pn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Hu(s,!1);else{if(Wt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=bp(t),o!==null){for(e.flags|=128,Hu(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ct(Pt,Pt.current&1|2),e.child}t=t.sibling}s.tail!==null&&It()>su&&(e.flags|=128,r=!0,Hu(s,!1),e.lanes=4194304)}else{if(!r)if(t=bp(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Hu(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!xt)return pn(e),null}else 2*It()-s.renderingStartTime>su&&n!==1073741824&&(e.flags|=128,r=!0,Hu(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=It(),e.sibling=null,n=Pt.current,ct(Pt,r?n&1|2:n&1),e):(pn(e),null);case 22:case 23:return Gb(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ur&1073741824&&(pn(e),e.subtreeFlags&6&&(e.flags|=8192)):pn(e),null;case 24:return null;case 25:return null}throw Error(ie(156,e.tag))}function _I(t,e){switch(Ab(e),e.tag){case 1:return er(e.type)&&fp(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ru(),vt(Qn),vt(Sn),Db(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Mb(e),null;case 13:if(vt(Pt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ie(340));tu()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return vt(Pt),null;case 4:return ru(),null;case 10:return Nb(e.type._context),null;case 22:case 23:return Gb(),null;case 24:return null;default:return null}}var Ph=!1,vn=!1,RI=typeof WeakSet=="function"?WeakSet:Set,ve=null;function xl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Rt(t,e,r)}else n.current=null}function yv(t,e,n){try{n()}catch(r){Rt(t,e,r)}}var lk=!1;function MI(t,e){if(ev=up,t=uP(),Cb(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,c=0,d=t,h=null;t:for(;;){for(var f;d!==n||i!==0&&d.nodeType!==3||(a=o+i),d!==s||r!==0&&d.nodeType!==3||(l=o+r),d.nodeType===3&&(o+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++u===i&&(a=o),h===s&&++c===r&&(l=o),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(tv={focusedElem:t,selectionRange:n},up=!1,ve=e;ve!==null;)if(e=ve,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ve=t;else for(;ve!==null;){e=ve;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,b=p.memoizedState,y=e.stateNode,v=y.getSnapshotBeforeUpdate(e.elementType===e.type?g:Yr(e.type,g),b);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ie(163))}}catch(S){Rt(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,ve=t;break}ve=e.return}return p=lk,lk=!1,p}function Cc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&yv(e,n,s)}i=i.next}while(i!==r)}}function Um(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function vv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function oT(t){var e=t.alternate;e!==null&&(t.alternate=null,oT(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Di],delete e[Zc],delete e[iv],delete e[gI],delete e[yI])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function aT(t){return t.tag===5||t.tag===3||t.tag===4}function uk(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||aT(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function wv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=hp));else if(r!==4&&(t=t.child,t!==null))for(wv(t,e,n),t=t.sibling;t!==null;)wv(t,e,n),t=t.sibling}function bv(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(bv(t,e,n),t=t.sibling;t!==null;)bv(t,e,n),t=t.sibling}var en=null,ti=!1;function Us(t,e,n){for(n=n.child;n!==null;)lT(t,e,n),n=n.sibling}function lT(t,e,n){if(Ui&&typeof Ui.onCommitFiberUnmount=="function")try{Ui.onCommitFiberUnmount(Mm,n)}catch{}switch(n.tag){case 5:vn||xl(n,e);case 6:var r=en,i=ti;en=null,Us(t,e,n),en=r,ti=i,en!==null&&(ti?(t=en,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):en.removeChild(n.stateNode));break;case 18:en!==null&&(ti?(t=en,n=n.stateNode,t.nodeType===8?i0(t.parentNode,n):t.nodeType===1&&i0(t,n),Hc(t)):i0(en,n.stateNode));break;case 4:r=en,i=ti,en=n.stateNode.containerInfo,ti=!0,Us(t,e,n),en=r,ti=i;break;case 0:case 11:case 14:case 15:if(!vn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&yv(n,e,o),i=i.next}while(i!==r)}Us(t,e,n);break;case 1:if(!vn&&(xl(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Rt(n,e,a)}Us(t,e,n);break;case 21:Us(t,e,n);break;case 22:n.mode&1?(vn=(r=vn)||n.memoizedState!==null,Us(t,e,n),vn=r):Us(t,e,n);break;default:Us(t,e,n)}}function ck(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new RI),e.forEach(function(r){var i=VI.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Zr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:en=a.stateNode,ti=!1;break e;case 3:en=a.stateNode.containerInfo,ti=!0;break e;case 4:en=a.stateNode.containerInfo,ti=!0;break e}a=a.return}if(en===null)throw Error(ie(160));lT(s,o,i),en=null,ti=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){Rt(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)uT(e,t),e=e.sibling}function uT(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Zr(e,t),xi(t),r&4){try{Cc(3,t,t.return),Um(3,t)}catch(g){Rt(t,t.return,g)}try{Cc(5,t,t.return)}catch(g){Rt(t,t.return,g)}}break;case 1:Zr(e,t),xi(t),r&512&&n!==null&&xl(n,n.return);break;case 5:if(Zr(e,t),xi(t),r&512&&n!==null&&xl(n,n.return),t.flags&32){var i=t.stateNode;try{zc(i,"")}catch(g){Rt(t,t.return,g)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&NA(i,s),Hy(a,o);var u=Hy(a,s);for(o=0;o<l.length;o+=2){var c=l[o],d=l[o+1];c==="style"?DA(i,d):c==="dangerouslySetInnerHTML"?RA(i,d):c==="children"?zc(i,d):db(i,c,d,u)}switch(a){case"input":jy(i,s);break;case"textarea":OA(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?Tl(i,!!s.multiple,f,!1):h!==!!s.multiple&&(s.defaultValue!=null?Tl(i,!!s.multiple,s.defaultValue,!0):Tl(i,!!s.multiple,s.multiple?[]:"",!1))}i[Zc]=s}catch(g){Rt(t,t.return,g)}}break;case 6:if(Zr(e,t),xi(t),r&4){if(t.stateNode===null)throw Error(ie(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(g){Rt(t,t.return,g)}}break;case 3:if(Zr(e,t),xi(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Hc(e.containerInfo)}catch(g){Rt(t,t.return,g)}break;case 4:Zr(e,t),xi(t);break;case 13:Zr(e,t),xi(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Hb=It())),r&4&&ck(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(vn=(u=vn)||c,Zr(e,t),vn=u):Zr(e,t),xi(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(ve=t,c=t.child;c!==null;){for(d=ve=c;ve!==null;){switch(h=ve,f=h.child,h.tag){case 0:case 11:case 14:case 15:Cc(4,h,h.return);break;case 1:xl(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(g){Rt(r,n,g)}}break;case 5:xl(h,h.return);break;case 22:if(h.memoizedState!==null){hk(d);continue}}f!==null?(f.return=h,ve=f):hk(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{i=d.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,l=d.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=MA("display",o))}catch(g){Rt(t,t.return,g)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Rt(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Zr(e,t),xi(t),r&4&&ck(t);break;case 21:break;default:Zr(e,t),xi(t)}}function xi(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(aT(n)){var r=n;break e}n=n.return}throw Error(ie(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(zc(i,""),r.flags&=-33);var s=uk(t);bv(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=uk(t);wv(t,a,o);break;default:throw Error(ie(161))}}catch(l){Rt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function DI(t,e,n){ve=t,cT(t)}function cT(t,e,n){for(var r=(t.mode&1)!==0;ve!==null;){var i=ve,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Ph;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||vn;a=Ph;var u=vn;if(Ph=o,(vn=l)&&!u)for(ve=i;ve!==null;)o=ve,l=o.child,o.tag===22&&o.memoizedState!==null?fk(i):l!==null?(l.return=o,ve=l):fk(i);for(;s!==null;)ve=s,cT(s),s=s.sibling;ve=i,Ph=a,vn=u}dk(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ve=s):dk(t)}}function dk(t){for(;ve!==null;){var e=ve;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:vn||Um(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!vn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Yr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&XS(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}XS(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Hc(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ie(163))}vn||e.flags&512&&vv(e)}catch(h){Rt(e,e.return,h)}}if(e===t){ve=null;break}if(n=e.sibling,n!==null){n.return=e.return,ve=n;break}ve=e.return}}function hk(t){for(;ve!==null;){var e=ve;if(e===t){ve=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ve=n;break}ve=e.return}}function fk(t){for(;ve!==null;){var e=ve;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Um(4,e)}catch(l){Rt(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Rt(e,i,l)}}var s=e.return;try{vv(e)}catch(l){Rt(e,s,l)}break;case 5:var o=e.return;try{vv(e)}catch(l){Rt(e,o,l)}}}catch(l){Rt(e,e.return,l)}if(e===t){ve=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ve=a;break}ve=e.return}}var II=Math.ceil,kp=Ms.ReactCurrentDispatcher,Ub=Ms.ReactCurrentOwner,jr=Ms.ReactCurrentBatchConfig,Xe=0,Yt=null,Bt=null,un=0,ur=0,Sl=Vo(0),Wt=0,td=null,$a=0,Vm=0,Vb=0,Ec=null,Zn=null,Hb=0,su=1/0,qi=null,Cp=!1,xv=null,So=null,Th=!1,uo=null,Ep=0,Ac=0,Sv=null,$f=-1,Nf=0;function Rn(){return Xe&6?It():$f!==-1?$f:$f=It()}function ko(t){return t.mode&1?Xe&2&&un!==0?un&-un:wI.transition!==null?(Nf===0&&(Nf=KA()),Nf):(t=tt,t!==0||(t=window.event,t=t===void 0?16:eP(t.type)),t):1}function ui(t,e,n,r){if(50<Ac)throw Ac=0,Sv=null,Error(ie(185));Hd(t,n,r),(!(Xe&2)||t!==Yt)&&(t===Yt&&(!(Xe&2)&&(Vm|=n),Wt===4&&Qs(t,un)),tr(t,r),n===1&&Xe===0&&!(e.mode&1)&&(su=It()+500,jm&&Ho()))}function tr(t,e){var n=t.callbackNode;w3(t,e);var r=lp(t,t===Yt?un:0);if(r===0)n!==null&&SS(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&SS(n),e===1)t.tag===0?vI(pk.bind(null,t)):wP(pk.bind(null,t)),pI(function(){!(Xe&6)&&Ho()}),n=null;else{switch(XA(r)){case 1:n=gb;break;case 4:n=WA;break;case 16:n=ap;break;case 536870912:n=GA;break;default:n=ap}n=vT(n,dT.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function dT(t,e){if($f=-1,Nf=0,Xe&6)throw Error(ie(327));var n=t.callbackNode;if(Rl()&&t.callbackNode!==n)return null;var r=lp(t,t===Yt?un:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ap(t,r);else{e=r;var i=Xe;Xe|=2;var s=fT();(Yt!==t||un!==e)&&(qi=null,su=It()+500,wa(t,e));do try{jI();break}catch(a){hT(t,a)}while(1);$b(),kp.current=s,Xe=i,Bt!==null?e=0:(Yt=null,un=0,e=Wt)}if(e!==0){if(e===2&&(i=Zy(t),i!==0&&(r=i,e=kv(t,i))),e===1)throw n=td,wa(t,0),Qs(t,r),tr(t,It()),n;if(e===6)Qs(t,r);else{if(i=t.current.alternate,!(r&30)&&!LI(i)&&(e=Ap(t,r),e===2&&(s=Zy(t),s!==0&&(r=s,e=kv(t,s))),e===1))throw n=td,wa(t,0),Qs(t,r),tr(t,It()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ie(345));case 2:ra(t,Zn,qi);break;case 3:if(Qs(t,r),(r&130023424)===r&&(e=Hb+500-It(),10<e)){if(lp(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Rn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=rv(ra.bind(null,t,Zn,qi),e);break}ra(t,Zn,qi);break;case 4:if(Qs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-li(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=It()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*II(r/1960))-r,10<r){t.timeoutHandle=rv(ra.bind(null,t,Zn,qi),r);break}ra(t,Zn,qi);break;case 5:ra(t,Zn,qi);break;default:throw Error(ie(329))}}}return tr(t,It()),t.callbackNode===n?dT.bind(null,t):null}function kv(t,e){var n=Ec;return t.current.memoizedState.isDehydrated&&(wa(t,e).flags|=256),t=Ap(t,e),t!==2&&(e=Zn,Zn=n,e!==null&&Cv(e)),t}function Cv(t){Zn===null?Zn=t:Zn.push.apply(Zn,t)}function LI(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!pi(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Qs(t,e){for(e&=~Vb,e&=~Vm,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-li(e),r=1<<n;t[n]=-1,e&=~r}}function pk(t){if(Xe&6)throw Error(ie(327));Rl();var e=lp(t,0);if(!(e&1))return tr(t,It()),null;var n=Ap(t,e);if(t.tag!==0&&n===2){var r=Zy(t);r!==0&&(e=r,n=kv(t,r))}if(n===1)throw n=td,wa(t,0),Qs(t,e),tr(t,It()),n;if(n===6)throw Error(ie(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ra(t,Zn,qi),tr(t,It()),null}function Wb(t,e){var n=Xe;Xe|=1;try{return t(e)}finally{Xe=n,Xe===0&&(su=It()+500,jm&&Ho())}}function Na(t){uo!==null&&uo.tag===0&&!(Xe&6)&&Rl();var e=Xe;Xe|=1;var n=jr.transition,r=tt;try{if(jr.transition=null,tt=1,t)return t()}finally{tt=r,jr.transition=n,Xe=e,!(Xe&6)&&Ho()}}function Gb(){ur=Sl.current,vt(Sl)}function wa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,fI(n)),Bt!==null)for(n=Bt.return;n!==null;){var r=n;switch(Ab(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&fp();break;case 3:ru(),vt(Qn),vt(Sn),Db();break;case 5:Mb(r);break;case 4:ru();break;case 13:vt(Pt);break;case 19:vt(Pt);break;case 10:Nb(r.type._context);break;case 22:case 23:Gb()}n=n.return}if(Yt=t,Bt=t=Co(t.current,null),un=ur=e,Wt=0,td=null,Vb=Vm=$a=0,Zn=Ec=null,ha!==null){for(e=0;e<ha.length;e++)if(n=ha[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}ha=null}return t}function hT(t,e){do{var n=Bt;try{if($b(),Af.current=Sp,xp){for(var r=$t.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}xp=!1}if(Ta=0,Zt=Ft=$t=null,kc=!1,qc=0,Ub.current=null,n===null||n.return===null){Wt=1,td=e,Bt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=un,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var h=c.alternate;h?(c.updateQueue=h.updateQueue,c.memoizedState=h.memoizedState,c.lanes=h.lanes):(c.updateQueue=null,c.memoizedState=null)}var f=tk(o);if(f!==null){f.flags&=-257,nk(f,o,a,s,e),f.mode&1&&ek(s,u,e),e=f,l=u;var p=e.updateQueue;if(p===null){var g=new Set;g.add(l),e.updateQueue=g}else p.add(l);break e}else{if(!(e&1)){ek(s,u,e),Kb();break e}l=Error(ie(426))}}else if(xt&&a.mode&1){var b=tk(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),nk(b,o,a,s,e),Pb(iu(l,a));break e}}s=l=iu(l,a),Wt!==4&&(Wt=2),Ec===null?Ec=[s]:Ec.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=ZP(s,l,e);KS(s,y);break e;case 1:a=l;var v=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(So===null||!So.has(w)))){s.flags|=65536,e&=-e,s.lanes|=e;var S=JP(s,a,e);KS(s,S);break e}}s=s.return}while(s!==null)}mT(n)}catch(C){e=C,Bt===n&&n!==null&&(Bt=n=n.return);continue}break}while(1)}function fT(){var t=kp.current;return kp.current=Sp,t===null?Sp:t}function Kb(){(Wt===0||Wt===3||Wt===2)&&(Wt=4),Yt===null||!($a&268435455)&&!(Vm&268435455)||Qs(Yt,un)}function Ap(t,e){var n=Xe;Xe|=2;var r=fT();(Yt!==t||un!==e)&&(qi=null,wa(t,e));do try{BI();break}catch(i){hT(t,i)}while(1);if($b(),Xe=n,kp.current=r,Bt!==null)throw Error(ie(261));return Yt=null,un=0,Wt}function BI(){for(;Bt!==null;)pT(Bt)}function jI(){for(;Bt!==null&&!c3();)pT(Bt)}function pT(t){var e=yT(t.alternate,t,ur);t.memoizedProps=t.pendingProps,e===null?mT(t):Bt=e,Ub.current=null}function mT(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=_I(n,e),n!==null){n.flags&=32767,Bt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Wt=6,Bt=null;return}}else if(n=OI(n,e,ur),n!==null){Bt=n;return}if(e=e.sibling,e!==null){Bt=e;return}Bt=e=t}while(e!==null);Wt===0&&(Wt=5)}function ra(t,e,n){var r=tt,i=jr.transition;try{jr.transition=null,tt=1,zI(t,e,n,r)}finally{jr.transition=i,tt=r}return null}function zI(t,e,n,r){do Rl();while(uo!==null);if(Xe&6)throw Error(ie(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ie(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(b3(t,s),t===Yt&&(Bt=Yt=null,un=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Th||(Th=!0,vT(ap,function(){return Rl(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=jr.transition,jr.transition=null;var o=tt;tt=1;var a=Xe;Xe|=4,Ub.current=null,MI(t,n),uT(n,t),oI(tv),up=!!ev,tv=ev=null,t.current=n,DI(n),d3(),Xe=a,tt=o,jr.transition=s}else t.current=n;if(Th&&(Th=!1,uo=t,Ep=i),s=t.pendingLanes,s===0&&(So=null),p3(n.stateNode),tr(t,It()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Cp)throw Cp=!1,t=xv,xv=null,t;return Ep&1&&t.tag!==0&&Rl(),s=t.pendingLanes,s&1?t===Sv?Ac++:(Ac=0,Sv=t):Ac=0,Ho(),null}function Rl(){if(uo!==null){var t=XA(Ep),e=jr.transition,n=tt;try{if(jr.transition=null,tt=16>t?16:t,uo===null)var r=!1;else{if(t=uo,uo=null,Ep=0,Xe&6)throw Error(ie(331));var i=Xe;for(Xe|=4,ve=t.current;ve!==null;){var s=ve,o=s.child;if(ve.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(ve=u;ve!==null;){var c=ve;switch(c.tag){case 0:case 11:case 15:Cc(8,c,s)}var d=c.child;if(d!==null)d.return=c,ve=d;else for(;ve!==null;){c=ve;var h=c.sibling,f=c.return;if(oT(c),c===u){ve=null;break}if(h!==null){h.return=f,ve=h;break}ve=f}}}var p=s.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var b=g.sibling;g.sibling=null,g=b}while(g!==null)}}ve=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ve=o;else e:for(;ve!==null;){if(s=ve,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Cc(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,ve=y;break e}ve=s.return}}var v=t.current;for(ve=v;ve!==null;){o=ve;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,ve=w;else e:for(o=v;ve!==null;){if(a=ve,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Um(9,a)}}catch(C){Rt(a,a.return,C)}if(a===o){ve=null;break e}var S=a.sibling;if(S!==null){S.return=a.return,ve=S;break e}ve=a.return}}if(Xe=i,Ho(),Ui&&typeof Ui.onPostCommitFiberRoot=="function")try{Ui.onPostCommitFiberRoot(Mm,t)}catch{}r=!0}return r}finally{tt=n,jr.transition=e}}return!1}function mk(t,e,n){e=iu(n,e),e=ZP(t,e,1),t=xo(t,e,1),e=Rn(),t!==null&&(Hd(t,1,e),tr(t,e))}function Rt(t,e,n){if(t.tag===3)mk(t,t,n);else for(;e!==null;){if(e.tag===3){mk(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(So===null||!So.has(r))){t=iu(n,t),t=JP(e,t,1),e=xo(e,t,1),t=Rn(),e!==null&&(Hd(e,1,t),tr(e,t));break}}e=e.return}}function FI(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Rn(),t.pingedLanes|=t.suspendedLanes&n,Yt===t&&(un&n)===n&&(Wt===4||Wt===3&&(un&130023424)===un&&500>It()-Hb?wa(t,0):Vb|=n),tr(t,e)}function gT(t,e){e===0&&(t.mode&1?(e=vh,vh<<=1,!(vh&130023424)&&(vh=4194304)):e=1);var n=Rn();t=Ps(t,e),t!==null&&(Hd(t,e,n),tr(t,n))}function UI(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),gT(t,n)}function VI(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ie(314))}r!==null&&r.delete(e),gT(t,n)}var yT;yT=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Qn.current)Yn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Yn=!1,NI(t,e,n);Yn=!!(t.flags&131072)}else Yn=!1,xt&&e.flags&1048576&&bP(e,gp,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Tf(t,e),t=e.pendingProps;var i=eu(e,Sn.current);_l(e,n),i=Lb(null,e,r,t,i,n);var s=Bb();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,er(r)?(s=!0,pp(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,_b(e),i.updater=zm,e.stateNode=i,i._reactInternals=e,cv(e,r,t,n),e=fv(null,e,r,!0,s,n)):(e.tag=0,xt&&s&&Eb(e),Tn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Tf(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=WI(r),t=Yr(r,t),i){case 0:e=hv(null,e,r,t,n);break e;case 1:e=sk(null,e,r,t,n);break e;case 11:e=rk(null,e,r,t,n);break e;case 14:e=ik(null,e,r,Yr(r.type,t),n);break e}throw Error(ie(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yr(r,i),hv(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yr(r,i),sk(t,e,r,i,n);case 3:e:{if(eT(e),t===null)throw Error(ie(387));r=e.pendingProps,s=e.memoizedState,i=s.element,CP(t,e),wp(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=iu(Error(ie(423)),e),e=ok(t,e,r,n,i);break e}else if(r!==i){i=iu(Error(ie(424)),e),e=ok(t,e,r,n,i);break e}else for(pr=bo(e.stateNode.containerInfo.firstChild),vr=e,xt=!0,ni=null,n=TP(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(tu(),r===i){e=Ts(t,e,n);break e}Tn(t,e,r,n)}e=e.child}return e;case 5:return $P(e),t===null&&av(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,nv(r,i)?o=null:s!==null&&nv(r,s)&&(e.flags|=32),QP(t,e),Tn(t,e,o,n),e.child;case 6:return t===null&&av(e),null;case 13:return tT(t,e,n);case 4:return Rb(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=nu(e,null,r,n):Tn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yr(r,i),rk(t,e,r,i,n);case 7:return Tn(t,e,e.pendingProps,n),e.child;case 8:return Tn(t,e,e.pendingProps.children,n),e.child;case 12:return Tn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,ct(yp,r._currentValue),r._currentValue=o,s!==null)if(pi(s.value,o)){if(s.children===i.children&&!Qn.current){e=Ts(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=ys(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),lv(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ie(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),lv(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Tn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,_l(e,n),i=Hr(i),r=r(i),e.flags|=1,Tn(t,e,r,n),e.child;case 14:return r=e.type,i=Yr(r,e.pendingProps),i=Yr(r.type,i),ik(t,e,r,i,n);case 15:return YP(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Yr(r,i),Tf(t,e),e.tag=1,er(r)?(t=!0,pp(e)):t=!1,_l(e,n),AP(e,r,i),cv(e,r,i,n),fv(null,e,r,!0,t,n);case 19:return nT(t,e,n);case 22:return qP(t,e,n)}throw Error(ie(156,e.tag))};function vT(t,e){return HA(t,e)}function HI(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ir(t,e,n,r){return new HI(t,e,n,r)}function Xb(t){return t=t.prototype,!(!t||!t.isReactComponent)}function WI(t){if(typeof t=="function")return Xb(t)?1:0;if(t!=null){if(t=t.$$typeof,t===fb)return 11;if(t===pb)return 14}return 2}function Co(t,e){var n=t.alternate;return n===null?(n=Ir(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Of(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Xb(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case hl:return ba(n.children,i,s,e);case hb:o=8,i|=8;break;case My:return t=Ir(12,n,e,i|2),t.elementType=My,t.lanes=s,t;case Dy:return t=Ir(13,n,e,i),t.elementType=Dy,t.lanes=s,t;case Iy:return t=Ir(19,n,e,i),t.elementType=Iy,t.lanes=s,t;case PA:return Hm(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case EA:o=10;break e;case AA:o=9;break e;case fb:o=11;break e;case pb:o=14;break e;case Gs:o=16,r=null;break e}throw Error(ie(130,t==null?t:typeof t,""))}return e=Ir(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function ba(t,e,n,r){return t=Ir(7,t,r,e),t.lanes=n,t}function Hm(t,e,n,r){return t=Ir(22,t,r,e),t.elementType=PA,t.lanes=n,t.stateNode={isHidden:!1},t}function h0(t,e,n){return t=Ir(6,t,null,e),t.lanes=n,t}function f0(t,e,n){return e=Ir(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function GI(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kg(0),this.expirationTimes=Kg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kg(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Zb(t,e,n,r,i,s,o,a,l){return t=new GI(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ir(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},_b(s),t}function KI(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dl,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function wT(t){if(!t)return $o;t=t._reactInternals;e:{if(Va(t)!==t||t.tag!==1)throw Error(ie(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(er(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ie(171))}if(t.tag===1){var n=t.type;if(er(n))return vP(t,n,e)}return e}function bT(t,e,n,r,i,s,o,a,l){return t=Zb(n,r,!0,t,i,s,o,a,l),t.context=wT(null),n=t.current,r=Rn(),i=ko(n),s=ys(r,i),s.callback=e??null,xo(n,s,i),t.current.lanes=i,Hd(t,i,r),tr(t,r),t}function Wm(t,e,n,r){var i=e.current,s=Rn(),o=ko(i);return n=wT(n),e.context===null?e.context=n:e.pendingContext=n,e=ys(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=xo(i,e,o),t!==null&&(ui(t,i,o,s),Ef(t,i,o)),o}function Pp(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function gk(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Jb(t,e){gk(t,e),(t=t.alternate)&&gk(t,e)}function XI(){return null}var xT=typeof reportError=="function"?reportError:function(t){console.error(t)};function Yb(t){this._internalRoot=t}Gm.prototype.render=Yb.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ie(409));Wm(t,e,null,null)};Gm.prototype.unmount=Yb.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Na(function(){Wm(null,t,null,null)}),e[As]=null}};function Gm(t){this._internalRoot=t}Gm.prototype.unstable_scheduleHydration=function(t){if(t){var e=YA();t={blockedOn:null,target:t,priority:e};for(var n=0;n<qs.length&&e!==0&&e<qs[n].priority;n++);qs.splice(n,0,t),n===0&&QA(t)}};function qb(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Km(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function yk(){}function ZI(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=Pp(o);s.call(u)}}var o=bT(e,r,t,0,null,!1,!1,"",yk);return t._reactRootContainer=o,t[As]=o.current,Kc(t.nodeType===8?t.parentNode:t),Na(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=Pp(l);a.call(u)}}var l=Zb(t,0,!1,null,null,!1,!1,"",yk);return t._reactRootContainer=l,t[As]=l.current,Kc(t.nodeType===8?t.parentNode:t),Na(function(){Wm(e,l,n,r)}),l}function Xm(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=Pp(o);a.call(l)}}Wm(e,o,t,i)}else o=ZI(n,e,t,i,r);return Pp(o)}ZA=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=lc(e.pendingLanes);n!==0&&(yb(e,n|1),tr(e,It()),!(Xe&6)&&(su=It()+500,Ho()))}break;case 13:Na(function(){var r=Ps(t,1);if(r!==null){var i=Rn();ui(r,t,1,i)}}),Jb(t,1)}};vb=function(t){if(t.tag===13){var e=Ps(t,134217728);if(e!==null){var n=Rn();ui(e,t,134217728,n)}Jb(t,134217728)}};JA=function(t){if(t.tag===13){var e=ko(t),n=Ps(t,e);if(n!==null){var r=Rn();ui(n,t,e,r)}Jb(t,e)}};YA=function(){return tt};qA=function(t,e){var n=tt;try{return tt=t,e()}finally{tt=n}};Gy=function(t,e,n){switch(e){case"input":if(jy(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Bm(r);if(!i)throw Error(ie(90));$A(r),jy(r,i)}}}break;case"textarea":OA(t,n);break;case"select":e=n.value,e!=null&&Tl(t,!!n.multiple,e,!1)}};BA=Wb;jA=Na;var JI={usingClientEntryPoint:!1,Events:[Gd,gl,Bm,IA,LA,Wb]},Wu={findFiberByHostInstance:da,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},YI={bundleType:Wu.bundleType,version:Wu.version,rendererPackageName:Wu.rendererPackageName,rendererConfig:Wu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ms.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=UA(t),t===null?null:t.stateNode},findFiberByHostInstance:Wu.findFiberByHostInstance||XI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$h.isDisabled&&$h.supportsFiber)try{Mm=$h.inject(YI),Ui=$h}catch{}}xr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JI;xr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qb(e))throw Error(ie(200));return KI(t,e,null,n)};xr.createRoot=function(t,e){if(!qb(t))throw Error(ie(299));var n=!1,r="",i=xT;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Zb(t,1,!1,null,null,n,!1,r,i),t[As]=e.current,Kc(t.nodeType===8?t.parentNode:t),new Yb(e)};xr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ie(188)):(t=Object.keys(t).join(","),Error(ie(268,t)));return t=UA(e),t=t===null?null:t.stateNode,t};xr.flushSync=function(t){return Na(t)};xr.hydrate=function(t,e,n){if(!Km(e))throw Error(ie(200));return Xm(null,t,e,!0,n)};xr.hydrateRoot=function(t,e,n){if(!qb(t))throw Error(ie(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=xT;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=bT(e,null,t,1,n??null,i,!1,s,o),t[As]=e.current,Kc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Gm(e)};xr.render=function(t,e,n){if(!Km(e))throw Error(ie(200));return Xm(null,t,e,!1,n)};xr.unmountComponentAtNode=function(t){if(!Km(t))throw Error(ie(40));return t._reactRootContainer?(Na(function(){Xm(null,null,t,!1,function(){t._reactRootContainer=null,t[As]=null})}),!0):!1};xr.unstable_batchedUpdates=Wb;xr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Km(n))throw Error(ie(200));if(t==null||t._reactInternals===void 0)throw Error(ie(38));return Xm(t,e,n,!1,r)};xr.version="18.2.0-next-9e3b772b8-20220608";function ST(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ST)}catch(t){console.error(t)}}ST(),bA.exports=xr;var Ds=bA.exports;const qI=Cu(Ds);var vk=Ds;_y.createRoot=vk.createRoot,_y.hydrateRoot=vk.hydrateRoot;function re(){return re=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},re.apply(this,arguments)}function fe(t,e,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t==null||t(i),n===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function wi(t,e=[]){let n=[];function r(s,o){const a=m.createContext(o),l=n.length;n=[...n,o];function u(d){const{scope:h,children:f,...p}=d,g=(h==null?void 0:h[t][l])||a,b=m.useMemo(()=>p,Object.values(p));return m.createElement(g.Provider,{value:b},f)}function c(d,h){const f=(h==null?void 0:h[t][l])||a,p=m.useContext(f);if(p)return p;if(o!==void 0)return o;throw new Error(`\`${d}\` must be used within \`${s}\``)}return u.displayName=s+"Provider",[u,c]}const i=()=>{const s=n.map(o=>m.createContext(o));return function(a){const l=(a==null?void 0:a[t])||s;return m.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return i.scopeName=t,[r,QI(i,...e)]}function QI(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const o=r.reduce((a,{useScope:l,scopeName:u})=>{const d=l(s)[`__scope${u}`];return{...a,...d}},{});return m.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function eL(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function Zm(...t){return e=>t.forEach(n=>eL(n,e))}function Je(...t){return m.useCallback(Zm(...t),t)}const Oa=m.forwardRef((t,e)=>{const{children:n,...r}=t,i=m.Children.toArray(n),s=i.find(nL);if(s){const o=s.props.children,a=i.map(l=>l===s?m.Children.count(o)>1?m.Children.only(null):m.isValidElement(o)?o.props.children:null:l);return m.createElement(Ev,re({},r,{ref:e}),m.isValidElement(o)?m.cloneElement(o,void 0,a):null)}return m.createElement(Ev,re({},r,{ref:e}),n)});Oa.displayName="Slot";const Ev=m.forwardRef((t,e)=>{const{children:n,...r}=t;return m.isValidElement(n)?m.cloneElement(n,{...rL(r,n.props),ref:e?Zm(e,n.ref):n.ref}):m.Children.count(n)>1?m.Children.only(null):null});Ev.displayName="SlotClone";const tL=({children:t})=>m.createElement(m.Fragment,null,t);function nL(t){return m.isValidElement(t)&&t.type===tL}function rL(t,e){const n={...e};for(const r in e){const i=t[r],s=e[r];/^on[A-Z]/.test(r)?i&&s?n[r]=(...a)=>{s(...a),i(...a)}:i&&(n[r]=i):r==="style"?n[r]={...i,...s}:r==="className"&&(n[r]=[i,s].filter(Boolean).join(" "))}return{...t,...n}}function Xd(t){const e=t+"CollectionProvider",[n,r]=wi(e),[i,s]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=f=>{const{scope:p,children:g}=f,b=Lt.useRef(null),y=Lt.useRef(new Map).current;return Lt.createElement(i,{scope:p,itemMap:y,collectionRef:b},g)},a=t+"CollectionSlot",l=Lt.forwardRef((f,p)=>{const{scope:g,children:b}=f,y=s(a,g),v=Je(p,y.collectionRef);return Lt.createElement(Oa,{ref:v},b)}),u=t+"CollectionItemSlot",c="data-radix-collection-item",d=Lt.forwardRef((f,p)=>{const{scope:g,children:b,...y}=f,v=Lt.useRef(null),w=Je(p,v),S=s(u,g);return Lt.useEffect(()=>(S.itemMap.set(v,{ref:v,...y}),()=>void S.itemMap.delete(v))),Lt.createElement(Oa,{[c]:"",ref:w},b)});function h(f){const p=s(t+"CollectionConsumer",f);return Lt.useCallback(()=>{const b=p.collectionRef.current;if(!b)return[];const y=Array.from(b.querySelectorAll(`[${c}]`));return Array.from(p.itemMap.values()).sort((S,C)=>y.indexOf(S.ref.current)-y.indexOf(C.ref.current))},[p.collectionRef,p.itemMap])}return[{Provider:o,Slot:l,ItemSlot:d},h,r]}const Gr=globalThis!=null&&globalThis.document?m.useLayoutEffect:()=>{},iL=lb["useId".toString()]||(()=>{});let sL=0;function _a(t){const[e,n]=m.useState(iL());return Gr(()=>{t||n(r=>r??String(sL++))},[t]),t||(e?`radix-${e}`:"")}const oL=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Fe=oL.reduce((t,e)=>{const n=m.forwardRef((r,i)=>{const{asChild:s,...o}=r,a=s?Oa:e;return m.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),m.createElement(a,re({},o,{ref:i}))});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function Qb(t,e){t&&Ds.flushSync(()=>t.dispatchEvent(e))}function Dn(t){const e=m.useRef(t);return m.useEffect(()=>{e.current=t}),m.useMemo(()=>(...n)=>{var r;return(r=e.current)===null||r===void 0?void 0:r.call(e,...n)},[])}function $s({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,i]=aL({defaultProp:e,onChange:n}),s=t!==void 0,o=s?t:r,a=Dn(n),l=m.useCallback(u=>{if(s){const d=typeof u=="function"?u(t):u;d!==t&&a(d)}else i(u)},[s,t,i,a]);return[o,l]}function aL({defaultProp:t,onChange:e}){const n=m.useState(t),[r]=n,i=m.useRef(r),s=Dn(e);return m.useEffect(()=>{i.current!==r&&(s(r),i.current=r)},[r,i,s]),n}const lL=m.createContext(void 0);function Zd(t){const e=m.useContext(lL);return t||e||"ltr"}const p0="rovingFocusGroup.onEntryFocus",uL={bubbles:!1,cancelable:!0},e1="RovingFocusGroup",[Av,kT,cL]=Xd(e1),[dL,Jm]=wi(e1,[cL]),[hL,fL]=dL(e1),pL=m.forwardRef((t,e)=>m.createElement(Av.Provider,{scope:t.__scopeRovingFocusGroup},m.createElement(Av.Slot,{scope:t.__scopeRovingFocusGroup},m.createElement(mL,re({},t,{ref:e}))))),mL=m.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:i=!1,dir:s,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:u,...c}=t,d=m.useRef(null),h=Je(e,d),f=Zd(s),[p=null,g]=$s({prop:o,defaultProp:a,onChange:l}),[b,y]=m.useState(!1),v=Dn(u),w=kT(n),S=m.useRef(!1),[C,E]=m.useState(0);return m.useEffect(()=>{const T=d.current;if(T)return T.addEventListener(p0,v),()=>T.removeEventListener(p0,v)},[v]),m.createElement(hL,{scope:n,orientation:r,dir:f,loop:i,currentTabStopId:p,onItemFocus:m.useCallback(T=>g(T),[g]),onItemShiftTab:m.useCallback(()=>y(!0),[]),onFocusableItemAdd:m.useCallback(()=>E(T=>T+1),[]),onFocusableItemRemove:m.useCallback(()=>E(T=>T-1),[])},m.createElement(Fe.div,re({tabIndex:b||C===0?-1:0,"data-orientation":r},c,{ref:h,style:{outline:"none",...t.style},onMouseDown:fe(t.onMouseDown,()=>{S.current=!0}),onFocus:fe(t.onFocus,T=>{const A=!S.current;if(T.target===T.currentTarget&&A&&!b){const N=new CustomEvent(p0,uL);if(T.currentTarget.dispatchEvent(N),!N.defaultPrevented){const R=w().filter(G=>G.focusable),O=R.find(G=>G.active),j=R.find(G=>G.id===p),I=[O,j,...R].filter(Boolean).map(G=>G.ref.current);CT(I)}}S.current=!1}),onBlur:fe(t.onBlur,()=>y(!1))})))}),gL="RovingFocusGroupItem",yL=m.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:i=!1,tabStopId:s,...o}=t,a=_a(),l=s||a,u=fL(gL,n),c=u.currentTabStopId===l,d=kT(n),{onFocusableItemAdd:h,onFocusableItemRemove:f}=u;return m.useEffect(()=>{if(r)return h(),()=>f()},[r,h,f]),m.createElement(Av.ItemSlot,{scope:n,id:l,focusable:r,active:i},m.createElement(Fe.span,re({tabIndex:c?0:-1,"data-orientation":u.orientation},o,{ref:e,onMouseDown:fe(t.onMouseDown,p=>{r?u.onItemFocus(l):p.preventDefault()}),onFocus:fe(t.onFocus,()=>u.onItemFocus(l)),onKeyDown:fe(t.onKeyDown,p=>{if(p.key==="Tab"&&p.shiftKey){u.onItemShiftTab();return}if(p.target!==p.currentTarget)return;const g=bL(p,u.orientation,u.dir);if(g!==void 0){p.preventDefault();let y=d().filter(v=>v.focusable).map(v=>v.ref.current);if(g==="last")y.reverse();else if(g==="prev"||g==="next"){g==="prev"&&y.reverse();const v=y.indexOf(p.currentTarget);y=u.loop?xL(y,v+1):y.slice(v+1)}setTimeout(()=>CT(y))}})})))}),vL={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function wL(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function bL(t,e,n){const r=wL(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return vL[r]}function CT(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function xL(t,e){return t.map((n,r)=>t[(e+r)%t.length])}const ET=pL,AT=yL;function SL(t,e){return m.useReducer((n,r)=>{const i=e[n][r];return i??n},t)}const Is=t=>{const{present:e,children:n}=t,r=kL(e),i=typeof n=="function"?n({present:r.isPresent}):m.Children.only(n),s=Je(r.ref,i.ref);return typeof n=="function"||r.isPresent?m.cloneElement(i,{ref:s}):null};Is.displayName="Presence";function kL(t){const[e,n]=m.useState(),r=m.useRef({}),i=m.useRef(t),s=m.useRef("none"),o=t?"mounted":"unmounted",[a,l]=SL(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return m.useEffect(()=>{const u=Nh(r.current);s.current=a==="mounted"?u:"none"},[a]),Gr(()=>{const u=r.current,c=i.current;if(c!==t){const h=s.current,f=Nh(u);t?l("MOUNT"):f==="none"||(u==null?void 0:u.display)==="none"?l("UNMOUNT"):l(c&&h!==f?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,l]),Gr(()=>{if(e){const u=d=>{const f=Nh(r.current).includes(d.animationName);d.target===e&&f&&Ds.flushSync(()=>l("ANIMATION_END"))},c=d=>{d.target===e&&(s.current=Nh(r.current))};return e.addEventListener("animationstart",c),e.addEventListener("animationcancel",u),e.addEventListener("animationend",u),()=>{e.removeEventListener("animationstart",c),e.removeEventListener("animationcancel",u),e.removeEventListener("animationend",u)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:m.useCallback(u=>{u&&(r.current=getComputedStyle(u)),n(u)},[])}}function Nh(t){return(t==null?void 0:t.animationName)||"none"}const PT="Tabs",[CL,hY]=wi(PT,[Jm]),TT=Jm(),[EL,t1]=CL(PT),AL=m.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:i,defaultValue:s,orientation:o="horizontal",dir:a,activationMode:l="automatic",...u}=t,c=Zd(a),[d,h]=$s({prop:r,onChange:i,defaultProp:s});return m.createElement(EL,{scope:n,baseId:_a(),value:d,onValueChange:h,orientation:o,dir:c,activationMode:l},m.createElement(Fe.div,re({dir:c,"data-orientation":o},u,{ref:e})))}),PL="TabsList",TL=m.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...i}=t,s=t1(PL,n),o=TT(n);return m.createElement(ET,re({asChild:!0},o,{orientation:s.orientation,dir:s.dir,loop:r}),m.createElement(Fe.div,re({role:"tablist","aria-orientation":s.orientation},i,{ref:e})))}),$L="TabsTrigger",wk=m.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:i=!1,...s}=t,o=t1($L,n),a=TT(n),l=$T(o.baseId,r),u=NT(o.baseId,r),c=r===o.value;return m.createElement(AT,re({asChild:!0},a,{focusable:!i,active:c}),m.createElement(Fe.button,re({type:"button",role:"tab","aria-selected":c,"aria-controls":u,"data-state":c?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:l},s,{ref:e,onMouseDown:fe(t.onMouseDown,d=>{!i&&d.button===0&&d.ctrlKey===!1?o.onValueChange(r):d.preventDefault()}),onKeyDown:fe(t.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&o.onValueChange(r)}),onFocus:fe(t.onFocus,()=>{const d=o.activationMode!=="manual";!c&&!i&&d&&o.onValueChange(r)})})))}),NL="TabsContent",m0=m.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:i,children:s,...o}=t,a=t1(NL,n),l=$T(a.baseId,r),u=NT(a.baseId,r),c=r===a.value,d=m.useRef(c);return m.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),m.createElement(Is,{present:i||c},({present:h})=>m.createElement(Fe.div,re({"data-state":c?"active":"inactive","data-orientation":a.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:u,tabIndex:0},o,{ref:e,style:{...t.style,animationDuration:d.current?"0s":void 0}}),h&&s))});function $T(t,e){return`${t}-trigger-${e}`}function NT(t,e){return`${t}-content-${e}`}let OL=0;function Ce(t,e){const n=`atom${++OL}`,r={toString:()=>n};return typeof t=="function"?r.read=t:(r.init=t,r.read=i=>i(r),r.write=(i,s,o)=>s(r,typeof o=="function"?o(i(r)):o)),e&&(r.write=e),r}const bk=t=>"init"in t,xk=t=>!!t.write,Tp=new WeakMap,_L=(t,e)=>{Tp.set(t,e),t.catch(()=>{}).finally(()=>Tp.delete(t))},Sk=(t,e)=>{const n=Tp.get(t);n&&(Tp.delete(t),n(e))},kk=(t,e)=>{t.status="fulfilled",t.value=e},Ck=(t,e)=>{t.status="rejected",t.reason=e},RL=t=>typeof(t==null?void 0:t.then)=="function",Oh=(t,e)=>"v"in t&&"v"in e&&Object.is(t.v,e.v),Ek=(t,e)=>"e"in t&&"e"in e&&Object.is(t.e,e.e),Gu=t=>"v"in t&&t.v instanceof Promise,ML=(t,e)=>"v"in t&&"v"in e&&t.v.orig&&t.v.orig===e.v.orig,_h=t=>{if("e"in t)throw t.e;return t.v},n1=()=>{const t=new WeakMap,e=new WeakMap,n=new Map;let r,i;const s=A=>t.get(A),o=(A,N)=>{const R=t.get(A);if(t.set(A,N),n.has(A)||n.set(A,R),R&&Gu(R)){const O="v"in N?N.v instanceof Promise?N.v:Promise.resolve(N.v):Promise.reject(N.e);Sk(R.v,O)}},a=(A,N,R)=>{const O=new Map;let j=!1;R.forEach((z,I)=>{!z&&I===A&&(z=N),z&&(O.set(I,z),N.d.get(I)!==z&&(j=!0))}),(j||N.d.size!==O.size)&&(N.d=O)},l=(A,N,R)=>{const O=s(A),j={d:(O==null?void 0:O.d)||new Map,v:N};if(R&&a(A,j,R),O&&Oh(O,j)&&O.d===j.d)return O;if(O&&Gu(O)&&Gu(j)&&ML(O,j)){if(O.d===j.d)return O;j.v=O.v}return o(A,j),j},u=(A,N,R,O)=>{if(RL(N)){let j;const z=new Promise((I,G)=>{let K=!1;N.then(ee=>{if(!K){K=!0;const F=s(A),_=l(A,z,R);kk(z,ee),I(ee),(F==null?void 0:F.d)!==_.d&&C(A,_,F==null?void 0:F.d)}},ee=>{if(!K){K=!0;const F=s(A),_=l(A,z,R);Ck(z,ee),G(ee),(F==null?void 0:F.d)!==_.d&&C(A,_,F==null?void 0:F.d)}}),j=ee=>{K||(K=!0,ee.then(F=>kk(z,F),F=>Ck(z,F)),I(ee))}});return z.orig=N,z.status="pending",_L(z,I=>{I&&j(I),O==null||O()}),l(A,z,R)}return l(A,N,R)},c=(A,N,R)=>{const O=s(A),j={d:(O==null?void 0:O.d)||new Map,e:N};return R&&a(A,j,R),O&&Ek(O,j)&&O.d===j.d?O:(o(A,j),j)},d=(A,N)=>{const R=s(A);if(!N&&R&&(e.has(A)||Array.from(R.d).every(([ee,F])=>ee===A||d(ee)===F)))return R;const O=new Map;let j=!0;const z=ee=>{if(ee===A){const _=s(ee);if(_)return O.set(ee,_),_h(_);if(bk(ee))return O.set(ee,void 0),ee.init;throw new Error("no atom init")}const F=d(ee);return O.set(ee,F),_h(F)};let I,G;const K={get signal(){return I||(I=new AbortController),I.signal},get setSelf(){return!G&&xk(A)&&(G=(...ee)=>{if(!j)return v(A,...ee)}),G}};try{const ee=A.read(z,K);return u(A,ee,O,()=>I==null?void 0:I.abort())}catch(ee){return c(A,ee,O)}finally{j=!1}},h=A=>_h(d(A)),f=A=>{let N=e.get(A);return N||(N=w(A)),N},p=(A,N)=>!N.l.size&&(!N.t.size||N.t.size===1&&N.t.has(A)),g=A=>{const N=e.get(A);N&&p(A,N)&&S(A)},b=A=>{const N=new Map,R=new WeakMap,O=z=>{const I=e.get(z);I==null||I.t.forEach(G=>{G!==z&&(N.set(G,(N.get(G)||new Set).add(z)),R.set(G,(R.get(G)||0)+1),O(G))})};O(A);const j=z=>{const I=e.get(z);I==null||I.t.forEach(G=>{var K;if(G!==z){let ee=R.get(G);if(ee&&R.set(G,--ee),!ee){let F=!!((K=N.get(G))!=null&&K.size);if(F){const _=s(G),V=d(G,!0);F=!_||!Oh(_,V)}F||N.forEach(_=>_.delete(G))}j(G)}})};j(A)},y=(A,...N)=>{let R=!0;const O=I=>_h(d(I)),j=(I,...G)=>{let K;if(I===A){if(!bk(I))throw new Error("atom not writable");const ee=s(I),F=u(I,G[0]);(!ee||!Oh(ee,F))&&b(I)}else K=y(I,...G);if(!R){const ee=E()}return K},z=A.write(O,j,...N);return R=!1,z},v=(A,...N)=>{const R=y(A,...N),O=E();return R},w=(A,N)=>{var R;(R=s(A))==null||R.d.forEach((j,z)=>{const I=e.get(z);I?I.t.add(A):z!==A&&w(z,A)}),d(A);const O={t:new Set(N&&[N]),l:new Set};if(e.set(A,O),xk(A)&&A.onMount){const j=A.onMount((...z)=>v(A,...z));j&&(O.u=j)}return O},S=A=>{var N;const R=(N=e.get(A))==null?void 0:N.u;R&&R(),e.delete(A);const O=s(A);O&&(Gu(O)&&Sk(O.v),O.d.forEach((j,z)=>{if(z!==A){const I=e.get(z);I&&(I.t.delete(A),p(z,I)&&S(z))}}))},C=(A,N,R)=>{const O=new Set(N.d.keys());R==null||R.forEach((j,z)=>{if(O.has(z)){O.delete(z);return}const I=e.get(z);I&&(I.t.delete(A),p(z,I)&&S(z))}),O.forEach(j=>{const z=e.get(j);z?z.t.add(A):e.has(A)&&w(j,A)})},E=()=>{let A;for(;n.size;){const N=Array.from(n);n.clear(),N.forEach(([R,O])=>{const j=s(R);if(j){j.d!==(O==null?void 0:O.d)&&C(R,j,O==null?void 0:O.d);const z=e.get(R);z&&!(O&&!Gu(O)&&(Oh(O,j)||Ek(O,j)))&&z.l.forEach(I=>I())}})}};return{get:h,set:v,sub:(A,N)=>{const R=f(A),O=E(),j=R.l;return j.add(N),()=>{j.delete(N),g(A)}}}};let g0;const DL=()=>(g0||(g0=n1()),g0),OT=m.createContext(void 0),_T=t=>{const e=m.useContext(OT);return(t==null?void 0:t.store)||e||DL()},IL=({children:t,store:e})=>{const n=m.useRef();return!e&&!n.current&&(n.current=n1()),m.createElement(OT.Provider,{value:e||n.current},t)},LL=t=>typeof(t==null?void 0:t.then)=="function",BL=Lt.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t)});function dn(t,e){const n=_T(e),[[r,i,s],o]=m.useReducer(u=>{const c=n.get(t);return Object.is(u[0],c)&&u[1]===n&&u[2]===t?u:[c,n,t]},void 0,()=>[n.get(t),n,t]);let a=r;(i!==n||s!==t)&&(o(),a=n.get(t));const l=e==null?void 0:e.delay;return m.useEffect(()=>{const u=n.sub(t,()=>{if(typeof l=="number"){setTimeout(o,l);return}o()});return o(),u},[n,t,l]),m.useDebugValue(a),LL(a)?BL(a):a}function RT(t,e){const n=_T(e);return m.useCallback((...i)=>n.set(t,...i),[n,t])}function Tu(t,e){return[dn(t,e),RT(t,e)]}const{createElement:ou,createContext:jL,forwardRef:MT,useCallback:Yi,useContext:DT,useEffect:vs,useImperativeHandle:IT,useLayoutEffect:zL,useMemo:FL,useRef:dr,useState:Pc}=lb,Ak=lb["useId".toString()],Tc=zL,UL=typeof Ak=="function"?Ak:()=>null;let VL=0;function r1(t=null){const e=UL(),n=dr(t||e||null);return n.current===null&&(n.current=""+VL++),n.current}const Ym=jL(null);Ym.displayName="PanelGroupContext";function LT({children:t=null,className:e="",collapsedSize:n=0,collapsible:r=!1,defaultSize:i=null,forwardedRef:s,id:o=null,maxSize:a=null,minSize:l,onCollapse:u=null,onResize:c=null,order:d=null,style:h={},tagName:f="div"}){const p=DT(Ym);if(p===null)throw Error("Panel components must be rendered within a PanelGroup container");const g=r1(o),{collapsePanel:b,expandPanel:y,getPanelSize:v,getPanelStyle:w,registerPanel:S,resizePanel:C,units:E,unregisterPanel:T}=p;l==null&&(E==="percentages"?l=10:l=0);const A=dr({onCollapse:u,onResize:c});vs(()=>{A.current.onCollapse=u,A.current.onResize=c});const N=w(g,i),R=dr({size:Pk(N)}),O=dr({callbacksRef:A,collapsedSize:n,collapsible:r,defaultSize:i,id:g,idWasAutoGenerated:o==null,maxSize:a,minSize:l,order:d});return Tc(()=>{R.current.size=Pk(N),O.current.callbacksRef=A,O.current.collapsedSize=n,O.current.collapsible=r,O.current.defaultSize=i,O.current.id=g,O.current.idWasAutoGenerated=o==null,O.current.maxSize=a,O.current.minSize=l,O.current.order=d}),Tc(()=>(S(g,O),()=>{T(g)}),[d,g,S,T]),IT(s,()=>({collapse:()=>b(g),expand:()=>y(g),getCollapsed(){return R.current.size===0},getId(){return g},getSize(j){return v(g,j)},resize:(j,z)=>C(g,j,z)}),[b,y,v,g,C]),ou(f,{children:t,className:e,"data-panel":"","data-panel-collapsible":r||void 0,"data-panel-id":g,"data-panel-size":parseFloat(""+N.flexGrow).toFixed(1),id:`data-panel-id-${g}`,style:{...N,...h}})}const _f=MT((t,e)=>ou(LT,{...t,forwardedRef:e}));LT.displayName="Panel";_f.displayName="forwardRef(Panel)";function Pk(t){const{flexGrow:e}=t;return typeof e=="string"?parseFloat(e):e}const Ra=10;function cc(t,e,n,r,i,s,o,a){const{id:l,panels:u,units:c}=e,d=c==="pixels"?eo(l):NaN,{sizes:h}=a||{},f=h||s,p=Gn(u),g=f.concat();let b=0;{const w=i<0?r:n,S=p.findIndex(A=>A.current.id===w),C=p[S],E=f[S],T=Pv(c,d,C,E,E+Math.abs(i),t);if(E===T)return f;T===0&&E>0&&o.set(w,E),i=i<0?E-T:T-E}let y=i<0?n:r,v=p.findIndex(w=>w.current.id===y);for(;;){const w=p[v],S=f[v],C=Math.abs(i)-Math.abs(b),E=Pv(c,d,w,S,S-C,t);if(S!==E&&(E===0&&S>0&&o.set(w.current.id,S),b+=S-E,g[v]=E,b.toPrecision(Ra).localeCompare(Math.abs(i).toPrecision(Ra),void 0,{numeric:!0})>=0))break;if(i<0){if(--v<0)break}else if(++v>=p.length)break}return b===0?f:(y=i<0?r:n,v=p.findIndex(w=>w.current.id===y),g[v]=f[v]+b,g)}function Qa(t,e,n){e.forEach((r,i)=>{const s=t[i];if(!s)return;const{callbacksRef:o,collapsedSize:a,collapsible:l,id:u}=s.current,c=n[u];if(c!==r){n[u]=r;const{onCollapse:d,onResize:h}=o.current;h&&h(r,c),l&&d&&((c==null||c===a)&&r!==a?d(!1):c!==a&&r===a&&d(!0))}})}function HL({groupId:t,panels:e,units:n}){const r=n==="pixels"?eo(t):NaN,i=Gn(e),s=Array(i.length);let o=0,a=100;for(let l=0;l<i.length;l++){const u=i[l],{defaultSize:c}=u.current;c!=null&&(o++,s[l]=n==="pixels"?c/r*100:c,a-=s[l])}for(let l=0;l<i.length;l++){const u=i[l];let{defaultSize:c,id:d,maxSize:h,minSize:f}=u.current;if(c!=null)continue;n==="pixels"&&(f=f/r*100,h!=null&&(h=h/r*100));const p=i.length-o,g=Math.min(h??100,Math.max(f,a/p));s[l]=g,o++,a-=g}if(a!==0)for(let l=0;l<i.length;l++){const u=i[l];let{maxSize:c,minSize:d}=u.current;n==="pixels"&&(d=d/r*100,c!=null&&(c=c/r*100));const h=Math.min(c??100,Math.max(d,s[l]+a));if(h!==s[l]&&(a-=h-s[l],s[l]=h,Math.abs(a).toFixed(3)==="0.000"))break}return Math.abs(a).toFixed(3),s}function y0(t,e){if(e.length<2)return[null,null];const n=e.findIndex(o=>o.current.id===t);if(n<0)return[null,null];const r=n===e.length-1,i=r?e[n-1].current.id:t,s=r?t:e[n+1].current.id;return[i,s]}function eo(t){const e=nd(t);if(e==null)return NaN;const n=e.getAttribute("data-panel-group-direction"),r=i1(t);return n==="horizontal"?e.offsetWidth-r.reduce((i,s)=>i+s.offsetWidth,0):e.offsetHeight-r.reduce((i,s)=>i+s.offsetHeight,0)}function BT(t,e,n){if(t.size===1)return"100";const i=Gn(t).findIndex(o=>o.current.id===e),s=n[i];return s==null?"0":s.toPrecision(Ra)}function WL(t){const e=document.querySelector(`[data-panel-id="${t}"]`);return e||null}function nd(t){const e=document.querySelector(`[data-panel-group-id="${t}"]`);return e||null}function qm(t){const e=document.querySelector(`[data-panel-resize-handle-id="${t}"]`);return e||null}function GL(t){return jT().findIndex(r=>r.getAttribute("data-panel-resize-handle-id")===t)??null}function jT(){return Array.from(document.querySelectorAll("[data-panel-resize-handle-id]"))}function i1(t){return Array.from(document.querySelectorAll(`[data-panel-resize-handle-id][data-panel-group-id="${t}"]`))}function s1(t,e,n){var l,u,c,d;const r=qm(e),i=i1(t),s=r?i.indexOf(r):-1,o=((u=(l=n[s])==null?void 0:l.current)==null?void 0:u.id)??null,a=((d=(c=n[s+1])==null?void 0:c.current)==null?void 0:d.id)??null;return[o,a]}function Gn(t){return Array.from(t.values()).sort((e,n)=>{const r=e.current.order,i=n.current.order;return r==null&&i==null?0:r==null?-1:i==null?1:r-i})}function Pv(t,e,n,r,i,s=null){var c;let{collapsedSize:o,collapsible:a,maxSize:l,minSize:u}=n.current;if(t==="pixels"&&(o=o/e*100,l!=null&&(l=l/e*100),u=u/e*100),a){if(r>o){if(i<=u/2+o)return o}else if(!((c=s==null?void 0:s.type)==null?void 0:c.startsWith("key"))&&i<u)return o}return Math.min(l??100,Math.max(u,i))}function KL(t,e){const{collapsible:n,defaultSize:r,maxSize:i,minSize:s}=e.current;(s<0||t==="percentages"&&s>100)&&(e.current.minSize=0),i!=null&&(i<0||t==="percentages"&&i>100)&&(e.current.maxSize=null),r!==null&&(r<0||t==="percentages"&&r>100?e.current.defaultSize=null:r<s&&!n?e.current.defaultSize=s:i!=null&&r>i&&(e.current.defaultSize=i))}function v0({groupId:t,panels:e,nextSizes:n,prevSizes:r,units:i}){n=[...n];const s=Gn(e),o=i==="pixels"?eo(t):NaN;let a=0;for(let l=0;l<s.length;l++){const u=s[l],c=r[l],d=n[l],h=Pv(i,o,u,c,d);d!=h&&(a+=d-h,n[l]=h)}if(a.toFixed(3)!=="0.000")for(let l=0;l<s.length;l++){const u=s[l];let{maxSize:c,minSize:d}=u.current;i==="pixels"&&(d=d/o*100,c!=null&&(c=c/o*100));const h=Math.min(c??100,Math.max(d,n[l]+a));if(h!==n[l]&&(a-=h-n[l],n[l]=h,Math.abs(a).toFixed(3)==="0.000"))break}return a.toFixed(3),n}function zT(t,e="Assertion failed!"){if(!t)throw console.error(e),Error(e)}function XL({committedValuesRef:t,groupId:e,panels:n,setSizes:r,sizes:i,panelSizeBeforeCollapse:s}){vs(()=>{const{direction:o,panels:a}=t.current,l=nd(e);zT(l!=null,`No group found for id "${e}"`);const{height:u,width:c}=l.getBoundingClientRect(),h=i1(e).map(f=>{const p=f.getAttribute("data-panel-resize-handle-id"),g=Gn(a),[b,y]=s1(e,p,g);if(b==null||y==null)return()=>{};let v=0,w=100,S=0,C=0;g.forEach(O=>{const{id:j,maxSize:z,minSize:I}=O.current;j===b?(v=I,w=z??100):(S+=I,C+=z??100)});const E=Math.min(w,100-S),T=Math.max(v,(g.length-1)*100-C),A=BT(a,b,i);f.setAttribute("aria-valuemax",""+Math.round(E)),f.setAttribute("aria-valuemin",""+Math.round(T)),f.setAttribute("aria-valuenow",""+Math.round(parseInt(A)));const N=O=>{if(!O.defaultPrevented)switch(O.key){case"Enter":{O.preventDefault();const j=g.findIndex(z=>z.current.id===b);if(j>=0){const z=g[j],I=i[j];if(I!=null){let G=0;I.toPrecision(Ra)<=z.current.minSize.toPrecision(Ra)?G=o==="horizontal"?c:u:G=-(o==="horizontal"?c:u);const K=cc(O,t.current,b,y,G,i,s.current,null);i!==K&&r(K)}}break}}};f.addEventListener("keydown",N);const R=WL(b);return R!=null&&f.setAttribute("aria-controls",R.id),()=>{f.removeAttribute("aria-valuemax"),f.removeAttribute("aria-valuemin"),f.removeAttribute("aria-valuenow"),f.removeEventListener("keydown",N),R!=null&&f.removeAttribute("aria-controls")}});return()=>{h.forEach(f=>f())}},[t,e,n,s,r,i])}function ZL({disabled:t,handleId:e,resizeHandler:n}){vs(()=>{if(t||n==null)return;const r=qm(e);if(r==null)return;const i=s=>{if(!s.defaultPrevented)switch(s.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{s.preventDefault(),n(s);break}case"F6":{s.preventDefault();const o=jT(),a=GL(e);zT(a!==null);const l=s.shiftKey?a>0?a-1:o.length-1:a+1<o.length?a+1:0;o[l].focus();break}}};return r.addEventListener("keydown",i),()=>{r.removeEventListener("keydown",i)}},[t,e,n])}function w0(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function FT(t,e,n,r=0,i=null){const s=n==="horizontal";let o=0;if(Tv(t))o=s?t.clientX:t.clientY;else if($v(t)){const c=t.touches[0];o=s?c.screenX:c.screenY}else return 0;const a=qm(e),l=i||a.getBoundingClientRect(),u=s?l.left:l.top;return o-u-r}function JL(t,e,n,r,i,s,o){const{dragOffset:a=0,dragHandleRect:l,sizes:u}=o||{},c=u||s;if(YL(t)){const d=i==="horizontal",f=nd(e).getBoundingClientRect(),p=d?f.width:f.height,g=t.shiftKey?10:100,b=p/g;let y=0;switch(t.key){case"ArrowDown":y=d?0:b;break;case"ArrowLeft":y=d?-b:0;break;case"ArrowRight":y=d?b:0;break;case"ArrowUp":y=d?0:-b;break;case"End":y=p;break;case"Home":y=-p;break}const[v,w]=s1(e,n,r),S=y<0?v:w,C=r.findIndex(T=>T.current.id===S),E=r[C];if(E.current.collapsible){const T=c[C];(T===0||T.toPrecision(Ra)===E.current.minSize.toPrecision(Ra))&&(y=y<0?-E.current.minSize*p:E.current.minSize*p)}return y}else return FT(t,n,i,a,l)}function YL(t){return t.type==="keydown"}function Tv(t){return t.type.startsWith("mouse")}function $v(t){return t.type.startsWith("touch")}let Nv=null,pa=null;function UT(t){switch(t){case"horizontal":return"ew-resize";case"horizontal-max":return"w-resize";case"horizontal-min":return"e-resize";case"vertical":return"ns-resize";case"vertical-max":return"n-resize";case"vertical-min":return"s-resize"}}function qL(){pa!==null&&(document.head.removeChild(pa),Nv=null,pa=null)}function b0(t){if(Nv===t)return;Nv=t;const e=UT(t);pa===null&&(pa=document.createElement("style"),document.head.appendChild(pa)),pa.innerHTML=`*{cursor: ${e}!important;}`}function QL(t,e=10){let n=null;return(...i)=>{n!==null&&clearTimeout(n),n=setTimeout(()=>{t(...i)},e)}}function VT(t){return t.map(e=>{const{minSize:n,order:r}=e.current;return r?`${r}:${n}`:`${n}`}).sort((e,n)=>e.localeCompare(n)).join(",")}function HT(t,e){try{const n=e.getItem(`PanelGroup:sizes:${t}`);if(n){const r=JSON.parse(n);if(typeof r=="object"&&r!=null)return r}}catch{}return null}function e5(t,e,n){const r=HT(t,n);if(r){const i=VT(e);return r[i]??null}return null}function t5(t,e,n,r){const i=VT(e),s=HT(t,r)||{};s[i]=n;try{r.setItem(`PanelGroup:sizes:${t}`,JSON.stringify(s))}catch(o){console.error(o)}}const x0={};function Tk(t){try{if(typeof localStorage<"u")t.getItem=e=>localStorage.getItem(e),t.setItem=(e,n)=>{localStorage.setItem(e,n)};else throw new Error("localStorage not supported in this environment")}catch(e){console.error(e),t.getItem=()=>null,t.setItem=()=>{}}}const dc={getItem:t=>(Tk(dc),dc.getItem(t)),setItem:(t,e)=>{Tk(dc),dc.setItem(t,e)}};function WT({autoSaveId:t,children:e=null,className:n="",direction:r,disablePointerEventsDuringResize:i=!1,forwardedRef:s,id:o=null,onLayout:a,storage:l=dc,style:u={},tagName:c="div",units:d="percentages"}){const h=r1(o),[f,p]=Pc(null),[g,b]=Pc(new Map),y=dr(null);dr({didLogDefaultSizeWarning:!1,didLogIdAndOrderWarning:!1,didLogInvalidLayoutWarning:!1,prevPanelIds:[]});const v=dr({onLayout:a});vs(()=>{v.current.onLayout=a});const w=dr({}),[S,C]=Pc([]),E=dr(new Map),T=dr(0),A=dr({direction:r,id:h,panels:g,sizes:S,units:d});IT(s,()=>({getId:()=>h,getLayout:_=>{const{sizes:V,units:Z}=A.current;if((_??Z)==="pixels"){const me=eo(h);return V.map(H=>H/100*me)}else return V},setLayout:(_,V)=>{const{id:Z,panels:ne,sizes:me,units:H}=A.current;if((V||H)==="pixels"){const $=eo(Z);_=_.map(D=>D/$*100)}const L=w.current,W=Gn(ne),k=v0({groupId:Z,panels:ne,nextSizes:_,prevSizes:me,units:H});w0(me,k)||(C(k),Qa(W,k,L))}}),[h]),Tc(()=>{A.current.direction=r,A.current.id=h,A.current.panels=g,A.current.sizes=S,A.current.units=d}),XL({committedValuesRef:A,groupId:h,panels:g,setSizes:C,sizes:S,panelSizeBeforeCollapse:E}),vs(()=>{const{onLayout:_}=v.current,{panels:V,sizes:Z}=A.current;if(Z.length>0){_&&_(Z);const ne=w.current,me=Gn(V);Qa(me,Z,ne)}},[S]),Tc(()=>{const{id:_,sizes:V,units:Z}=A.current;if(V.length===g.size)return;let ne=null;if(t){const me=Gn(g);ne=e5(t,me,l)}if(ne!=null){const me=v0({groupId:_,panels:g,nextSizes:ne,prevSizes:ne,units:Z});C(me)}else{const me=HL({groupId:_,panels:g,units:Z});C(me)}},[t,g,l]),vs(()=>{if(t){if(S.length===0||S.length!==g.size)return;const _=Gn(g);x0[t]||(x0[t]=QL(t5,100)),x0[t](t,_,S,l)}},[t,g,S,l]),Tc(()=>{if(d==="pixels"){const _=new ResizeObserver(()=>{const{panels:V,sizes:Z}=A.current,ne=v0({groupId:h,panels:V,nextSizes:Z,prevSizes:Z,units:d});w0(Z,ne)||C(ne)});return _.observe(nd(h)),()=>{_.disconnect()}}},[h,d]);const N=Yi((_,V)=>{const{panels:Z,units:ne}=A.current,H=Gn(Z).findIndex(k=>k.current.id===_),L=S[H];if((V??ne)==="pixels"){const k=eo(h);return L/100*k}else return L},[h,S]),R=Yi((_,V)=>{const{panels:Z}=A.current;return Z.size===0?{flexBasis:0,flexGrow:V??void 0,flexShrink:1,overflow:"hidden"}:{flexBasis:0,flexGrow:BT(Z,_,S),flexShrink:1,overflow:"hidden",pointerEvents:i&&f!==null?"none":void 0}},[f,i,S]),O=Yi((_,V)=>{const{units:Z}=A.current;KL(Z,V),b(ne=>{if(ne.has(_))return ne;const me=new Map(ne);return me.set(_,V),me})},[]),j=Yi(_=>Z=>{Z.preventDefault();const{direction:ne,panels:me,sizes:H}=A.current,L=Gn(me),[W,k]=s1(h,_,L);if(W==null||k==null)return;let $=JL(Z,h,_,L,ne,H,y.current);if($===0)return;const M=nd(h).getBoundingClientRect(),U=ne==="horizontal";document.dir==="rtl"&&U&&($=-$);const X=U?M.width:M.height,Y=$/X*100,q=cc(Z,A.current,W,k,Y,H,E.current,y.current),oe=!w0(H,q);if((Tv(Z)||$v(Z))&&T.current!=Y&&b0(oe?U?"horizontal":"vertical":U?$<0?"horizontal-min":"horizontal-max":$<0?"vertical-min":"vertical-max"),oe){const Be=w.current;C(q),Qa(L,q,Be)}T.current=Y},[h]),z=Yi(_=>{b(V=>{if(!V.has(_))return V;const Z=new Map(V);return Z.delete(_),Z})},[]),I=Yi(_=>{const{panels:V,sizes:Z}=A.current,ne=V.get(_);if(ne==null)return;const{collapsedSize:me,collapsible:H}=ne.current;if(!H)return;const L=Gn(V),W=L.indexOf(ne);if(W<0)return;const k=Z[W];if(k===me)return;E.current.set(_,k);const[$,D]=y0(_,L);if($==null||D==null)return;const U=W===L.length-1?k:me-k,X=cc(null,A.current,$,D,U,Z,E.current,null);if(Z!==X){const Y=w.current;C(X),Qa(L,X,Y)}},[]),G=Yi(_=>{const{panels:V,sizes:Z}=A.current,ne=V.get(_);if(ne==null)return;const{collapsedSize:me,minSize:H}=ne.current,L=E.current.get(_)||H;if(!L)return;const W=Gn(V),k=W.indexOf(ne);if(k<0||Z[k]!==me)return;const[D,M]=y0(_,W);if(D==null||M==null)return;const X=k===W.length-1?me-L:L,Y=cc(null,A.current,D,M,X,Z,E.current,null);if(Z!==Y){const q=w.current;C(Y),Qa(W,Y,q)}},[]),K=Yi((_,V,Z)=>{const{id:ne,panels:me,sizes:H,units:L}=A.current;if((Z||L)==="pixels"){const Re=eo(ne);V=V/Re*100}const W=me.get(_);if(W==null)return;let{collapsedSize:k,collapsible:$,maxSize:D,minSize:M}=W.current;if(L==="pixels"){const Re=eo(ne);M=M/Re*100,D!=null&&(D=D/Re*100)}const U=Gn(me),X=U.indexOf(W);if(X<0)return;const Y=H[X];if(Y===V)return;$&&V===k||(V=Math.min(D??100,Math.max(M,V)));const[q,oe]=y0(_,U);if(q==null||oe==null)return;const we=X===U.length-1?Y-V:V-Y,Ne=cc(null,A.current,q,oe,we,H,E.current,null);if(H!==Ne){const Re=w.current;C(Ne),Qa(U,Ne,Re)}},[]),ee=FL(()=>({activeHandleId:f,collapsePanel:I,direction:r,expandPanel:G,getPanelSize:N,getPanelStyle:R,groupId:h,registerPanel:O,registerResizeHandle:j,resizePanel:K,startDragging:(_,V)=>{if(p(_),Tv(V)||$v(V)){const Z=qm(_);y.current={dragHandleRect:Z.getBoundingClientRect(),dragOffset:FT(V,_,r),sizes:A.current.sizes}}},stopDragging:()=>{qL(),p(null),y.current=null},units:d,unregisterPanel:z}),[f,I,r,G,N,R,h,O,j,K,d,z]),F={display:"flex",flexDirection:r==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return ou(Ym.Provider,{children:ou(c,{children:e,className:n,"data-panel-group":"","data-panel-group-direction":r,"data-panel-group-id":h,"data-panel-group-units":d,style:{...F,...u}}),value:ee})}const GT=MT((t,e)=>ou(WT,{...t,forwardedRef:e}));WT.displayName="PanelGroup";GT.displayName="forwardRef(PanelGroup)";function Ov({children:t=null,className:e="",disabled:n=!1,id:r=null,onDragging:i,style:s={},tagName:o="div"}){const a=dr(null),l=dr({onDragging:i});vs(()=>{l.current.onDragging=i});const u=DT(Ym);if(u===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{activeHandleId:c,direction:d,groupId:h,registerResizeHandle:f,startDragging:p,stopDragging:g}=u,b=r1(r),y=c===b,[v,w]=Pc(!1),[S,C]=Pc(null),E=Yi(()=>{a.current.blur(),g();const{onDragging:N}=l.current;N&&N(!1)},[g]);vs(()=>{if(n)C(null);else{const A=f(b);C(()=>A)}},[n,b,f]),vs(()=>{if(n||S==null||!y)return;const A=j=>{S(j)},N=j=>{S(j)},O=a.current.ownerDocument;return O.body.addEventListener("contextmenu",E),O.body.addEventListener("mousemove",A),O.body.addEventListener("touchmove",A),O.body.addEventListener("mouseleave",N),window.addEventListener("mouseup",E),window.addEventListener("touchend",E),()=>{O.body.removeEventListener("contextmenu",E),O.body.removeEventListener("mousemove",A),O.body.removeEventListener("touchmove",A),O.body.removeEventListener("mouseleave",N),window.removeEventListener("mouseup",E),window.removeEventListener("touchend",E)}},[d,n,y,S,E]),ZL({disabled:n,handleId:b,resizeHandler:S});const T={cursor:UT(d),touchAction:"none",userSelect:"none"};return ou(o,{children:t,className:e,"data-resize-handle-active":y?"pointer":v?"keyboard":void 0,"data-panel-group-direction":d,"data-panel-group-id":h,"data-panel-resize-handle-enabled":!n,"data-panel-resize-handle-id":b,onBlur:()=>w(!1),onFocus:()=>w(!0),onMouseDown:A=>{p(b,A.nativeEvent);const{onDragging:N}=l.current;N&&N(!0)},onMouseUp:E,onTouchCancel:E,onTouchEnd:E,onTouchStart:A=>{p(b,A.nativeEvent);const{onDragging:N}=l.current;N&&N(!0)},ref:a,role:"separator",style:{...T,...s},tabIndex:0})}Ov.displayName="PanelResizeHandle";var n5=function(){};function r5(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t&&t.addEventListener&&t.addEventListener.apply(t,e)}function i5(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t&&t.removeEventListener&&t.removeEventListener.apply(t,e)}var KT=typeof window<"u",s5=KT?window:null,$k=function(t){return!!t.addEventListener},Nk=function(t){return!!t.on},o5=function(t,e,n,r){n===void 0&&(n=s5),m.useEffect(function(){if(e&&n)return $k(n)?r5(n,t,e,r):Nk(n)&&n.on(t,e,r),function(){$k(n)?i5(n,t,e,r):Nk(n)&&n.off(t,e,r)}},[t,e,n,JSON.stringify(r)])};const Rf=o5;var a5=function(t){return typeof t=="function"?t:typeof t=="string"?function(e){return e.key===t}:t?function(){return!0}:function(){return!1}},l5=function(t,e,n,r){e===void 0&&(e=n5),n===void 0&&(n={}),r===void 0&&(r=[t]);var i=n.event,s=i===void 0?"keydown":i,o=n.target,a=n.options,l=m.useMemo(function(){var u=a5(t),c=function(d){if(u(d))return e(d)};return c},r);Rf(s,l,o,a)};const xa=l5;var u5=function(t,e){return e!==void 0?e:KT?window.matchMedia(t).matches:!1},c5=function(t,e){var n=m.useState(u5(t,e)),r=n[0],i=n[1];return m.useEffect(function(){var s=!0,o=window.matchMedia(t),a=function(){s&&i(!!o.matches)};return o.addListener(a),i(o.matches),function(){s=!1,o.removeListener(a)}},[t]),r};const d5=c5,h5="modulepreload",f5=function(t){return"/vonsim-next/"+t},Ok={},p5=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=f5(s),s in Ok)return;Ok[s]=!0;const o=s.endsWith(".css"),a=o?'[rel="stylesheet"]':"";if(!!r)for(let c=i.length-1;c>=0;c--){const d=i[c];if(d.href===s&&(!o||d.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${a}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":h5,o||(u.as="script",u.crossOrigin=""),u.href=s,document.head.appendChild(u),o)return new Promise((c,d)=>{u.addEventListener("load",c),u.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};function m5(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:s,onRegisterError:o}=t;let a,l,u;const c=async(h=!0)=>{await l,await(u==null?void 0:u())};async function d(){if("serviceWorker"in navigator){const{Workbox:h}=await p5(()=>import("./workbox-window.prod.es5-a7b12eab.js"),[]);a=new h("/vonsim-next/sw.js",{scope:"/vonsim-next/",type:"classic"}),u=async()=>{await(a==null?void 0:a.messageSkipWaiting())};{let f=!1;const p=()=>{f=!0,a==null||a.addEventListener("controlling",g=>{g.isUpdate&&window.location.reload()}),n==null||n()};a.addEventListener("installed",g=>{typeof g.isUpdate>"u"?typeof g.isExternal<"u"?g.isExternal?p():!f&&(r==null||r()):g.isExternal?window.location.reload():!f&&(r==null||r()):g.isUpdate||r==null||r()}),a.addEventListener("waiting",p),a.addEventListener("externalwaiting",p)}a.register({immediate:e}).then(f=>{s?s("/vonsim-next/sw.js",f):i==null||i(f)}).catch(f=>{o==null||o(f)})}}return l=d(),c}function g5(t={}){const{immediate:e=!0,onNeedRefresh:n,onOfflineReady:r,onRegistered:i,onRegisteredSW:s,onRegisterError:o}=t,[a,l]=m.useState(!1),[u,c]=m.useState(!1),[d]=m.useState(()=>m5({immediate:e,onOfflineReady(){c(!0),r==null||r()},onNeedRefresh(){l(!0),n==null||n()},onRegistered:i,onRegisteredSW:s,onRegisterError:o}));return{needRefresh:[a,l],offlineReady:[u,c],updateServiceWorker:d}}function XT(t,e){const n=e.split(".");let r=t;for(const i of n)if(i in r)r=r[i];else throw new ReferenceError(`Couldn't find path "${e}".`);return r}const ZT=["en","es"];function o1(t){return function(n,r,...i){const s=XT(t[n],r);if(typeof s=="function")return s(...i);if(typeof s=="string")return s;throw new Error(`Missing translation for key ${r}`)}}const y5=Symbol(),v5=t=>typeof(t==null?void 0:t.then)=="function";function w5(t){let e,n;const r={getItem:(i,s)=>{var o,a;const l=c=>{if(c=c||"",e!==c){try{n=JSON.parse(c)}catch{return s}e=c}return n},u=(a=(o=t())==null?void 0:o.getItem(i))!=null?a:null;return v5(u)?u.then(l):l(u)},setItem:(i,s)=>{var o;return(o=t())==null?void 0:o.setItem(i,JSON.stringify(s))},removeItem:i=>{var s;return(s=t())==null?void 0:s.removeItem(i)}};return typeof window<"u"&&typeof window.addEventListener=="function"&&(r.subscribe=(i,s,o)=>{if(!(t()instanceof window.Storage))return()=>{};const a=l=>{if(l.storageArea===t()&&l.key===i){let u;try{u=JSON.parse(l.newValue||"")}catch{u=o}s(u)}};return window.addEventListener("storage",a),()=>{window.removeEventListener("storage",a)}}),r}const b5=w5(()=>typeof window<"u"?window.localStorage:void 0);function JT(t,e,n=b5,r){const i=r==null?void 0:r.unstable_getOnInit,s=Ce(i?n.getItem(t,e):e);return s.onMount=a=>{i||a(n.getItem(t,e));let l;return n.subscribe&&(l=n.subscribe(t,a,e)),l},Ce(a=>a(s),(a,l,u)=>{const c=typeof u=="function"?u(a(s)):u;return c===y5?(l(s,e),n.removeItem(t)):c instanceof Promise?c.then(d=>(l(s,d),n.setItem(t,d))):(l(s,c),n.setItem(t,c))})}const Q=n1();function x5(t){return x.jsx(IL,{store:Q,children:t.children})}var Ye;(function(t){t.assertEqual=i=>i;function e(i){}t.assertIs=e;function n(i){throw new Error}t.assertNever=n,t.arrayToEnum=i=>{const s={};for(const o of i)s[o]=o;return s},t.getValidEnumValues=i=>{const s=t.objectKeys(i).filter(a=>typeof i[i[a]]!="number"),o={};for(const a of s)o[a]=i[a];return t.objectValues(o)},t.objectValues=i=>t.objectKeys(i).map(function(s){return i[s]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&s.push(o);return s},t.find=(i,s)=>{for(const o of i)if(s(o))return o},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function r(i,s=" | "){return i.map(o=>typeof o=="string"?`'${o}'`:o).join(s)}t.joinValues=r,t.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(Ye||(Ye={}));var _v;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(_v||(_v={}));const pe=Ye.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),to=t=>{switch(typeof t){case"undefined":return pe.undefined;case"string":return pe.string;case"number":return isNaN(t)?pe.nan:pe.number;case"boolean":return pe.boolean;case"function":return pe.function;case"bigint":return pe.bigint;case"symbol":return pe.symbol;case"object":return Array.isArray(t)?pe.array:t===null?pe.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?pe.promise:typeof Map<"u"&&t instanceof Map?pe.map:typeof Set<"u"&&t instanceof Set?pe.set:typeof Date<"u"&&t instanceof Date?pe.date:pe.object;default:return pe.unknown}},ae=Ye.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),S5=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class ci extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(s){return s.message},r={_errors:[]},i=s=>{for(const o of s.issues)if(o.code==="invalid_union")o.unionErrors.map(i);else if(o.code==="invalid_return_type")i(o.returnTypeError);else if(o.code==="invalid_arguments")i(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let a=r,l=0;for(;l<o.path.length;){const u=o.path[l];l===o.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(n(o))):a[u]=a[u]||{_errors:[]},a=a[u],l++}}};return i(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ye.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const i of this.issues)i.path.length>0?(n[i.path[0]]=n[i.path[0]]||[],n[i.path[0]].push(e(i))):r.push(e(i));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}ci.create=t=>new ci(t);const rd=(t,e)=>{let n;switch(t.code){case ae.invalid_type:t.received===pe.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case ae.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Ye.jsonStringifyReplacer)}`;break;case ae.unrecognized_keys:n=`Unrecognized key(s) in object: ${Ye.joinValues(t.keys,", ")}`;break;case ae.invalid_union:n="Invalid input";break;case ae.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Ye.joinValues(t.options)}`;break;case ae.invalid_enum_value:n=`Invalid enum value. Expected ${Ye.joinValues(t.options)}, received '${t.received}'`;break;case ae.invalid_arguments:n="Invalid function arguments";break;case ae.invalid_return_type:n="Invalid function return type";break;case ae.invalid_date:n="Invalid date";break;case ae.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Ye.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case ae.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case ae.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case ae.custom:n="Invalid input";break;case ae.invalid_intersection_types:n="Intersection results could not be merged";break;case ae.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case ae.not_finite:n="Number must be finite";break;default:n=e.defaultError,Ye.assertNever(t)}return{message:n}};let YT=rd;function k5(t){YT=t}function $p(){return YT}const Np=t=>{const{data:e,path:n,errorMaps:r,issueData:i}=t,s=[...n,...i.path||[]],o={...i,path:s};let a="";const l=r.filter(u=>!!u).slice().reverse();for(const u of l)a=u(o,{data:e,defaultError:a}).message;return{...i,path:s,message:i.message||a}},C5=[];function ge(t,e){const n=Np({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,$p(),rd].filter(r=>!!r)});t.common.issues.push(n)}class kn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const i of n){if(i.status==="aborted")return _e;i.status==="dirty"&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const i of n)r.push({key:await i.key,value:await i.value});return kn.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const i of n){const{key:s,value:o}=i;if(s.status==="aborted"||o.status==="aborted")return _e;s.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof o.value<"u"||i.alwaysSet)&&(r[s.value]=o.value)}return{status:e.value,value:r}}}const _e=Object.freeze({status:"aborted"}),qT=t=>({status:"dirty",value:t}),In=t=>({status:"valid",value:t}),Rv=t=>t.status==="aborted",Mv=t=>t.status==="dirty",id=t=>t.status==="valid",Op=t=>typeof Promise<"u"&&t instanceof Promise;var Pe;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Pe||(Pe={}));class Gi{constructor(e,n,r,i){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const _k=(t,e)=>{if(id(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new ci(t.common.issues);return this._error=n,this._error}}};function De(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:i}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:r??a.defaultError}:{message:n??a.defaultError},description:i}}class je{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return to(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:to(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new kn,ctx:{common:e.parent.common,data:e.data,parsedType:to(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(Op(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const i={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:to(e)},s=this._parseSync({data:e,path:i.path,parent:i});return _k(i,s)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:to(e)},i=this._parse({data:e,path:r.path,parent:r}),s=await(Op(i)?i:Promise.resolve(i));return _k(r,s)}refine(e,n){const r=i=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(i):n;return this._refinement((i,s)=>{const o=e(i),a=()=>s.addIssue({code:ae.custom,...r(i)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof n=="function"?n(r,i):n),!1))}_refinement(e){return new mi({schema:this,typeName:$e.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return ws.create(this,this._def)}nullable(){return Ia.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return di.create(this,this._def)}promise(){return lu.create(this,this._def)}or(e){return ld.create([this,e],this._def)}and(e){return ud.create(this,e,this._def)}transform(e){return new mi({...De(this._def),schema:this,typeName:$e.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new pd({...De(this._def),innerType:this,defaultValue:n,typeName:$e.ZodDefault})}brand(){return new e$({typeName:$e.ZodBranded,type:this,...De(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Dp({...De(this._def),innerType:this,catchValue:n,typeName:$e.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Jd.create(this,e)}readonly(){return Lp.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const E5=/^c[^\s-]{8,}$/i,A5=/^[a-z][a-z0-9]*$/,P5=/[0-9A-HJKMNP-TV-Z]{26}/,T5=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,$5=/^([A-Z0-9_+-]+\.?)*[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,N5=/^(\p{Extended_Pictographic}|\p{Emoji_Component})+$/u,O5=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,_5=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,R5=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function M5(t,e){return!!((e==="v4"||!e)&&O5.test(t)||(e==="v6"||!e)&&_5.test(t))}class si extends je{constructor(){super(...arguments),this._regex=(e,n,r)=>this.refinement(i=>e.test(i),{validation:n,code:ae.invalid_string,...Pe.errToObj(r)}),this.nonempty=e=>this.min(1,Pe.errToObj(e)),this.trim=()=>new si({...this._def,checks:[...this._def.checks,{kind:"trim"}]}),this.toLowerCase=()=>new si({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]}),this.toUpperCase=()=>new si({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==pe.string){const s=this._getOrReturnCtx(e);return ge(s,{code:ae.invalid_type,expected:pe.string,received:s.parsedType}),_e}const r=new kn;let i;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),ge(i,{code:ae.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),ge(i,{code:ae.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="length"){const o=e.data.length>s.value,a=e.data.length<s.value;(o||a)&&(i=this._getOrReturnCtx(e,i),o?ge(i,{code:ae.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&ge(i,{code:ae.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),r.dirty())}else if(s.kind==="email")$5.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"email",code:ae.invalid_string,message:s.message}),r.dirty());else if(s.kind==="emoji")N5.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"emoji",code:ae.invalid_string,message:s.message}),r.dirty());else if(s.kind==="uuid")T5.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"uuid",code:ae.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid")E5.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"cuid",code:ae.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid2")A5.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"cuid2",code:ae.invalid_string,message:s.message}),r.dirty());else if(s.kind==="ulid")P5.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"ulid",code:ae.invalid_string,message:s.message}),r.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),ge(i,{validation:"url",code:ae.invalid_string,message:s.message}),r.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"regex",code:ae.invalid_string,message:s.message}),r.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),ge(i,{code:ae.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),r.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),ge(i,{code:ae.invalid_string,validation:{startsWith:s.value},message:s.message}),r.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),ge(i,{code:ae.invalid_string,validation:{endsWith:s.value},message:s.message}),r.dirty()):s.kind==="datetime"?R5(s).test(e.data)||(i=this._getOrReturnCtx(e,i),ge(i,{code:ae.invalid_string,validation:"datetime",message:s.message}),r.dirty()):s.kind==="ip"?M5(e.data,s.version)||(i=this._getOrReturnCtx(e,i),ge(i,{validation:"ip",code:ae.invalid_string,message:s.message}),r.dirty()):Ye.assertNever(s);return{status:r.value,value:e.data}}_addCheck(e){return new si({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Pe.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Pe.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Pe.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Pe.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Pe.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Pe.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Pe.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Pe.errToObj(e)})}datetime(e){var n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,...Pe.errToObj(e==null?void 0:e.message)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...Pe.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...Pe.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...Pe.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...Pe.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...Pe.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...Pe.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...Pe.errToObj(n)})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}si.create=t=>{var e;return new si({checks:[],typeName:$e.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...De(t)})};function D5(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,i=n>r?n:r,s=parseInt(t.toFixed(i).replace(".","")),o=parseInt(e.toFixed(i).replace(".",""));return s%o/Math.pow(10,i)}class No extends je{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==pe.number){const s=this._getOrReturnCtx(e);return ge(s,{code:ae.invalid_type,expected:pe.number,received:s.parsedType}),_e}let r;const i=new kn;for(const s of this._def.checks)s.kind==="int"?Ye.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),ge(r,{code:ae.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),ge(r,{code:ae.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),ge(r,{code:ae.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?D5(e.data,s.value)!==0&&(r=this._getOrReturnCtx(e,r),ge(r,{code:ae.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),ge(r,{code:ae.not_finite,message:s.message}),i.dirty()):Ye.assertNever(s);return{status:i.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Pe.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Pe.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Pe.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Pe.toString(n))}setLimit(e,n,r,i){return new No({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Pe.toString(i)}]})}_addCheck(e){return new No({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Pe.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Pe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Pe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Pe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Pe.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Pe.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:Pe.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Pe.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Pe.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ye.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}No.create=t=>new No({checks:[],typeName:$e.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...De(t)});class Oo extends je{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==pe.bigint){const s=this._getOrReturnCtx(e);return ge(s,{code:ae.invalid_type,expected:pe.bigint,received:s.parsedType}),_e}let r;const i=new kn;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),ge(r,{code:ae.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),ge(r,{code:ae.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),ge(r,{code:ae.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):Ye.assertNever(s);return{status:i.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Pe.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Pe.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Pe.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Pe.toString(n))}setLimit(e,n,r,i){return new Oo({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Pe.toString(i)}]})}_addCheck(e){return new Oo({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Pe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Pe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Pe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Pe.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Pe.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Oo.create=t=>{var e;return new Oo({checks:[],typeName:$e.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...De(t)})};class sd extends je{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==pe.boolean){const r=this._getOrReturnCtx(e);return ge(r,{code:ae.invalid_type,expected:pe.boolean,received:r.parsedType}),_e}return In(e.data)}}sd.create=t=>new sd({typeName:$e.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...De(t)});class Ma extends je{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==pe.date){const s=this._getOrReturnCtx(e);return ge(s,{code:ae.invalid_type,expected:pe.date,received:s.parsedType}),_e}if(isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return ge(s,{code:ae.invalid_date}),_e}const r=new kn;let i;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),ge(i,{code:ae.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),r.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=this._getOrReturnCtx(e,i),ge(i,{code:ae.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),r.dirty()):Ye.assertNever(s);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ma({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:Pe.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:Pe.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Ma.create=t=>new Ma({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:$e.ZodDate,...De(t)});class _p extends je{_parse(e){if(this._getType(e)!==pe.symbol){const r=this._getOrReturnCtx(e);return ge(r,{code:ae.invalid_type,expected:pe.symbol,received:r.parsedType}),_e}return In(e.data)}}_p.create=t=>new _p({typeName:$e.ZodSymbol,...De(t)});class od extends je{_parse(e){if(this._getType(e)!==pe.undefined){const r=this._getOrReturnCtx(e);return ge(r,{code:ae.invalid_type,expected:pe.undefined,received:r.parsedType}),_e}return In(e.data)}}od.create=t=>new od({typeName:$e.ZodUndefined,...De(t)});class ad extends je{_parse(e){if(this._getType(e)!==pe.null){const r=this._getOrReturnCtx(e);return ge(r,{code:ae.invalid_type,expected:pe.null,received:r.parsedType}),_e}return In(e.data)}}ad.create=t=>new ad({typeName:$e.ZodNull,...De(t)});class au extends je{constructor(){super(...arguments),this._any=!0}_parse(e){return In(e.data)}}au.create=t=>new au({typeName:$e.ZodAny,...De(t)});class Sa extends je{constructor(){super(...arguments),this._unknown=!0}_parse(e){return In(e.data)}}Sa.create=t=>new Sa({typeName:$e.ZodUnknown,...De(t)});class Ns extends je{_parse(e){const n=this._getOrReturnCtx(e);return ge(n,{code:ae.invalid_type,expected:pe.never,received:n.parsedType}),_e}}Ns.create=t=>new Ns({typeName:$e.ZodNever,...De(t)});class Rp extends je{_parse(e){if(this._getType(e)!==pe.undefined){const r=this._getOrReturnCtx(e);return ge(r,{code:ae.invalid_type,expected:pe.void,received:r.parsedType}),_e}return In(e.data)}}Rp.create=t=>new Rp({typeName:$e.ZodVoid,...De(t)});class di extends je{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),i=this._def;if(n.parsedType!==pe.array)return ge(n,{code:ae.invalid_type,expected:pe.array,received:n.parsedType}),_e;if(i.exactLength!==null){const o=n.data.length>i.exactLength.value,a=n.data.length<i.exactLength.value;(o||a)&&(ge(n,{code:o?ae.too_big:ae.too_small,minimum:a?i.exactLength.value:void 0,maximum:o?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(ge(n,{code:ae.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&n.data.length>i.maxLength.value&&(ge(n,{code:ae.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>i.type._parseAsync(new Gi(n,o,n.path,a)))).then(o=>kn.mergeArray(r,o));const s=[...n.data].map((o,a)=>i.type._parseSync(new Gi(n,o,n.path,a)));return kn.mergeArray(r,s)}get element(){return this._def.type}min(e,n){return new di({...this._def,minLength:{value:e,message:Pe.toString(n)}})}max(e,n){return new di({...this._def,maxLength:{value:e,message:Pe.toString(n)}})}length(e,n){return new di({...this._def,exactLength:{value:e,message:Pe.toString(n)}})}nonempty(e){return this.min(1,e)}}di.create=(t,e)=>new di({type:t,minLength:null,maxLength:null,exactLength:null,typeName:$e.ZodArray,...De(e)});function al(t){if(t instanceof At){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=ws.create(al(r))}return new At({...t._def,shape:()=>e})}else return t instanceof di?new di({...t._def,type:al(t.element)}):t instanceof ws?ws.create(al(t.unwrap())):t instanceof Ia?Ia.create(al(t.unwrap())):t instanceof Ki?Ki.create(t.items.map(e=>al(e))):t}class At extends je{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Ye.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==pe.object){const u=this._getOrReturnCtx(e);return ge(u,{code:ae.invalid_type,expected:pe.object,received:u.parsedType}),_e}const{status:r,ctx:i}=this._processInputParams(e),{shape:s,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Ns&&this._def.unknownKeys==="strip"))for(const u in i.data)o.includes(u)||a.push(u);const l=[];for(const u of o){const c=s[u],d=i.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Gi(i,d,i.path,u)),alwaysSet:u in i.data})}if(this._def.catchall instanceof Ns){const u=this._def.unknownKeys;if(u==="passthrough")for(const c of a)l.push({key:{status:"valid",value:c},value:{status:"valid",value:i.data[c]}});else if(u==="strict")a.length>0&&(ge(i,{code:ae.unrecognized_keys,keys:a}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const c of a){const d=i.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Gi(i,d,i.path,c)),alwaysSet:c in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const u=[];for(const c of l){const d=await c.key;u.push({key:d,value:await c.value,alwaysSet:c.alwaysSet})}return u}).then(u=>kn.mergeObjectSync(r,u)):kn.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return Pe.errToObj,new At({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var i,s,o,a;const l=(o=(s=(i=this._def).errorMap)===null||s===void 0?void 0:s.call(i,n,r).message)!==null&&o!==void 0?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(a=Pe.errToObj(e).message)!==null&&a!==void 0?a:l}:{message:l}}}:{}})}strip(){return new At({...this._def,unknownKeys:"strip"})}passthrough(){return new At({...this._def,unknownKeys:"passthrough"})}extend(e){return new At({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new At({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:$e.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new At({...this._def,catchall:e})}pick(e){const n={};return Ye.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new At({...this._def,shape:()=>n})}omit(e){const n={};return Ye.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new At({...this._def,shape:()=>n})}deepPartial(){return al(this)}partial(e){const n={};return Ye.objectKeys(this.shape).forEach(r=>{const i=this.shape[r];e&&!e[r]?n[r]=i:n[r]=i.optional()}),new At({...this._def,shape:()=>n})}required(e){const n={};return Ye.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let s=this.shape[r];for(;s instanceof ws;)s=s._def.innerType;n[r]=s}}),new At({...this._def,shape:()=>n})}keyof(){return QT(Ye.objectKeys(this.shape))}}At.create=(t,e)=>new At({shape:()=>t,unknownKeys:"strip",catchall:Ns.create(),typeName:$e.ZodObject,...De(e)});At.strictCreate=(t,e)=>new At({shape:()=>t,unknownKeys:"strict",catchall:Ns.create(),typeName:$e.ZodObject,...De(e)});At.lazycreate=(t,e)=>new At({shape:t,unknownKeys:"strip",catchall:Ns.create(),typeName:$e.ZodObject,...De(e)});class ld extends je{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function i(s){for(const a of s)if(a.result.status==="valid")return a.result;for(const a of s)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=s.map(a=>new ci(a.ctx.common.issues));return ge(n,{code:ae.invalid_union,unionErrors:o}),_e}if(n.common.async)return Promise.all(r.map(async s=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await s._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(i);{let s;const o=[];for(const l of r){const u={...n,common:{...n.common,issues:[]},parent:null},c=l._parseSync({data:n.data,path:n.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!s&&(s={result:c,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(s)return n.common.issues.push(...s.ctx.common.issues),s.result;const a=o.map(l=>new ci(l));return ge(n,{code:ae.invalid_union,unionErrors:a}),_e}}get options(){return this._def.options}}ld.create=(t,e)=>new ld({options:t,typeName:$e.ZodUnion,...De(e)});const Mf=t=>t instanceof dd?Mf(t.schema):t instanceof mi?Mf(t.innerType()):t instanceof hd?[t.value]:t instanceof _o?t.options:t instanceof fd?Object.keys(t.enum):t instanceof pd?Mf(t._def.innerType):t instanceof od?[void 0]:t instanceof ad?[null]:null;class Qm extends je{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==pe.object)return ge(n,{code:ae.invalid_type,expected:pe.object,received:n.parsedType}),_e;const r=this.discriminator,i=n.data[r],s=this.optionsMap.get(i);return s?n.common.async?s._parseAsync({data:n.data,path:n.path,parent:n}):s._parseSync({data:n.data,path:n.path,parent:n}):(ge(n,{code:ae.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),_e)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const i=new Map;for(const s of n){const o=Mf(s.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(i.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);i.set(a,s)}}return new Qm({typeName:$e.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:i,...De(r)})}}function Dv(t,e){const n=to(t),r=to(e);if(t===e)return{valid:!0,data:t};if(n===pe.object&&r===pe.object){const i=Ye.objectKeys(e),s=Ye.objectKeys(t).filter(a=>i.indexOf(a)!==-1),o={...t,...e};for(const a of s){const l=Dv(t[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(n===pe.array&&r===pe.array){if(t.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<t.length;s++){const o=t[s],a=e[s],l=Dv(o,a);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return n===pe.date&&r===pe.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class ud extends je{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=(s,o)=>{if(Rv(s)||Rv(o))return _e;const a=Dv(s.value,o.value);return a.valid?((Mv(s)||Mv(o))&&n.dirty(),{status:n.value,value:a.data}):(ge(r,{code:ae.invalid_intersection_types}),_e)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([s,o])=>i(s,o)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ud.create=(t,e,n)=>new ud({left:t,right:e,typeName:$e.ZodIntersection,...De(n)});class Ki extends je{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==pe.array)return ge(r,{code:ae.invalid_type,expected:pe.array,received:r.parsedType}),_e;if(r.data.length<this._def.items.length)return ge(r,{code:ae.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),_e;!this._def.rest&&r.data.length>this._def.items.length&&(ge(r,{code:ae.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const s=[...r.data].map((o,a)=>{const l=this._def.items[a]||this._def.rest;return l?l._parse(new Gi(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(s).then(o=>kn.mergeArray(n,o)):kn.mergeArray(n,s)}get items(){return this._def.items}rest(e){return new Ki({...this._def,rest:e})}}Ki.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Ki({items:t,typeName:$e.ZodTuple,rest:null,...De(e)})};class cd extends je{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==pe.object)return ge(r,{code:ae.invalid_type,expected:pe.object,received:r.parsedType}),_e;const i=[],s=this._def.keyType,o=this._def.valueType;for(const a in r.data)i.push({key:s._parse(new Gi(r,a,r.path,a)),value:o._parse(new Gi(r,r.data[a],r.path,a))});return r.common.async?kn.mergeObjectAsync(n,i):kn.mergeObjectSync(n,i)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof je?new cd({keyType:e,valueType:n,typeName:$e.ZodRecord,...De(r)}):new cd({keyType:si.create(),valueType:e,typeName:$e.ZodRecord,...De(n)})}}class Mp extends je{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==pe.map)return ge(r,{code:ae.invalid_type,expected:pe.map,received:r.parsedType}),_e;const i=this._def.keyType,s=this._def.valueType,o=[...r.data.entries()].map(([a,l],u)=>({key:i._parse(new Gi(r,a,r.path,[u,"key"])),value:s._parse(new Gi(r,l,r.path,[u,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const l of o){const u=await l.key,c=await l.value;if(u.status==="aborted"||c.status==="aborted")return _e;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),a.set(u.value,c.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const l of o){const u=l.key,c=l.value;if(u.status==="aborted"||c.status==="aborted")return _e;(u.status==="dirty"||c.status==="dirty")&&n.dirty(),a.set(u.value,c.value)}return{status:n.value,value:a}}}}Mp.create=(t,e,n)=>new Mp({valueType:e,keyType:t,typeName:$e.ZodMap,...De(n)});class Da extends je{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==pe.set)return ge(r,{code:ae.invalid_type,expected:pe.set,received:r.parsedType}),_e;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(ge(r,{code:ae.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(ge(r,{code:ae.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const s=this._def.valueType;function o(l){const u=new Set;for(const c of l){if(c.status==="aborted")return _e;c.status==="dirty"&&n.dirty(),u.add(c.value)}return{status:n.value,value:u}}const a=[...r.data.values()].map((l,u)=>s._parse(new Gi(r,l,r.path,u)));return r.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,n){return new Da({...this._def,minSize:{value:e,message:Pe.toString(n)}})}max(e,n){return new Da({...this._def,maxSize:{value:e,message:Pe.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Da.create=(t,e)=>new Da({valueType:t,minSize:null,maxSize:null,typeName:$e.ZodSet,...De(e)});class Ml extends je{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==pe.function)return ge(n,{code:ae.invalid_type,expected:pe.function,received:n.parsedType}),_e;function r(a,l){return Np({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,$p(),rd].filter(u=>!!u),issueData:{code:ae.invalid_arguments,argumentsError:l}})}function i(a,l){return Np({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,$p(),rd].filter(u=>!!u),issueData:{code:ae.invalid_return_type,returnTypeError:l}})}const s={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof lu){const a=this;return In(async function(...l){const u=new ci([]),c=await a._def.args.parseAsync(l,s).catch(f=>{throw u.addIssue(r(l,f)),u}),d=await Reflect.apply(o,this,c);return await a._def.returns._def.type.parseAsync(d,s).catch(f=>{throw u.addIssue(i(d,f)),u})})}else{const a=this;return In(function(...l){const u=a._def.args.safeParse(l,s);if(!u.success)throw new ci([r(l,u.error)]);const c=Reflect.apply(o,this,u.data),d=a._def.returns.safeParse(c,s);if(!d.success)throw new ci([i(c,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Ml({...this._def,args:Ki.create(e).rest(Sa.create())})}returns(e){return new Ml({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new Ml({args:e||Ki.create([]).rest(Sa.create()),returns:n||Sa.create(),typeName:$e.ZodFunction,...De(r)})}}class dd extends je{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}dd.create=(t,e)=>new dd({getter:t,typeName:$e.ZodLazy,...De(e)});class hd extends je{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return ge(n,{received:n.data,code:ae.invalid_literal,expected:this._def.value}),_e}return{status:"valid",value:e.data}}get value(){return this._def.value}}hd.create=(t,e)=>new hd({value:t,typeName:$e.ZodLiteral,...De(e)});function QT(t,e){return new _o({values:t,typeName:$e.ZodEnum,...De(e)})}class _o extends je{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return ge(n,{expected:Ye.joinValues(r),received:n.parsedType,code:ae.invalid_type}),_e}if(this._def.values.indexOf(e.data)===-1){const n=this._getOrReturnCtx(e),r=this._def.values;return ge(n,{received:n.data,code:ae.invalid_enum_value,options:r}),_e}return In(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e){return _o.create(e)}exclude(e){return _o.create(this.options.filter(n=>!e.includes(n)))}}_o.create=QT;class fd extends je{_parse(e){const n=Ye.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==pe.string&&r.parsedType!==pe.number){const i=Ye.objectValues(n);return ge(r,{expected:Ye.joinValues(i),received:r.parsedType,code:ae.invalid_type}),_e}if(n.indexOf(e.data)===-1){const i=Ye.objectValues(n);return ge(r,{received:r.data,code:ae.invalid_enum_value,options:i}),_e}return In(e.data)}get enum(){return this._def.values}}fd.create=(t,e)=>new fd({values:t,typeName:$e.ZodNativeEnum,...De(e)});class lu extends je{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==pe.promise&&n.common.async===!1)return ge(n,{code:ae.invalid_type,expected:pe.promise,received:n.parsedType}),_e;const r=n.parsedType===pe.promise?n.data:Promise.resolve(n.data);return In(r.then(i=>this._def.type.parseAsync(i,{path:n.path,errorMap:n.common.contextualErrorMap})))}}lu.create=(t,e)=>new lu({type:t,typeName:$e.ZodPromise,...De(e)});class mi extends je{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===$e.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:o=>{ge(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const o=i.transform(r.data,s);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:r.path,parent:r})):this._def.schema._parseSync({data:o,path:r.path,parent:r})}if(i.type==="refinement"){const o=a=>{const l=i.refinement(a,s);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?_e:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?_e:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(i.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!id(o))return o;const a=i.transform(o.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>id(o)?Promise.resolve(i.transform(o.value,s)).then(a=>({status:n.value,value:a})):o);Ye.assertNever(i)}}mi.create=(t,e,n)=>new mi({schema:t,typeName:$e.ZodEffects,effect:e,...De(n)});mi.createWithPreprocess=(t,e,n)=>new mi({schema:e,effect:{type:"preprocess",transform:t},typeName:$e.ZodEffects,...De(n)});class ws extends je{_parse(e){return this._getType(e)===pe.undefined?In(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ws.create=(t,e)=>new ws({innerType:t,typeName:$e.ZodOptional,...De(e)});class Ia extends je{_parse(e){return this._getType(e)===pe.null?In(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ia.create=(t,e)=>new Ia({innerType:t,typeName:$e.ZodNullable,...De(e)});class pd extends je{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===pe.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}pd.create=(t,e)=>new pd({innerType:t,typeName:$e.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...De(e)});class Dp extends je{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Op(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new ci(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ci(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Dp.create=(t,e)=>new Dp({innerType:t,typeName:$e.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...De(e)});class Ip extends je{_parse(e){if(this._getType(e)!==pe.nan){const r=this._getOrReturnCtx(e);return ge(r,{code:ae.invalid_type,expected:pe.nan,received:r.parsedType}),_e}return{status:"valid",value:e.data}}}Ip.create=t=>new Ip({typeName:$e.ZodNaN,...De(t)});const I5=Symbol("zod_brand");class e$ extends je{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Jd extends je{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?_e:s.status==="dirty"?(n.dirty(),qT(s.value)):this._def.out._parseAsync({data:s.value,path:r.path,parent:r})})();{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?_e:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(e,n){return new Jd({in:e,out:n,typeName:$e.ZodPipeline})}}class Lp extends je{_parse(e){const n=this._def.innerType._parse(e);return id(n)&&(n.value=Object.freeze(n.value)),n}}Lp.create=(t,e)=>new Lp({innerType:t,typeName:$e.ZodReadonly,...De(e)});const t$=(t,e={},n)=>t?au.create().superRefine((r,i)=>{var s,o;if(!t(r)){const a=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,l=(o=(s=a.fatal)!==null&&s!==void 0?s:n)!==null&&o!==void 0?o:!0,u=typeof a=="string"?{message:a}:a;i.addIssue({code:"custom",...u,fatal:l})}}):au.create(),L5={object:At.lazycreate};var $e;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})($e||($e={}));const B5=(t,e={message:`Input not instance of ${t.name}`})=>t$(n=>n instanceof t,e),n$=si.create,r$=No.create,j5=Ip.create,z5=Oo.create,i$=sd.create,F5=Ma.create,U5=_p.create,V5=od.create,H5=ad.create,W5=au.create,G5=Sa.create,K5=Ns.create,X5=Rp.create,Z5=di.create,J5=At.create,Y5=At.strictCreate,q5=ld.create,Q5=Qm.create,e6=ud.create,t6=Ki.create,n6=cd.create,r6=Mp.create,i6=Da.create,s6=Ml.create,o6=dd.create,a6=hd.create,l6=_o.create,u6=fd.create,c6=lu.create,Rk=mi.create,d6=ws.create,h6=Ia.create,f6=mi.createWithPreprocess,p6=Jd.create,m6=()=>n$().optional(),g6=()=>r$().optional(),y6=()=>i$().optional(),v6={string:t=>si.create({...t,coerce:!0}),number:t=>No.create({...t,coerce:!0}),boolean:t=>sd.create({...t,coerce:!0}),bigint:t=>Oo.create({...t,coerce:!0}),date:t=>Ma.create({...t,coerce:!0})},w6=_e;var Vs=Object.freeze({__proto__:null,defaultErrorMap:rd,setErrorMap:k5,getErrorMap:$p,makeIssue:Np,EMPTY_PATH:C5,addIssueToContext:ge,ParseStatus:kn,INVALID:_e,DIRTY:qT,OK:In,isAborted:Rv,isDirty:Mv,isValid:id,isAsync:Op,get util(){return Ye},get objectUtil(){return _v},ZodParsedType:pe,getParsedType:to,ZodType:je,ZodString:si,ZodNumber:No,ZodBigInt:Oo,ZodBoolean:sd,ZodDate:Ma,ZodSymbol:_p,ZodUndefined:od,ZodNull:ad,ZodAny:au,ZodUnknown:Sa,ZodNever:Ns,ZodVoid:Rp,ZodArray:di,ZodObject:At,ZodUnion:ld,ZodDiscriminatedUnion:Qm,ZodIntersection:ud,ZodTuple:Ki,ZodRecord:cd,ZodMap:Mp,ZodSet:Da,ZodFunction:Ml,ZodLazy:dd,ZodLiteral:hd,ZodEnum:_o,ZodNativeEnum:fd,ZodPromise:lu,ZodEffects:mi,ZodTransformer:mi,ZodOptional:ws,ZodNullable:Ia,ZodDefault:pd,ZodCatch:Dp,ZodNaN:Ip,BRAND:I5,ZodBranded:e$,ZodPipeline:Jd,ZodReadonly:Lp,custom:t$,Schema:je,ZodSchema:je,late:L5,get ZodFirstPartyTypeKind(){return $e},coerce:v6,any:W5,array:Z5,bigint:z5,boolean:i$,date:F5,discriminatedUnion:Q5,effect:Rk,enum:l6,function:s6,instanceof:B5,intersection:e6,lazy:o6,literal:a6,map:r6,nan:j5,nativeEnum:u6,never:K5,null:H5,nullable:h6,number:r$,object:J5,oboolean:y6,onumber:g6,optional:d6,ostring:m6,pipeline:p6,preprocess:f6,promise:c6,record:n6,set:i6,strictObject:Y5,string:n$,symbol:U5,transformer:Rk,tuple:t6,undefined:V5,union:q5,unknown:G5,void:X5,NEVER:w6,ZodIssueCode:ae,quotelessJson:S5,ZodError:ci});const s$=["randomize","clean","unchanged"],o$=["no-devices","pio-switches-and-leds","pio-printer","handshake"],Iv=Vs.object({language:Vs.enum(ZT).catch(x6),dataOnLoad:Vs.enum(s$).catch("randomize"),devices:Vs.enum(o$).catch("no-devices"),animations:Vs.boolean().catch(!0),executionUnit:Vs.number().min(1).max(500).catch(150),clockSpeed:Vs.number().min(100).max(3e3).catch(1e3),printerSpeed:Vs.number().min(500).max(2e4).catch(5e3)}),b6=Iv.parse({});function x6(){const t=navigator.language.toLowerCase();for(const e of ZT)if(t.startsWith(e))return e;return"en"}const $u=JT("vonsim-settings",b6,{getItem(t,e){try{const n=localStorage.getItem(t);return Iv.parse(JSON.parse(n??""))}catch{return e}},setItem(t,e){localStorage.setItem(t,JSON.stringify(e))},removeItem(t){localStorage.removeItem(t)},subscribe(t,e,n){const r=i=>{if(i.storageArea===localStorage&&i.key===t){let s;try{s=Iv.parse(JSON.parse(i.newValue??""))}catch{s=n}e(s)}};return window==null||window.addEventListener("storage",r),()=>window==null?void 0:window.removeEventListener("storage",r)}},{unstable_getOnInit:!0}),gi=()=>Q.get($u),S6=()=>Tu($u),k6=Ce(t=>t($u).language),a$=()=>dn(k6);Ce(t=>t($u).dataOnLoad);const C6=Ce(t=>t($u).devices),E6=()=>dn(C6);Ce(t=>{const e=t($u);return{executionUnit:e.executionUnit,clock:e.clockSpeed,printer:e.printerSpeed}});function md(t){const e=t.charCodeAt(0);return B.fitsUnsigned(e,8)?e:null}function a1(t){return B.fitsUnsigned(t,8)?String.fromCharCode(t):null}function l$(t){return A6.at(t)??null}const A6=["NUL","SOH","STX","ETX","EOT","ENQ","ACK","BEL","BS","HT","LF","VT","FF","CR","SO","SI","DLE","DC1","DC2","DC3","DC4","NAK","SYN","ETB","CAN","EM","SUB","ESC","FS","GS","RS","US","SPACE","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?","@","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","[","\\","]","^","_","`","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","{","|","}","~","DEL","XXX","XXX","BPH","NBH","IND","NEL","SSA","ESA","HTS","HTJ","VTS","PLD","PLU","RI","SS2","SS3","DCS","PU1","PU2","STS","CCH","MW","SPA","EPA","SOS","XXX","SCI","CSI","ST","OSC","PM","APC","NBSP","","","","","","","","","","","","","SHY","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""];var wt,Et;const We=class We{constructor(e,n){Ee(this,wt,void 0);Ee(this,Et,void 0);J(this,wt,e|0),J(this,Et,n)}get size(){return P(this,Et)}is8bits(){return P(this,Et)===8}is16bits(){return P(this,Et)===16}get unsigned(){return P(this,wt)}get signed(){return P(this,wt)<=We.maxSignedValue(P(this,Et))?P(this,wt):P(this,wt)-(We.maxValue(P(this,Et))+1)}get low(){return this.is8bits()?this:We.fromUnsigned(P(this,wt)&We.maxValue(8),8)}get high(){return this.is8bits()?new We(0,8):We.fromUnsigned(P(this,wt)>>8&We.maxValue(8),8)}withLow(e){if(e.is16bits())throw new TypeError("Byte must be 8 bits");return We.fromUnsigned(P(this,wt)&~We.maxValue(8)|e.unsigned,P(this,Et))}withHigh(e){if(e.is16bits())throw new TypeError("Byte must be 8 bits");return We.fromUnsigned(P(this,wt)&We.maxValue(8)|e.unsigned<<8,16)}bit(e){if(!Number.isSafeInteger(e)||e<0||e>=P(this,Et))throw new RangeError(`Index ${e} out of bounds for byte of size ${P(this,Et)}`);return(P(this,wt)&1<<e)!==0}withBit(e,n){if(!Number.isSafeInteger(e)||e<0||e>=P(this,Et))throw new RangeError(`Index ${e} out of bounds for byte of size ${P(this,Et)}`);return n?We.fromUnsigned(P(this,wt)|1<<e,P(this,Et)):We.fromUnsigned(P(this,wt)&~(1<<e),P(this,Et))}add(e){return e=Number(e),We.fromUnsigned(P(this,wt)+e,P(this,Et))}isZero(){return this.unsigned===0}equals(e){return typeof e=="number"?e<0?this.signed===e:this.unsigned===e:P(this,wt)===P(e,wt)}toUint8Array(){return this.is8bits()?new Uint8Array([this.unsigned]):new Uint8Array([this.low.unsigned,this.high.unsigned])}toArray(){const e=new Array(P(this,Et));for(let n=0;n<P(this,Et);n++)e[n]=this.bit(n);return e}toString(e="int"){switch(e){case"hex":return P(this,wt).toString(16).padStart(P(this,Et)/4,"0").toUpperCase();case"bin":return P(this,wt).toString(2).padStart(P(this,Et),"0");case"int":return this.signed.toString(10);case"uint":return this.unsigned.toString(10);case"ascii":return P(this,Et)===8?a1(P(this,wt))??"---":this.low.toString("ascii")+this.high.toString("ascii");case"safe-ascii":return P(this,Et)===8?l$(P(this,wt))??"---":this.low.toString("safe-ascii")+" "+this.high.toString("safe-ascii")}}toJSON(){return P(this,wt)}valueOf(){return P(this,wt)}static minValue(){return 0}static maxValue(e){return 2**e-1}static minSignedValue(e){return-(2**(e-1))}static maxSignedValue(e){return 2**(e-1)-1}static fits(e,n){return Number.isSafeInteger(e)&&e>=We.minSignedValue(n)&&e<=We.maxValue(n)}static fitsUnsigned(e,n){return Number.isSafeInteger(e)&&e>=We.minValue()&&e<=We.maxValue(n)}static fitsSigned(e,n){return Number.isSafeInteger(e)&&e>=We.minSignedValue(n)&&e<=We.maxSignedValue(n)}static fromUnsigned(e,n){if(!We.fitsUnsigned(e,n))throw new RangeError(`Value ${e} does not fit in a ${n}-bit byte.`);return new We(e,n)}static fromSigned(e,n){if(!We.fitsSigned(e,n))throw new RangeError(`Value ${e} does not fit in a ${n}-bit byte.`);return e<0?new We(e+We.maxValue(n)+1,n):new We(e,n)}static fromNumber(e,n){return e<0?We.fromSigned(e,n):We.fromUnsigned(e,n)}static fromChar(e){const n=md(e)??-1;return We.fromUnsigned(n,8)}static random(e){const n=Math.round(Math.random()*We.maxValue(e));return new We(n,e)}static zero(e){return new We(0,e)}};wt=new WeakMap,Et=new WeakMap;let B=We;var ns;const Js=class Js{constructor(e){Ee(this,ns,void 0);J(this,ns,e)}get value(){return P(this,ns).unsigned}get byte(){return P(this,ns)}toString(e=!0){let n=P(this,ns).toString("hex");return e&&(n+="h"),n}toJSON(){return P(this,ns).toJSON()}valueOf(){return P(this,ns).valueOf()}static inRange(e){return e=Number(e),Number.isSafeInteger(e)&&e>=Js.MIN_ADDRESS&&e<=Js.MAX_ADDRESS}static from(e){if(e=Number(e),!Js.inRange(e))throw new RangeError(`Address ${e} is out of range.`);const n=B.fromUnsigned(e,16);return new Js(n)}static format(e,n=!0){if(e=Number(e),!Number.isSafeInteger(e)||e<0)return"????";let r=e.toString(16).padStart(4,"0").toUpperCase();return n&&(r+="h"),r}};ns=new WeakMap,se(Js,"MIN_ADDRESS",0),se(Js,"MAX_ADDRESS",32767);let be=Js;var rs;const Ys=class Ys{constructor(e){Ee(this,rs,void 0);J(this,rs,e)}get value(){return P(this,rs).unsigned}get byte(){return P(this,rs)}toString(e=!0){let n=P(this,rs).toString("hex");return e&&(n+="h"),n}toJSON(){return P(this,rs).toJSON()}valueOf(){return P(this,rs).valueOf()}static inRange(e){return e=Number(e),Number.isSafeInteger(e)&&e>=Ys.MIN_ADDRESS&&e<=Ys.MAX_ADDRESS}static from(e){if(e=Number(e),!Ys.inRange(e))throw new RangeError(`Address ${e} is out of range.`);const n=B.fromUnsigned(e,8);return new Ys(n)}static format(e,n=!0){if(e=Number(e),!Number.isSafeInteger(e)||e<0)return"??";let r=e.toString(16).padStart(2,"0").toUpperCase();return n&&(r+="h"),r}};rs=new WeakMap,se(Ys,"MIN_ADDRESS",0),se(Ys,"MAX_ADDRESS",127);let br=Ys;const P6=be.from(be.MAX_ADDRESS).toString(),T6=`; Welcome to VonSim!
; This is an example program that calculates the first
; n numbers of the Fibonacci sequence, and stores them
; starting at memory position 1000h.

     n  equ 10    ; Calculate the first 10 numbers

        org 1000h
start   db 1

        org 2000h
        mov bx, offset start + 1
        mov al, 0
        mov ah, start

loop:   cmp bx, offset start + n
        jns finish
        mov cl, ah
        add cl, al
        mov al, ah
        mov ah, cl
        mov [bx], cl
        inc bx
        jmp loop
finish: hlt
        end
`,$6={generics:{clean:"Clean","io-register":(t,e)=>`${t} register (${br.format(e)})`,"byte-representation":{hex:"Hexadecimal",bin:"Binary",uint:"Unsigned integer",int:"Signed integer","safe-ascii":"ASCII"}},update:{"update-available":"There's a new version available!",reload:"Update"},messages:{"assemble-error":"Assemble error. Fix the errors and try again.","invalid-action":"Invalid action."},editor:{example:T6,lintSummary:t=>t===0?"Ready to compile":t===1?"There's an error":`There're ${t} errors`,files:{unsupported:"Your browser doesn't support the FileSystem API","no-file":"No file open",open:"Open file",unsaved:"There are unsaved changes, do you want to discard them?","open-error":"Error opening file",save:"Save file","save-as":"Save file as","save-error":"Error saving file"}},control:{action:{start:"Start",continue:"Continue",running:"Running...",run:{"cycle-change":"One cycle","end-of-instruction":"One instruction",infinity:"Until stop"},stop:"Stop"},tabs:{editor:"Editor",computer:"Computer"},zoom:{in:"Zoom in",out:"Zoom out"}},computer:{cpu:{name:"CPU",register:t=>`${t} register`,"control-unit":"Control unit",decoder:"Decoder",status:{fetching:"Fetching instruction...","fetching-operands":"Fetching operands...",executing:"Executing...",writeback:"Saving results...",interrupt:"Handling interrupt...",stopped:"Stopped","stopped-error":"Error","waiting-for-input":"Waiting for input...",int6:"Running INT 6...",int7:"Running INT 7..."}},memory:{name:"Memory",cell:t=>`Cell ${be.format(t)}`,"fix-address":"Fix address","unfix-address":"Unfix address","address-must-be-integer":"Start address must be an integer.","address-out-of-range":`Start address must be less or equal to ${P6}.`},"chip-select":{name:"Chip select",mem:"mem",pic:"pic",timer:"timer",pio:"pio",handshake:"handshake"},f10:"F10 key",keyboard:"Keyboard",leds:"LEDs",printer:{name:"Printer",buffer:"Buffer"},screen:"Screen",switches:"Switches",handshake:{name:"Handshake",data:"Data",state:"State"},pic:"PIC",pio:{name:"PIO",port:t=>`Port ${t}`},timer:"Timer"},settings:{title:"Settings",language:{label:"Language"},dataOnLoad:{label:"Data on load",description:"What to do with the memory when loading a new program.",randomize:"Randomize",clean:"Empty",unchanged:"Unchanged"},devices:{label:"Devices",description:"Which preset of devices to use.","no-devices":"No devices","pio-switches-and-leds":"Switches and LEDs","pio-printer":"Printer (PIO)",handshake:"Printer (Handshake)"},animations:{label:"Animations",description:["Disabling animations, you get faster execution.","Only affects animations affected by the simulation speed (like the CPU).","Other animations (like the clock and the printer) will run at their own speed.","Be careful! Very high simulation speeds without animations can saturate the processor."].join(" ")},speeds:{executionUnit:"Simulation speed",clockSpeed:"Clock speed",printerSpeed:"Printer speed"}},footer:{documentation:"Documentation","report-issue":"Report an issue",copyright:"III-LIDI, FI, UNLP"}},N6=be.from(be.MAX_ADDRESS).toString(),O6=`; Bienvenido a VonSim!
; Este es un ejemplo de cdigo que calcula los primeros
; n nmeros de la sucesin de Fibonacci, y se guardan a
; partir de la posicin 1000h de la memoria.

     n  equ 10    ; Calcula los primeros 10 nmeros

        org 1000h
inicio  db 1

        org 2000h
        mov bx, offset inicio + 1
        mov al, 0
        mov ah, inicio

bucle:  cmp bx, offset inicio + n
        jns fin
        mov cl, ah
        add cl, al
        mov al, ah
        mov ah, cl
        mov [bx], cl
        inc bx
        jmp bucle
fin:    hlt
        end
`,_6={generics:{clean:"Limpiar","io-register":(t,e)=>`Registro ${t} (${br.format(e)})`,"byte-representation":{hex:"Hexadecimal",bin:"Binario",uint:"Entero sin signo",int:"Entero con signo","safe-ascii":"ASCII"}},update:{"update-available":"Hay una nueva versin disponible!",reload:"Actualizar"},messages:{"assemble-error":"Error de ensamblado. Solucione los errores y vuelva a intentar.","invalid-action":"Accin invlida."},editor:{example:O6,lintSummary:t=>t===0?"Listo para compilar":t===1?"Hay un error":`Hay ${t} errores`,files:{unsupported:"Tu navegador no soporta la FileSystem API","no-file":"No hay ningn archivo abierto",open:"Abrir",unsaved:"Hay cambios sin guardar, desea descartarlos?","open-error":"Error al abrir el archivo",save:"Guardar","save-as":"Guardar como","save-error":"Error al guardar el archivo"}},control:{action:{start:"Iniciar",continue:"Continuar",running:"Ejecutando...",run:{"cycle-change":"Un ciclo","end-of-instruction":"Una instruccin",infinity:"Hasta el final"},stop:"Detener"},tabs:{editor:"Editor",computer:"Computadora"},zoom:{in:"Acercar",out:"Alejar"}},computer:{cpu:{name:"CPU",register:t=>`Registro ${t}`,"control-unit":"Unidad de control",decoder:"Decodificador",status:{fetching:"Leyendo instruccin...","fetching-operands":"Leyendo operandos...",executing:"Ejecutando...",writeback:"Escribiendo resultados...",interrupt:"Manejando interrupcin...",stopped:"Detenido","stopped-error":"Error","waiting-for-input":"Esperando tecla...",int6:"Ejecutando INT 6...",int7:"Ejecutando INT 7..."}},memory:{name:"Memoria",cell:t=>`Celda ${be.format(t)}`,"fix-address":"Fijar direccin","unfix-address":"Desfijar direccin","address-must-be-integer":"El valor de inicio debe ser un nmero entero.","address-out-of-range":`El valor de inicio debe ser menor o igual a ${N6}.`},"chip-select":{name:"Chip select",mem:"mem",pic:"pic",timer:"timer",pio:"pio",handshake:"handshake"},f10:"Tecla F10",keyboard:"Teclado",leds:"Leds",printer:{name:"Impresora",buffer:"Buffer"},screen:"Pantalla",switches:"Teclas",handshake:{name:"Handshake",data:"Dato",state:"Estado"},pic:"PIC",pio:{name:"PIO",port:t=>`Puerto ${t}`},timer:"Timer"},settings:{title:"Configuracin",language:{label:"Idioma"},dataOnLoad:{label:"Memoria al cargar",description:"Qu hacer con la memoria al cargar un nuevo programa.",randomize:"Aleatoria",clean:"Vaciar",unchanged:"Reusar"},devices:{label:"Dispositivos",description:"Qu conjunto de dispositivos usar.","no-devices":"Ninguno","pio-switches-and-leds":"Teclas y luces","pio-printer":"Impresora (PIO)",handshake:"Impresora (Handshake)"},animations:{label:"Animaciones",description:["Inhabilitando las animaciones, se obtiene ejecucin ms rpida.","Solo afecta a las animaciones afectadas por la velocidad de simulacin (como la CPU).","Otras animaciones (como el reloj y la impresora) se ejecutarn a su propia velocidad.","Cuidado! Velocidades de simulacin muy altas sin animaciones puede saturar el procesador."].join(" ")},speeds:{executionUnit:"Velocidad de simulacin",clockSpeed:"Velocidad del reloj",printerSpeed:"Velocidad de impresin"}},footer:{documentation:"Documentacin","report-issue":"Reportar un error",copyright:"III-LIDI, FI, UNLP"}},eg=o1({en:$6,es:_6});function lt(){const t=a$();return m.useCallback((e,...n)=>eg(t,e,...n),[t])}function R6(){const t=lt();return x.jsxs("footer",{className:"px-2 py-1 text-center text-xs tracking-wider text-stone-500",children:[x.jsx("a",{href:"/docs",className:"transition-colors hover:text-stone-400",target:"_blank",rel:"noopener noreferrer",children:t("footer.documentation")}),x.jsx("span",{className:"px-2",children:""}),x.jsx("a",{href:"https://github.com/vonsim/vonsim",className:"transition-colors hover:text-stone-400",target:"_blank",rel:"noopener noreferrer",children:"GitHub"}),x.jsx("span",{className:"px-2",children:""}),x.jsx("a",{href:"https://github.com/vonsim/vonsim/issues/new?labels=new+version",className:"transition-colors hover:text-stone-400",target:"_blank",rel:"noopener noreferrer",children:t("footer.report-issue")}),x.jsx("span",{className:"px-2 max-sm:hidden",children:""}),x.jsx("br",{className:"sm:hidden"}),x.jsxs("a",{href:"/docs#licencia",className:"transition-colors hover:text-stone-400",target:"_blank",rel:"noopener noreferrer",children:[" Copyright 2017-",new Date().getFullYear(),"  ",t("footer.copyright")]})]})}function u$(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=u$(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function Me(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=u$(t))&&(r&&(r+=" "),r+=e);return r}function M6(t,e=globalThis==null?void 0:globalThis.document){const n=Dn(t);m.useEffect(()=>{const r=i=>{i.key==="Escape"&&n(i)};return e.addEventListener("keydown",r),()=>e.removeEventListener("keydown",r)},[n,e])}const Lv="dismissableLayer.update",D6="dismissableLayer.pointerDownOutside",I6="dismissableLayer.focusOutside";let Mk;const c$=m.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),tg=m.forwardRef((t,e)=>{var n;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:i,onPointerDownOutside:s,onFocusOutside:o,onInteractOutside:a,onDismiss:l,...u}=t,c=m.useContext(c$),[d,h]=m.useState(null),f=(n=d==null?void 0:d.ownerDocument)!==null&&n!==void 0?n:globalThis==null?void 0:globalThis.document,[,p]=m.useState({}),g=Je(e,A=>h(A)),b=Array.from(c.layers),[y]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),v=b.indexOf(y),w=d?b.indexOf(d):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,C=w>=v,E=B6(A=>{const N=A.target,R=[...c.branches].some(O=>O.contains(N));!C||R||(s==null||s(A),a==null||a(A),A.defaultPrevented||l==null||l())},f),T=j6(A=>{const N=A.target;[...c.branches].some(O=>O.contains(N))||(o==null||o(A),a==null||a(A),A.defaultPrevented||l==null||l())},f);return M6(A=>{w===c.layers.size-1&&(i==null||i(A),!A.defaultPrevented&&l&&(A.preventDefault(),l()))},f),m.useEffect(()=>{if(d)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(Mk=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),Dk(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=Mk)}},[d,f,r,c]),m.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),Dk())},[d,c]),m.useEffect(()=>{const A=()=>p({});return document.addEventListener(Lv,A),()=>document.removeEventListener(Lv,A)},[]),m.createElement(Fe.div,re({},u,{ref:g,style:{pointerEvents:S?C?"auto":"none":void 0,...t.style},onFocusCapture:fe(t.onFocusCapture,T.onFocusCapture),onBlurCapture:fe(t.onBlurCapture,T.onBlurCapture),onPointerDownCapture:fe(t.onPointerDownCapture,E.onPointerDownCapture)}))}),L6=m.forwardRef((t,e)=>{const n=m.useContext(c$),r=m.useRef(null),i=Je(e,r);return m.useEffect(()=>{const s=r.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),m.createElement(Fe.div,re({},t,{ref:i}))});function B6(t,e=globalThis==null?void 0:globalThis.document){const n=Dn(t),r=m.useRef(!1),i=m.useRef(()=>{});return m.useEffect(()=>{const s=a=>{if(a.target&&!r.current){let c=function(){d$(D6,n,u,{discrete:!0})};var l=c;const u={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=c,e.addEventListener("click",i.current,{once:!0})):c()}r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",s),e.removeEventListener("click",i.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function j6(t,e=globalThis==null?void 0:globalThis.document){const n=Dn(t),r=m.useRef(!1);return m.useEffect(()=>{const i=s=>{s.target&&!r.current&&d$(I6,n,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Dk(){const t=new CustomEvent(Lv);document.dispatchEvent(t)}function d$(t,e,n,{discrete:r}){const i=n.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?Qb(i,s):i.dispatchEvent(s)}const z6=tg,F6=L6;let S0=0;function l1(){m.useEffect(()=>{var t,e;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(t=n[0])!==null&&t!==void 0?t:Ik()),document.body.insertAdjacentElement("beforeend",(e=n[1])!==null&&e!==void 0?e:Ik()),S0++,()=>{S0===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),S0--}},[])}function Ik(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",t}const k0="focusScope.autoFocusOnMount",C0="focusScope.autoFocusOnUnmount",Lk={bubbles:!1,cancelable:!0},u1=m.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...o}=t,[a,l]=m.useState(null),u=Dn(i),c=Dn(s),d=m.useRef(null),h=Je(e,g=>l(g)),f=m.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;m.useEffect(()=>{if(r){let v=function(E){if(f.paused||!a)return;const T=E.target;a.contains(T)?d.current=T:Ws(d.current,{select:!0})},w=function(E){if(f.paused||!a)return;const T=E.relatedTarget;T!==null&&(a.contains(T)||Ws(d.current,{select:!0}))},S=function(E){const T=document.activeElement;for(const A of E)A.removedNodes.length>0&&(a!=null&&a.contains(T)||Ws(a))};var g=v,b=w,y=S;document.addEventListener("focusin",v),document.addEventListener("focusout",w);const C=new MutationObserver(S);return a&&C.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",w),C.disconnect()}}},[r,a,f.paused]),m.useEffect(()=>{if(a){jk.add(f);const g=document.activeElement;if(!a.contains(g)){const y=new CustomEvent(k0,Lk);a.addEventListener(k0,u),a.dispatchEvent(y),y.defaultPrevented||(U6(K6(h$(a)),{select:!0}),document.activeElement===g&&Ws(a))}return()=>{a.removeEventListener(k0,u),setTimeout(()=>{const y=new CustomEvent(C0,Lk);a.addEventListener(C0,c),a.dispatchEvent(y),y.defaultPrevented||Ws(g??document.body,{select:!0}),a.removeEventListener(C0,c),jk.remove(f)},0)}}},[a,u,c,f]);const p=m.useCallback(g=>{if(!n&&!r||f.paused)return;const b=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,y=document.activeElement;if(b&&y){const v=g.currentTarget,[w,S]=V6(v);w&&S?!g.shiftKey&&y===S?(g.preventDefault(),n&&Ws(w,{select:!0})):g.shiftKey&&y===w&&(g.preventDefault(),n&&Ws(S,{select:!0})):y===v&&g.preventDefault()}},[n,r,f.paused]);return m.createElement(Fe.div,re({tabIndex:-1},o,{ref:h,onKeyDown:p}))});function U6(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Ws(r,{select:e}),document.activeElement!==n)return}function V6(t){const e=h$(t),n=Bk(e,t),r=Bk(e.reverse(),t);return[n,r]}function h$(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Bk(t,e){for(const n of t)if(!H6(n,{upTo:e}))return n}function H6(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function W6(t){return t instanceof HTMLInputElement&&"select"in t}function Ws(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&W6(t)&&e&&t.select()}}const jk=G6();function G6(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=zk(t,e),t.unshift(e)},remove(e){var n;t=zk(t,e),(n=t[0])===null||n===void 0||n.resume()}}}function zk(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function K6(t){return t.filter(e=>e.tagName!=="A")}function Nu(t){return t.split("-")[1]}function c1(t){return t==="y"?"height":"width"}function bs(t){return t.split("-")[0]}function Ha(t){return["top","bottom"].includes(bs(t))?"x":"y"}function Fk(t,e,n){let{reference:r,floating:i}=t;const s=r.x+r.width/2-i.width/2,o=r.y+r.height/2-i.height/2,a=Ha(e),l=c1(a),u=r[l]/2-i[l]/2,c=a==="x";let d;switch(bs(e)){case"top":d={x:s,y:r.y-i.height};break;case"bottom":d={x:s,y:r.y+r.height};break;case"right":d={x:r.x+r.width,y:o};break;case"left":d={x:r.x-i.width,y:o};break;default:d={x:r.x,y:r.y}}switch(Nu(e)){case"start":d[a]-=u*(n&&c?-1:1);break;case"end":d[a]+=u*(n&&c?-1:1)}return d}const X6=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:o}=n,a=s.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:i}),{x:c,y:d}=Fk(u,r,l),h=r,f={},p=0;for(let g=0;g<a.length;g++){const{name:b,fn:y}=a[g],{x:v,y:w,data:S,reset:C}=await y({x:c,y:d,initialPlacement:r,placement:h,strategy:i,middlewareData:f,rects:u,platform:o,elements:{reference:t,floating:e}});c=v??c,d=w??d,f={...f,[b]:{...f[b],...S}},C&&p<=50&&(p++,typeof C=="object"&&(C.placement&&(h=C.placement),C.rects&&(u=C.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:i}):C.rects),{x:c,y:d}=Fk(u,h,l)),g=-1)}return{x:c,y:d,placement:h,strategy:i,middlewareData:f}};function Os(t,e){return typeof t=="function"?t(e):t}function f$(t){return typeof t!="number"?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(t):{top:t,right:t,bottom:t,left:t}}function Bp(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function gd(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:s,rects:o,elements:a,strategy:l}=t,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=Os(e,t),p=f$(f),g=a[h?d==="floating"?"reference":"floating":d],b=Bp(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(g)))==null||n?g:g.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(a.floating)),boundary:u,rootBoundary:c,strategy:l})),y=d==="floating"?{...o.floating,x:r,y:i}:o.reference,v=await(s.getOffsetParent==null?void 0:s.getOffsetParent(a.floating)),w=await(s.isElement==null?void 0:s.isElement(v))&&await(s.getScale==null?void 0:s.getScale(v))||{x:1,y:1},S=Bp(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:y,offsetParent:v,strategy:l}):y);return{top:(b.top-S.top+p.top)/w.y,bottom:(S.bottom-b.bottom+p.bottom)/w.y,left:(b.left-S.left+p.left)/w.x,right:(S.right-b.right+p.right)/w.x}}const yd=Math.min,ia=Math.max;function Bv(t,e,n){return ia(t,yd(e,n))}const Uk=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:i,rects:s,platform:o,elements:a}=e,{element:l,padding:u=0}=Os(t,e)||{};if(l==null)return{};const c=f$(u),d={x:n,y:r},h=Ha(i),f=c1(h),p=await o.getDimensions(l),g=h==="y",b=g?"top":"left",y=g?"bottom":"right",v=g?"clientHeight":"clientWidth",w=s.reference[f]+s.reference[h]-d[h]-s.floating[f],S=d[h]-s.reference[h],C=await(o.getOffsetParent==null?void 0:o.getOffsetParent(l));let E=C?C[v]:0;E&&await(o.isElement==null?void 0:o.isElement(C))||(E=a.floating[v]||s.floating[f]);const T=w/2-S/2,A=E/2-p[f]/2-1,N=yd(c[b],A),R=yd(c[y],A),O=N,j=E-p[f]-R,z=E/2-p[f]/2+T,I=Bv(O,z,j),G=Nu(i)!=null&&z!=I&&s.reference[f]/2-(z<O?N:R)-p[f]/2<0?z<O?O-z:j-z:0;return{[h]:d[h]-G,data:{[h]:I,centerOffset:z-I+G}}}}),p$=["top","right","bottom","left"];p$.reduce((t,e)=>t.concat(e,e+"-start",e+"-end"),[]);const Z6={left:"right",right:"left",bottom:"top",top:"bottom"};function jp(t){return t.replace(/left|right|bottom|top/g,e=>Z6[e])}function J6(t,e,n){n===void 0&&(n=!1);const r=Nu(t),i=Ha(t),s=c1(i);let o=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(o=jp(o)),{main:o,cross:jp(o)}}const Y6={start:"end",end:"start"};function E0(t){return t.replace(/start|end/g,e=>Y6[e])}const q6=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n;const{placement:r,middlewareData:i,rects:s,initialPlacement:o,platform:a,elements:l}=e,{mainAxis:u=!0,crossAxis:c=!0,fallbackPlacements:d,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:f="none",flipAlignment:p=!0,...g}=Os(t,e),b=bs(r),y=bs(o)===o,v=await(a.isRTL==null?void 0:a.isRTL(l.floating)),w=d||(y||!p?[jp(o)]:function(O){const j=jp(O);return[E0(O),j,E0(j)]}(o));d||f==="none"||w.push(...function(O,j,z,I){const G=Nu(O);let K=function(ee,F,_){const V=["left","right"],Z=["right","left"],ne=["top","bottom"],me=["bottom","top"];switch(ee){case"top":case"bottom":return _?F?Z:V:F?V:Z;case"left":case"right":return F?ne:me;default:return[]}}(bs(O),z==="start",I);return G&&(K=K.map(ee=>ee+"-"+G),j&&(K=K.concat(K.map(E0)))),K}(o,p,f,v));const S=[o,...w],C=await gd(e,g),E=[];let T=((n=i.flip)==null?void 0:n.overflows)||[];if(u&&E.push(C[b]),c){const{main:O,cross:j}=J6(r,s,v);E.push(C[O],C[j])}if(T=[...T,{placement:r,overflows:E}],!E.every(O=>O<=0)){var A,N;const O=(((A=i.flip)==null?void 0:A.index)||0)+1,j=S[O];if(j)return{data:{index:O,overflows:T},reset:{placement:j}};let z=(N=T.filter(I=>I.overflows[0]<=0).sort((I,G)=>I.overflows[1]-G.overflows[1])[0])==null?void 0:N.placement;if(!z)switch(h){case"bestFit":{var R;const I=(R=T.map(G=>[G.placement,G.overflows.filter(K=>K>0).reduce((K,ee)=>K+ee,0)]).sort((G,K)=>G[1]-K[1])[0])==null?void 0:R[0];I&&(z=I);break}case"initialPlacement":z=o}if(r!==z)return{reset:{placement:z}}}return{}}}};function Vk(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function Hk(t){return p$.some(e=>t[e]>=0)}const Q6=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...i}=Os(t,e);switch(r){case"referenceHidden":{const s=Vk(await gd(e,{...i,elementContext:"reference"}),n.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:Hk(s)}}}case"escaped":{const s=Vk(await gd(e,{...i,altBoundary:!0}),n.floating);return{data:{escapedOffsets:s,escaped:Hk(s)}}}default:return{}}}}},e4=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){const{x:n,y:r}=e,i=await async function(s,o){const{placement:a,platform:l,elements:u}=s,c=await(l.isRTL==null?void 0:l.isRTL(u.floating)),d=bs(a),h=Nu(a),f=Ha(a)==="x",p=["left","top"].includes(d)?-1:1,g=c&&f?-1:1,b=Os(o,s);let{mainAxis:y,crossAxis:v,alignmentAxis:w}=typeof b=="number"?{mainAxis:b,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...b};return h&&typeof w=="number"&&(v=h==="end"?-1*w:w),f?{x:v*g,y:y*p}:{x:y*p,y:v*g}}(e,t);return{x:n+i.x,y:r+i.y,data:i}}}};function m$(t){return t==="x"?"y":"x"}const t4=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:s=!0,crossAxis:o=!1,limiter:a={fn:b=>{let{x:y,y:v}=b;return{x:y,y:v}}},...l}=Os(t,e),u={x:n,y:r},c=await gd(e,l),d=Ha(bs(i)),h=m$(d);let f=u[d],p=u[h];if(s){const b=d==="y"?"bottom":"right";f=Bv(f+c[d==="y"?"top":"left"],f,f-c[b])}if(o){const b=h==="y"?"bottom":"right";p=Bv(p+c[h==="y"?"top":"left"],p,p-c[b])}const g=a.fn({...e,[d]:f,[h]:p});return{...g,data:{x:g.x-n,y:g.y-r}}}}},n4=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:i,rects:s,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:u=!0}=Os(t,e),c={x:n,y:r},d=Ha(i),h=m$(d);let f=c[d],p=c[h];const g=Os(a,e),b=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const w=d==="y"?"height":"width",S=s.reference[d]-s.floating[w]+b.mainAxis,C=s.reference[d]+s.reference[w]-b.mainAxis;f<S?f=S:f>C&&(f=C)}if(u){var y,v;const w=d==="y"?"width":"height",S=["top","left"].includes(bs(i)),C=s.reference[h]-s.floating[w]+(S&&((y=o.offset)==null?void 0:y[h])||0)+(S?0:b.crossAxis),E=s.reference[h]+s.reference[w]+(S?0:((v=o.offset)==null?void 0:v[h])||0)-(S?b.crossAxis:0);p<C?p=C:p>E&&(p=E)}return{[d]:f,[h]:p}}}},r4=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){const{placement:n,rects:r,platform:i,elements:s}=e,{apply:o=()=>{},...a}=Os(t,e),l=await gd(e,a),u=bs(n),c=Nu(n),d=Ha(n)==="x",{width:h,height:f}=r.floating;let p,g;u==="top"||u==="bottom"?(p=u,g=c===(await(i.isRTL==null?void 0:i.isRTL(s.floating))?"start":"end")?"left":"right"):(g=u,p=c==="end"?"top":"bottom");const b=f-l[p],y=h-l[g],v=!e.middlewareData.shift;let w=b,S=y;if(d){const E=h-l.left-l.right;S=c||v?yd(y,E):E}else{const E=f-l.top-l.bottom;w=c||v?yd(b,E):E}if(v&&!c){const E=ia(l.left,0),T=ia(l.right,0),A=ia(l.top,0),N=ia(l.bottom,0);d?S=h-2*(E!==0||T!==0?E+T:ia(l.left,l.right)):w=f-2*(A!==0||N!==0?A+N:ia(l.top,l.bottom))}await o({...e,availableWidth:S,availableHeight:w});const C=await i.getDimensions(s.floating);return h!==C.width||f!==C.height?{reset:{rects:!0}}:{}}}};function mr(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Xi(t){return mr(t).getComputedStyle(t)}function g$(t){return t instanceof mr(t).Node}function Ro(t){return g$(t)?(t.nodeName||"").toLowerCase():"#document"}function yi(t){return t instanceof HTMLElement||t instanceof mr(t).HTMLElement}function Wk(t){return typeof ShadowRoot<"u"&&(t instanceof mr(t).ShadowRoot||t instanceof ShadowRoot)}function vd(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=Xi(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function i4(t){return["table","td","th"].includes(Ro(t))}function jv(t){const e=d1(),n=Xi(t);return n.transform!=="none"||n.perspective!=="none"||!!n.containerType&&n.containerType!=="normal"||!e&&!!n.backdropFilter&&n.backdropFilter!=="none"||!e&&!!n.filter&&n.filter!=="none"||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function d1(){return!(typeof CSS>"u"||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function ng(t){return["html","body","#document"].includes(Ro(t))}const zv=Math.min,Dl=Math.max,zp=Math.round,Rh=Math.floor,Mo=t=>({x:t,y:t});function y$(t){const e=Xi(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=yi(t),s=i?t.offsetWidth:n,o=i?t.offsetHeight:r,a=zp(n)!==s||zp(r)!==o;return a&&(n=s,r=o),{width:n,height:r,$:a}}function xs(t){return t instanceof Element||t instanceof mr(t).Element}function h1(t){return xs(t)?t:t.contextElement}function Il(t){const e=h1(t);if(!yi(e))return Mo(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:s}=y$(e);let o=(s?zp(n.width):n.width)/r,a=(s?zp(n.height):n.height)/i;return o&&Number.isFinite(o)||(o=1),a&&Number.isFinite(a)||(a=1),{x:o,y:a}}const s4=Mo(0);function v$(t){const e=mr(t);return d1()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:s4}function La(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),s=h1(t);let o=Mo(1);e&&(r?xs(r)&&(o=Il(r)):o=Il(t));const a=function(h,f,p){return f===void 0&&(f=!1),!(!p||f&&p!==mr(h))&&f}(s,n,r)?v$(s):Mo(0);let l=(i.left+a.x)/o.x,u=(i.top+a.y)/o.y,c=i.width/o.x,d=i.height/o.y;if(s){const h=mr(s),f=r&&xs(r)?mr(r):r;let p=h.frameElement;for(;p&&r&&f!==h;){const g=Il(p),b=p.getBoundingClientRect(),y=getComputedStyle(p),v=b.left+(p.clientLeft+parseFloat(y.paddingLeft))*g.x,w=b.top+(p.clientTop+parseFloat(y.paddingTop))*g.y;l*=g.x,u*=g.y,c*=g.x,d*=g.y,l+=v,u+=w,p=mr(p).frameElement}}return Bp({width:c,height:d,x:l,y:u})}function rg(t){return xs(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Ss(t){var e;return(e=(g$(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function w$(t){return La(Ss(t)).left+rg(t).scrollLeft}function uu(t){if(Ro(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Wk(t)&&t.host||Ss(t);return Wk(e)?e.host:e}function b$(t){const e=uu(t);return ng(e)?t.ownerDocument?t.ownerDocument.body:t.body:yi(e)&&vd(e)?e:b$(e)}function Fp(t,e){var n;e===void 0&&(e=[]);const r=b$(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),s=mr(r);return i?e.concat(s,s.visualViewport||[],vd(r)?r:[]):e.concat(r,Fp(r))}function Gk(t,e,n){let r;if(e==="viewport")r=function(i,s){const o=mr(i),a=Ss(i),l=o.visualViewport;let u=a.clientWidth,c=a.clientHeight,d=0,h=0;if(l){u=l.width,c=l.height;const f=d1();(!f||f&&s==="fixed")&&(d=l.offsetLeft,h=l.offsetTop)}return{width:u,height:c,x:d,y:h}}(t,n);else if(e==="document")r=function(i){const s=Ss(i),o=rg(i),a=i.ownerDocument.body,l=Dl(s.scrollWidth,s.clientWidth,a.scrollWidth,a.clientWidth),u=Dl(s.scrollHeight,s.clientHeight,a.scrollHeight,a.clientHeight);let c=-o.scrollLeft+w$(i);const d=-o.scrollTop;return Xi(a).direction==="rtl"&&(c+=Dl(s.clientWidth,a.clientWidth)-l),{width:l,height:u,x:c,y:d}}(Ss(t));else if(xs(e))r=function(i,s){const o=La(i,!0,s==="fixed"),a=o.top+i.clientTop,l=o.left+i.clientLeft,u=yi(i)?Il(i):Mo(1);return{width:i.clientWidth*u.x,height:i.clientHeight*u.y,x:l*u.x,y:a*u.y}}(e,n);else{const i=v$(t);r={...e,x:e.x-i.x,y:e.y-i.y}}return Bp(r)}function x$(t,e){const n=uu(t);return!(n===e||!xs(n)||ng(n))&&(Xi(n).position==="fixed"||x$(n,e))}function o4(t,e,n){const r=yi(e),i=Ss(e),s=n==="fixed",o=La(t,!0,s,e);let a={scrollLeft:0,scrollTop:0};const l=Mo(0);if(r||!r&&!s)if((Ro(e)!=="body"||vd(i))&&(a=rg(e)),yi(e)){const u=La(e,!0,s,e);l.x=u.x+e.clientLeft,l.y=u.y+e.clientTop}else i&&(l.x=w$(i));return{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function Kk(t,e){return yi(t)&&Xi(t).position!=="fixed"?e?e(t):t.offsetParent:null}function Xk(t,e){const n=mr(t);if(!yi(t))return n;let r=Kk(t,e);for(;r&&i4(r)&&Xi(r).position==="static";)r=Kk(r,e);return r&&(Ro(r)==="html"||Ro(r)==="body"&&Xi(r).position==="static"&&!jv(r))?n:r||function(i){let s=uu(i);for(;yi(s)&&!ng(s);){if(jv(s))return s;s=uu(s)}return null}(t)||n}const a4={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:n,strategy:r}=t;const i=yi(n),s=Ss(n);if(n===s)return e;let o={scrollLeft:0,scrollTop:0},a=Mo(1);const l=Mo(0);if((i||!i&&r!=="fixed")&&((Ro(n)!=="body"||vd(s))&&(o=rg(n)),yi(n))){const u=La(n);a=Il(n),l.x=u.x+n.clientLeft,l.y=u.y+n.clientTop}return{width:e.width*a.x,height:e.height*a.y,x:e.x*a.x-o.scrollLeft*a.x+l.x,y:e.y*a.y-o.scrollTop*a.y+l.y}},getDocumentElement:Ss,getClippingRect:function(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const s=[...n==="clippingAncestors"?function(l,u){const c=u.get(l);if(c)return c;let d=Fp(l).filter(g=>xs(g)&&Ro(g)!=="body"),h=null;const f=Xi(l).position==="fixed";let p=f?uu(l):l;for(;xs(p)&&!ng(p);){const g=Xi(p),b=jv(p);b||g.position!=="fixed"||(h=null),(f?!b&&!h:!b&&g.position==="static"&&h&&["absolute","fixed"].includes(h.position)||vd(p)&&!b&&x$(l,p))?d=d.filter(y=>y!==p):h=g,p=uu(p)}return u.set(l,d),d}(e,this._c):[].concat(n),r],o=s[0],a=s.reduce((l,u)=>{const c=Gk(e,u,i);return l.top=Dl(c.top,l.top),l.right=zv(c.right,l.right),l.bottom=zv(c.bottom,l.bottom),l.left=Dl(c.left,l.left),l},Gk(e,o,i));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},getOffsetParent:Xk,getElementRects:async function(t){let{reference:e,floating:n,strategy:r}=t;const i=this.getOffsetParent||Xk,s=this.getDimensions;return{reference:o4(e,await i(n),r),floating:{x:0,y:0,...await s(n)}}},getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){return y$(t)},getScale:Il,isElement:xs,isRTL:function(t){return getComputedStyle(t).direction==="rtl"}};function l4(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,u=h1(t),c=i||s?[...u?Fp(u):[],...Fp(e)]:[];c.forEach(b=>{i&&b.addEventListener("scroll",n,{passive:!0}),s&&b.addEventListener("resize",n)});const d=u&&a?function(b,y){let v,w=null;const S=Ss(b);function C(){clearTimeout(v),w&&w.disconnect(),w=null}return function E(T,A){T===void 0&&(T=!1),A===void 0&&(A=1),C();const{left:N,top:R,width:O,height:j}=b.getBoundingClientRect();if(T||y(),!O||!j)return;const z={rootMargin:-Rh(R)+"px "+-Rh(S.clientWidth-(N+O))+"px "+-Rh(S.clientHeight-(R+j))+"px "+-Rh(N)+"px",threshold:Dl(0,zv(1,A))||1};let I=!0;function G(K){const ee=K[0].intersectionRatio;if(ee!==A){if(!I)return E();ee?E(!1,ee):v=setTimeout(()=>{E(!1,1e-7)},100)}I=!1}try{w=new IntersectionObserver(G,{...z,root:S.ownerDocument})}catch{w=new IntersectionObserver(G,z)}w.observe(b)}(!0),C}(u,n):null;let h,f=-1,p=null;o&&(p=new ResizeObserver(b=>{let[y]=b;y&&y.target===u&&p&&(p.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{p&&p.observe(e)})),n()}),u&&!l&&p.observe(u),p.observe(e));let g=l?La(t):null;return l&&function b(){const y=La(t);!g||y.x===g.x&&y.y===g.y&&y.width===g.width&&y.height===g.height||n(),g=y,h=requestAnimationFrame(b)}(),n(),()=>{c.forEach(b=>{i&&b.removeEventListener("scroll",n),s&&b.removeEventListener("resize",n)}),d&&d(),p&&p.disconnect(),p=null,l&&cancelAnimationFrame(h)}}const u4=(t,e,n)=>{const r=new Map,i={platform:a4,...n},s={...i.platform,_c:r};return X6(t,e,{...i,platform:s})},c4=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:i}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?Uk({element:r.current,padding:i}).fn(n):{}:r?Uk({element:r,padding:i}).fn(n):{}}}};var Df=typeof document<"u"?m.useLayoutEffect:m.useEffect;function Up(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,i;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(r=n;r--!==0;)if(!Up(t[r],e[r]))return!1;return!0}if(i=Object.keys(t),n=i.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=n;r--!==0;){const s=i[r];if(!(s==="_owner"&&t.$$typeof)&&!Up(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function S$(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Zk(t,e){const n=S$(t);return Math.round(e*n)/n}function Jk(t){const e=m.useRef(t);return Df(()=>{e.current=t}),e}function d4(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:s,floating:o}={},transform:a=!0,whileElementsMounted:l,open:u}=t,[c,d]=m.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[h,f]=m.useState(r);Up(h,r)||f(r);const[p,g]=m.useState(null),[b,y]=m.useState(null),v=m.useCallback(K=>{K!=E.current&&(E.current=K,g(K))},[g]),w=m.useCallback(K=>{K!==T.current&&(T.current=K,y(K))},[y]),S=s||p,C=o||b,E=m.useRef(null),T=m.useRef(null),A=m.useRef(c),N=Jk(l),R=Jk(i),O=m.useCallback(()=>{if(!E.current||!T.current)return;const K={placement:e,strategy:n,middleware:h};R.current&&(K.platform=R.current),u4(E.current,T.current,K).then(ee=>{const F={...ee,isPositioned:!0};j.current&&!Up(A.current,F)&&(A.current=F,Ds.flushSync(()=>{d(F)}))})},[h,e,n,R]);Df(()=>{u===!1&&A.current.isPositioned&&(A.current.isPositioned=!1,d(K=>({...K,isPositioned:!1})))},[u]);const j=m.useRef(!1);Df(()=>(j.current=!0,()=>{j.current=!1}),[]),Df(()=>{if(S&&(E.current=S),C&&(T.current=C),S&&C){if(N.current)return N.current(S,C,O);O()}},[S,C,O,N]);const z=m.useMemo(()=>({reference:E,floating:T,setReference:v,setFloating:w}),[v,w]),I=m.useMemo(()=>({reference:S,floating:C}),[S,C]),G=m.useMemo(()=>{const K={position:n,left:0,top:0};if(!I.floating)return K;const ee=Zk(I.floating,c.x),F=Zk(I.floating,c.y);return a?{...K,transform:"translate("+ee+"px, "+F+"px)",...S$(I.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:ee,top:F}},[n,a,I.floating,c.x,c.y]);return m.useMemo(()=>({...c,update:O,refs:z,elements:I,floatingStyles:G}),[c,O,z,I,G])}function f1(t){const[e,n]=m.useState(void 0);return Gr(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const s=i[0];let o,a;if("borderBoxSize"in s){const l=s.borderBoxSize,u=Array.isArray(l)?l[0]:l;o=u.inlineSize,a=u.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}const k$="Popper",[C$,Ou]=wi(k$),[h4,E$]=C$(k$),f4=t=>{const{__scopePopper:e,children:n}=t,[r,i]=m.useState(null);return m.createElement(h4,{scope:e,anchor:r,onAnchorChange:i},n)},p4="PopperAnchor",m4=m.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...i}=t,s=E$(p4,n),o=m.useRef(null),a=Je(e,o);return m.useEffect(()=>{s.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:m.createElement(Fe.div,re({},i,{ref:a}))}),A$="PopperContent",[g4,fY]=C$(A$),y4=m.forwardRef((t,e)=>{var n,r,i,s,o,a,l,u;const{__scopePopper:c,side:d="bottom",sideOffset:h=0,align:f="center",alignOffset:p=0,arrowPadding:g=0,collisionBoundary:b=[],collisionPadding:y=0,sticky:v="partial",hideWhenDetached:w=!1,avoidCollisions:S=!0,onPlaced:C,...E}=t,T=E$(A$,c),[A,N]=m.useState(null),R=Je(e,q=>N(q)),[O,j]=m.useState(null),z=f1(O),I=(n=z==null?void 0:z.width)!==null&&n!==void 0?n:0,G=(r=z==null?void 0:z.height)!==null&&r!==void 0?r:0,K=d+(f!=="center"?"-"+f:""),ee=typeof y=="number"?y:{top:0,right:0,bottom:0,left:0,...y},F=Array.isArray(b)?b:[b],_=F.length>0,V={padding:ee,boundary:F.filter(v4),altBoundary:_},{refs:Z,floatingStyles:ne,placement:me,isPositioned:H,middlewareData:L}=d4({strategy:"fixed",placement:K,whileElementsMounted:l4,elements:{reference:T.anchor},middleware:[e4({mainAxis:h+G,alignmentAxis:p}),S&&t4({mainAxis:!0,crossAxis:!1,limiter:v==="partial"?n4():void 0,...V}),S&&q6({...V}),r4({...V,apply:({elements:q,rects:oe,availableWidth:Be,availableHeight:we})=>{const{width:Ne,height:Re}=oe.reference,ye=q.floating.style;ye.setProperty("--radix-popper-available-width",`${Be}px`),ye.setProperty("--radix-popper-available-height",`${we}px`),ye.setProperty("--radix-popper-anchor-width",`${Ne}px`),ye.setProperty("--radix-popper-anchor-height",`${Re}px`)}}),O&&c4({element:O,padding:g}),w4({arrowWidth:I,arrowHeight:G}),w&&Q6({strategy:"referenceHidden"})]}),[W,k]=P$(me),$=Dn(C);Gr(()=>{H&&($==null||$())},[H,$]);const D=(i=L.arrow)===null||i===void 0?void 0:i.x,M=(s=L.arrow)===null||s===void 0?void 0:s.y,U=((o=L.arrow)===null||o===void 0?void 0:o.centerOffset)!==0,[X,Y]=m.useState();return Gr(()=>{A&&Y(window.getComputedStyle(A).zIndex)},[A]),m.createElement("div",{ref:Z.setFloating,"data-radix-popper-content-wrapper":"",style:{...ne,transform:H?ne.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:X,"--radix-popper-transform-origin":[(a=L.transformOrigin)===null||a===void 0?void 0:a.x,(l=L.transformOrigin)===null||l===void 0?void 0:l.y].join(" ")},dir:t.dir},m.createElement(g4,{scope:c,placedSide:W,onArrowChange:j,arrowX:D,arrowY:M,shouldHideArrow:U},m.createElement(Fe.div,re({"data-side":W,"data-align":k},E,{ref:R,style:{...E.style,animation:H?void 0:"none",opacity:(u=L.hide)!==null&&u!==void 0&&u.referenceHidden?0:void 0}}))))});function v4(t){return t!==null}const w4=t=>({name:"transformOrigin",options:t,fn(e){var n,r,i,s,o;const{placement:a,rects:l,middlewareData:u}=e,d=((n=u.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,h=d?0:t.arrowWidth,f=d?0:t.arrowHeight,[p,g]=P$(a),b={start:"0%",center:"50%",end:"100%"}[g],y=((r=(i=u.arrow)===null||i===void 0?void 0:i.x)!==null&&r!==void 0?r:0)+h/2,v=((s=(o=u.arrow)===null||o===void 0?void 0:o.y)!==null&&s!==void 0?s:0)+f/2;let w="",S="";return p==="bottom"?(w=d?b:`${y}px`,S=`${-f}px`):p==="top"?(w=d?b:`${y}px`,S=`${l.floating.height+f}px`):p==="right"?(w=`${-f}px`,S=d?b:`${v}px`):p==="left"&&(w=`${l.floating.width+f}px`,S=d?b:`${v}px`),{data:{x:w,y:S}}}});function P$(t){const[e,n="center"]=t.split("-");return[e,n]}const p1=f4,m1=m4,g1=y4,ig=m.forwardRef((t,e)=>{var n;const{container:r=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...i}=t;return r?qI.createPortal(m.createElement(Fe.div,re({},i,{ref:e})),r):null});var b4=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},el=new WeakMap,Mh=new WeakMap,Dh={},A0=0,T$=function(t){return t&&(t.host||T$(t.parentNode))},x4=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=T$(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},S4=function(t,e,n,r){var i=x4(e,Array.isArray(t)?t:[t]);Dh[n]||(Dh[n]=new WeakMap);var s=Dh[n],o=[],a=new Set,l=new Set(i),u=function(d){!d||a.has(d)||(a.add(d),u(d.parentNode))};i.forEach(u);var c=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(a.has(h))c(h);else{var f=h.getAttribute(r),p=f!==null&&f!=="false",g=(el.get(h)||0)+1,b=(s.get(h)||0)+1;el.set(h,g),s.set(h,b),o.push(h),g===1&&p&&Mh.set(h,!0),b===1&&h.setAttribute(n,"true"),p||h.setAttribute(r,"true")}})};return c(e),a.clear(),A0++,function(){o.forEach(function(d){var h=el.get(d)-1,f=s.get(d)-1;el.set(d,h),s.set(d,f),h||(Mh.has(d)||d.removeAttribute(r),Mh.delete(d)),f||d.removeAttribute(n)}),A0--,A0||(el=new WeakMap,el=new WeakMap,Mh=new WeakMap,Dh={})}},y1=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),i=e||b4(t);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),S4(r,i,n,"aria-hidden")):function(){return null}},Ii=function(){return Ii=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Ii.apply(this,arguments)};function $$(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function k4(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var If="right-scroll-bar-position",Lf="width-before-scroll-bar",C4="with-scroll-bars-hidden",E4="--removed-body-scroll-bar-size";function A4(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function P4(t,e){var n=m.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}function T4(t,e){return P4(e||null,function(n){return t.forEach(function(r){return A4(r,n)})})}function $4(t){return t}function N4(t,e){e===void 0&&(e=$4);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var o=e(s,r);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(s){for(r=!0;n.length;){var o=n;n=[],o.forEach(s)}n={push:function(a){return s(a)},filter:function(){return n}}},assignMedium:function(s){r=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(s),o=n}var l=function(){var c=o;o=[],c.forEach(s)},u=function(){return Promise.resolve().then(l)};u(),n={push:function(c){o.push(c),u()},filter:function(c){return o=o.filter(c),n}}}};return i}function O4(t){t===void 0&&(t={});var e=N4(null);return e.options=Ii({async:!0,ssr:!1},t),e}var N$=function(t){var e=t.sideCar,n=$$(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return m.createElement(r,Ii({},n))};N$.isSideCarExport=!0;function _4(t,e){return t.useMedium(e),N$}var O$=O4(),P0=function(){},sg=m.forwardRef(function(t,e){var n=m.useRef(null),r=m.useState({onScrollCapture:P0,onWheelCapture:P0,onTouchMoveCapture:P0}),i=r[0],s=r[1],o=t.forwardProps,a=t.children,l=t.className,u=t.removeScrollBar,c=t.enabled,d=t.shards,h=t.sideCar,f=t.noIsolation,p=t.inert,g=t.allowPinchZoom,b=t.as,y=b===void 0?"div":b,v=$$(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),w=h,S=T4([n,e]),C=Ii(Ii({},v),i);return m.createElement(m.Fragment,null,c&&m.createElement(w,{sideCar:O$,removeScrollBar:u,shards:d,noIsolation:f,inert:p,setCallbacks:s,allowPinchZoom:!!g,lockRef:n}),o?m.cloneElement(m.Children.only(a),Ii(Ii({},C),{ref:S})):m.createElement(y,Ii({},C,{className:l,ref:S}),a))});sg.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};sg.classNames={fullWidth:Lf,zeroRight:If};var Yk,R4=function(){if(Yk)return Yk;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function M4(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=R4();return e&&t.setAttribute("nonce",e),t}function D4(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function I4(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var L4=function(){var t=0,e=null;return{add:function(n){t==0&&(e=M4())&&(D4(e,n),I4(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},B4=function(){var t=L4();return function(e,n){m.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},_$=function(){var t=B4(),e=function(n){var r=n.styles,i=n.dynamic;return t(r,i),null};return e},j4={left:0,top:0,right:0,gap:0},T0=function(t){return parseInt(t||"",10)||0},z4=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],i=e[t==="padding"?"paddingRight":"marginRight"];return[T0(n),T0(r),T0(i)]},F4=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return j4;var e=z4(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},U4=_$(),V4=function(t,e,n,r){var i=t.left,s=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(C4,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(If,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(Lf,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(If," .").concat(If,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Lf," .").concat(Lf,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body {
    `).concat(E4,": ").concat(a,`px;
  }
`)},H4=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,i=r===void 0?"margin":r,s=m.useMemo(function(){return F4(i)},[i]);return m.createElement(U4,{styles:V4(s,!e,i,n?"":"!important")})},Fv=!1;if(typeof window<"u")try{var Ih=Object.defineProperty({},"passive",{get:function(){return Fv=!0,!0}});window.addEventListener("test",Ih,Ih),window.removeEventListener("test",Ih,Ih)}catch{Fv=!1}var tl=Fv?{passive:!1}:!1,W4=function(t){return t.tagName==="TEXTAREA"},R$=function(t,e){var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!W4(t)&&n[e]==="visible")},G4=function(t){return R$(t,"overflowY")},K4=function(t){return R$(t,"overflowX")},qk=function(t,e){var n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var r=M$(t,n);if(r){var i=D$(t,n),s=i[1],o=i[2];if(s>o)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},X4=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},Z4=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},M$=function(t,e){return t==="v"?G4(e):K4(e)},D$=function(t,e){return t==="v"?X4(e):Z4(e)},J4=function(t,e){return t==="h"&&e==="rtl"?-1:1},Y4=function(t,e,n,r,i){var s=J4(t,window.getComputedStyle(e).direction),o=s*r,a=n.target,l=e.contains(a),u=!1,c=o>0,d=0,h=0;do{var f=D$(t,a),p=f[0],g=f[1],b=f[2],y=g-b-s*p;(p||y)&&M$(t,a)&&(d+=y,h+=p),a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(c&&(i&&d===0||!i&&o>d)||!c&&(i&&h===0||!i&&-o>h))&&(u=!0),u},Lh=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Qk=function(t){return[t.deltaX,t.deltaY]},eC=function(t){return t&&"current"in t?t.current:t},q4=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Q4=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},e8=0,nl=[];function t8(t){var e=m.useRef([]),n=m.useRef([0,0]),r=m.useRef(),i=m.useState(e8++)[0],s=m.useState(function(){return _$()})[0],o=m.useRef(t);m.useEffect(function(){o.current=t},[t]),m.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var g=k4([t.lockRef.current],(t.shards||[]).map(eC),!0).filter(Boolean);return g.forEach(function(b){return b.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),g.forEach(function(b){return b.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var a=m.useCallback(function(g,b){if("touches"in g&&g.touches.length===2)return!o.current.allowPinchZoom;var y=Lh(g),v=n.current,w="deltaX"in g?g.deltaX:v[0]-y[0],S="deltaY"in g?g.deltaY:v[1]-y[1],C,E=g.target,T=Math.abs(w)>Math.abs(S)?"h":"v";if("touches"in g&&T==="h"&&E.type==="range")return!1;var A=qk(T,E);if(!A)return!0;if(A?C=T:(C=T==="v"?"h":"v",A=qk(T,E)),!A)return!1;if(!r.current&&"changedTouches"in g&&(w||S)&&(r.current=C),!C)return!0;var N=r.current||C;return Y4(N,b,g,N==="h"?w:S,!0)},[]),l=m.useCallback(function(g){var b=g;if(!(!nl.length||nl[nl.length-1]!==s)){var y="deltaY"in b?Qk(b):Lh(b),v=e.current.filter(function(C){return C.name===b.type&&C.target===b.target&&q4(C.delta,y)})[0];if(v&&v.should){b.cancelable&&b.preventDefault();return}if(!v){var w=(o.current.shards||[]).map(eC).filter(Boolean).filter(function(C){return C.contains(b.target)}),S=w.length>0?a(b,w[0]):!o.current.noIsolation;S&&b.cancelable&&b.preventDefault()}}},[]),u=m.useCallback(function(g,b,y,v){var w={name:g,delta:b,target:y,should:v};e.current.push(w),setTimeout(function(){e.current=e.current.filter(function(S){return S!==w})},1)},[]),c=m.useCallback(function(g){n.current=Lh(g),r.current=void 0},[]),d=m.useCallback(function(g){u(g.type,Qk(g),g.target,a(g,t.lockRef.current))},[]),h=m.useCallback(function(g){u(g.type,Lh(g),g.target,a(g,t.lockRef.current))},[]);m.useEffect(function(){return nl.push(s),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,tl),document.addEventListener("touchmove",l,tl),document.addEventListener("touchstart",c,tl),function(){nl=nl.filter(function(g){return g!==s}),document.removeEventListener("wheel",l,tl),document.removeEventListener("touchmove",l,tl),document.removeEventListener("touchstart",c,tl)}},[]);var f=t.removeScrollBar,p=t.inert;return m.createElement(m.Fragment,null,p?m.createElement(s,{styles:Q4(i)}):null,f?m.createElement(H4,{gapMode:"margin"}):null)}const n8=_4(O$,t8);var I$=m.forwardRef(function(t,e){return m.createElement(sg,Ii({},t,{ref:e,sideCar:n8}))});I$.classNames=sg.classNames;const v1=I$,Uv=["Enter"," "],r8=["ArrowDown","PageUp","Home"],L$=["ArrowUp","PageDown","End"],i8=[...r8,...L$],s8={ltr:[...Uv,"ArrowRight"],rtl:[...Uv,"ArrowLeft"]},o8={ltr:["ArrowLeft"],rtl:["ArrowRight"]},og="Menu",[wd,a8,l8]=Xd(og),[Wa,B$]=wi(og,[l8,Ou,Jm]),w1=Ou(),j$=Jm(),[u8,Ga]=Wa(og),[c8,Yd]=Wa(og),d8=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:i,onOpenChange:s,modal:o=!0}=t,a=w1(e),[l,u]=m.useState(null),c=m.useRef(!1),d=Dn(s),h=Zd(i);return m.useEffect(()=>{const f=()=>{c.current=!0,document.addEventListener("pointerdown",p,{capture:!0,once:!0}),document.addEventListener("pointermove",p,{capture:!0,once:!0})},p=()=>c.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",p,{capture:!0}),document.removeEventListener("pointermove",p,{capture:!0})}},[]),m.createElement(p1,a,m.createElement(u8,{scope:e,open:n,onOpenChange:d,content:l,onContentChange:u},m.createElement(c8,{scope:e,onClose:m.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:c,dir:h,modal:o},r)))},z$=m.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,i=w1(n);return m.createElement(m1,re({},i,r,{ref:e}))}),F$="MenuPortal",[h8,U$]=Wa(F$,{forceMount:void 0}),f8=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:i}=t,s=Ga(F$,e);return m.createElement(h8,{scope:e,forceMount:n},m.createElement(Is,{present:n||s.open},m.createElement(ig,{asChild:!0,container:i},r)))},hi="MenuContent",[p8,b1]=Wa(hi),m8=m.forwardRef((t,e)=>{const n=U$(hi,t.__scopeMenu),{forceMount:r=n.forceMount,...i}=t,s=Ga(hi,t.__scopeMenu),o=Yd(hi,t.__scopeMenu);return m.createElement(wd.Provider,{scope:t.__scopeMenu},m.createElement(Is,{present:r||s.open},m.createElement(wd.Slot,{scope:t.__scopeMenu},o.modal?m.createElement(g8,re({},i,{ref:e})):m.createElement(y8,re({},i,{ref:e})))))}),g8=m.forwardRef((t,e)=>{const n=Ga(hi,t.__scopeMenu),r=m.useRef(null),i=Je(e,r);return m.useEffect(()=>{const s=r.current;if(s)return y1(s)},[]),m.createElement(x1,re({},t,{ref:i,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:fe(t.onFocusOutside,s=>s.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)}))}),y8=m.forwardRef((t,e)=>{const n=Ga(hi,t.__scopeMenu);return m.createElement(x1,re({},t,{ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)}))}),x1=m.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:i,onOpenAutoFocus:s,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:u,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:h,onDismiss:f,disableOutsideScroll:p,...g}=t,b=Ga(hi,n),y=Yd(hi,n),v=w1(n),w=j$(n),S=a8(n),[C,E]=m.useState(null),T=m.useRef(null),A=Je(e,T,b.onContentChange),N=m.useRef(0),R=m.useRef(""),O=m.useRef(0),j=m.useRef(null),z=m.useRef("right"),I=m.useRef(0),G=p?v1:m.Fragment,K=p?{as:Oa,allowPinchZoom:!0}:void 0,ee=_=>{var V,Z;const ne=R.current+_,me=S().filter(D=>!D.disabled),H=document.activeElement,L=(V=me.find(D=>D.ref.current===H))===null||V===void 0?void 0:V.textValue,W=me.map(D=>D.textValue),k=R8(W,ne,L),$=(Z=me.find(D=>D.textValue===k))===null||Z===void 0?void 0:Z.ref.current;(function D(M){R.current=M,window.clearTimeout(N.current),M!==""&&(N.current=window.setTimeout(()=>D(""),1e3))})(ne),$&&setTimeout(()=>$.focus())};m.useEffect(()=>()=>window.clearTimeout(N.current),[]),l1();const F=m.useCallback(_=>{var V,Z;return z.current===((V=j.current)===null||V===void 0?void 0:V.side)&&D8(_,(Z=j.current)===null||Z===void 0?void 0:Z.area)},[]);return m.createElement(p8,{scope:n,searchRef:R,onItemEnter:m.useCallback(_=>{F(_)&&_.preventDefault()},[F]),onItemLeave:m.useCallback(_=>{var V;F(_)||((V=T.current)===null||V===void 0||V.focus(),E(null))},[F]),onTriggerLeave:m.useCallback(_=>{F(_)&&_.preventDefault()},[F]),pointerGraceTimerRef:O,onPointerGraceIntentChange:m.useCallback(_=>{j.current=_},[])},m.createElement(G,K,m.createElement(u1,{asChild:!0,trapped:i,onMountAutoFocus:fe(s,_=>{var V;_.preventDefault(),(V=T.current)===null||V===void 0||V.focus()}),onUnmountAutoFocus:o},m.createElement(tg,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:u,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:h,onDismiss:f},m.createElement(ET,re({asChild:!0},w,{dir:y.dir,orientation:"vertical",loop:r,currentTabStopId:C,onCurrentTabStopIdChange:E,onEntryFocus:fe(l,_=>{y.isUsingKeyboardRef.current||_.preventDefault()})}),m.createElement(g1,re({role:"menu","aria-orientation":"vertical","data-state":K$(b.open),"data-radix-menu-content":"",dir:y.dir},v,g,{ref:A,style:{outline:"none",...g.style},onKeyDown:fe(g.onKeyDown,_=>{const Z=_.target.closest("[data-radix-menu-content]")===_.currentTarget,ne=_.ctrlKey||_.altKey||_.metaKey,me=_.key.length===1;Z&&(_.key==="Tab"&&_.preventDefault(),!ne&&me&&ee(_.key));const H=T.current;if(_.target!==H||!i8.includes(_.key))return;_.preventDefault();const W=S().filter(k=>!k.disabled).map(k=>k.ref.current);L$.includes(_.key)&&W.reverse(),O8(W)}),onBlur:fe(t.onBlur,_=>{_.currentTarget.contains(_.target)||(window.clearTimeout(N.current),R.current="")}),onPointerMove:fe(t.onPointerMove,bd(_=>{const V=_.target,Z=I.current!==_.clientX;if(_.currentTarget.contains(V)&&Z){const ne=_.clientX>I.current?"right":"left";z.current=ne,I.current=_.clientX}}))})))))))}),v8=m.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return m.createElement(Fe.div,re({},r,{ref:e}))}),Vv="MenuItem",tC="menu.itemSelect",S1=m.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...i}=t,s=m.useRef(null),o=Yd(Vv,t.__scopeMenu),a=b1(Vv,t.__scopeMenu),l=Je(e,s),u=m.useRef(!1),c=()=>{const d=s.current;if(!n&&d){const h=new CustomEvent(tC,{bubbles:!0,cancelable:!0});d.addEventListener(tC,f=>r==null?void 0:r(f),{once:!0}),Qb(d,h),h.defaultPrevented?u.current=!1:o.onClose()}};return m.createElement(V$,re({},i,{ref:l,disabled:n,onClick:fe(t.onClick,c),onPointerDown:d=>{var h;(h=t.onPointerDown)===null||h===void 0||h.call(t,d),u.current=!0},onPointerUp:fe(t.onPointerUp,d=>{var h;u.current||(h=d.currentTarget)===null||h===void 0||h.click()}),onKeyDown:fe(t.onKeyDown,d=>{const h=a.searchRef.current!=="";n||h&&d.key===" "||Uv.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})}))}),V$=m.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:i,...s}=t,o=b1(Vv,n),a=j$(n),l=m.useRef(null),u=Je(e,l),[c,d]=m.useState(!1),[h,f]=m.useState("");return m.useEffect(()=>{const p=l.current;if(p){var g;f(((g=p.textContent)!==null&&g!==void 0?g:"").trim())}},[s.children]),m.createElement(wd.ItemSlot,{scope:n,disabled:r,textValue:i??h},m.createElement(AT,re({asChild:!0},a,{focusable:!r}),m.createElement(Fe.div,re({role:"menuitem","data-highlighted":c?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0},s,{ref:u,onPointerMove:fe(t.onPointerMove,bd(p=>{r?o.onItemLeave(p):(o.onItemEnter(p),p.defaultPrevented||p.currentTarget.focus())})),onPointerLeave:fe(t.onPointerLeave,bd(p=>o.onItemLeave(p))),onFocus:fe(t.onFocus,()=>d(!0)),onBlur:fe(t.onBlur,()=>d(!1))}))))}),w8=m.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...i}=t;return m.createElement(W$,{scope:t.__scopeMenu,checked:n},m.createElement(S1,re({role:"menuitemcheckbox","aria-checked":Vp(n)?"mixed":n},i,{ref:e,"data-state":k1(n),onSelect:fe(i.onSelect,()=>r==null?void 0:r(Vp(n)?!0:!n),{checkForDefaultPrevented:!1})})))}),b8="MenuRadioGroup",[pY,x8]=Wa(b8,{value:void 0,onValueChange:()=>{}}),S8="MenuRadioItem",k8=m.forwardRef((t,e)=>{const{value:n,...r}=t,i=x8(S8,t.__scopeMenu),s=n===i.value;return m.createElement(W$,{scope:t.__scopeMenu,checked:s},m.createElement(S1,re({role:"menuitemradio","aria-checked":s},r,{ref:e,"data-state":k1(s),onSelect:fe(r.onSelect,()=>{var o;return(o=i.onValueChange)===null||o===void 0?void 0:o.call(i,n)},{checkForDefaultPrevented:!1})})))}),H$="MenuItemIndicator",[W$,C8]=Wa(H$,{checked:!1}),E8=m.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...i}=t,s=C8(H$,n);return m.createElement(Is,{present:r||Vp(s.checked)||s.checked===!0},m.createElement(Fe.span,re({},i,{ref:e,"data-state":k1(s.checked)})))}),A8=m.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return m.createElement(Fe.div,re({role:"separator","aria-orientation":"horizontal"},r,{ref:e}))}),P8="MenuSub",[mY,G$]=Wa(P8),Bh="MenuSubTrigger",T8=m.forwardRef((t,e)=>{const n=Ga(Bh,t.__scopeMenu),r=Yd(Bh,t.__scopeMenu),i=G$(Bh,t.__scopeMenu),s=b1(Bh,t.__scopeMenu),o=m.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=s,u={__scopeMenu:t.__scopeMenu},c=m.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return m.useEffect(()=>c,[c]),m.useEffect(()=>{const d=a.current;return()=>{window.clearTimeout(d),l(null)}},[a,l]),m.createElement(z$,re({asChild:!0},u),m.createElement(V$,re({id:i.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":i.contentId,"data-state":K$(n.open)},t,{ref:Zm(e,i.onTriggerChange),onClick:d=>{var h;(h=t.onClick)===null||h===void 0||h.call(t,d),!(t.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:fe(t.onPointerMove,bd(d=>{s.onItemEnter(d),!d.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(s.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),c()},100))})),onPointerLeave:fe(t.onPointerLeave,bd(d=>{var h;c();const f=(h=n.content)===null||h===void 0?void 0:h.getBoundingClientRect();if(f){var p;const g=(p=n.content)===null||p===void 0?void 0:p.dataset.side,b=g==="right",y=b?-5:5,v=f[b?"left":"right"],w=f[b?"right":"left"];s.onPointerGraceIntentChange({area:[{x:d.clientX+y,y:d.clientY},{x:v,y:f.top},{x:w,y:f.top},{x:w,y:f.bottom},{x:v,y:f.bottom}],side:g}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>s.onPointerGraceIntentChange(null),300)}else{if(s.onTriggerLeave(d),d.defaultPrevented)return;s.onPointerGraceIntentChange(null)}})),onKeyDown:fe(t.onKeyDown,d=>{const h=s.searchRef.current!=="";if(!(t.disabled||h&&d.key===" ")&&s8[r.dir].includes(d.key)){var f;n.onOpenChange(!0),(f=n.content)===null||f===void 0||f.focus(),d.preventDefault()}})})))}),$8="MenuSubContent",N8=m.forwardRef((t,e)=>{const n=U$(hi,t.__scopeMenu),{forceMount:r=n.forceMount,...i}=t,s=Ga(hi,t.__scopeMenu),o=Yd(hi,t.__scopeMenu),a=G$($8,t.__scopeMenu),l=m.useRef(null),u=Je(e,l);return m.createElement(wd.Provider,{scope:t.__scopeMenu},m.createElement(Is,{present:r||s.open},m.createElement(wd.Slot,{scope:t.__scopeMenu},m.createElement(x1,re({id:a.contentId,"aria-labelledby":a.triggerId},i,{ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:c=>{var d;o.isUsingKeyboardRef.current&&((d=l.current)===null||d===void 0||d.focus()),c.preventDefault()},onCloseAutoFocus:c=>c.preventDefault(),onFocusOutside:fe(t.onFocusOutside,c=>{c.target!==a.trigger&&s.onOpenChange(!1)}),onEscapeKeyDown:fe(t.onEscapeKeyDown,c=>{o.onClose(),c.preventDefault()}),onKeyDown:fe(t.onKeyDown,c=>{const d=c.currentTarget.contains(c.target),h=o8[o.dir].includes(c.key);if(d&&h){var f;s.onOpenChange(!1),(f=a.trigger)===null||f===void 0||f.focus(),c.preventDefault()}})})))))});function K$(t){return t?"open":"closed"}function Vp(t){return t==="indeterminate"}function k1(t){return Vp(t)?"indeterminate":t?"checked":"unchecked"}function O8(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function _8(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function R8(t,e,n){const i=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let o=_8(t,Math.max(s,0));i.length===1&&(o=o.filter(u=>u!==n));const l=o.find(u=>u.toLowerCase().startsWith(i.toLowerCase()));return l!==n?l:void 0}function M8(t,e){const{x:n,y:r}=t;let i=!1;for(let s=0,o=e.length-1;s<e.length;o=s++){const a=e[s].x,l=e[s].y,u=e[o].x,c=e[o].y;l>r!=c>r&&n<(u-a)*(r-l)/(c-l)+a&&(i=!i)}return i}function D8(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return M8(n,e)}function bd(t){return e=>e.pointerType==="mouse"?t(e):void 0}const I8=d8,L8=z$,B8=f8,j8=m8,z8=v8,F8=S1,U8=w8,V8=k8,H8=E8,W8=A8,G8=T8,K8=N8,X$="DropdownMenu",[X8,gY]=wi(X$,[B$]),Xr=B$(),[Z8,Z$]=X8(X$),J8=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:i,defaultOpen:s,onOpenChange:o,modal:a=!0}=t,l=Xr(e),u=m.useRef(null),[c=!1,d]=$s({prop:i,defaultProp:s,onChange:o});return m.createElement(Z8,{scope:e,triggerId:_a(),triggerRef:u,contentId:_a(),open:c,onOpenChange:d,onOpenToggle:m.useCallback(()=>d(h=>!h),[d]),modal:a},m.createElement(I8,re({},l,{open:c,onOpenChange:d,dir:r,modal:a}),n))},Y8="DropdownMenuTrigger",q8=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...i}=t,s=Z$(Y8,n),o=Xr(n);return m.createElement(L8,re({asChild:!0},o),m.createElement(Fe.button,re({type:"button",id:s.triggerId,"aria-haspopup":"menu","aria-expanded":s.open,"aria-controls":s.open?s.contentId:void 0,"data-state":s.open?"open":"closed","data-disabled":r?"":void 0,disabled:r},i,{ref:Zm(e,s.triggerRef),onPointerDown:fe(t.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(s.onOpenToggle(),s.open||a.preventDefault())}),onKeyDown:fe(t.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&s.onOpenToggle(),a.key==="ArrowDown"&&s.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})))}),Q8=t=>{const{__scopeDropdownMenu:e,...n}=t,r=Xr(e);return m.createElement(B8,re({},r,n))},eB="DropdownMenuContent",tB=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Z$(eB,n),s=Xr(n),o=m.useRef(!1);return m.createElement(j8,re({id:i.contentId,"aria-labelledby":i.triggerId},s,r,{ref:e,onCloseAutoFocus:fe(t.onCloseAutoFocus,a=>{var l;o.current||(l=i.triggerRef.current)===null||l===void 0||l.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:fe(t.onInteractOutside,a=>{const l=a.detail.originalEvent,u=l.button===0&&l.ctrlKey===!0,c=l.button===2||u;(!i.modal||c)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),nB=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Xr(n);return m.createElement(z8,re({},i,r,{ref:e}))}),rB=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Xr(n);return m.createElement(F8,re({},i,r,{ref:e}))}),iB=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Xr(n);return m.createElement(U8,re({},i,r,{ref:e}))}),sB=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Xr(n);return m.createElement(V8,re({},i,r,{ref:e}))}),oB=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Xr(n);return m.createElement(H8,re({},i,r,{ref:e}))}),aB=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Xr(n);return m.createElement(W8,re({},i,r,{ref:e}))}),lB=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Xr(n);return m.createElement(G8,re({},i,r,{ref:e}))}),uB=m.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,i=Xr(n);return m.createElement(K8,re({},i,r,{ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),cB=J8,dB=q8,hB=Q8,J$=tB,Y$=nB,q$=rB,Q$=iB,eN=sB,tN=oB,nN=aB,rN=lB,iN=uB,sN=cB,oN=dB,fB=m.forwardRef(({className:t,inset:e,children:n,...r},i)=>x.jsxs(rN,{ref:i,className:Me("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-mantis-500 data-[state=open]:bg-mantis-500",e&&"pl-8",t),...r,children:[n,x.jsx("span",{className:"icon-[lucide--chevron-right] ml-auto block h-4 w-4"})]}));fB.displayName=rN.displayName;const pB=m.forwardRef(({className:t,...e},n)=>x.jsx(iN,{ref:n,className:Me("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-stone-900 p-1 text-white shadow-lg transition-opacity data-[state=closed]:opacity-0 data-[state=open]:opacity-100",t),...e}));pB.displayName=iN.displayName;const C1=m.forwardRef(({className:t,sideOffset:e=4,...n},r)=>x.jsx(hB,{children:x.jsx(J$,{ref:r,sideOffset:e,className:Me("z-50 min-w-[8rem] overflow-hidden rounded-md border border-stone-600 bg-stone-900 p-1 text-white shadow-md transition-opacity data-[state=closed]:opacity-0 data-[state=open]:opacity-100",t),...n})}));C1.displayName=J$.displayName;const ka=m.forwardRef(({className:t,inset:e,...n},r)=>x.jsx(q$,{ref:r,className:Me("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-mantis-500 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e&&"pl-8",t),...n}));ka.displayName=q$.displayName;const mB=m.forwardRef(({className:t,children:e,checked:n,...r},i)=>x.jsxs(Q$,{ref:i,className:Me("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-mantis-500 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...r,children:[x.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:x.jsx(tN,{children:x.jsx("span",{className:"icon-[lucide--check] h-4 w-4"})})}),e]}));mB.displayName=Q$.displayName;const gB=m.forwardRef(({className:t,children:e,...n},r)=>x.jsxs(eN,{ref:r,className:Me("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-mantis-500 focus:text-white data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[x.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:x.jsx(tN,{children:x.jsx("span",{className:"icon-[lucide--circle-dot] block h-4 w-4"})})}),e]}));gB.displayName=eN.displayName;const yB=m.forwardRef(({className:t,inset:e,...n},r)=>x.jsx(Y$,{ref:r,className:Me("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));yB.displayName=Y$.displayName;const vB=m.forwardRef(({className:t,...e},n)=>x.jsx(nN,{ref:n,className:Me("-mx-1 my-1 h-px bg-stone-600",t),...e}));vB.displayName=nN.displayName;function Hp(t,e,n){const r=[];for(let i=0;i<t.length;i++)try{const s=e(t[i],i,t);s&&(Array.isArray(s)?s.forEach(o=>o&&r.push(n(o,i,t))):r.push(n(s,i,t)))}catch(s){r.push(n(s,i,t))}return r}class Ut{constructor(e,n){se(this,"start");se(this,"end");this.start=e|0,this.end=(n??e)|0}get range(){return[this.start,this.end]}toString(){let e=`${this.start}`;return this.end!==this.start&&(e+=`:${this.end}`),e}static merge(...e){const n=e.filter(Boolean);if(n.length===0)throw new Error("Cannot merge 0 positions");let r=n[0].start,i=n[0].end;for(const s of n)s.start<r&&(r=s.start),s.end>i&&(i=s.end);return new Ut(r,i)}toJSON(){return this.range}}const nC=be.from(be.MAX_ADDRESS).toString(),wB=br.from(br.MAX_ADDRESS).toString(),bB={"address-has-code":t=>`Memory address ${t} has instructions. It cannot be used as a data address.`,"address-out-of-range":t=>`Memory address ${be.format(t)} is out of range (max memory address: ${nC}).`,"cannot-accept-strings":t=>`${t} can't accept strings.`,"cannot-be-indirect":"This operand can't be an indirect memory address.","cannot-be-unassinged":t=>`${t} can't be unassigned.`,"cannot-be-word":"This operand can't be of 16 bits.","circular-reference":"Circular reference detected.","constant-must-have-a-label":"Constant must have a label.","constant-must-have-one-value":"Constant must have exactly one value.","destination-cannot-be-immediate":"The destination can't be an immediate value.","double-memory-access":"Can't access to a memory location twice in the same instruction.","duplicated-label":t=>`Duplicated label "${t}".`,"empty-program":"Empty program. The program must have, at least, an END statement.","end-must-be-the-last-statement":"END must be the last statement.","equ-not-found":t=>`EQU "${t}" not found.`,"expects-ax":"This operand should be AX or AL.","expects-dx":"The only valid register is DX.","expects-immediate":"This operand should be immediate.","expects-label":"This operand should be a label.","expects-no-operands":"This instruction doesn't expect any operands.","expects-one-operand":"This instruction expects one operand.","expects-two-operands":"This instruction expects two operands.","expects-word-register":"This instruction expects a 16-bits register as its operand.","instruction-out-of-range":t=>`This instruction would be placed in address ${be.format(t)}, which is outside the memory range (max memory address: ${nC}).`,"invalid-interrupt":t=>`Invalid interrupt number ${t}.`,"io-address-out-of-range":t=>`I/O address ${t} is out of range (max I/O address: ${wB}).`,"label-not-found":t=>`Label "${t}" has not been defined.`,"label-should-be-a-number":t=>`Label ${t} should point to a EQU declaration or to a instruction. Maybe you ment to write OFFSET ${t}.`,"label-should-be-an-instruction":t=>`Label ${t} should point to a instruction.`,"missing-org":"No ORG before this instruction  cannot determine its location in memory.","must-have-one-or-more-values":t=>`${t} must have at least one value.`,"occupied-address":t=>`This instruction would be placed in address ${t}, which is already occupied.`,"offset-only-with-data-directive":"OFFSET can only be use with data directives.","size-mismatch":(t,e)=>`The source (${t}-bit) and destination (${e}-bit) must be the same size.`,"unexpected-error":t=>`Unexpected error: ${String(t)}`,"unknown-size":"Addressing an unknown memory address with an immediate operand requires specifying the type of pointer with WORD PTR or BYTE PTR before the address.","value-out-of-range":(t,e)=>`The number ${t} cannot be represented with ${e} bits.`,lexer:{"character-too-long":"Character literals can only have one character.","empty-character":"Character literals can't be empty.","invalid-binary":"Invalid binary number. It should only contain 0s and 1s.","invalid-decimal":"Invalid decimal number. It should only contain digits.","only-ascii":"Only ASCII character are supported for characters literals and strings.","unexpected-character":t=>`Unexpected character "${t}".`,"unterminated-character":"Unterminated character.","unterminated-string":"Unterminated string."},parser:{"ambiguous-unary":"Ambiguous unary expression detected. Use parentheses to disambiguate.","expected-address-after-org":"Expected address after ORG.","expected-argument":"Expected argument.","expected-eos":"Expected end of statement.","expected-instruction":t=>`Expected instruction, got ${t.type}.`,"expected-label-after-offset":"Expected label after OFFSET.","expected-instruction-after-label":t=>`Expected instruction after label, got ${t.type}.`,"expected-literal-after-expression":t=>`Expected "${t}" after expression.`,"expected-literal-after-literal":(t,e)=>`Expected "${t}" after "${e}".`,"expected-type":(t,e)=>`Expected ${t}, got ${e}.`,"indirect-addressing-must-be-bx":"The only register supported for indirect addressing is BX.","unclosed-parenthesis":"Unclosed parenthesis.","unexpected-identifier":"Unexpected identifier. You may have forgotten a colon (:) to make it a label."}},rC=be.from(be.MAX_ADDRESS).toString(),xB=br.from(br.MAX_ADDRESS).toString(),SB={"address-has-code":t=>`La direccin de memoria ${be.format(t)} tiene instrucciones. No se puede usar como direccin de datos.`,"address-out-of-range":t=>`La direccin de memoria ${be.format(t)} est fuera de rango (direccin mxima de memoria: ${rC}).`,"cannot-accept-strings":t=>`${t} no puede aceptar cadenas de texto.`,"cannot-be-indirect":"Este operando no puede ser una direccin de memoria indirecta.","cannot-be-unassinged":t=>`${t} no puede estar sin asignar.`,"cannot-be-word":"Este operando no puede ser de 16 bits.","circular-reference":"Se detect una referencia circular.","constant-must-have-a-label":"La constante debe tener una etiqueta.","constant-must-have-one-value":"La constante debe tener una exactamente un valor.","destination-cannot-be-immediate":"El destino no puede ser un valor inmediato.","double-memory-access":"No se puede acceder a una memoria dos veces en la misma instruccin.","duplicated-label":t=>`Etiqueta duplicada "${t}".`,"empty-program":"Programa vaco. El programa debe tener, al menos, una instruccin END.","end-must-be-the-last-statement":"END debe ser la ltima instruccin.","equ-not-found":t=>`EQU "${t}" no encontrado.`,"expects-ax":"Este operando debe ser AX o AL.","expects-dx":"El nico registro vlido es DX.","expects-immediate":"Este operando debe ser inmediato.","expects-label":"Este operando debe ser una etiqueta.","expects-no-operands":"Esta instruccin no espera ningn operando.","expects-one-operand":"Esta instruccin espera un operando.","expects-two-operands":"Esta instruccin espera dos operandos.","expects-word-register":"Esta instruccin espera un registro de 16 bits como su operando.","instruction-out-of-range":t=>`Esta instruccin se colocara en la direccin ${be.format(t)}, la cual se encuentra fuera del rango de memoria (direccin mxima de memoria: ${rC}).`,"invalid-interrupt":t=>`${t} no es un nmero de interrupcin vlido.`,"io-address-out-of-range":t=>`La direccin de E/S ${t} est fuera de rango (direccin mxima de memoria E/S: ${xB}).`,"label-not-found":t=>`La etiqueta "${t}" no ha sido definida.`,"label-should-be-a-number":t=>`La etiqueta ${t} debera apuntar a una constante EQU o a una instruccin. Quizs quiso escribir OFFSET ${t}.`,"label-should-be-an-instruction":t=>`La etiqueta ${t} debera apuntar a una instruccin.`,"missing-org":"No hay ningn ORG antes de esta instruccin, por lo que no se puede determinar su ubicacin en memoria.","must-have-one-or-more-values":t=>`${t} debe tener al menos un valor.`,"occupied-address":t=>`Esta instruccin sera colocada en la direccin ${be.format(t)}, la cual ya est ocupada.`,"offset-only-with-data-directive":"OFFSET solo puede ser usado con variables.","size-mismatch":(t,e)=>`La fuente (${t} bits) y el destino (${e} bits) deben ser del mismo tamao.`,"unexpected-error":t=>`Error inesperado: ${String(t)}`,"unknown-size":"Acceder a una direccin de memoria desconocida con un operando inmediato requiere especificar el tipo de puntero con WORD PTR o BYTE PTR antes de la direccin.","value-out-of-range":(t,e)=>`El nmero ${t} no puede ser representado con ${e} bits.`,lexer:{"character-too-long":"El carcter solo puede contener un carcter.","empty-character":"Los carcter no puede estar vaco.","invalid-binary":"Nmero binario invlido. Solo puede contener ceros y unos.","invalid-decimal":"Nmero decimal invlido. Solo puede contener dgitos.","only-ascii":"Solo se soportan caracteres ASCII para caracteres y cadenas de texto.","unexpected-character":t=>`Carcter inesperado "${t}".`,"unterminated-character":"Carcter sin terminar.","unterminated-string":"Cadena sin terminar."},parser:{"ambiguous-unary":"Se detect una expresin unaria ambigua. Use parntesis para evitar ambigedades.","expected-address-after-org":"Se esperaba una direccin despus de ORG.","expected-argument":"Se esperaba un argumento.","expected-eos":"Se esperaba que la instruccin termine.","expected-instruction":t=>`Se esperaba una instruccin, se obtuvo ${t.type}.`,"expected-label-after-offset":"Se esperaba una etiqueta despus de OFFSET.","expected-instruction-after-label":t=>`Se esperaba una instruccin despus de la etiqueta, se obtuvo ${t.type}.`,"expected-literal-after-expression":t=>`Se esperaba "${t}" despus de la expresin.`,"expected-literal-after-literal":(t,e)=>`Se esperaba "${t}" despus de "${e}".`,"expected-type":(t,e)=>`Se esperaba ${t}, se obtuvo ${e}.`,"indirect-addressing-must-be-bx":"El nico registro vlido para el direccionamiento indirecto es BX.","unclosed-parenthesis":"Parntesis sin cerrar.","unexpected-identifier":"Identificador inesperado. Tal vez te olvidaste agregar dos puntos (:) para hacerlo una etiqueta."}},kB=o1({en:bB,es:SB});class le extends Error{constructor(n,...r){super();se(this,"code");se(this,"context");se(this,"position");this.code=n,this.context=r,this.position=null,n==="unexpected-error"&&console.error("[Unexpected Assembler Error]",...r)}at(n){return n&&(n instanceof Ut?this.position=n:"position"in n?this.position=n.position:"meta"in n&&(this.position=n.meta.position)),this}translate(n){return kB(n,this.code,...this.context)}get message(){let n=this.translate("en");return this.position&&(n+=` (${this.position})`),n}toString(){return this.message}static from(n){return n instanceof le?n:new le("unexpected-error",n)}}var ro,Wl;class CB{constructor(){se(this,"codeMemory",new Set);se(this,"labels",new Map);Ee(this,ro,!1);Ee(this,Wl,!1)}loadStatements(e){if(P(this,ro))throw new Error("Tried to load statements twice");J(this,ro,!0),this.labels.clear();const n=[];for(const r of e)if("label"in r&&r.label){if(this.labels.has(r.label)){n.push(new le("duplicated-label",r.label).at(r.position));continue}r.isInstruction()?this.labels.set(r.label,{type:"instruction",address:be.from(0)}):r.directive==="EQU"?this.labels.set(r.label,{type:"EQU",constant:r}):this.labels.set(r.label,{type:r.directive,address:be.from(0)})}return n}computeAddresses(e){if(P(this,Wl))throw new Error("Tried to compute addresses twice");J(this,Wl,!0),this.codeMemory.clear();const n=new Set;let r=null;return Hp(e,s=>{if(s.isEnd()||s.isDataDirective()&&s.directive==="EQU")return;if(s.isOriginChange()){r=s.newAddress;return}if(r===null)throw new le("missing-org").at(s);const o=s.length;for(let l=0;l<o;l++){if(!be.inRange(r+l))throw new le("instruction-out-of-range",r+l).at(s);const u=be.from(r+l);if(n.has(u.value))throw new le("occupied-address",u).at(s);n.add(u.value),s.isInstruction()&&this.codeMemory.add(u.value)}const a=be.from(r);s.setStart(a),s.label&&this.labels.set(s.label,{type:s.isInstruction()?"instruction":s.directive,address:a}),r+=o},le.from)}labelExists(e){if(!P(this,ro))throw new Error("Tried to check if label exists before loading statements");return this.labels.has(e)}getLabelType(e){var n;if(!P(this,ro))throw new Error("Tried to get type of label before loading statements");return(n=this.labels.get(e))==null?void 0:n.type}getLabelValue(e){if(!P(this,ro))throw new Error("Tried to get type of label before loading statements");const n=this.labels.get(e);if(n){if(n.type==="EQU")return n.constant.evaluate(this);if(!P(this,Wl))throw new Error("Tried to get address of label before computing addresses");return n.address.value}}addressIsReserved(e){return e instanceof be&&(e=e.value),this.codeMemory.has(e)}}ro=new WeakMap,Wl=new WeakMap;const EB=["AL","BL","CL","DL","AH","BH","CH","DH"],aN=["AX","BX","CX","DX","SP"],Wp=[...EB,...aN],E1=["DB","DW","EQU"],A1=["MOV","PUSH","POP","IN","OUT","PUSHF","POPF","ADD","ADC","INC","SUB","SBB","DEC","NEG","CMP","NOT","AND","OR","XOR","CALL","JMP","RET","JZ","JO","JS","JC","JNZ","JNO","JNS","JNC","INT","IRET","CLI","STI","NOP","HLT"],AB=["OFFSET","ORG","BYTE","WORD","PTR","END",...Wp,...A1,...E1];class PB{constructor(e,n,r){se(this,"type");se(this,"lexeme");se(this,"position");this.type=e,this.lexeme=n,this.position=r}toJSON(){return{type:this.type,lexeme:this.lexeme,position:this.position.toJSON()}}}class TB{constructor(e){se(this,"scanned",!1);se(this,"tokens",[]);se(this,"position",new Ut(0));this.source=e}scanTokens(){if(this.scanned)throw new Error("Scanner has already been used.");for(this.scanned=!0;!this.isAtEnd();){this.position=new Ut(this.position.end);const e=this.advance();switch(e){case"(":this.addToken("LEFT_PAREN");continue;case")":this.addToken("RIGHT_PAREN");continue;case"[":this.addToken("LEFT_BRACKET");continue;case"]":this.addToken("RIGHT_BRACKET");continue;case",":this.addToken("COMMA");continue;case"?":this.addToken("QUESTION_MARK");continue;case"+":this.addToken("PLUS");continue;case"-":this.addToken("MINUS");continue;case"*":this.addToken("ASTERISK");continue;case"'":{let n=0;for(;this.peek()!=="'";){if(this.isAtEnd()||this.peek()===`
`)throw new le("lexer.unterminated-character").at(this.position);if(md(this.peek())===null)throw new le("lexer.only-ascii").at(new Ut(this.position.end,this.position.end+1));this.advance(),n++}if(this.advance(),n===0)throw new le("lexer.empty-character").at(this.position);if(n>=2)throw new le("lexer.character-too-long").at(this.position);this.addToken("CHARACTER");continue}case'"':for(;this.peek()!=='"';){if(this.isAtEnd()||this.peek()===`
`)throw new le("lexer.unterminated-string").at(this.position);if(md(this.peek())===null)throw new le("lexer.only-ascii").at(new Ut(this.position.end,this.position.end+1));this.advance()}this.advance(),this.addToken("STRING");continue;case";":for(;this.peek()!==`
`&&!this.isAtEnd();)this.advance();continue;case" ":case"\r":case"	":continue;case`
`:this.addToken("EOL");continue}if(this.isDigit(e)){for(;this.isDigit(this.peek())||this.peek()>="a"&&this.peek()<="f"||this.peek()>="A"&&this.peek()<="F";)this.advance();if(this.peek()==="H"||this.peek()==="h")this.advance();else{const n=this.source.slice(this.position.start,this.position.end);if(n.at(-1)==="b"||n.at(-1)==="B"){if(!/^[01]+b$/i.test(n))throw new le("lexer.invalid-binary").at(this.position)}else if(!/^\d+$/.test(n))throw new le("lexer.invalid-decimal").at(this.position)}this.addToken("NUMBER");continue}if(this.isAlpha(e)){for(;this.isAlphaNumeric(this.peek());)this.advance();const n=this.source.slice(this.position.start,this.position.end).toUpperCase();AB.includes(n)?this.addToken(n):this.peek()===":"?(this.advance(),this.addToken("LABEL")):this.addToken("IDENTIFIER");continue}throw new le("lexer.unexpected-character",e).at(this.position)}return this.position=new Ut(this.position.end),this.addToken("EOF"),this.tokens}addToken(e){this.tokens.push(new PB(e,this.source.slice(this.position.start,this.position.end),this.position))}advance(){const e=this.source.charAt(this.position.end);return this.position=new Ut(this.position.start,this.position.end+1),e}isAlpha(e){return e>="a"&&e<="z"||e>="A"&&e<="Z"||e==="_"}isAlphaNumeric(e){return this.isAlpha(e)||this.isDigit(e)}isAtEnd(){return this.position.end>=this.source.length}isDigit(e){return e>="0"&&e<="9"}peek(){return this.isAtEnd()?"\0":this.source.charAt(this.position.end)}}class rn{constructor(e){this.position=e}isNumberLiteral(){return this.type==="number-literal"}isLabel(){return this.type==="label"}isUnaryOperation(){return this.type==="unary-operation"}isBinaryOperation(){return this.type==="binary-operation"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}se(rn,"numberLiteral",(...e)=>new $B(...e)),se(rn,"label",(...e)=>new NB(...e)),se(rn,"unaryOperation",(...e)=>new OB(...e)),se(rn,"binaryOperation",(...e)=>new _B(...e));class $B extends rn{constructor(n,r){super(r);se(this,"type","number-literal");this.value=n}evaluate(){return this.value}toJSON(){return{...super.toJSON(),value:this.value}}}let NB=class extends rn{constructor(n,r,i){super(i);se(this,"type","label");this.value=n,this.offset=r}evaluate(n){if(!n.labelExists(this.value))throw new le("label-not-found",this.value).at(this.position);const r=n.getLabelType(this.value);if((r==="DB"||r==="DW")&&!this.offset)throw new le("label-should-be-a-number",this.value).at(this.position);if((r==="EQU"||r==="instruction")&&this.offset)throw new le("offset-only-with-data-directive").at(this.position);return n.getLabelValue(this.value)}toJSON(){return{...super.toJSON(),value:this.value,offset:this.offset}}};class OB extends rn{constructor(n,r,i){super(i);se(this,"type","unary-operation");this.operator=n,this.right=r}evaluate(n){return this.operator==="+"?this.right.evaluate(n):-this.right.evaluate(n)}toJSON(){return{...super.toJSON(),operator:this.operator,right:this.right.toJSON()}}}class _B extends rn{constructor(n,r,i,s){super(s);se(this,"type","binary-operation");this.left=n,this.operator=r,this.right=i}evaluate(n){return this.operator==="+"?this.left.evaluate(n)+this.right.evaluate(n):this.operator==="-"?this.left.evaluate(n)-this.right.evaluate(n):this.left.evaluate(n)*this.right.evaluate(n)}toJSON(){return{...super.toJSON(),operator:this.operator,left:this.left.toJSON(),right:this.right.toJSON()}}}class ag{constructor(e){this.position=e}isOriginChange(){return this.type==="origin-change"}isEnd(){return this.type==="end"}isDataDirective(){return this.type==="data-directive"}isInstruction(){return this.type==="instruction"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}var is;class lN extends ag{constructor(n,r,i){super(i);se(this,"type","data-directive");se(this,"label");se(this,"values");Ee(this,is,null);this.values=n,this.label=r}get start(){if(P(this,is)===null)throw new Error("Start not set");return P(this,is)}setStart(n){if(P(this,is)!==null)throw new Error("Start already set");J(this,is,n)}toJSON(){return{...super.toJSON(),...P(this,is)?{start:P(this,is).toJSON()}:{},directive:this.directive,label:this.label}}}is=new WeakMap;var va,io,Gl;class RB extends lN{constructor(n,r,i){super(n,r,i);se(this,"directive","EQU");Ee(this,va,"not-processed");Ee(this,io,null);Ee(this,Gl,null)}toJSON(){var n;return{...super.toJSON(),value:P(this,Gl)??((n=P(this,io))==null?void 0:n.toJSON())??this.values.map(r=>r.toJSON())}}validate(){if(P(this,io))throw new Error("Constant already validated");if(!this.label)throw new le("constant-must-have-a-label").at(this);if(this.values.length!==1)throw new le("constant-must-have-one-value").at(this);const n=this.values[0];if(n.type==="string")throw new le("cannot-accept-strings","EQU").at(n);if(n.type==="unassigned")throw new le("cannot-be-unassinged","EQU").at(n);J(this,io,n.value)}evaluateExpressions(n){if(!P(this,io))throw new Error("Constant not validated");if(P(this,va)==="processed")return P(this,Gl);if(P(this,va)==="processing")throw new le("circular-reference").at(this.position);J(this,va,"processed");const r=P(this,io).evaluate(n);return J(this,va,"processed"),J(this,Gl,r),r}evaluate(n){return this.evaluateExpressions(n)}}va=new WeakMap,io=new WeakMap,Gl=new WeakMap;const hc=Symbol("unassigned");var Vn,qr;class MB extends lN{constructor(n,r,i,s){super(r,i,s);se(this,"size");Ee(this,Vn,null);Ee(this,qr,null);this.directive=n,this.size=n==="DB"?8:16}get length(){if(!P(this,Vn))throw new Error("Data directive not validated");return P(this,Vn).length*(this.size/8)}getValues(){if(!P(this,qr))throw new Error("Data directive not evaluated");return P(this,qr)}toJSON(){return{...super.toJSON(),values:(P(this,qr)??P(this,Vn)??this.values).map(n=>n===hc?"?":n.toJSON())}}validate(){if(P(this,Vn))throw new Error("Data directive already validated");J(this,Vn,[]);for(const n of this.values)if(n.isUnassigned())P(this,Vn).push(hc);else if(n.isString()){if(this.directive!=="DB")throw new le("cannot-accept-strings",this.directive).at(n);const r=n.value;for(let i=0;i<r.length;i++){const s=md(r[i]);if(s===null)throw new Error("Invalid character, should not happen");const o=new Ut(n.position.start+i,n.position.start+i+1),a=rn.numberLiteral(s,o);P(this,Vn).push(a)}}else P(this,Vn).push(n.value);if(P(this,Vn).length===0)throw new le("must-have-one-or-more-values",this.directive).at(this)}evaluateExpressions(n){if(!P(this,Vn))throw new Error("Data directive not validated");if(P(this,qr))throw new Error("Data directive already evaluated");J(this,qr,[]);const r=Hp(P(this,Vn),i=>{if(i===hc)P(this,qr).push(hc);else{const s=i.evaluate(n);if(!B.fits(s,this.size))throw new le("value-out-of-range",s,this.size).at(this);const o=B.fromNumber(s,this.size);P(this,qr).push(o)}},le.from);return r.length>0&&J(this,qr,null),r}}Vn=new WeakMap,qr=new WeakMap;class P1{constructor(e){this.position=e}isString(){return this.type==="string"}isUnassigned(){return this.type==="unassigned"}isNumberExpression(){return this.type==="number-expression"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}class DB extends P1{constructor(n,r){super(r);se(this,"type","string");this.value=n}toJSON(){return{...super.toJSON(),value:this.value}}}class IB extends P1{constructor(n){super(n);se(this,"type","unassigned")}}class LB extends P1{constructor(n){super(n.position);se(this,"type","number-expression");this.value=n}toJSON(){return{...super.toJSON(),value:this.value.toJSON()}}}function BB(t,e,n){const r=Ut.merge(t.position,...e.map(i=>i.position));switch(t.type){case"DB":case"DW":return new MB(t.type,e,n,r);case"EQU":return new RB(e,n,r)}}class jB extends ag{constructor(n){super(n);se(this,"type","end")}}function sa(t){switch(t){case"AL":case"AX":return 0;case"CL":case"CX":return 1;case"DL":case"DX":return 2;case"BL":case"BX":return 3;case"AH":case"SP":return 4;case"CH":return 5;case"DH":return 6;case"BH":return 7}}var ss;class Ka extends ag{constructor(n,r,i){super(i);se(this,"type","instruction");se(this,"label");se(this,"operands");Ee(this,ss,null);this.operands=n,this.label=r}get start(){if(P(this,ss)===null)throw new Error("Start not set");return P(this,ss)}setStart(n){if(P(this,ss)!==null)throw new Error("Start already set");J(this,ss,n)}toJSON(){return{...super.toJSON(),...P(this,ss)?{start:P(this,ss).toJSON()}:{},instruction:this.instruction,label:this.label}}}ss=new WeakMap;var mn,Pr;class zB extends Ka{constructor(n,r,i,s){super(r,i,s);Ee(this,mn,null);Ee(this,Pr,null);this.instruction=n}get length(){if(!P(this,mn))throw new Error("Instruction not validated");const{mode:n,size:r,out:i,src:s}=P(this,mn);let o=2;return(n==="reg<-mem"&&s.mode==="direct"||(n==="mem<-reg"||n==="mem<-imd")&&i.mode==="direct")&&(o+=2),(n==="reg<-imd"||n==="mem<-imd")&&(o+=r/8),o}get operation(){if(!P(this,Pr))throw new Error("Instruction not evaluated");return P(this,Pr)}toBytes(){const{mode:n,size:r,out:i,src:s}=this.operation,o=[],a={MOV:128,AND:130,OR:132,XOR:134,ADD:136,ADC:138,SUB:140,SBB:142,CMP:144};switch(o[0]=a[this.instruction],r===16&&(o[0]|=1),n){case"reg<-reg":{o[1]=0,o[1]|=sa(s)<<3,o[1]|=sa(i)<<0;break}case"reg<-mem":{s.mode==="direct"?(o[1]=64,o.push(s.address.byte.low.unsigned),o.push(s.address.byte.high.unsigned)):o[1]=80,o[1]|=sa(i)<<0;break}case"reg<-imd":{o[1]=72,o[1]|=sa(i)<<0,o.push(s.low.unsigned),r===16&&o.push(s.high.unsigned);break}case"mem<-reg":{i.mode==="direct"?(o[1]=192,o.push(i.address.byte.low.unsigned),o.push(i.address.byte.high.unsigned)):o[1]=208,o[1]|=sa(s)<<0;break}case"mem<-imd":{i.mode==="direct"?(o[1]=200,o.push(i.address.byte.low.unsigned),o.push(i.address.byte.high.unsigned)):o[1]=216,o.push(s.low.unsigned),r===16&&o.push(s.high.unsigned);break}default:return n}return new Uint8Array(o)}toJSON(){return{...super.toJSON(),...P(this,Pr)??P(this,mn)??{operands:this.operands.map(n=>n.toJSON())}}}validate(n){if(P(this,mn))throw new Error("Instruction already validated");if(this.operands.length!==2)throw new le("expects-two-operands").at(this);const[r,i]=this.operands;if(r.isRegister()){if(i.isRegister()){if(r.size!==i.size)throw new le("size-mismatch",i.size,r.size).at(this);J(this,mn,{mode:"reg<-reg",size:r.size,out:r.value,src:i.value});return}if(i.isDirectAddress()){if(i.size!=="auto"&&i.size!==r.size)throw new le("size-mismatch",i.size,r.size).at(this);J(this,mn,{mode:"reg<-mem",size:r.size,out:r.value,src:{mode:"direct",address:i.value}});return}if(i.isIndirectAddress()){if(i.size!=="auto"&&i.size!==r.size)throw new le("size-mismatch",i.size,r.size).at(this);J(this,mn,{mode:"reg<-mem",size:r.size,out:r.value,src:{mode:"indirect"}});return}const s=i.getAsDirectAddress(n);if(s){if(s.size!==r.size)throw new le("size-mismatch",s.size,r.size).at(this);J(this,mn,{mode:"reg<-mem",size:r.size,out:r.value,src:{mode:"direct",address:s.expression}});return}J(this,mn,{mode:"reg<-imd",size:r.size,out:r.value,src:i.value});return}else{let s,o;if(r.isIndirectAddress())s=r.size,o={mode:"indirect"};else if(r.isDirectAddress())s=r.size,o={mode:"direct",address:r.value};else{const a=r.getAsDirectAddress(n);if(a)s=a.size,o={mode:"direct",address:a.expression};else throw new le("destination-cannot-be-immediate").at(r)}if(i.isRegister()){if(s!=="auto"&&s!==i.size)throw new le("size-mismatch",s,i.size).at(this);J(this,mn,{mode:"mem<-reg",size:i.size,out:o,src:i.value});return}if(i.isNumberExpression()){if(i.getAsDirectAddress(n))throw new le("double-memory-access").at(this);if(s==="auto")throw new le("unknown-size").at(r);J(this,mn,{mode:"mem<-imd",size:s,out:o,src:i.value});return}throw new le("double-memory-access").at(this)}}evaluateExpressions(n){if(!P(this,mn))throw new Error("Instruction not validated");if(P(this,Pr))throw new Error("Instruction aready evaluated");const{mode:r,size:i,out:s,src:o}=P(this,mn),a=l=>{const u=l.evaluate(n);if(!be.inRange(u))throw new le("address-out-of-range",u).at(l);const c=be.from(u);if(n.addressIsReserved(c))throw new le("address-has-code",c).at(l);return c};switch(r){case"reg<-reg":{J(this,Pr,{mode:r,size:i,out:s,src:o});return}case"reg<-mem":{J(this,Pr,{mode:r,size:i,out:s,src:o.mode==="direct"?{mode:"direct",address:a(o.address)}:{mode:"indirect"}});return}case"reg<-imd":{const l=o.evaluate(n);if(!B.fits(l,i))throw new le("value-out-of-range",l,i).at(o);const u=B.fromNumber(l,i);J(this,Pr,{mode:r,size:i,out:s,src:u});return}case"mem<-reg":{J(this,Pr,{mode:r,size:i,out:s.mode==="direct"?{mode:"direct",address:a(s.address)}:{mode:"indirect"},src:o});return}case"mem<-imd":{const l=o.evaluate(n);if(!B.fits(l,i))throw new le("value-out-of-range",l,i).at(o);const u=B.fromNumber(l,i);J(this,Pr,{mode:r,size:i,out:s.mode==="direct"?{mode:"direct",address:a(s.address)}:{mode:"indirect"},src:u});return}default:return r}}}mn=new WeakMap,Pr=new WeakMap;var Ni,os;class FB extends Ka{constructor(n,r,i,s){super(r,i,s);Ee(this,Ni,null);Ee(this,os,null);se(this,"length",2);this.instruction=n}toBytes(){return new Uint8Array([26,this.value.unsigned])}get value(){if(!P(this,os))throw new Error("Instruction not evaluated");return P(this,os)}toJSON(){return{...super.toJSON(),...P(this,os)?{value:P(this,os).toJSON()}:P(this,Ni)?{initialValue:P(this,Ni).toJSON()}:{operands:this.operands.map(n=>n.toJSON())}}}validate(){if(P(this,Ni))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new le("expects-one-operand").at(this);const n=this.operands[0];if(!n.isNumberExpression())throw new le("expects-immediate").at(n);J(this,Ni,n.value)}evaluateExpressions(n){if(!P(this,Ni))throw new Error("Instruction not validated");if(P(this,os))throw new Error("Instruction aready evaluated");const r=P(this,Ni).evaluate(n);if(!B.fitsUnsigned(r,8))throw new le("invalid-interrupt",r).at(P(this,Ni));J(this,os,B.fromUnsigned(r,8))}}Ni=new WeakMap,os=new WeakMap;var Qr,as,eA;let UB=(eA=class extends Ka{constructor(n,r,i,s){super(r,i,s);Ee(this,Qr,null);Ee(this,as,null);this.instruction=n}get length(){if(!P(this,Qr))throw new Error("Instruction not validated");return P(this,Qr).port==="fixed"?2:1}toBytes(){const n=[],r={IN:80,OUT:84};return n[0]=r[this.instruction],this.operation.size===16&&(n[0]|=1),this.operation.port==="fixed"?n[1]=this.operation.address.value:n[0]|=2,new Uint8Array(n)}get operation(){if(P(this,as)===null)throw new Error("Operation not set");return P(this,as)}toJSON(){return{...super.toJSON(),...P(this,as)??P(this,Qr)??{operands:this.operands.map(n=>n.toJSON())}}}validate(){if(P(this,Qr))throw new Error("Instruction already validated");if(this.operands.length!==2)throw new le("expects-two-operands").at(this);const n=this.operands[this.instruction==="IN"?0:1],r=this.operands[this.instruction==="IN"?1:0];if(!n.isRegister()||n.value!=="AL"&&n.value!=="AX")throw new le("expects-ax").at(n);const i=n.value==="AX"?16:8;if(r.isRegister()){if(r.value!=="DX")throw new le("expects-dx").at(r);J(this,Qr,{port:"variable",size:i});return}if(r.isNumberExpression()){J(this,Qr,{port:"fixed",size:i,address:r.value});return}throw new le("expects-immediate").at(r)}evaluateExpressions(n){if(!P(this,Qr))throw new Error("Instruction not validated");if(P(this,as))throw new Error("Instruction aready evaluated");const r=P(this,Qr);if(r.port==="fixed"){const i=r.address.evaluate(n);if(!br.inRange(i))throw new le("io-address-out-of-range",i).at(this);const s=br.from(i);J(this,as,{port:"fixed",size:r.size,address:s})}else J(this,as,{port:"variable",size:r.size})}},Qr=new WeakMap,as=new WeakMap,eA);var ls,us,tA;let VB=(tA=class extends Ka{constructor(n,r,i,s){super(r,i,s);Ee(this,ls,null);Ee(this,us,null);se(this,"length",3);this.instruction=n}toBytes(){const n=[],r={JC:32,JNC:33,JZ:34,JNZ:35,JS:36,JNS:37,JO:38,JNO:39,JMP:48,CALL:49};return n.push(r[this.instruction]),n.push(this.address.byte.low.unsigned),n.push(this.address.byte.high.unsigned),new Uint8Array(n)}get address(){if(P(this,us)===null)throw new Error("Instruction not evaluated");return P(this,us)}toJSON(){return{...super.toJSON(),...P(this,us)?{address:P(this,us).toJSON()}:P(this,ls)?{jumpTo:P(this,ls)}:{operands:this.operands.map(n=>n.toJSON())}}}validate(n){if(P(this,ls))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new le("expects-one-operand").at(this);const r=this.operands[0];if(!r.isNumberExpression()||!r.value.isLabel())throw new le("expects-label").at(r);const i=r.value.value,s=n.getLabelType(i);if(!s)throw new le("label-not-found",i).at(r);if(s!=="instruction")throw new le("label-should-be-an-instruction",i).at(r);J(this,ls,i)}evaluateExpressions(n){if(!P(this,ls))throw new Error("Instruction not validated");if(P(this,us))throw new Error("Instruction aready evaluated");const r=n.getLabelValue(P(this,ls));if(!be.inRange(r))throw new le("address-out-of-range",r).at(this);J(this,us,be.from(r))}},ls=new WeakMap,us=new WeakMap,tA);var Oi,nA;let HB=(nA=class extends Ka{constructor(n,r,i,s){super(r,i,s);Ee(this,Oi,null);se(this,"length",1);this.instruction=n}toBytes(){let r={PUSH:96,POP:104}[this.instruction];return r|=sa(this.register),new Uint8Array([r])}get register(){if(!P(this,Oi))throw new Error("Instruction not evaluated");return P(this,Oi)}toJSON(){return{...super.toJSON(),...P(this,Oi)?{register:P(this,Oi)}:{operands:this.operands.map(n=>n.toJSON())}}}validate(){if(P(this,Oi))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new le("expects-one-operand").at(this);const n=this.operands[0];if(!n.isRegister()||n.size!==16)throw new le("expects-word-register").at(n);J(this,Oi,n.value)}evaluateExpressions(){if(!P(this,Oi))throw new Error("Instruction not validated")}},Oi=new WeakMap,nA);var sr,_i;class WB extends Ka{constructor(n,r,i,s){super(r,i,s);Ee(this,sr,null);Ee(this,_i,null);this.instruction=n}get length(){if(!P(this,sr))throw new Error("Instruction not validated");const{mode:n}=P(this,sr);let r=2;return n==="mem-direct"&&(r+=2),r}toBytes(){const n=[],r={NOT:64,NEG:66,INC:68,DEC:70};switch(n[0]=r[this.instruction],this.operation.size===16&&(n[0]|=1),this.operation.mode){case"reg":{n[1]=0,n[1]|=sa(this.operation.reg);break}case"mem-direct":{n[1]=192;const i=this.operation.address.byte;n.push(i.low.unsigned),n.push(i.high.unsigned);break}case"mem-indirect":{n[1]=208;break}default:return this.operation}return new Uint8Array(n)}get operation(){if(!P(this,_i))throw new Error("Instruction not evaluated");return P(this,_i)}toJSON(){return{...super.toJSON(),...P(this,_i)??P(this,sr)??{operands:this.operands.map(n=>n.toJSON())}}}validate(n){if(P(this,sr))throw new Error("Instruction already validated");if(this.operands.length!==1)throw new le("expects-one-operand").at(this);const r=this.operands[0];if(r.isRegister()){J(this,sr,{mode:"reg",size:r.size,reg:r.value});return}if(r.isDirectAddress()){if(r.size==="auto")throw new le("unknown-size").at(r);J(this,sr,{mode:"mem-direct",size:r.size,address:r.value});return}if(r.isIndirectAddress()){if(r.size==="auto")throw new le("unknown-size").at(r);J(this,sr,{mode:"mem-indirect",size:r.size});return}const i=r.getAsDirectAddress(n);if(i){J(this,sr,{mode:"mem-direct",size:i.size,address:i.expression});return}throw new le("destination-cannot-be-immediate").at(r)}evaluateExpressions(n){if(!P(this,sr))throw new Error("Instruction not validated");if(P(this,_i))throw new Error("Instruction aready evaluated");const r=P(this,sr);switch(r.mode){case"reg":{J(this,_i,{mode:"reg",size:r.size,reg:r.reg});return}case"mem-direct":{const i=r.address.evaluate(n);if(!be.inRange(i))throw new le("address-out-of-range",i).at(r.address);const s=be.from(i);if(n.addressIsReserved(s))throw new le("address-has-code",s).at(r.address);J(this,_i,{mode:"mem-direct",size:r.size,address:s});return}case"mem-indirect":{J(this,_i,{mode:"mem-indirect",size:r.size});return}default:return r}}}sr=new WeakMap,_i=new WeakMap;var Kl;class GB extends Ka{constructor(n,r,i,s){super(r,i,s);Ee(this,Kl,!1);se(this,"length",1);this.instruction=n}toBytes(){const n={PUSHF:112,POPF:120,RET:51,CLI:24,STI:25,IRET:59,NOP:16,HLT:17};return new Uint8Array([n[this.instruction]])}validate(){if(P(this,Kl))throw new Error("Instruction already validated");if(this.operands.length>0)throw new le("expects-no-operands").at(this);J(this,Kl,!0)}evaluateExpressions(){if(!P(this,Kl))throw new Error("Instruction not validated")}}Kl=new WeakMap;class lg{constructor(e){this.position=e}isRegister(){return this.type==="register"}isIndirectAddress(){return this.type==="indirect-address"}isDirectAddress(){return this.type==="direct-address"}isNumberExpression(){return this.type==="number-expression"}toJSON(){return{type:this.type,position:this.position.toJSON()}}}class KB extends lg{constructor(n){super(n.position);se(this,"type","register");se(this,"value");this.value=n.type}get size(){return aN.includes(this.value)?16:8}toJSON(){return{...super.toJSON(),value:this.value}}}class XB extends lg{constructor(n,r){super(r);se(this,"type","indirect-address");se(this,"size");n?this.size=n==="BYTE"?8:16:this.size="auto"}toJSON(){return{...super.toJSON(),size:this.size}}}class ZB extends lg{constructor(n,r,i){super(i);se(this,"type","direct-address");se(this,"size");this.value=n,r?this.size=r==="BYTE"?8:16:this.size="auto"}toJSON(){return{...super.toJSON(),size:this.size,value:this.value.toJSON()}}}class Gp extends lg{constructor(n){super(n.position);se(this,"type","number-expression");this.value=n}getAsDirectAddress(n){return Gp.recursiveGetAsDirectAddress(this.value,n)}static recursiveGetAsDirectAddress(n,r){if(n.isLabel()){const i=n;if(i.offset)return!1;if(!r.labelExists(i.value))throw new le("label-not-found",i.value).at(n.position);const s=r.getLabelType(i.value),o=s==="DB"?8:s==="DW"?16:!1;return o?{size:o,expression:rn.label(i.value,!0,n.position)}:!1}else if(n.isBinaryOperation()){if(n.operator!=="+"&&n.operator!=="-")return!1;const i=Gp.recursiveGetAsDirectAddress(n.left,r);return i?{size:i.size,expression:rn.binaryOperation(i.expression,n.operator,n.right,n.position)}:!1}return!1}toJSON(){return{...super.toJSON(),value:this.value.toJSON()}}}function iC(t,e,n){const r=Ut.merge(t.position,...e.map(i=>i.position));switch(t.type){case"PUSHF":case"POPF":case"RET":case"IRET":case"CLI":case"STI":case"NOP":case"HLT":return new GB(t.type,e,n,r);case"MOV":case"ADD":case"ADC":case"SUB":case"SBB":case"CMP":case"AND":case"OR":case"XOR":return new zB(t.type,e,n,r);case"NEG":case"INC":case"DEC":case"NOT":return new WB(t.type,e,n,r);case"PUSH":case"POP":return new HB(t.type,e,n,r);case"CALL":case"JZ":case"JNZ":case"JS":case"JNS":case"JC":case"JNC":case"JO":case"JNO":case"JMP":return new VB(t.type,e,n,r);case"IN":case"OUT":return new UB(t.type,e,n,r);case"INT":return new FB(t.type,e,n,r)}}class JB extends ag{constructor(n,r){super(r);se(this,"type","origin-change");this.newAddress=n}toJSON(){return{...super.toJSON(),newAddress:this.newAddress}}}let YB=class{constructor(e){se(this,"tokens");se(this,"current",0);this.tokens=e}parse(){this.current=0;const e=[];for(;!this.isAtEnd();)this.match("EOL")||e.push(this.statement());return e}statement(){const e=this.originChangeStatement()??this.endStatement()??this.dataDirectiveStatement()??this.instructionStatement();if(!e){const n=this.peek();throw new le("parser.expected-instruction",n).at(n)}return e}originChangeStatement(){const e=this.match("ORG");if(!e)return null;const n=this.consume("NUMBER",new le("parser.expected-address-after-org")),r=this.parseNumber(n);return this.endOfStatement(),new JB(r,Ut.merge(e.position,n.position))}endStatement(){const e=this.match("END");if(!e)return null;for(;!this.isAtEnd();)if(!this.match("EOL"))throw new le("end-must-be-the-last-statement").at(e);return new jB(e.position)}dataDirectiveStatement(){const e=this.match("IDENTIFIER"),n=this.match(...E1);if(e&&!n)throw new le("parser.unexpected-identifier").at(e);if(!n)return null;const r=(e==null?void 0:e.lexeme.toUpperCase())||null,i=[this.dataDirectiveValue()];for(;this.match("COMMA");)i.push(this.dataDirectiveValue());return this.endOfStatement(),BB(n,i,r)}dataDirectiveValue(){if(this.match("STRING")){const e=this.previous();return new DB(this.parseString(e),e.position)}if(this.match("QUESTION_MARK")){const e=this.previous();return new IB(e.position)}return new LB(this.numberExpression())}instructionStatement(){const e=this.match("LABEL");for(;this.match("EOL"););const n=this.match(...A1);if(e&&!n){const s=this.peek();throw new le("parser.expected-instruction-after-label",s).at(s)}if(!n)return null;const r=(e==null?void 0:e.lexeme.toUpperCase().slice(0,-1))||null;if(this.isAtEndOfStatement())return iC(n,[],r);const i=[this.instructionOperand()];for(;this.match("COMMA");)i.push(this.instructionOperand());return this.endOfStatement(),iC(n,i,r)}instructionOperand(){if(this.match(...Wp)){const n=this.previous();return new KB(n)}const e=this.match("BYTE","WORD");if(e&&this.consume("PTR",new le("parser.expected-literal-after-literal","PTR",this.previous().type)),this.match("LEFT_BRACKET")){const n=this.previous();if(this.check(...Wp)){this.consume("BX",new le("parser.indirect-addressing-must-be-bx"));const r=this.consume("RIGHT_BRACKET",new le("parser.expected-literal-after-literal","]","BX"));return new XB(e==null?void 0:e.type,Ut.merge(e==null?void 0:e.position,n.position,r.position))}else{const r=this.numberExpression(),i=this.consume("RIGHT_BRACKET",new le("parser.expected-literal-after-expression","]"));return new ZB(r,e==null?void 0:e.type,Ut.merge(e==null?void 0:e.position,n.position,i.position))}}else if(e)throw new le("parser.expected-literal-after-literal","[","PTR");return new Gp(this.numberExpression())}advance(){return this.tokens[this.current++]}check(...e){if(this.isAtEnd())return!1;for(const n of e)if(this.peek().type===n)return!0;return!1}consume(e,n){Array.isArray(e)||(e=[e]);const r=this.match(...e);if(r)return r;throw n||(n=new le("parser.expected-type",e.join(","),this.peek().type)),n.at(this.peek())}endOfStatement(){if(!this.isAtEnd()){if(this.check("EOL"))return this.advance();throw new le("parser.expected-eos").at(this.peek())}}isAtEnd(){return this.peek().type==="EOF"}isAtEndOfStatement(){return this.check("EOL")||this.isAtEnd()}match(...e){return this.check(...e)?this.advance():null}parseNumber(e){return e.lexeme.at(-1)==="h"||e.lexeme.at(-1)==="H"?parseInt(e.lexeme.slice(0,-1),16):e.lexeme.at(-1)==="b"||e.lexeme.at(-1)==="B"?parseInt(e.lexeme.slice(0,-1),2):parseInt(e.lexeme,10)}parseString(e){return e.lexeme.slice(1,-1)}peek(){return this.tokens[this.current]}previous(){return this.tokens[this.current-1]}primaryNE(){if(this.match("NUMBER")){const r=this.previous(),i=this.parseNumber(r);return rn.numberLiteral(i,r.position)}if(this.match("CHARACTER")){const r=this.previous(),i=md(r.lexeme.slice(1,-1));return rn.numberLiteral(i,r.position)}if(this.match("LEFT_PAREN")){const r=this.numberExpression();return this.consume("RIGHT_PAREN",new le("parser.unclosed-parenthesis")),r}const e=this.match("OFFSET"),n=this.match("IDENTIFIER");if(e&&!n)throw new le("parser.expected-label-after-offset").at(this.peek());if(!n)throw new le("parser.expected-argument").at(this.peek());return rn.label(n.lexeme.toUpperCase(),e!==null,Ut.merge(e==null?void 0:e.position,n.position))}unaryNE(){if(this.match("PLUS","MINUS")){const e=this.previous();if(this.check("PLUS","MINUS"))throw new le("parser.ambiguous-unary").at(this.peek());const n=this.unaryNE();return rn.unaryOperation(e.type==="PLUS"?"+":"-",n,Ut.merge(e.position,n.position))}return this.primaryNE()}factorNE(){let e=this.unaryNE();for(;this.match("ASTERISK");){const n=this.unaryNE();e=rn.binaryOperation(e,"*",n,Ut.merge(e.position,n.position))}return e}termNE(){let e=this.factorNE();for(;this.match("PLUS","MINUS");){const n=this.previous(),r=this.factorNE();e=rn.binaryOperation(e,n.type==="PLUS"?"+":"-",r,Ut.merge(e.position,r.position))}return e}numberExpression(){return this.termNE()}};function uN(t){try{const n=new TB(t).scanTokens(),i=new YB(n).parse(),s=i.at(-1);if(!s)throw new le("empty-program");if(!s.isEnd())throw new le("end-must-be-the-last-statement").at(s);let o=[];const a=new CB;if(o=a.loadStatements(i),o.length>0)return{success:!1,errors:o};if(o=Hp(i,c=>{c.isOriginChange()||c.isEnd()||c.validate(a)},le.from),o.length>0)return{success:!1,errors:o};if(o=a.computeAddresses(i),o.length>0)return{success:!1,errors:o};const l=[],u=[];return o=Hp(i,c=>{if(c.isDataDirective())if(c.directive==="EQU")c.evaluateExpressions(a);else{const d=c.evaluateExpressions(a);return l.push(c),d}else c.isInstruction()&&(c.evaluateExpressions(a),u.push(c))},le.from),o.length>0?{success:!1,errors:o}:{success:!0,data:l,instructions:u}}catch(e){return{success:!1,errors:[le.from(e)]}}}class nr{constructor(e){se(this,"computer");this.computer=e.computer}}const qB=be.from(be.MAX_ADDRESS).toString(),QB={"address-has-instruction":t=>`Memory address ${be.format(t)} has an instruction, and cannot be read nor written.`,"address-out-of-range":t=>`Memory address ${be.format(t)} is out of range (max memory address: ${qB}).`,"device-not-connected":t=>`"${t}" is not connected to the computer.`,"io-memory-not-connected":t=>`Didn't found a module connected to I/O memory address ${br.format(t)}.`,"no-instruction":t=>`Expected instruction at memory address ${be.format(t)} but none was found.`,"no-program":"No program loaded. Assemble before running.","stack-overflow":"Stack overflow","stack-underflow":"Stack underflow","unexpected-error":t=>`Unexpected error: ${String(t)}`},e7=be.from(be.MAX_ADDRESS).toString(),t7={"address-has-instruction":t=>`La direccin de memoria ${be.format(t)} tiene una instruccin, y no se puede leer ni escribir.`,"address-out-of-range":t=>`La direccin de memoria ${be.format(t)} est fuera de rango (direccin mxima de memoria: ${e7}).`,"device-not-connected":t=>`"${t}" no est conectado a la computadora.`,"io-memory-not-connected":t=>`No se encontr ningn mdulo conectado a la direccin de memoria E/S ${br.format(t)}.`,"no-instruction":t=>`Se esperaba una instruccin en la direccin de memoria ${be.format(t)} pero no se encontr ninguna.`,"no-program":"No hay ningn programa cargado. Ensambl antes de ejecutar.","stack-overflow":"Stack overflow","stack-underflow":"Stack underflow","unexpected-error":t=>`Error inesperado: ${String(t)}`},n7=o1({en:QB,es:t7});class Qe extends Error{constructor(n,...r){super();se(this,"code");se(this,"context");this.code=n,this.context=r,n==="unexpected-error"&&console.error("[Unexpected Simulator Error]",...r)}translate(n){return n7(n,this.code,...this.context)}get message(){return this.translate("en")}toString(){return this.message}static from(n){return n instanceof Qe?n:new Qe("unexpected-error",n)}}class Ls{constructor(e){this.statement=e}get name(){return this.statement.instruction}get start(){return this.statement.start}get position(){return this.statement.position}*consumeInstruction(e,n){if(yield*e.cpu.setMAR("IP"),!(yield*e.cpu.useBus("mem-read"))){const i=e.cpu.getRegister("IP").toString("hex");throw new Qe("unexpected-error",`Could not read instruction byte at address ${i}h`)}yield*e.cpu.updateWordRegister("IP",i=>i.add(1)),yield*e.cpu.getMBR(n)}}var $m,cN;class r7 extends Ls{constructor(){super(...arguments);Ee(this,$m)}get operation(){return this.statement.operation}*execute(n){const{mode:r,size:i,out:s,src:o}=this.operation;if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:it(this,$m,cN).call(this),willUse:{ri:r==="reg<-mem"||r==="mem<-reg"||r==="mem<-imd"}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},r==="reg<-reg"||r==="reg<-mem"||r==="reg<-imd")i===8?yield*n.cpu.copyByteRegister(s,"left.l"):yield*n.cpu.copyWordRegister(s,"left");else{if(s.mode==="direct"?(yield*this.consumeInstruction(n,"ri.l"),yield*this.consumeInstruction(n,"ri.h")):yield*n.cpu.copyWordRegister("BX","ri"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(yield*n.cpu.getMBR("left.l"),i===16){if(yield*n.cpu.updateWordRegister("ri",d=>d.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("left.h")}}if(r==="reg<-reg"||r==="mem<-reg")i===8?yield*n.cpu.copyByteRegister(o,"right.l"):yield*n.cpu.copyWordRegister(o,"right");else if(r==="reg<-imd"||r==="mem<-imd")yield*this.consumeInstruction(n,"right.l"),i===16&&(yield*this.consumeInstruction(n,"right.h"));else{if(o.mode==="direct"?(yield*this.consumeInstruction(n,"ri.l"),yield*this.consumeInstruction(n,"ri.h")):yield*n.cpu.copyWordRegister("BX","ri"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(yield*n.cpu.getMBR("right.l"),i===16){if(yield*n.cpu.updateWordRegister("ri",d=>d.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("right.h")}}yield{type:"cpu:cycle.update",phase:"execute"};const a=i===8?n.cpu.getRegister("left.l"):n.cpu.getRegister("left"),l=i===8?n.cpu.getRegister("right.l"):n.cpu.getRegister("right");let u;const c={};switch(this.name){case"AND":case"OR":case"XOR":{const d=this.name==="AND"?a.signed&l.signed:this.name==="OR"?a.signed|l.signed:a.signed^l.signed;u=B.fromSigned(d,i),c.CF=!1,c.OF=!1;break}case"ADD":case"ADC":{const d=this.name==="ADC"&&n.cpu.getFlag("CF")?1:0,h=a.unsigned+l.unsigned+d;h>B.maxValue(i)?(c.CF=!0,u=B.fromUnsigned(h-B.maxValue(i)-1,i)):(c.CF=!1,u=B.fromUnsigned(h,i)),c.OF=a.signed>=0&&l.signed>=0&&u.signed<0||a.signed<0&&l.signed<0&&u.signed>=0;break}case"SUB":case"SBB":case"CMP":{const d=this.name==="SBB"&&n.cpu.getFlag("CF")?1:0,h=a.unsigned-l.unsigned-d;h<0?(c.CF=!0,u=B.fromUnsigned(h+B.maxValue(i)+1,i)):(c.CF=!1,u=B.fromUnsigned(h,i)),c.OF=a.signed>=0&&l.signed<0&&u.signed<0||a.signed<0&&l.signed>=0&&u.signed>=0;break}}if(c.ZF=u.isZero(),c.SF=u.signed<0,yield*n.cpu.aluExecute(this.name==="CMP"?"SUB":this.name,u,c),this.name==="CMP")return!0;if(yield{type:"cpu:cycle.update",phase:"writeback"},r==="reg<-reg"||r==="reg<-mem"||r==="reg<-imd")i===8?yield*n.cpu.copyByteRegister("result.l",s):yield*n.cpu.copyWordRegister("result",s);else{if(i===16){if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.h"),!(yield*n.cpu.useBus("mem-write")))return!1;yield*n.cpu.updateWordRegister("ri",d=>d.add(-1))}if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.l"),!(yield*n.cpu.useBus("mem-write")))return!1}return!0}}$m=new WeakSet,cN=function(){const{mode:n,out:r,src:i}=this.operation;switch(n){case"reg<-reg":return[r,i];case"reg<-mem":{const s=i.mode==="direct"?i.address.toString():"BX";return[r,`[${s}]`]}case"reg<-imd":return[r,`${i.toString("hex")}h`];case"mem<-reg":return[`[${r.mode==="direct"?r.address.toString():"BX"}]`,i];case"mem<-imd":return[`[${r.mode==="direct"?r.address.toString():"BX"}]`,`${i.toString("hex")}h`];default:return n}};var Nm,dN;class i7 extends Ls{constructor(){super(...arguments);Ee(this,Nm)}get operation(){return this.statement.operation}*execute(n){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:it(this,Nm,dN).call(this),willUse:{ri:this.operation.mode==="mem-direct"||this.operation.mode==="mem-indirect"}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},this.operation.mode==="reg")this.operation.size===8?yield*n.cpu.copyByteRegister(this.operation.reg,"left.l"):yield*n.cpu.copyWordRegister(this.operation.reg,"left");else{if(this.operation.mode==="mem-direct"?(yield*this.consumeInstruction(n,"ri.l"),yield*this.consumeInstruction(n,"ri.h")):yield*n.cpu.copyWordRegister("BX","ri"),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(yield*n.cpu.getMBR("left.l"),this.operation.size===16){if(yield*n.cpu.updateWordRegister("ri",o=>o.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("left.h")}}yield{type:"cpu:cycle.update",phase:"execute"};const r=this.operation.size===8?n.cpu.getRegister("left.l"):n.cpu.getRegister("left");let i;const s={};switch(this.name){case"NOT":{i=B.fromSigned(~r.signed,this.operation.size),s.CF=!1,s.OF=!1;break}case"NEG":{i=B.fromSigned(-r.signed,this.operation.size),s.CF=!r.isZero(),s.OF=r.signed===B.minSignedValue(this.operation.size);break}case"INC":{yield*n.cpu.updateWordRegister("right",B.fromSigned(1,16));const o=r.unsigned+1;o>B.maxValue(this.operation.size)?(s.CF=!0,i=B.fromUnsigned(o-B.maxValue(this.operation.size)-1,this.operation.size)):(s.CF=!1,i=B.fromUnsigned(o,this.operation.size)),s.OF=r.signed>=0&&i.signed<0;break}case"DEC":{yield*n.cpu.updateWordRegister("right",B.fromSigned(1,16));const o=r.unsigned-1;o<0?(s.CF=!0,i=B.fromUnsigned(o+B.maxValue(this.operation.size)+1,this.operation.size)):(s.CF=!1,i=B.fromUnsigned(o,this.operation.size)),s.OF=r.signed<0&&i.signed>=0;break}}if(s.ZF=i.isZero(),s.SF=i.signed<0,yield*n.cpu.aluExecute(this.name==="INC"?"ADD":this.name==="DEC"?"SUB":this.name,i,s),yield{type:"cpu:cycle.update",phase:"writeback"},this.operation.mode==="reg")this.operation.size===8?yield*n.cpu.copyByteRegister("result.l",this.operation.reg):yield*n.cpu.copyWordRegister("result",this.operation.reg);else{if(this.operation.size===16){if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.h"),!(yield*n.cpu.useBus("mem-write")))return!1;yield*n.cpu.updateWordRegister("ri",o=>o.add(-1))}if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("result.l"),!(yield*n.cpu.useBus("mem-write")))return!1}return!0}}Nm=new WeakSet,dN=function(){switch(this.operation.mode){case"reg":return[this.operation.reg];case"mem-direct":return[`[${this.operation.address.toString()}]`];case"mem-indirect":return["[BX]"];default:return this.operation}};class s7 extends Ls{get number(){return this.statement.value}*execute(e){return yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[this.number.toString("uint")],willUse:{id:!0}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},yield*super.consumeInstruction(e,"ri.l"),yield{type:"cpu:cycle.update",phase:"execute"},yield*e.cpu.startInterrupt(this.number)}}var Om,hN;class o7 extends Ls{constructor(){super(...arguments);Ee(this,Om)}get operation(){return this.statement.operation}*execute(n){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:it(this,Om,hN).call(this),willUse:{ri:!0}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},this.operation.port==="fixed")yield*n.cpu.updateWordRegister("ri",B.zero(16)),yield*super.consumeInstruction(n,"ri.l");else if(yield*n.cpu.copyWordRegister("DX","ri"),!n.cpu.getRegister("DX").high.isZero())return yield{type:"cpu:error",error:new Qe("io-memory-not-connected",n.cpu.getRegister("DX"))},!1;if(yield{type:"cpu:cycle.update",phase:"writeback"},this.name==="IN"){if(yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("io-read")))return!1;if(yield*n.cpu.getMBR("AL"),this.operation.size===16){if(yield*n.cpu.updateWordRegister("ri",r=>r.add(1)),yield*n.cpu.setMAR("ri"),!n.cpu.getRegister("ri.h").isZero())return yield{type:"cpu:error",error:new Qe("io-memory-not-connected",n.cpu.getRegister("ri"))},!1;if(!(yield*n.cpu.useBus("io-read")))return!1;yield*n.cpu.getMBR("AH")}}else{if(yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("AL"),!(yield*n.cpu.useBus("io-write")))return!1;if(this.operation.size===16){if(yield*n.cpu.updateWordRegister("ri",r=>r.add(1)),yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("AH"),!n.cpu.getRegister("ri.h").isZero())return yield{type:"cpu:error",error:new Qe("io-memory-not-connected",n.cpu.getRegister("ri"))},!1;if(!(yield*n.cpu.useBus("io-write")))return!1}}return!0}}Om=new WeakSet,hN=function(){const n=[];return this.operation.port==="variable"?n.push("DX"):n.push(this.operation.address.toString()),this.operation.size===8?n.push("AL"):n.push("AX"),this.name==="IN"?n.reverse():n};class a7 extends Ls{get jumpTo(){return this.statement.address}*execute(e){yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[this.jumpTo.toString()],willUse:{id:this.name==="CALL",ri:!0}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},yield*super.consumeInstruction(e,"ri.l"),yield*super.consumeInstruction(e,"ri.h"),yield{type:"cpu:cycle.update",phase:"execute"};let n;switch(this.name){case"JC":n=e.cpu.getFlag("CF");break;case"JNC":n=!e.cpu.getFlag("CF");break;case"JZ":n=e.cpu.getFlag("ZF");break;case"JNZ":n=!e.cpu.getFlag("ZF");break;case"JS":n=e.cpu.getFlag("SF");break;case"JNS":n=!e.cpu.getFlag("SF");break;case"JO":n=e.cpu.getFlag("OF");break;case"JNO":n=!e.cpu.getFlag("OF");break;case"CALL":case"JMP":n=!0;break;default:return this.name}if(n){if(this.name==="CALL"&&(yield*e.cpu.copyWordRegister("IP","id"),!(yield*e.cpu.pushToStack())))return!1;yield*e.cpu.copyWordRegister("ri","IP")}return!0}}class l7 extends Ls{*execute(e){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[],willUse:{}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},this.name==="CLI")yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},yield*e.cpu.updateFLAGS({IF:!1});else if(this.name==="STI")yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},yield*e.cpu.updateFLAGS({IF:!0});else if(this.name==="HLT")return yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},yield{type:"cpu:halt"},!1;return!0}}function oa(t){switch(t){case"AL":return["AX","low"];case"AH":return["AX","high"];case"BL":return["BX","low"];case"BH":return["BX","high"];case"CL":return["CX","low"];case"CH":return["CX","high"];case"DL":return["DX","low"];case"DH":return["DX","high"];default:{const[e,n]=t.split(".");return[e,n==="l"?"low":n==="h"?"high":null]}}}function u7(t){switch(t){case"AX":return["AL","AH"];case"BX":return["BL","BH"];case"CX":return["CL","CH"];case"DX":return["DL","DH"];case"SP":return["SP.l","SP.h"];case"IP":return["IP.l","IP.h"];case"ri":return["ri.l","ri.h"];case"id":return["id.l","id.h"];case"left":return["left.l","left.h"];case"right":return["right.l","right.h"];case"result":return["result.l","result.h"];case"FLAGS":return["FLAGS.l","FLAGS.h"];default:return[t,null]}}var _m,fN;class c7 extends Ls{constructor(){super(...arguments);Ee(this,_m)}get operation(){return this.statement.operation}*execute(n){const{mode:r,size:i,out:s,src:o}=this.operation;switch(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:it(this,_m,fN).call(this),willUse:{ri:r==="reg<-mem"||r==="mem<-reg"||r==="mem<-imd",id:r==="reg<-mem"||r==="reg<-imd"||r==="mem<-imd"}}},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield*super.consumeInstruction(n,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"fetch-operands"},(this.operation.mode==="reg<-mem"||this.operation.mode==="mem<-reg"||this.operation.mode==="mem<-imd")&&((this.operation.mode==="reg<-mem"?this.operation.src.mode:this.operation.out.mode)==="direct"?(yield*super.consumeInstruction(n,"ri.l"),yield*super.consumeInstruction(n,"ri.h")):yield*n.cpu.copyWordRegister("BX","ri")),(this.operation.mode==="reg<-imd"||this.operation.mode==="mem<-imd")&&(yield*super.consumeInstruction(n,"id.l"),this.operation.size===16&&(yield*super.consumeInstruction(n,"id.h"))),yield{type:"cpu:cycle.update",phase:"writeback"},r){case"reg<-reg":return i===8?yield*n.cpu.copyByteRegister(o,s):yield*n.cpu.copyWordRegister(o,s),!0;case"reg<-mem":{if(yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;if(yield*n.cpu.getMBR("id.l"),i===16){if(yield*n.cpu.updateWordRegister("ri",a=>a.add(1)),yield*n.cpu.setMAR("ri"),!(yield*n.cpu.useBus("mem-read")))return!1;yield*n.cpu.getMBR("id.h"),yield*n.cpu.copyWordRegister("id",s)}else yield*n.cpu.copyByteRegister("id.l",s);return!0}case"reg<-imd":return i===8?yield*n.cpu.copyByteRegister("id.l",s):yield*n.cpu.copyWordRegister("id",s),!0;case"mem<-reg":{const[a,l]=u7(o);return yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR(a),!(!(yield*n.cpu.useBus("mem-write"))||l&&(yield*n.cpu.updateWordRegister("ri",u=>u.add(1)),yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR(l),!(yield*n.cpu.useBus("mem-write"))))}case"mem<-imd":return yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("id.l"),!(!(yield*n.cpu.useBus("mem-write"))||i===16&&(yield*n.cpu.updateWordRegister("ri",a=>a.add(1)),yield*n.cpu.setMAR("ri"),yield*n.cpu.setMBR("id.h"),!(yield*n.cpu.useBus("mem-write"))));default:return r}}}_m=new WeakSet,fN=function(){const{mode:n,out:r,src:i}=this.operation;switch(n){case"reg<-reg":return[r,i];case"reg<-mem":{const s=i.mode==="direct"?i.address.toString():"BX";return[r,`[${s}]`]}case"reg<-imd":return[r,`${i.toString("hex")}h`];case"mem<-reg":return[`[${r.mode==="direct"?r.address.toString():"BX"}]`,i];case"mem<-imd":return[`[${r.mode==="direct"?r.address.toString():"BX"}]`,`${i.toString("hex")}h`];default:return n}};class d7 extends Ls{*execute(e){if(yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:[],willUse:{id:!0}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},!(yield*e.cpu.popFromStack()))return!1;if(yield*e.cpu.copyWordRegister("id","IP"),this.name==="IRET"){if(!(yield*e.cpu.popFromStack()))return!1;yield*e.cpu.copyWordRegister("id","FLAGS")}return!0}}class h7 extends Ls{*execute(e){const n=this.statement.instruction==="PUSH"||this.statement.instruction==="POP"?this.statement.register:"FLAGS";return yield{type:"cpu:cycle.start",instruction:{name:this.name,position:this.position,operands:n!=="FLAGS"?[n]:[],willUse:{id:!0}}},yield*super.consumeInstruction(e,"IR"),yield{type:"cpu:decode"},yield{type:"cpu:cycle.update",phase:"decoded",next:"execute"},this.name==="PUSH"||this.name==="PUSHF"?(yield*e.cpu.copyWordRegister(n,"id"),yield*e.cpu.pushToStack()):(yield*e.cpu.popFromStack())?(yield*e.cpu.copyWordRegister("id",n),!0):!1}}function f7(t){switch(t.instruction){case"MOV":return new c7(t);case"AND":case"OR":case"XOR":case"ADD":case"ADC":case"SUB":case"SBB":case"CMP":return new r7(t);case"NOT":case"NEG":case"INC":case"DEC":return new i7(t);case"IN":case"OUT":return new o7(t);case"PUSH":case"POP":case"PUSHF":case"POPF":return new h7(t);case"JC":case"JNC":case"JZ":case"JNZ":case"JS":case"JNS":case"JO":case"JNO":case"JMP":case"CALL":return new a7(t);case"RET":case"IRET":return new d7(t);case"INT":return new s7(t);case"CLI":case"STI":case"NOP":case"HLT":return new l7(t)}}const kl={0:32768,3:32771,6:32774,7:32775};function p7(t){return Object.values(kl).includes(t.unsigned)}function*m7(t,e){switch(e.unsigned){case kl[0]:return yield{type:"cpu:int.0"},!1;case kl[3]:return yield{type:"cpu:int.3"},!0;case kl[6]:{if(yield{type:"cpu:int.6"},!("keyboard"in t.io))return yield{type:"cpu:error",error:new Qe("device-not-connected","keyboard")},!1;yield*t.cpu.copyWordRegister("BX","ri");const n=yield*t.io.keyboard.readChar();if(yield*t.cpu.updateWordRegister("id",n.withHigh(B.zero(8))),yield*t.cpu.setMAR("ri"),yield*t.cpu.setMBR("id.l"),!(yield*t.cpu.useBus("mem-write")))return!1;break}case kl[7]:{if(yield{type:"cpu:int.7"},!("screen"in t.io))return yield{type:"cpu:error",error:new Qe("device-not-connected","screen")},!1;if(yield*t.cpu.copyWordRegister("AX","id"),!(yield*t.cpu.pushToStack())||(yield*t.cpu.copyWordRegister("BX","id"),!(yield*t.cpu.pushToStack())))return!1;yield*t.cpu.copyByteRegister("AL","left.l"),yield*t.cpu.updateByteRegister("right.l",B.zero(8));const n=t.cpu.getRegister("AL");for(yield*t.cpu.aluExecute("SUB",n,{CF:!1,OF:!1,SF:n.signed<0,ZF:n.isZero()});!t.cpu.getRegister("AL").isZero();){if(yield*t.cpu.copyWordRegister("BX","ri"),yield*t.cpu.setMAR("ri"),!(yield*t.cpu.useBus("mem-read")))return!1;yield*t.cpu.getMBR("id.l");const r=t.cpu.getRegister("id.l");yield*t.io.screen.sendChar(r),yield*t.cpu.copyWordRegister("BX","left"),yield*t.cpu.updateWordRegister("right",B.fromUnsigned(1,16));const i=t.cpu.getRegister("BX").add(1);yield*t.cpu.aluExecute("ADD",i,{CF:!1,OF:i.signed<0,SF:i.signed<0,ZF:!1}),yield*t.cpu.copyWordRegister("result","BX"),yield*t.cpu.copyByteRegister("AL","left.l"),yield*t.cpu.updateByteRegister("right.l",B.fromUnsigned(1,8));const s=t.cpu.getRegister("AL").add(-1);yield*t.cpu.aluExecute("SUB",s,{CF:!1,OF:s.signed===B.maxSignedValue(8),SF:s.signed<0,ZF:s.isZero()}),yield*t.cpu.copyByteRegister("result.l","AL")}if(!(yield*t.cpu.popFromStack())||(yield*t.cpu.copyWordRegister("id","BX"),!(yield*t.cpu.popFromStack())))return!1;yield*t.cpu.copyWordRegister("id","AX");break}default:throw new Error("Invalid interrupt number")}return!(yield*t.cpu.popFromStack())||(yield*t.cpu.copyWordRegister("id","IP"),!(yield*t.cpu.popFromStack()))?!1:(yield*t.cpu.copyWordRegister("id","FLAGS"),!0)}var Xl,Ie,or,En,so,ll,Hn,Ar,rA;let g7=(rA=class extends nr{constructor(n){super(n);Ee(this,so);Ee(this,Hn);Ee(this,Xl,void 0);Ee(this,Ie,void 0);Ee(this,or,void 0);Ee(this,En,void 0);n.data==="unchanged"?(J(this,Ie,P(n.previous.cpu,Ie)),J(this,or,P(n.previous.cpu,or)),J(this,En,P(n.previous.cpu,En))):n.data==="randomize"?(J(this,Ie,{AX:B.random(16),BX:B.random(16),CX:B.random(16),DX:B.random(16),SP:B.random(16),IP:B.random(16),IR:B.random(8),ri:B.random(16),id:B.random(16),left:B.random(16),right:B.random(16),result:B.random(16),FLAGS:B.random(16)}),J(this,or,B.random(16)),J(this,En,B.random(8))):(J(this,Ie,{AX:B.zero(16),BX:B.zero(16),CX:B.zero(16),DX:B.zero(16),SP:B.zero(16),IP:B.zero(16),IR:B.zero(8),ri:B.zero(16),id:B.zero(16),left:B.zero(16),right:B.zero(16),result:B.zero(16),FLAGS:B.zero(16)}),J(this,or,B.zero(16)),J(this,En,B.zero(8))),P(this,Ie).SP=B.fromUnsigned(be.MAX_ADDRESS+1,16),P(this,Ie).IP=B.fromUnsigned(8192,16),it(this,Hn,Ar).call(this,"IF",!0),J(this,Xl,new Map);for(const r of n.program.instructions){const i=f7(r);P(this,Xl).set(i.start.value,i)}}*run(){for(;;){const n=P(this,Ie).IP;if(p7(n)){if(!(yield*m7(this.computer,n)))return}else{const r=P(this,Xl).get(n.unsigned);if(!r){yield{type:"cpu:error",error:new Qe("no-instruction",P(this,Ie).IP)};return}if(!(yield*r.execute(this.computer)))return}if(this.getFlag("IF")&&"pic"in this.computer.io&&this.computer.io.pic.isINTRActive()){yield{type:"cpu:cycle.interrupt"};const r=yield*this.computer.io.pic.handleINTR();yield*this.getMBR("ri.l"),yield*this.updateByteRegister("ri.h",B.zero(8)),yield*this.startInterrupt(r)}yield{type:"cpu:cycle.end"}}}*startInterrupt(n){if(yield*this.copyWordRegister("FLAGS","id"),!(yield*this.pushToStack())||(yield*this.updateFLAGS({IF:!1}),yield*this.copyWordRegister("IP","id"),!(yield*this.pushToStack())))return!1;let r=B.fromUnsigned(n.unsigned*4,16);return yield*this.updateWordRegister("ri",r),yield*this.setMAR("ri"),!(yield*this.useBus("mem-read"))||(yield*this.getMBR("id.l"),r=r.add(1),yield*this.updateWordRegister("ri",r),yield*this.setMAR("ri"),!(yield*this.useBus("mem-read")))?!1:(yield*this.getMBR("id.h"),yield*this.copyWordRegister("id","IP"),!0)}toJSON(){return{...Object.entries(P(this,Ie)).reduce((r,[i,s])=>({...r,[i]:s.toJSON()}),{}),MAR:P(this,or).toJSON(),MBR:P(this,En).toJSON()}}getRegister(n){const[r,i]=oa(n);return i==="low"?P(this,Ie)[r].low:i==="high"?P(this,Ie)[r].high:P(this,Ie)[r]}*copyByteRegister(n,r){const i=this.getRegister(n);it(this,so,ll).call(this,r,i),yield{type:"cpu:register.copy",size:8,src:n,dest:r}}*copyWordRegister(n,r){const i=this.getRegister(n);it(this,so,ll).call(this,r,i),yield{type:"cpu:register.copy",size:16,src:n,dest:r}}*updateByteRegister(n,r){r=typeof r=="function"?r(this.getRegister(n)):r,it(this,so,ll).call(this,n,r),yield{type:"cpu:register.update",size:8,register:n,value:r}}*updateWordRegister(n,r){r=typeof r=="function"?r(this.getRegister(n)):r,it(this,so,ll).call(this,n,r),yield{type:"cpu:register.update",size:16,register:n,value:r}}getFlag(n){switch(n){case"CF":return P(this,Ie).FLAGS.bit(0);case"ZF":return P(this,Ie).FLAGS.bit(6);case"SF":return P(this,Ie).FLAGS.bit(7);case"IF":return P(this,Ie).FLAGS.bit(9);case"OF":return P(this,Ie).FLAGS.bit(11);default:throw new TypeError(`Invalid flag ${n}`)}}*updateFLAGS(n){typeof n.CF=="boolean"&&it(this,Hn,Ar).call(this,"CF",n.CF),typeof n.ZF=="boolean"&&it(this,Hn,Ar).call(this,"ZF",n.ZF),typeof n.SF=="boolean"&&it(this,Hn,Ar).call(this,"SF",n.SF),typeof n.IF=="boolean"&&it(this,Hn,Ar).call(this,"IF",n.IF),typeof n.OF=="boolean"&&it(this,Hn,Ar).call(this,"OF",n.OF),yield{type:"cpu:register.update",size:16,register:"FLAGS",value:P(this,Ie).FLAGS}}*aluExecute(n,r,i){P(this,Ie).result=r.is8bits()?P(this,Ie).result.withLow(r):r,typeof i.CF=="boolean"&&it(this,Hn,Ar).call(this,"CF",i.CF),typeof i.ZF=="boolean"&&it(this,Hn,Ar).call(this,"ZF",i.ZF),typeof i.SF=="boolean"&&it(this,Hn,Ar).call(this,"SF",i.SF),typeof i.IF=="boolean"&&it(this,Hn,Ar).call(this,"IF",i.IF),typeof i.OF=="boolean"&&it(this,Hn,Ar).call(this,"OF",i.OF),yield{type:"cpu:alu.execute",operation:n,size:r.size,result:P(this,Ie).result,flags:P(this,Ie).FLAGS}}*setMAR(n){const r=this.getRegister(n);J(this,or,r),yield{type:"cpu:mar.set",register:n}}*getMBR(n){it(this,so,ll).call(this,n,P(this,En)),yield{type:"cpu:mbr.get",register:n}}*setMBR(n){const r=this.getRegister(n);J(this,En,r),yield{type:"cpu:mbr.set",register:n}}*useBus(n){switch(n){case"mem-read":{yield{type:"cpu:rd.on"};const r=yield*this.computer.memory.read(P(this,or));return r?(J(this,En,r),yield{type:"bus:reset"},!0):!1}case"mem-write":return yield{type:"cpu:wr.on"},(yield*this.computer.memory.write(P(this,or),P(this,En)))?(yield{type:"bus:reset"},!0):!1;case"io-read":{yield{type:"cpu:iom.on"};const r=yield*this.computer.io.chipSelect(P(this,or).low);if(!r)return!1;yield{type:"cpu:rd.on"};const i=yield*this.computer.io.read(r);return i?(J(this,En,i),yield{type:"bus:reset"},!0):!1}case"io-write":{yield{type:"cpu:iom.on"};const r=yield*this.computer.io.chipSelect(P(this,or).low);return!r||(yield{type:"cpu:wr.on"},!(yield*this.computer.io.write(r,P(this,En))))?!1:(yield{type:"bus:reset"},!0)}case"intr-read":{if(!("pic"in this.computer.io))return!1;const r=yield*this.computer.io.pic.handleINTR();return J(this,En,r),yield{type:"bus:reset"},!0}default:return n}}*pushToStack(){let n=this.getRegister("SP");return be.inRange(n.unsigned-1)?(n=n.add(-1),yield*this.updateWordRegister("SP",n),yield*this.setMAR("SP"),yield*this.setMBR("id.h"),(yield*this.useBus("mem-write"))?be.inRange(n.unsigned-1)?(n=n.add(-1),yield*this.updateWordRegister("SP",n),yield*this.setMAR("SP"),yield*this.setMBR("id.l"),!!(yield*this.useBus("mem-write"))):(yield{type:"cpu:error",error:new Qe("stack-overflow")},!1):!1):(yield{type:"cpu:error",error:new Qe("stack-overflow")},!1)}*popFromStack(){let n=this.getRegister("SP");return be.inRange(n)?(yield*this.setMAR("SP"),(yield*this.useBus("mem-read"))?(yield*this.getMBR("id.l"),n=n.add(1),yield*this.updateWordRegister("SP",n),be.inRange(n)?(yield*this.setMAR("SP"),(yield*this.useBus("mem-read"))?(yield*this.getMBR("id.h"),n=n.add(1),yield*this.updateWordRegister("SP",n),!0):!1):(yield{type:"cpu:error",error:new Qe("stack-underflow")},!0)):!1):(yield{type:"cpu:error",error:new Qe("stack-underflow")},!1)}},Xl=new WeakMap,Ie=new WeakMap,or=new WeakMap,En=new WeakMap,so=new WeakSet,ll=function(n,r){const[i,s]=oa(n);if(s===null){if(P(this,Ie)[i].size!==r.size)throw new TypeError(`Cannot set register ${n} with value ${r} of different size`);P(this,Ie)[i]=r}else{if(!r.is8bits())throw new TypeError(`Cannot set register ${n} with value ${r} of different size`);s==="low"?P(this,Ie)[i]=P(this,Ie)[i].withLow(r):P(this,Ie)[i]=P(this,Ie)[i].withHigh(r)}},Hn=new WeakSet,Ar=function(n,r){switch(n){case"CF":P(this,Ie).FLAGS=P(this,Ie).FLAGS.withBit(0,r);return;case"ZF":P(this,Ie).FLAGS=P(this,Ie).FLAGS.withBit(6,r);return;case"SF":P(this,Ie).FLAGS=P(this,Ie).FLAGS.withBit(7,r);return;case"IF":P(this,Ie).FLAGS=P(this,Ie).FLAGS.withBit(9,r);return;case"OF":P(this,Ie).FLAGS=P(this,Ie).FLAGS.withBit(11,r);return;default:throw new TypeError(`Invalid flag ${n}`)}},rA),T1=class extends nr{*tick(){yield{type:"clock:tick"},yield*this.computer.io.timer.tick()}toJSON(){return null}},$1=class extends nr{*press(){yield{type:"f10:press"},yield*this.computer.io.pic.interrupt(0)}toJSON(){return null}};var Zl,iA;let N1=(iA=class extends nr{constructor(){super(...arguments);Ee(this,Zl,null)}*readChar(){yield{type:"keyboard:listen-key"};const n=P(this,Zl);if(!n)throw new Error("INT 6 was not given a valid 8-bit character!");return yield{type:"keyboard:read",char:n},J(this,Zl,null),n}setLastCharRead(n){J(this,Zl,n)}toJSON(){return null}},Zl=new WeakMap,iA);var ar,sA;let O1=(sA=class extends nr{constructor(n){super(n);Ee(this,ar,void 0);n.data==="unchanged"&&"screen"in n.previous.io?J(this,ar,P(n.previous.io.screen,ar)):J(this,ar,"")}clear(){return this.sendChar(B.fromUnsigned(12,8))}*sendChar(n){switch(n.unsigned){case 8:J(this,ar,P(this,ar).slice(0,-1));break;case 10:J(this,ar,P(this,ar)+`
`);break;case 12:J(this,ar,"");break;default:J(this,ar,P(this,ar)+a1(n.unsigned));break}yield{type:"screen:send-char",char:n,output:P(this,ar)}}toJSON(){return P(this,ar)}},ar=new WeakMap,sA);class ug extends nr{}var zi,cs,Wn,An,ei,Jl,Bf,Yl,jf;let _1=(zi=class extends ug{constructor(n){super(n);Ee(this,Jl);Ee(this,Yl);Ee(this,cs,void 0);Ee(this,Wn,void 0);Ee(this,An,void 0);Ee(this,ei,void 0);J(this,cs,B.fromUnsigned(255,8)),J(this,Wn,B.fromUnsigned(0,8)),J(this,An,B.fromUnsigned(0,8)),n.data==="unchanged"&&"pic"in n.previous.io?J(this,ei,P(n.previous.io.pic,ei)):n.data==="randomize"?J(this,ei,new Array(zi.LINES).fill(B.zero(8)).map(()=>B.random(8))):J(this,ei,new Array(zi.LINES).fill(B.zero(8)))}chipSelect(n){const i=4+zi.LINES;return n=Number(n)-32,n<0||n>=i?null:n===0?"EOI":n===1?"IMR":n===2?"IRR":n===3?"ISR":`INT${n-4}`}*read(n){yield{type:"pic:read",register:n};let r;if(n==="EOI")r=B.zero(8);else if(n==="IMR")r=P(this,cs);else if(n==="IRR")r=P(this,Wn);else if(n==="ISR")r=P(this,An);else{const i=Number(n.slice(3));r=P(this,ei)[i]}return yield{type:"pic:read.ok",value:r},r}*write(n,r){if(yield{type:"pic:write",register:n,value:r},n==="EOI")P(this,An).isZero()||(yield{type:"pic:intr.off"},J(this,An,B.zero(8)),yield{type:"pic:register.update",register:"ISR",value:P(this,An)},yield*it(this,Yl,jf).call(this));else if(n==="IMR")J(this,cs,r),yield{type:"pic:register.update",register:"IMR",value:P(this,cs)},yield*it(this,Yl,jf).call(this);else if(!(n==="IRR"||n==="ISR")){const i=Number(n.slice(3));P(this,ei)[i]=r,yield{type:"pic:register.update",register:n,value:r}}yield{type:"pic:write.ok"}}*interrupt(n){if(n<0||n>=zi.LINES)throw new RangeError(`Invalid interrupt line ${n}`);P(this,Wn).bit(n)||(J(this,Wn,P(this,Wn).withBit(n,!0)),yield{type:"pic:register.update",register:"IRR",value:P(this,Wn)},yield*it(this,Yl,jf).call(this))}isINTRActive(){return P(this,An).isZero()&&it(this,Jl,Bf).call(this)!==null}*handleINTR(){if(yield{type:"cpu:inta.on"},!P(this,An).isZero())throw new Error("INTR line is active but ISR is not zero");const n=it(this,Jl,Bf).call(this);if(n===null)throw new Error("INTR line is active but no interrupt is pending");J(this,An,P(this,An).withBit(n,!0)),yield{type:"pic:register.update",register:"ISR",value:P(this,An)},J(this,Wn,P(this,Wn).withBit(n,!1)),yield{type:"pic:register.update",register:"IRR",value:P(this,Wn)},yield{type:"cpu:inta.off"},yield{type:"cpu:inta.on"};const r=P(this,ei)[n];return yield{type:"pic:int.send",number:r},yield{type:"cpu:inta.off"},yield{type:"pic:intr.off"},r}toJSON(){return{IMR:P(this,cs).toJSON(),IRR:P(this,Wn).toJSON(),ISR:P(this,An).toJSON(),lines:P(this,ei).map(n=>n.toJSON())}}},cs=new WeakMap,Wn=new WeakMap,An=new WeakMap,ei=new WeakMap,Jl=new WeakSet,Bf=function(){for(let n=0;n<zi.LINES;n++)if(P(this,Wn).bit(n)&&!P(this,cs).bit(n))return n;return null},Yl=new WeakSet,jf=function*(){P(this,An).isZero()&&it(this,Jl,Bf).call(this)!==null&&(yield{type:"pic:intr.on"})},se(zi,"LINES",8),zi);var Ri,oo,oA;let R1=(oA=class extends ug{constructor(n){super(n);Ee(this,Ri,void 0);Ee(this,oo,void 0);J(this,Ri,B.zero(8)),J(this,oo,B.zero(8))}chipSelect(n){return n=Number(n),n===16?"CONT":n===17?"COMP":null}*read(n){yield{type:"timer:read",register:n};let r;if(n==="CONT")r=P(this,Ri);else if(n==="COMP")r=P(this,oo);else return n;return yield{type:"timer:read.ok",value:r},r}*write(n,r){if(yield{type:"timer:write",register:n,value:r},n==="CONT")J(this,Ri,r);else if(n==="COMP")J(this,oo,r);else return n;yield{type:"timer:register.update",register:n,value:r},yield{type:"timer:write.ok"}}*tick(){const n=P(this,Ri).unsigned===B.maxValue(8)?B.zero(8):P(this,Ri).add(1);J(this,Ri,n),yield{type:"timer:register.update",register:"CONT",value:n},P(this,oo).equals(n)?(yield{type:"timer:int.on"},yield*this.computer.io.pic.interrupt(1)):yield{type:"timer:int.off"}}toJSON(){return{CONT:P(this,Ri).toJSON(),COMP:P(this,oo).toJSON()}}},Ri=new WeakMap,oo=new WeakMap,oA);var Mi,Pn,aA;let y7=(aA=class extends ug{constructor(n){super(n);Ee(this,Mi,void 0);Ee(this,Pn,void 0);n.data==="unchanged"&&"handshake"in n.previous.io?J(this,Mi,B.zero(8)):n.data==="randomize"?J(this,Mi,B.random(8)):J(this,Mi,B.zero(8)),J(this,Pn,B.zero(8))}get interrupts(){return P(this,Pn).bit(7)}get DATA(){return P(this,Mi)}chipSelect(n){return n=Number(n),n===64?"DATA":n===65?"STATE":null}*read(n){yield{type:"handshake:read",register:n};let r;if(n==="DATA")r=P(this,Mi);else if(n==="STATE")r=P(this,Pn);else return n;return yield{type:"handshake:read.ok",value:r},r}*write(n,r){if(yield{type:"handshake:write",register:n,value:r},n==="DATA")J(this,Mi,r),yield{type:"handshake:register.update",register:n,value:r},yield*this.computer.io.printer.setStrobe(!0),yield*this.computer.io.printer.setStrobe(!1);else if(n==="STATE")r=r.withBit(0,this.computer.io.printer.busy),J(this,Pn,r),yield{type:"handshake:register.update",register:n,value:r},P(this,Pn).bit(1)?(yield*this.computer.io.printer.setStrobe(!0),yield*this.computer.io.printer.setStrobe(!1),J(this,Pn,P(this,Pn).withBit(1,!1)),yield{type:"handshake:register.update",register:n,value:P(this,Pn)}):this.interrupts&&!this.computer.io.printer.busy?(yield{type:"handshake:int.on"},yield*this.computer.io.pic.interrupt(2)):yield{type:"handshake:int.off"};else return n;yield{type:"handshake:write.ok"}}*updateBusy(n){J(this,Pn,P(this,Pn).withBit(0,n)),yield{type:"handshake:register.update",register:"STATE",value:P(this,Pn)},this.interrupts&&!n?(yield{type:"handshake:int.on"},yield*this.computer.io.pic.interrupt(2)):yield{type:"handshake:int.off"}}toJSON(){return{DATA:P(this,Mi).toJSON(),STATE:P(this,Pn).toJSON()}}},Mi=new WeakMap,Pn=new WeakMap,aA);var Tr,ds,ao;const Bc=class Bc extends nr{constructor(n){super(n);Ee(this,Tr,void 0);Ee(this,ds,void 0);Ee(this,ao,!1);this.computer=n.computer,n.data==="unchanged"&&"printer"in n.previous.io?(J(this,Tr,P(n.previous.io.printer,Tr)),J(this,ds,P(n.previous.io.printer,ds)),J(this,ao,P(n.previous.io.printer,ao))):(J(this,Tr,[]),J(this,ds,""),J(this,ao,!1))}get busy(){return P(this,Tr).length>=Bc.BUFFER_SIZE}*setStrobe(n){const r=P(this,ao);if(r===n)return;if(J(this,ao,n),n?yield{type:"printer:strobe.on"}:yield{type:"printer:strobe.off"},n&&!r&&!this.busy){const s=yield*this.readData();P(this,Tr).push(s),yield{type:"printer:buffer.add",char:s},yield*this.updateBusy(!0),this.busy||(yield*this.updateBusy(!1))}}*clear(){J(this,ds,""),yield{type:"printer:paper.replace"}}*print(){if(P(this,Tr).length===0)return;const[n,...r]=P(this,Tr);if(J(this,Tr,r),yield{type:"printer:buffer.pop",char:n},r.length===Bc.BUFFER_SIZE-1&&(yield*this.updateBusy(!1)),n.unsigned===12)yield*this.clear();else{const i=a1(n.unsigned);J(this,ds,P(this,ds)+i),yield{type:"printer:paper.print",char:i}}}toJSON(){return{paper:P(this,ds),buffer:[...P(this,Tr).map(n=>n.unsigned)]}}};Tr=new WeakMap,ds=new WeakMap,ao=new WeakMap,se(Bc,"BUFFER_SIZE",5);let Kp=Bc,v7=class extends Kp{*readData(){const e=this.computer.io.handshake.DATA;return yield{type:"printer:data.read",char:e},e}*updateBusy(e){e?yield{type:"printer:busy.on"}:yield{type:"printer:busy.off"},yield*this.computer.io.handshake.updateBusy(e)}},w7=class extends nr{constructor(n){super(n);se(this,"clock");se(this,"f10");se(this,"keyboard");se(this,"printer");se(this,"screen");se(this,"handshake");se(this,"pic");se(this,"timer");this.clock=new T1(n),this.f10=new $1(n),this.keyboard=new N1(n),this.printer=new v7(n),this.screen=new O1(n),this.handshake=new y7(n),this.pic=new _1(n),this.timer=new R1(n)}*chipSelect(n){const r=this.handshake.chipSelect(n);if(r)return yield{type:"bus:io.selected",chip:"handshake"},{chip:"handshake",register:r};const i=this.pic.chipSelect(n);if(i)return yield{type:"bus:io.selected",chip:"pic"},{chip:"pic",register:i};const s=this.timer.chipSelect(n);return s?(yield{type:"bus:io.selected",chip:"timer"},{chip:"timer",register:s}):(yield{type:"bus:io.error",error:new Qe("io-memory-not-connected",n)},null)}*read(n){const{chip:r,register:i}=n;return r==="handshake"?yield*this.handshake.read(i):r==="pic"?yield*this.pic.read(i):r==="timer"?yield*this.timer.read(i):(yield{type:"bus:io.error",error:new Qe("device-not-connected",r)},null)}*write(n,r){const{chip:i,register:s}=n;return i==="handshake"?(yield*this.handshake.write(s,r),!0):i==="pic"?(yield*this.pic.write(s,r),!0):i==="timer"?(yield*this.timer.write(s,r),!0):(yield{type:"bus:io.error",error:new Qe("device-not-connected",i)},!1)}toJSON(){return{clock:this.clock.toJSON(),f10:this.f10.toJSON(),keyboard:this.keyboard.toJSON(),printer:this.printer.toJSON(),screen:this.screen.toJSON(),handshake:this.handshake.toJSON(),pic:this.pic.toJSON(),timer:this.timer.toJSON()}}};class b7 extends nr{*chipSelect(e){return yield{type:"bus:io.error",error:new Qe("io-memory-not-connected",e)},null}*read(e){return yield{type:"bus:io.error",error:new Qe("device-not-connected",e.chip)},null}*write(e){return yield{type:"bus:io.error",error:new Qe("device-not-connected",e.chip)},!1}toJSON(){return{}}}class pN extends ug{constructor(n){super(n);se(this,"PA");se(this,"PB");se(this,"CA");se(this,"CB");n.data==="unchanged"&&"pio"in n.previous.io?(this.PA=n.previous.io.pio.PA,this.PB=n.previous.io.pio.PB,this.CA=n.previous.io.pio.CA,this.CB=n.previous.io.pio.CB):n.data==="randomize"?(this.PA=B.random(8),this.PB=B.random(8),this.CA=B.random(8),this.CB=B.random(8)):(this.PA=B.zero(8),this.PB=B.zero(8),this.CA=B.zero(8),this.CB=B.zero(8))}chipSelect(n){return n=Number(n),n===48?"PA":n===49?"PB":n===50?"CA":n===51?"CB":null}*read(n){yield{type:"pio:read",register:n};let r;if(n==="PA")r=this.PA;else if(n==="PB")r=this.PB;else if(n==="CA")r=this.CA;else if(n==="CB")r=this.CB;else return n;return yield{type:"pio:read.ok",value:r},r}*write(n,r){if(yield{type:"pio:write",register:n,value:r},n==="PA")this.PA=r;else if(n==="PB")this.PB=r;else if(n==="CA")this.CA=r;else if(n==="CB")this.CB=r;else return n;yield{type:"pio:register.update",register:n,value:r},n==="PA"||n==="CA"?yield*this.updatePort("A"):yield*this.updatePort("B"),yield{type:"pio:write.ok"}}line(n,r){return n==="A"?this.CA.bit(r)?"input":"output":this.CB.bit(r)?"input":"output"}toJSON(){return{PA:this.PA.toJSON(),PB:this.PB.toJSON(),CA:this.CA.toJSON(),CB:this.CB.toJSON()}}}let x7=class extends pN{readData(){const e=this.PB.unsigned&~this.CB.unsigned;return B.fromUnsigned(e,8)}*updatePort(e){if(e==="B")return;let n=this.PA.unsigned;const r=this.CA.unsigned,i=this.computer.io.printer.busy;n=n&~r,this.line("A",0)==="input"&&i&&(n|=1),n!==this.PA.unsigned&&(this.PA=B.fromUnsigned(n,8),yield{type:"pio:register.update",register:"PA",value:this.PA}),this.line("A",1)==="output"&&(yield*this.computer.io.printer.setStrobe(this.PA.bit(1)))}},S7=class extends Kp{*readData(){const e=this.computer.io.pio.readData();return yield{type:"printer:data.read",char:e},e}*updateBusy(e){e?yield{type:"printer:busy.on"}:yield{type:"printer:busy.off"},yield*this.computer.io.pio.updatePort("A")}};class k7 extends nr{constructor(n){super(n);se(this,"clock");se(this,"f10");se(this,"keyboard");se(this,"printer");se(this,"screen");se(this,"pic");se(this,"pio");se(this,"timer");this.clock=new T1(n),this.f10=new $1(n),this.keyboard=new N1(n),this.printer=new S7(n),this.screen=new O1(n),this.pic=new _1(n),this.pio=new x7(n),this.timer=new R1(n)}*chipSelect(n){const r=this.pic.chipSelect(n);if(r)return yield{type:"bus:io.selected",chip:"pic"},{chip:"pic",register:r};const i=this.pio.chipSelect(n);if(i)return yield{type:"bus:io.selected",chip:"pio"},{chip:"pio",register:i};const s=this.timer.chipSelect(n);return s?(yield{type:"bus:io.selected",chip:"timer"},{chip:"timer",register:s}):(yield{type:"bus:io.error",error:new Qe("io-memory-not-connected",n)},null)}*read(n){const{chip:r,register:i}=n;return r==="pic"?yield*this.pic.read(i):r==="pio"?yield*this.pio.read(i):r==="timer"?yield*this.timer.read(i):(yield{type:"bus:io.error",error:new Qe("device-not-connected",r)},null)}*write(n,r){const{chip:i,register:s}=n;return i==="pic"?(yield*this.pic.write(s,r),!0):i==="pio"?(yield*this.pio.write(s,r),!0):i==="timer"?(yield*this.timer.write(s,r),!0):(yield{type:"bus:io.error",error:new Qe("device-not-connected",i)},!1)}toJSON(){return{clock:this.clock.toJSON(),f10:this.f10.toJSON(),keyboard:this.keyboard.toJSON(),printer:this.printer.toJSON(),screen:this.screen.toJSON(),pic:this.pic.toJSON(),pio:this.pio.toJSON(),timer:this.timer.toJSON()}}}var hs,lA;let C7=(lA=class extends nr{constructor(n){super(n);Ee(this,hs,void 0);n.data==="unchanged"&&"leds"in n.previous.io?J(this,hs,P(n.previous.io.leds,hs)):n.data==="randomize"?J(this,hs,B.random(8)):J(this,hs,B.zero(8))}get state(){return P(this,hs)}*update(n){yield{type:"leds:update",state:n}}toJSON(){return P(this,hs).toJSON()}},hs=new WeakMap,lA),E7=class extends pN{*updatePort(e){if(e==="A"){const n=this.computer.io.switches.state.unsigned;let r=this.PA.unsigned;const i=this.CA.unsigned;r=n&i|r&~i,r!==this.PA.unsigned&&(this.PA=B.fromUnsigned(r,8),yield{type:"pio:register.update",register:"PA",value:this.PA})}else{let n=this.PB.unsigned;const r=this.CB.unsigned;n=n&~r,yield*this.computer.io.leds.update(B.fromUnsigned(n,8))}}};var $r,uA;let A7=(uA=class extends nr{constructor(n){super(n);Ee(this,$r,void 0);this.computer=n.computer,n.data==="unchanged"&&"switches"in n.previous.io?J(this,$r,P(n.previous.io.switches,$r)):n.data==="randomize"?J(this,$r,B.random(8)):J(this,$r,B.zero(8))}get state(){return P(this,$r)}*toggle(n){J(this,$r,P(this,$r).withBit(n,!P(this,$r).bit(n))),yield{type:"switches:toggle",index:n},yield*this.computer.io.pio.updatePort("A")}toJSON(){return P(this,$r).toJSON()}},$r=new WeakMap,uA);class P7 extends nr{constructor(n){super(n);se(this,"clock");se(this,"f10");se(this,"keyboard");se(this,"leds");se(this,"screen");se(this,"switches");se(this,"pic");se(this,"pio");se(this,"timer");this.clock=new T1(n),this.f10=new $1(n),this.keyboard=new N1(n),this.leds=new C7(n),this.screen=new O1(n),this.switches=new A7(n),this.pic=new _1(n),this.pio=new E7(n),this.timer=new R1(n)}*chipSelect(n){const r=this.pic.chipSelect(n);if(r)return yield{type:"bus:io.selected",chip:"pic"},{chip:"pic",register:r};const i=this.pio.chipSelect(n);if(i)return yield{type:"bus:io.selected",chip:"pio"},{chip:"pio",register:i};const s=this.timer.chipSelect(n);return s?(yield{type:"bus:io.selected",chip:"timer"},{chip:"timer",register:s}):(yield{type:"bus:io.error",error:new Qe("io-memory-not-connected",n)},null)}*read(n){const{chip:r,register:i}=n;return r==="pic"?yield*this.pic.read(i):r==="pio"?yield*this.pio.read(i):r==="timer"?yield*this.timer.read(i):(yield{type:"bus:io.error",error:new Qe("device-not-connected",r)},null)}*write(n,r){const{chip:i,register:s}=n;return i==="pic"?(yield*this.pic.write(s,r),!0):i==="pio"?(yield*this.pio.write(s,r),!0):i==="timer"?(yield*this.timer.write(s,r),!0):(yield{type:"bus:io.error",error:new Qe("device-not-connected",i)},!1)}toJSON(){return{clock:this.clock.toJSON(),f10:this.f10.toJSON(),keyboard:this.keyboard.toJSON(),leds:this.leds.toJSON(),screen:this.screen.toJSON(),switches:this.switches.toJSON(),pic:this.pic.toJSON(),pio:this.pio.toJSON(),timer:this.timer.toJSON()}}}var Ea,lr,ql;let T7=(Ea=class extends nr{constructor(n){super(n);Ee(this,lr,void 0);Ee(this,ql,void 0);n.data==="unchanged"?J(this,lr,P(n.previous.memory,lr)):n.data==="randomize"?J(this,lr,new Uint8Array(Ea.SIZE).map(()=>B.random(8).unsigned)):J(this,lr,new Uint8Array(Ea.SIZE));for(const[r,i]of Object.entries(kl)){const s=B.fromUnsigned(i,16);P(this,lr).set(s.toUint8Array(),Number(r)*4)}for(const r of n.program.data){let i=r.start.value;for(const s of r.getValues())s!==hc&&P(this,lr).set(s.toUint8Array(),i),i+=r.size/8}J(this,ql,new Set);for(const r of n.program.instructions){P(this,lr).set(r.toBytes(),r.start.value);for(let i=0;i<r.length;i++)P(this,ql).add(r.start.value+i)}}*read(n){if(n=Number(n),yield{type:"memory:read",address:n},!be.inRange(n))return yield{type:"memory:read.error",error:new Qe("address-out-of-range",n)},null;const r=B.fromUnsigned(P(this,lr).at(n),8);return yield{type:"memory:read.ok",address:be.from(n),value:r},r}*write(n,r){return n=Number(n),yield{type:"memory:write",address:n,value:r},be.inRange(n)?P(this,ql).has(n)?(yield{type:"memory:write.error",error:new Qe("address-has-instruction",n)},!1):(P(this,lr).set([r.unsigned],n),yield{type:"memory:write.ok",address:be.from(n),value:r},!0):(yield{type:"memory:write.error",error:new Qe("address-out-of-range",n)},!1)}toJSON(){return[...P(this,lr)]}},lr=new WeakMap,ql=new WeakMap,se(Ea,"SIZE",be.MAX_ADDRESS+1),Ea);class sC{constructor(e){se(this,"cpu");se(this,"memory");se(this,"io");const n={computer:this,...e};switch(this.cpu=new g7(n),this.memory=new T7(n),e.devices){case"no-devices":{this.io=new b7(n);break}case"pio-switches-and-leds":{this.io=new P7(n);break}case"pio-printer":{this.io=new k7(n);break}case"handshake":{this.io=new w7(n);break}default:{const r=e.devices;throw new Error(`Unknown devices configuration: ${r}`)}}}toJSON(){return{cpu:this.cpu.toJSON(),memory:this.memory.toJSON(),io:this.io.toJSON()}}}var et;class $7{constructor(){Ee(this,et,new sC({program:{data:[],instructions:[]},devices:"pio-switches-and-leds",data:"clean"}))}loadProgram(e){J(this,et,new sC({...e,previous:P(this,et)}))}getComputerState(){var e;return((e=P(this,et))==null?void 0:e.toJSON())||null}startCPU(){if(!P(this,et))throw new Qe("no-program");return P(this,et).cpu.run()}get devices(){if(!P(this,et))throw new Error("No computer loaded!");return{clock:{connected:()=>"clock"in P(this,et).io,tick:()=>{if("clock"in P(this,et).io)return P(this,et).io.clock.tick();console.warn("Called clock.tick() when no clock was connected to the computer")}},f10:{connected:()=>"f10"in P(this,et).io,press:()=>{if("f10"in P(this,et).io)return P(this,et).io.f10.press();console.warn("Called f10.press() when no f10 was connected to the computer")}},keyboard:{connected:()=>"keyboard"in P(this,et).io,readChar:e=>{if("keyboard"in P(this,et).io)return P(this,et).io.keyboard.setLastCharRead(e);console.warn("Called keyboard.press() when no keyboard was connected to the computer")}},leds:{connected:()=>"leds"in P(this,et).io},printer:{connected:()=>"printer"in P(this,et).io,clear:()=>{if("printer"in P(this,et).io)return P(this,et).io.printer.clear();console.warn("No printer connected to the computer!")},print:()=>{if("printer"in P(this,et).io)return P(this,et).io.printer.print();console.warn("No printer connected to the computer!")}},screen:{connected:()=>"screen"in P(this,et).io,clear:()=>{if("screen"in P(this,et).io)return P(this,et).io.screen.clear();console.warn("Called screen.clear() when no screen was connected to the computer")}},switches:{connected:()=>"switches"in P(this,et).io,toggle:e=>{if("switches"in P(this,et).io)return P(this,et).io.switches.toggle(e);console.warn("Called switches.toggle() when no switches were connected to the computer")}}}}}et=new WeakMap;class qe{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,n,r){let i=[];return this.decompose(0,e,i,2),r.length&&r.decompose(0,r.length,i,3),this.decompose(n,this.length,i,1),Li.from(i,this.length-(n-e)+r.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,n=this.length){let r=[];return this.decompose(e,n,r,0),Li.from(r,n-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let n=this.scanIdentical(e,1),r=this.length-this.scanIdentical(e,-1),i=new $c(this),s=new $c(e);for(let o=n,a=n;;){if(i.next(o),s.next(o),o=0,i.lineBreak!=s.lineBreak||i.done!=s.done||i.value!=s.value)return!1;if(a+=i.value.length,i.done||a>=r)return!0}}iter(e=1){return new $c(this,e)}iterRange(e,n=this.length){return new mN(this,e,n)}iterLines(e,n){let r;if(e==null)r=this.iter();else{n==null&&(n=this.lines+1);let i=this.line(e).from;r=this.iterRange(i,Math.max(i,n==this.lines+1?this.length:n<=1?0:this.line(n-1).to))}return new gN(r)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?qe.empty:e.length<=32?new Mt(e):Li.from(Mt.split(e,[]))}}class Mt extends qe{constructor(e,n=N7(e)){super(),this.text=e,this.length=n}get lines(){return this.text.length}get children(){return null}lineInner(e,n,r,i){for(let s=0;;s++){let o=this.text[s],a=i+o.length;if((n?r:a)>=e)return new O7(i,a,r,o);i=a+1,r++}}decompose(e,n,r,i){let s=e<=0&&n>=this.length?this:new Mt(oC(this.text,e,n),Math.min(n,this.length)-Math.max(0,e));if(i&1){let o=r.pop(),a=zf(s.text,o.text.slice(),0,s.length);if(a.length<=32)r.push(new Mt(a,o.length+s.length));else{let l=a.length>>1;r.push(new Mt(a.slice(0,l)),new Mt(a.slice(l)))}}else r.push(s)}replace(e,n,r){if(!(r instanceof Mt))return super.replace(e,n,r);let i=zf(this.text,zf(r.text,oC(this.text,0,e)),n),s=this.length+r.length-(n-e);return i.length<=32?new Mt(i,s):Li.from(Mt.split(i,[]),s)}sliceString(e,n=this.length,r=`
`){let i="";for(let s=0,o=0;s<=n&&o<this.text.length;o++){let a=this.text[o],l=s+a.length;s>e&&o&&(i+=r),e<l&&n>s&&(i+=a.slice(Math.max(0,e-s),n-s)),s=l+1}return i}flatten(e){for(let n of this.text)e.push(n)}scanIdentical(){return 0}static split(e,n){let r=[],i=-1;for(let s of e)r.push(s),i+=s.length+1,r.length==32&&(n.push(new Mt(r,i)),r=[],i=-1);return i>-1&&n.push(new Mt(r,i)),n}}class Li extends qe{constructor(e,n){super(),this.children=e,this.length=n,this.lines=0;for(let r of e)this.lines+=r.lines}lineInner(e,n,r,i){for(let s=0;;s++){let o=this.children[s],a=i+o.length,l=r+o.lines-1;if((n?l:a)>=e)return o.lineInner(e,n,r,i);i=a+1,r=l+1}}decompose(e,n,r,i){for(let s=0,o=0;o<=n&&s<this.children.length;s++){let a=this.children[s],l=o+a.length;if(e<=l&&n>=o){let u=i&((o<=e?1:0)|(l>=n?2:0));o>=e&&l<=n&&!u?r.push(a):a.decompose(e-o,n-o,r,u)}o=l+1}}replace(e,n,r){if(r.lines<this.lines)for(let i=0,s=0;i<this.children.length;i++){let o=this.children[i],a=s+o.length;if(e>=s&&n<=a){let l=o.replace(e-s,n-s,r),u=this.lines-o.lines+l.lines;if(l.lines<u>>5-1&&l.lines>u>>5+1){let c=this.children.slice();return c[i]=l,new Li(c,this.length-(n-e)+r.length)}return super.replace(s,a,l)}s=a+1}return super.replace(e,n,r)}sliceString(e,n=this.length,r=`
`){let i="";for(let s=0,o=0;s<this.children.length&&o<=n;s++){let a=this.children[s],l=o+a.length;o>e&&s&&(i+=r),e<l&&n>o&&(i+=a.sliceString(e-o,n-o,r)),o=l+1}return i}flatten(e){for(let n of this.children)n.flatten(e)}scanIdentical(e,n){if(!(e instanceof Li))return 0;let r=0,[i,s,o,a]=n>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;i+=n,s+=n){if(i==o||s==a)return r;let l=this.children[i],u=e.children[s];if(l!=u)return r+l.scanIdentical(u,n);r+=l.length+1}}static from(e,n=e.reduce((r,i)=>r+i.length+1,-1)){let r=0;for(let f of e)r+=f.lines;if(r<32){let f=[];for(let p of e)p.flatten(f);return new Mt(f,n)}let i=Math.max(32,r>>5),s=i<<1,o=i>>1,a=[],l=0,u=-1,c=[];function d(f){let p;if(f.lines>s&&f instanceof Li)for(let g of f.children)d(g);else f.lines>o&&(l>o||!l)?(h(),a.push(f)):f instanceof Mt&&l&&(p=c[c.length-1])instanceof Mt&&f.lines+p.lines<=32?(l+=f.lines,u+=f.length+1,c[c.length-1]=new Mt(p.text.concat(f.text),p.length+1+f.length)):(l+f.lines>i&&h(),l+=f.lines,u+=f.length+1,c.push(f))}function h(){l!=0&&(a.push(c.length==1?c[0]:Li.from(c,u)),u=-1,l=c.length=0)}for(let f of e)d(f);return h(),a.length==1?a[0]:new Li(a,n)}}qe.empty=new Mt([""],0);function N7(t){let e=-1;for(let n of t)e+=n.length+1;return e}function zf(t,e,n=0,r=1e9){for(let i=0,s=0,o=!0;s<t.length&&i<=r;s++){let a=t[s],l=i+a.length;l>=n&&(l>r&&(a=a.slice(0,r-i)),i<n&&(a=a.slice(n-i)),o?(e[e.length-1]+=a,o=!1):e.push(a)),i=l+1}return e}function oC(t,e,n){return zf(t,[""],e,n)}class $c{constructor(e,n=1){this.dir=n,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[n>0?1:(e instanceof Mt?e.text.length:e.children.length)<<1]}nextInner(e,n){for(this.done=this.lineBreak=!1;;){let r=this.nodes.length-1,i=this.nodes[r],s=this.offsets[r],o=s>>1,a=i instanceof Mt?i.text.length:i.children.length;if(o==(n>0?a:0)){if(r==0)return this.done=!0,this.value="",this;n>0&&this.offsets[r-1]++,this.nodes.pop(),this.offsets.pop()}else if((s&1)==(n>0?0:1)){if(this.offsets[r]+=n,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(i instanceof Mt){let l=i.text[o+(n<0?-1:0)];if(this.offsets[r]+=n,l.length>Math.max(0,e))return this.value=e==0?l:n>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=i.children[o+(n<0?-1:0)];e>l.length?(e-=l.length,this.offsets[r]+=n):(n<0&&this.offsets[r]--,this.nodes.push(l),this.offsets.push(n>0?1:(l instanceof Mt?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class mN{constructor(e,n,r){this.value="",this.done=!1,this.cursor=new $c(e,n>r?-1:1),this.pos=n>r?e.length:0,this.from=Math.min(n,r),this.to=Math.max(n,r)}nextInner(e,n){if(n<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,n<0?this.pos-this.to:this.from-this.pos);let r=n<0?this.pos-this.from:this.to-this.pos;e>r&&(e=r),r-=e;let{value:i}=this.cursor.next(e);return this.pos+=(i.length+e)*n,this.value=i.length<=r?i:n<0?i.slice(i.length-r):i.slice(0,r),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class gN{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:n,lineBreak:r,value:i}=this.inner.next(e);return n?(this.done=!0,this.value=""):r?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=i,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(qe.prototype[Symbol.iterator]=function(){return this.iter()},$c.prototype[Symbol.iterator]=mN.prototype[Symbol.iterator]=gN.prototype[Symbol.iterator]=function(){return this});class O7{constructor(e,n,r,i){this.from=e,this.to=n,this.number=r,this.text=i}get length(){return this.to-this.from}}let Ll="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(t=>t?parseInt(t,36):1);for(let t=1;t<Ll.length;t++)Ll[t]+=Ll[t-1];function _7(t){for(let e=1;e<Ll.length;e+=2)if(Ll[e]>t)return Ll[e-1]<=t;return!1}function aC(t){return t>=127462&&t<=127487}const lC=8205;function bn(t,e,n=!0,r=!0){return(n?yN:R7)(t,e,r)}function yN(t,e,n){if(e==t.length)return e;e&&vN(t.charCodeAt(e))&&wN(t.charCodeAt(e-1))&&e--;let r=$n(t,e);for(e+=ii(r);e<t.length;){let i=$n(t,e);if(r==lC||i==lC||n&&_7(i))e+=ii(i),r=i;else if(aC(i)){let s=0,o=e-2;for(;o>=0&&aC($n(t,o));)s++,o-=2;if(s%2==0)break;e+=2}else break}return e}function R7(t,e,n){for(;e>0;){let r=yN(t,e-2,n);if(r<e)return r;e--}return 0}function vN(t){return t>=56320&&t<57344}function wN(t){return t>=55296&&t<56320}function $n(t,e){let n=t.charCodeAt(e);if(!wN(n)||e+1==t.length)return n;let r=t.charCodeAt(e+1);return vN(r)?(n-55296<<10)+(r-56320)+65536:n}function M1(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10)+55296,(t&1023)+56320))}function ii(t){return t<65536?1:2}const Hv=/\r\n?|\n/;var Jn=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(Jn||(Jn={}));class Hi{constructor(e){this.sections=e}get length(){let e=0;for(let n=0;n<this.sections.length;n+=2)e+=this.sections[n];return e}get newLength(){let e=0;for(let n=0;n<this.sections.length;n+=2){let r=this.sections[n+1];e+=r<0?this.sections[n]:r}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let n=0,r=0,i=0;n<this.sections.length;){let s=this.sections[n++],o=this.sections[n++];o<0?(e(r,i,s),i+=s):i+=o,r+=s}}iterChangedRanges(e,n=!1){Wv(this,e,n)}get invertedDesc(){let e=[];for(let n=0;n<this.sections.length;){let r=this.sections[n++],i=this.sections[n++];i<0?e.push(r,i):e.push(i,r)}return new Hi(e)}composeDesc(e){return this.empty?e:e.empty?this:bN(this,e)}mapDesc(e,n=!1){return e.empty?this:Gv(this,e,n)}mapPos(e,n=-1,r=Jn.Simple){let i=0,s=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],u=i+a;if(l<0){if(u>e)return s+(e-i);s+=a}else{if(r!=Jn.Simple&&u>=e&&(r==Jn.TrackDel&&i<e&&u>e||r==Jn.TrackBefore&&i<e||r==Jn.TrackAfter&&u>e))return null;if(u>e||u==e&&n<0&&!a)return e==i||n<0?s:s+l;s+=l}i=u}if(e>i)throw new RangeError(`Position ${e} is out of range for changeset of length ${i}`);return s}touchesRange(e,n=e){for(let r=0,i=0;r<this.sections.length&&i<=n;){let s=this.sections[r++],o=this.sections[r++],a=i+s;if(o>=0&&i<=n&&a>=e)return i<e&&a>n?"cover":!0;i=a}return!1}toString(){let e="";for(let n=0;n<this.sections.length;){let r=this.sections[n++],i=this.sections[n++];e+=(e?" ":"")+r+(i>=0?":"+i:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(n=>typeof n!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Hi(e)}static create(e){return new Hi(e)}}class Vt extends Hi{constructor(e,n){super(e),this.inserted=n}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Wv(this,(n,r,i,s,o)=>e=e.replace(i,i+(r-n),o),!1),e}mapDesc(e,n=!1){return Gv(this,e,n,!0)}invert(e){let n=this.sections.slice(),r=[];for(let i=0,s=0;i<n.length;i+=2){let o=n[i],a=n[i+1];if(a>=0){n[i]=a,n[i+1]=o;let l=i>>1;for(;r.length<l;)r.push(qe.empty);r.push(o?e.slice(s,s+o):qe.empty)}s+=o}return new Vt(n,r)}compose(e){return this.empty?e:e.empty?this:bN(this,e,!0)}map(e,n=!1){return e.empty?this:Gv(this,e,n,!0)}iterChanges(e,n=!1){Wv(this,e,n)}get desc(){return Hi.create(this.sections)}filter(e){let n=[],r=[],i=[],s=new xd(this);e:for(let o=0,a=0;;){let l=o==e.length?1e9:e[o++];for(;a<l||a==l&&s.len==0;){if(s.done)break e;let c=Math.min(s.len,l-a);yn(i,c,-1);let d=s.ins==-1?-1:s.off==0?s.ins:0;yn(n,c,d),d>0&&co(r,n,s.text),s.forward(c),a+=c}let u=e[o++];for(;a<u;){if(s.done)break e;let c=Math.min(s.len,u-a);yn(n,c,-1),yn(i,c,s.ins==-1?-1:s.off==0?s.ins:0),s.forward(c),a+=c}}return{changes:new Vt(n,r),filtered:Hi.create(i)}}toJSON(){let e=[];for(let n=0;n<this.sections.length;n+=2){let r=this.sections[n],i=this.sections[n+1];i<0?e.push(r):i==0?e.push([r]):e.push([r].concat(this.inserted[n>>1].toJSON()))}return e}static of(e,n,r){let i=[],s=[],o=0,a=null;function l(c=!1){if(!c&&!i.length)return;o<n&&yn(i,n-o,-1);let d=new Vt(i,s);a=a?a.compose(d.map(a)):d,i=[],s=[],o=0}function u(c){if(Array.isArray(c))for(let d of c)u(d);else if(c instanceof Vt){if(c.length!=n)throw new RangeError(`Mismatched change set length (got ${c.length}, expected ${n})`);l(),a=a?a.compose(c.map(a)):c}else{let{from:d,to:h=d,insert:f}=c;if(d>h||d<0||h>n)throw new RangeError(`Invalid change range ${d} to ${h} (in doc of length ${n})`);let p=f?typeof f=="string"?qe.of(f.split(r||Hv)):f:qe.empty,g=p.length;if(d==h&&g==0)return;d<o&&l(),d>o&&yn(i,d-o,-1),yn(i,h-d,g),co(s,i,p),o=h}}return u(e),l(!a),a}static empty(e){return new Vt(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let n=[],r=[];for(let i=0;i<e.length;i++){let s=e[i];if(typeof s=="number")n.push(s,-1);else{if(!Array.isArray(s)||typeof s[0]!="number"||s.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(s.length==1)n.push(s[0],0);else{for(;r.length<i;)r.push(qe.empty);r[i]=qe.of(s.slice(1)),n.push(s[0],r[i].length)}}}return new Vt(n,r)}static createSet(e,n){return new Vt(e,n)}}function yn(t,e,n,r=!1){if(e==0&&n<=0)return;let i=t.length-2;i>=0&&n<=0&&n==t[i+1]?t[i]+=e:e==0&&t[i]==0?t[i+1]+=n:r?(t[i]+=e,t[i+1]+=n):t.push(e,n)}function co(t,e,n){if(n.length==0)return;let r=e.length-2>>1;if(r<t.length)t[t.length-1]=t[t.length-1].append(n);else{for(;t.length<r;)t.push(qe.empty);t.push(n)}}function Wv(t,e,n){let r=t.inserted;for(let i=0,s=0,o=0;o<t.sections.length;){let a=t.sections[o++],l=t.sections[o++];if(l<0)i+=a,s+=a;else{let u=i,c=s,d=qe.empty;for(;u+=a,c+=l,l&&r&&(d=d.append(r[o-2>>1])),!(n||o==t.sections.length||t.sections[o+1]<0);)a=t.sections[o++],l=t.sections[o++];e(i,u,s,c,d),i=u,s=c}}}function Gv(t,e,n,r=!1){let i=[],s=r?[]:null,o=new xd(t),a=new xd(e);for(let l=-1;;)if(o.ins==-1&&a.ins==-1){let u=Math.min(o.len,a.len);yn(i,u,-1),o.forward(u),a.forward(u)}else if(a.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(a.len<o.len||a.len==o.len&&!n))){let u=a.len;for(yn(i,a.ins,-1);u;){let c=Math.min(o.len,u);o.ins>=0&&l<o.i&&o.len<=c&&(yn(i,0,o.ins),s&&co(s,i,o.text),l=o.i),o.forward(c),u-=c}a.next()}else if(o.ins>=0){let u=0,c=o.len;for(;c;)if(a.ins==-1){let d=Math.min(c,a.len);u+=d,c-=d,a.forward(d)}else if(a.ins==0&&a.len<c)c-=a.len,a.next();else break;yn(i,u,l<o.i?o.ins:0),s&&l<o.i&&co(s,i,o.text),l=o.i,o.forward(o.len-c)}else{if(o.done&&a.done)return s?Vt.createSet(i,s):Hi.create(i);throw new Error("Mismatched change set lengths")}}function bN(t,e,n=!1){let r=[],i=n?[]:null,s=new xd(t),o=new xd(e);for(let a=!1;;){if(s.done&&o.done)return i?Vt.createSet(r,i):Hi.create(r);if(s.ins==0)yn(r,s.len,0,a),s.next();else if(o.len==0&&!o.done)yn(r,0,o.ins,a),i&&co(i,r,o.text),o.next();else{if(s.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(s.len2,o.len),u=r.length;if(s.ins==-1){let c=o.ins==-1?-1:o.off?0:o.ins;yn(r,l,c,a),i&&c&&co(i,r,o.text)}else o.ins==-1?(yn(r,s.off?0:s.len,l,a),i&&co(i,r,s.textBit(l))):(yn(r,s.off?0:s.len,o.off?0:o.ins,a),i&&!o.off&&co(i,r,o.text));a=(s.ins>l||o.ins>=0&&o.len>l)&&(a||r.length>u),s.forward2(l),o.forward(l)}}}}class xd{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,n=this.i-2>>1;return n>=e.length?qe.empty:e[n]}textBit(e){let{inserted:n}=this.set,r=this.i-2>>1;return r>=n.length&&!e?qe.empty:n[r].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class ma{constructor(e,n,r){this.from=e,this.to=n,this.flags=r}get anchor(){return this.flags&16?this.to:this.from}get head(){return this.flags&16?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&4?-1:this.flags&8?1:0}get bidiLevel(){let e=this.flags&3;return e==3?null:e}get goalColumn(){let e=this.flags>>5;return e==33554431?void 0:e}map(e,n=-1){let r,i;return this.empty?r=i=e.mapPos(this.from,n):(r=e.mapPos(this.from,1),i=e.mapPos(this.to,-1)),r==this.from&&i==this.to?this:new ma(r,i,this.flags)}extend(e,n=e){if(e<=this.anchor&&n>=this.anchor)return te.range(e,n);let r=Math.abs(e-this.anchor)>Math.abs(n-this.anchor)?e:n;return te.range(this.anchor,r)}eq(e){return this.anchor==e.anchor&&this.head==e.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return te.range(e.anchor,e.head)}static create(e,n,r){return new ma(e,n,r)}}class te{constructor(e,n){this.ranges=e,this.mainIndex=n}map(e,n=-1){return e.empty?this:te.create(this.ranges.map(r=>r.map(e,n)),this.mainIndex)}eq(e){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new te([this.main],0)}addRange(e,n=!0){return te.create([e].concat(this.ranges),n?0:this.mainIndex+1)}replaceRange(e,n=this.mainIndex){let r=this.ranges.slice();return r[n]=e,te.create(r,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new te(e.ranges.map(n=>ma.fromJSON(n)),e.main)}static single(e,n=e){return new te([te.range(e,n)],0)}static create(e,n=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let r=0,i=0;i<e.length;i++){let s=e[i];if(s.empty?s.from<=r:s.from<r)return te.normalized(e.slice(),n);r=s.to}return new te(e,n)}static cursor(e,n=0,r,i){return ma.create(e,e,(n==0?0:n<0?4:8)|(r==null?3:Math.min(2,r))|(i??33554431)<<5)}static range(e,n,r,i){let s=(r??33554431)<<5|(i==null?3:Math.min(2,i));return n<e?ma.create(n,e,24|s):ma.create(e,n,(n>e?4:0)|s)}static normalized(e,n=0){let r=e[n];e.sort((i,s)=>i.from-s.from),n=e.indexOf(r);for(let i=1;i<e.length;i++){let s=e[i],o=e[i-1];if(s.empty?s.from<=o.to:s.from<o.to){let a=o.from,l=Math.max(s.to,o.to);i<=n&&n--,e.splice(--i,2,s.anchor>s.head?te.range(l,a):te.range(a,l))}}return new te(e,n)}}function xN(t,e){for(let n of t.ranges)if(n.to>e)throw new RangeError("Selection points outside of document")}let D1=0;class Se{constructor(e,n,r,i,s){this.combine=e,this.compareInput=n,this.compare=r,this.isStatic=i,this.id=D1++,this.default=e([]),this.extensions=typeof s=="function"?s(this):s}static define(e={}){return new Se(e.combine||(n=>n),e.compareInput||((n,r)=>n===r),e.compare||(e.combine?(n,r)=>n===r:I1),!!e.static,e.enables)}of(e){return new Ff([],this,0,e)}compute(e,n){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ff(e,this,1,n)}computeN(e,n){if(this.isStatic)throw new Error("Can't compute a static facet");return new Ff(e,this,2,n)}from(e,n){return n||(n=r=>r),this.compute([e],r=>n(r.field(e)))}}function I1(t,e){return t==e||t.length==e.length&&t.every((n,r)=>n===e[r])}class Ff{constructor(e,n,r,i){this.dependencies=e,this.facet=n,this.type=r,this.value=i,this.id=D1++}dynamicSlot(e){var n;let r=this.value,i=this.facet.compareInput,s=this.id,o=e[s]>>1,a=this.type==2,l=!1,u=!1,c=[];for(let d of this.dependencies)d=="doc"?l=!0:d=="selection"?u=!0:((n=e[d.id])!==null&&n!==void 0?n:1)&1||c.push(e[d.id]);return{create(d){return d.values[o]=r(d),1},update(d,h){if(l&&h.docChanged||u&&(h.docChanged||h.selection)||Kv(d,c)){let f=r(d);if(a?!uC(f,d.values[o],i):!i(f,d.values[o]))return d.values[o]=f,1}return 0},reconfigure:(d,h)=>{let f,p=h.config.address[s];if(p!=null){let g=Zp(h,p);if(this.dependencies.every(b=>b instanceof Se?h.facet(b)===d.facet(b):b instanceof Cn?h.field(b,!1)==d.field(b,!1):!0)||(a?uC(f=r(d),g,i):i(f=r(d),g)))return d.values[o]=g,0}else f=r(d);return d.values[o]=f,1}}}}function uC(t,e,n){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!n(t[r],e[r]))return!1;return!0}function Kv(t,e){let n=!1;for(let r of e)Nc(t,r)&1&&(n=!0);return n}function M7(t,e,n){let r=n.map(l=>t[l.id]),i=n.map(l=>l.type),s=r.filter(l=>!(l&1)),o=t[e.id]>>1;function a(l){let u=[];for(let c=0;c<r.length;c++){let d=Zp(l,r[c]);if(i[c]==2)for(let h of d)u.push(h);else u.push(d)}return e.combine(u)}return{create(l){for(let u of r)Nc(l,u);return l.values[o]=a(l),1},update(l,u){if(!Kv(l,s))return 0;let c=a(l);return e.compare(c,l.values[o])?0:(l.values[o]=c,1)},reconfigure(l,u){let c=Kv(l,r),d=u.config.facets[e.id],h=u.facet(e);if(d&&!c&&I1(n,d))return l.values[o]=h,0;let f=a(l);return e.compare(f,h)?(l.values[o]=h,0):(l.values[o]=f,1)}}}const cC=Se.define({static:!0});class Cn{constructor(e,n,r,i,s){this.id=e,this.createF=n,this.updateF=r,this.compareF=i,this.spec=s,this.provides=void 0}static define(e){let n=new Cn(D1++,e.create,e.update,e.compare||((r,i)=>r===i),e);return e.provide&&(n.provides=e.provide(n)),n}create(e){let n=e.facet(cC).find(r=>r.field==this);return((n==null?void 0:n.create)||this.createF)(e)}slot(e){let n=e[this.id]>>1;return{create:r=>(r.values[n]=this.create(r),1),update:(r,i)=>{let s=r.values[n],o=this.updateF(s,i);return this.compareF(s,o)?0:(r.values[n]=o,1)},reconfigure:(r,i)=>i.config.address[this.id]!=null?(r.values[n]=i.field(this),0):(r.values[n]=this.create(r),1)}}init(e){return[this,cC.of({field:this,create:e})]}get extension(){return this}}const aa={lowest:4,low:3,default:2,high:1,highest:0};function Ku(t){return e=>new SN(e,t)}const qd={highest:Ku(aa.highest),high:Ku(aa.high),default:Ku(aa.default),low:Ku(aa.low),lowest:Ku(aa.lowest)};class SN{constructor(e,n){this.inner=e,this.prec=n}}class Qd{of(e){return new Xv(this,e)}reconfigure(e){return Qd.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Xv{constructor(e,n){this.compartment=e,this.inner=n}}class Xp{constructor(e,n,r,i,s,o){for(this.base=e,this.compartments=n,this.dynamicSlots=r,this.address=i,this.staticValues=s,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<r.length;)this.statusTemplate.push(0)}staticFacet(e){let n=this.address[e.id];return n==null?e.default:this.staticValues[n>>1]}static resolve(e,n,r){let i=[],s=Object.create(null),o=new Map;for(let h of D7(e,n,o))h instanceof Cn?i.push(h):(s[h.facet.id]||(s[h.facet.id]=[])).push(h);let a=Object.create(null),l=[],u=[];for(let h of i)a[h.id]=u.length<<1,u.push(f=>h.slot(f));let c=r==null?void 0:r.config.facets;for(let h in s){let f=s[h],p=f[0].facet,g=c&&c[h]||[];if(f.every(b=>b.type==0))if(a[p.id]=l.length<<1|1,I1(g,f))l.push(r.facet(p));else{let b=p.combine(f.map(y=>y.value));l.push(r&&p.compare(b,r.facet(p))?r.facet(p):b)}else{for(let b of f)b.type==0?(a[b.id]=l.length<<1|1,l.push(b.value)):(a[b.id]=u.length<<1,u.push(y=>b.dynamicSlot(y)));a[p.id]=u.length<<1,u.push(b=>M7(b,p,f))}}let d=u.map(h=>h(a));return new Xp(e,o,d,a,l,s)}}function D7(t,e,n){let r=[[],[],[],[],[]],i=new Map;function s(o,a){let l=i.get(o);if(l!=null){if(l<=a)return;let u=r[l].indexOf(o);u>-1&&r[l].splice(u,1),o instanceof Xv&&n.delete(o.compartment)}if(i.set(o,a),Array.isArray(o))for(let u of o)s(u,a);else if(o instanceof Xv){if(n.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let u=e.get(o.compartment)||o.inner;n.set(o.compartment,u),s(u,a)}else if(o instanceof SN)s(o.inner,o.prec);else if(o instanceof Cn)r[a].push(o),o.provides&&s(o.provides,a);else if(o instanceof Ff)r[a].push(o),o.facet.extensions&&s(o.facet.extensions,aa.default);else{let u=o.extension;if(!u)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);s(u,a)}}return s(t,aa.default),r.reduce((o,a)=>o.concat(a))}function Nc(t,e){if(e&1)return 2;let n=e>>1,r=t.status[n];if(r==4)throw new Error("Cyclic dependency between fields and/or facets");if(r&2)return r;t.status[n]=4;let i=t.computeSlot(t,t.config.dynamicSlots[n]);return t.status[n]=2|i}function Zp(t,e){return e&1?t.config.staticValues[e>>1]:t.values[e>>1]}const kN=Se.define(),CN=Se.define({combine:t=>t.some(e=>e),static:!0}),EN=Se.define({combine:t=>t.length?t[0]:void 0,static:!0}),AN=Se.define(),PN=Se.define(),TN=Se.define(),$N=Se.define({combine:t=>t.length?t[0]:!1});class Bs{constructor(e,n){this.type=e,this.value=n}static define(){return new I7}}class I7{of(e){return new Bs(this,e)}}class L7{constructor(e){this.map=e}of(e){return new ze(this,e)}}class ze{constructor(e,n){this.type=e,this.value=n}map(e){let n=this.type.map(this.value,e);return n===void 0?void 0:n==this.value?this:new ze(this.type,n)}is(e){return this.type==e}static define(e={}){return new L7(e.map||(n=>n))}static mapEffects(e,n){if(!e.length)return e;let r=[];for(let i of e){let s=i.map(n);s&&r.push(s)}return r}}ze.reconfigure=ze.define();ze.appendConfig=ze.define();class Gt{constructor(e,n,r,i,s,o){this.startState=e,this.changes=n,this.selection=r,this.effects=i,this.annotations=s,this.scrollIntoView=o,this._doc=null,this._state=null,r&&xN(r,n.newLength),s.some(a=>a.type==Gt.time)||(this.annotations=s.concat(Gt.time.of(Date.now())))}static create(e,n,r,i,s,o){return new Gt(e,n,r,i,s,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let n of this.annotations)if(n.type==e)return n.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let n=this.annotation(Gt.userEvent);return!!(n&&(n==e||n.length>e.length&&n.slice(0,e.length)==e&&n[e.length]=="."))}}Gt.time=Bs.define();Gt.userEvent=Bs.define();Gt.addToHistory=Bs.define();Gt.remote=Bs.define();function B7(t,e){let n=[];for(let r=0,i=0;;){let s,o;if(r<t.length&&(i==e.length||e[i]>=t[r]))s=t[r++],o=t[r++];else if(i<e.length)s=e[i++],o=e[i++];else return n;!n.length||n[n.length-1]<s?n.push(s,o):n[n.length-1]<o&&(n[n.length-1]=o)}}function NN(t,e,n){var r;let i,s,o;return n?(i=e.changes,s=Vt.empty(e.changes.length),o=t.changes.compose(e.changes)):(i=e.changes.map(t.changes),s=t.changes.mapDesc(e.changes,!0),o=t.changes.compose(i)),{changes:o,selection:e.selection?e.selection.map(s):(r=t.selection)===null||r===void 0?void 0:r.map(i),effects:ze.mapEffects(t.effects,i).concat(ze.mapEffects(e.effects,s)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function Zv(t,e,n){let r=e.selection,i=Bl(e.annotations);return e.userEvent&&(i=i.concat(Gt.userEvent.of(e.userEvent))),{changes:e.changes instanceof Vt?e.changes:Vt.of(e.changes||[],n,t.facet(EN)),selection:r&&(r instanceof te?r:te.single(r.anchor,r.head)),effects:Bl(e.effects),annotations:i,scrollIntoView:!!e.scrollIntoView}}function ON(t,e,n){let r=Zv(t,e.length?e[0]:{},t.doc.length);e.length&&e[0].filter===!1&&(n=!1);for(let s=1;s<e.length;s++){e[s].filter===!1&&(n=!1);let o=!!e[s].sequential;r=NN(r,Zv(t,e[s],o?r.changes.newLength:t.doc.length),o)}let i=Gt.create(t,r.changes,r.selection,r.effects,r.annotations,r.scrollIntoView);return z7(n?j7(i):i)}function j7(t){let e=t.startState,n=!0;for(let i of e.facet(AN)){let s=i(t);if(s===!1){n=!1;break}Array.isArray(s)&&(n=n===!0?s:B7(n,s))}if(n!==!0){let i,s;if(n===!1)s=t.changes.invertedDesc,i=Vt.empty(e.doc.length);else{let o=t.changes.filter(n);i=o.changes,s=o.filtered.mapDesc(o.changes).invertedDesc}t=Gt.create(e,i,t.selection&&t.selection.map(s),ze.mapEffects(t.effects,s),t.annotations,t.scrollIntoView)}let r=e.facet(PN);for(let i=r.length-1;i>=0;i--){let s=r[i](t);s instanceof Gt?t=s:Array.isArray(s)&&s.length==1&&s[0]instanceof Gt?t=s[0]:t=ON(e,Bl(s),!1)}return t}function z7(t){let e=t.startState,n=e.facet(TN),r=t;for(let i=n.length-1;i>=0;i--){let s=n[i](t);s&&Object.keys(s).length&&(r=NN(r,Zv(e,s,t.changes.newLength),!0))}return r==t?t:Gt.create(e,t.changes,t.selection,r.effects,r.annotations,r.scrollIntoView)}const F7=[];function Bl(t){return t==null?F7:Array.isArray(t)?t:[t]}var ln=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(ln||(ln={}));const U7=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Jv;try{Jv=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function V7(t){if(Jv)return Jv.test(t);for(let e=0;e<t.length;e++){let n=t[e];if(/\w/.test(n)||n>""&&(n.toUpperCase()!=n.toLowerCase()||U7.test(n)))return!0}return!1}function H7(t){return e=>{if(!/\S/.test(e))return ln.Space;if(V7(e))return ln.Word;for(let n=0;n<t.length;n++)if(e.indexOf(t[n])>-1)return ln.Word;return ln.Other}}class Ue{constructor(e,n,r,i,s,o){this.config=e,this.doc=n,this.selection=r,this.values=i,this.status=e.statusTemplate.slice(),this.computeSlot=s,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)Nc(this,a<<1);this.computeSlot=null}field(e,n=!0){let r=this.config.address[e.id];if(r==null){if(n)throw new RangeError("Field is not present in this state");return}return Nc(this,r),Zp(this,r)}update(...e){return ON(this,e,!0)}applyTransaction(e){let n=this.config,{base:r,compartments:i}=n;for(let o of e.effects)o.is(Qd.reconfigure)?(n&&(i=new Map,n.compartments.forEach((a,l)=>i.set(l,a)),n=null),i.set(o.value.compartment,o.value.extension)):o.is(ze.reconfigure)?(n=null,r=o.value):o.is(ze.appendConfig)&&(n=null,r=Bl(r).concat(o.value));let s;n?s=e.startState.values.slice():(n=Xp.resolve(r,i,this),s=new Ue(n,this.doc,this.selection,n.dynamicSlots.map(()=>null),(a,l)=>l.reconfigure(a,this),null).values),new Ue(n,e.newDoc,e.newSelection,s,(o,a)=>a.update(o,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:e},range:te.cursor(n.from+e.length)}))}changeByRange(e){let n=this.selection,r=e(n.ranges[0]),i=this.changes(r.changes),s=[r.range],o=Bl(r.effects);for(let a=1;a<n.ranges.length;a++){let l=e(n.ranges[a]),u=this.changes(l.changes),c=u.map(i);for(let h=0;h<a;h++)s[h]=s[h].map(c);let d=i.mapDesc(u,!0);s.push(l.range.map(d)),i=i.compose(c),o=ze.mapEffects(o,c).concat(ze.mapEffects(Bl(l.effects),d))}return{changes:i,selection:te.create(s,n.mainIndex),effects:o}}changes(e=[]){return e instanceof Vt?e:Vt.of(e,this.doc.length,this.facet(Ue.lineSeparator))}toText(e){return qe.of(e.split(this.facet(Ue.lineSeparator)||Hv))}sliceDoc(e=0,n=this.doc.length){return this.doc.sliceString(e,n,this.lineBreak)}facet(e){let n=this.config.address[e.id];return n==null?e.default:(Nc(this,n),Zp(this,n))}toJSON(e){let n={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let r in e){let i=e[r];i instanceof Cn&&this.config.address[i.id]!=null&&(n[r]=i.spec.toJSON(this.field(e[r]),this))}return n}static fromJSON(e,n={},r){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let i=[];if(r){for(let s in r)if(Object.prototype.hasOwnProperty.call(e,s)){let o=r[s],a=e[s];i.push(o.init(l=>o.spec.fromJSON(a,l)))}}return Ue.create({doc:e.doc,selection:te.fromJSON(e.selection),extensions:n.extensions?i.concat([n.extensions]):i})}static create(e={}){let n=Xp.resolve(e.extensions||[],new Map),r=e.doc instanceof qe?e.doc:qe.of((e.doc||"").split(n.staticFacet(Ue.lineSeparator)||Hv)),i=e.selection?e.selection instanceof te?e.selection:te.single(e.selection.anchor,e.selection.head):te.single(0);return xN(i,r.length),n.staticFacet(CN)||(i=i.asSingle()),new Ue(n,r,i,n.dynamicSlots.map(()=>null),(s,o)=>o.create(s),null)}get tabSize(){return this.facet(Ue.tabSize)}get lineBreak(){return this.facet(Ue.lineSeparator)||`
`}get readOnly(){return this.facet($N)}phrase(e,...n){for(let r of this.facet(Ue.phrases))if(Object.prototype.hasOwnProperty.call(r,e)){e=r[e];break}return n.length&&(e=e.replace(/\$(\$|\d*)/g,(r,i)=>{if(i=="$")return"$";let s=+(i||1);return!s||s>n.length?r:n[s-1]})),e}languageDataAt(e,n,r=-1){let i=[];for(let s of this.facet(kN))for(let o of s(this,n,r))Object.prototype.hasOwnProperty.call(o,e)&&i.push(o[e]);return i}charCategorizer(e){return H7(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:n,from:r,length:i}=this.doc.lineAt(e),s=this.charCategorizer(e),o=e-r,a=e-r;for(;o>0;){let l=bn(n,o,!1);if(s(n.slice(l,o))!=ln.Word)break;o=l}for(;a<i;){let l=bn(n,a);if(s(n.slice(a,l))!=ln.Word)break;a=l}return o==a?null:te.range(o+r,a+r)}}Ue.allowMultipleSelections=CN;Ue.tabSize=Se.define({combine:t=>t.length?t[0]:4});Ue.lineSeparator=EN;Ue.readOnly=$N;Ue.phrases=Se.define({compare(t,e){let n=Object.keys(t),r=Object.keys(e);return n.length==r.length&&n.every(i=>t[i]==e[i])}});Ue.languageData=kN;Ue.changeFilter=AN;Ue.transactionFilter=PN;Ue.transactionExtender=TN;Qd.reconfigure=ze.define();function Wo(t,e,n={}){let r={};for(let i of t)for(let s of Object.keys(i)){let o=i[s],a=r[s];if(a===void 0)r[s]=o;else if(!(a===o||o===void 0))if(Object.hasOwnProperty.call(n,s))r[s]=n[s](a,o);else throw new Error("Config merge conflict for field "+s)}for(let i in e)r[i]===void 0&&(r[i]=e[i]);return r}class Ba{eq(e){return this==e}range(e,n=e){return Yv.create(e,n,this)}}Ba.prototype.startSide=Ba.prototype.endSide=0;Ba.prototype.point=!1;Ba.prototype.mapMode=Jn.TrackDel;let Yv=class _N{constructor(e,n,r){this.from=e,this.to=n,this.value=r}static create(e,n,r){return new _N(e,n,r)}};function qv(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class L1{constructor(e,n,r,i){this.from=e,this.to=n,this.value=r,this.maxPoint=i}get length(){return this.to[this.to.length-1]}findIndex(e,n,r,i=0){let s=r?this.to:this.from;for(let o=i,a=s.length;;){if(o==a)return o;let l=o+a>>1,u=s[l]-e||(r?this.value[l].endSide:this.value[l].startSide)-n;if(l==o)return u>=0?o:a;u>=0?a=l:o=l+1}}between(e,n,r,i){for(let s=this.findIndex(n,-1e9,!0),o=this.findIndex(r,1e9,!1,s);s<o;s++)if(i(this.from[s]+e,this.to[s]+e,this.value[s])===!1)return!1}map(e,n){let r=[],i=[],s=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let u=this.value[l],c=this.from[l]+e,d=this.to[l]+e,h,f;if(c==d){let p=n.mapPos(c,u.startSide,u.mapMode);if(p==null||(h=f=p,u.startSide!=u.endSide&&(f=n.mapPos(c,u.endSide),f<h)))continue}else if(h=n.mapPos(c,u.startSide),f=n.mapPos(d,u.endSide),h>f||h==f&&u.startSide>0&&u.endSide<=0)continue;(f-h||u.endSide-u.startSide)<0||(o<0&&(o=h),u.point&&(a=Math.max(a,f-h)),r.push(u),i.push(h-o),s.push(f-o))}return{mapped:r.length?new L1(i,s,r,a):null,pos:o}}}class yt{constructor(e,n,r,i){this.chunkPos=e,this.chunk=n,this.nextLayer=r,this.maxPoint=i}static create(e,n,r,i){return new yt(e,n,r,i)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let n of this.chunk)e+=n.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:n=[],sort:r=!1,filterFrom:i=0,filterTo:s=this.length}=e,o=e.filter;if(n.length==0&&!o)return this;if(r&&(n=n.slice().sort(qv)),this.isEmpty)return n.length?yt.of(n):this;let a=new RN(this,null,-1).goto(0),l=0,u=[],c=new ja;for(;a.value||l<n.length;)if(l<n.length&&(a.from-n[l].from||a.startSide-n[l].value.startSide)>=0){let d=n[l++];c.addInner(d.from,d.to,d.value)||u.push(d)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==n.length||this.chunkEnd(a.chunkIndex)<n[l].from)&&(!o||i>this.chunkEnd(a.chunkIndex)||s<this.chunkPos[a.chunkIndex])&&c.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||i>a.to||s<a.from||o(a.from,a.to,a.value))&&(c.addInner(a.from,a.to,a.value)||u.push(Yv.create(a.from,a.to,a.value))),a.next());return c.finishInner(this.nextLayer.isEmpty&&!u.length?yt.empty:this.nextLayer.update({add:u,filter:o,filterFrom:i,filterTo:s}))}map(e){if(e.empty||this.isEmpty)return this;let n=[],r=[],i=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o],u=e.touchesRange(a,a+l.length);if(u===!1)i=Math.max(i,l.maxPoint),n.push(l),r.push(e.mapPos(a));else if(u===!0){let{mapped:c,pos:d}=l.map(a,e);c&&(i=Math.max(i,c.maxPoint),n.push(c),r.push(d))}}let s=this.nextLayer.map(e);return n.length==0?s:new yt(r,n,s||yt.empty,i)}between(e,n,r){if(!this.isEmpty){for(let i=0;i<this.chunk.length;i++){let s=this.chunkPos[i],o=this.chunk[i];if(n>=s&&e<=s+o.length&&o.between(s,e-s,n-s,r)===!1)return}this.nextLayer.between(e,n,r)}}iter(e=0){return Sd.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,n=0){return Sd.from(e).goto(n)}static compare(e,n,r,i,s=-1){let o=e.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=s),a=n.filter(d=>d.maxPoint>0||!d.isEmpty&&d.maxPoint>=s),l=dC(o,a,r),u=new Xu(o,l,s),c=new Xu(a,l,s);r.iterGaps((d,h,f)=>hC(u,d,c,h,f,i)),r.empty&&r.length==0&&hC(u,0,c,0,0,i)}static eq(e,n,r=0,i){i==null&&(i=1e9-1);let s=e.filter(c=>!c.isEmpty&&n.indexOf(c)<0),o=n.filter(c=>!c.isEmpty&&e.indexOf(c)<0);if(s.length!=o.length)return!1;if(!s.length)return!0;let a=dC(s,o),l=new Xu(s,a,0).goto(r),u=new Xu(o,a,0).goto(r);for(;;){if(l.to!=u.to||!Qv(l.active,u.active)||l.point&&(!u.point||!l.point.eq(u.point)))return!1;if(l.to>i)return!0;l.next(),u.next()}}static spans(e,n,r,i,s=-1){let o=new Xu(e,null,s).goto(n),a=n,l=o.openStart;for(;;){let u=Math.min(o.to,r);if(o.point){let c=o.activeForPoint(o.to),d=o.pointFrom<n?c.length+1:Math.min(c.length,l);i.point(a,u,o.point,c,d,o.pointRank),l=Math.min(o.openEnd(u),c.length)}else u>a&&(i.span(a,u,o.active,l),l=o.openEnd(u));if(o.to>r)return l+(o.point&&o.to>r?1:0);a=o.to,o.next()}}static of(e,n=!1){let r=new ja;for(let i of e instanceof Yv?[e]:n?W7(e):e)r.add(i.from,i.to,i.value);return r.finish()}}yt.empty=new yt([],[],null,-1);function W7(t){if(t.length>1)for(let e=t[0],n=1;n<t.length;n++){let r=t[n];if(qv(e,r)>0)return t.slice().sort(qv);e=r}return t}yt.empty.nextLayer=yt.empty;class ja{finishChunk(e){this.chunks.push(new L1(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,n,r){this.addInner(e,n,r)||(this.nextLayer||(this.nextLayer=new ja)).add(e,n,r)}addInner(e,n,r){let i=e-this.lastTo||r.startSide-this.last.endSide;if(i<=0&&(e-this.lastFrom||r.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return i<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(n-this.chunkStart),this.last=r,this.lastFrom=e,this.lastTo=n,this.value.push(r),r.point&&(this.maxPoint=Math.max(this.maxPoint,n-e)),!0)}addChunk(e,n){if((e-this.lastTo||n.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,n.maxPoint),this.chunks.push(n),this.chunkPos.push(e);let r=n.value.length-1;return this.last=n.value[r],this.lastFrom=n.from[r]+e,this.lastTo=n.to[r]+e,!0}finish(){return this.finishInner(yt.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let n=yt.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,n}}function dC(t,e,n){let r=new Map;for(let s of t)for(let o=0;o<s.chunk.length;o++)s.chunk[o].maxPoint<=0&&r.set(s.chunk[o],s.chunkPos[o]);let i=new Set;for(let s of e)for(let o=0;o<s.chunk.length;o++){let a=r.get(s.chunk[o]);a!=null&&(n?n.mapPos(a):a)==s.chunkPos[o]&&!(n!=null&&n.touchesRange(a,a+s.chunk[o].length))&&i.add(s.chunk[o])}return i}class RN{constructor(e,n,r,i=0){this.layer=e,this.skip=n,this.minPoint=r,this.rank=i}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,n=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,n,!1),this}gotoInner(e,n,r){for(;this.chunkIndex<this.layer.chunk.length;){let i=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(i)||this.layer.chunkEnd(this.chunkIndex)<e||i.maxPoint<this.minPoint))break;this.chunkIndex++,r=!1}if(this.chunkIndex<this.layer.chunk.length){let i=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],n,!0);(!r||this.rangeIndex<i)&&this.setRangeIndex(i)}this.next()}forward(e,n){(this.to-e||this.endSide-n)<0&&this.gotoInner(e,n,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],n=this.layer.chunk[this.chunkIndex],r=e+n.from[this.rangeIndex];if(this.from=r,this.to=e+n.to[this.rangeIndex],this.value=n.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class Sd{constructor(e){this.heap=e}static from(e,n=null,r=-1){let i=[];for(let s=0;s<e.length;s++)for(let o=e[s];!o.isEmpty;o=o.nextLayer)o.maxPoint>=r&&i.push(new RN(o,n,r,s));return i.length==1?i[0]:new Sd(i)}get startSide(){return this.value?this.value.startSide:0}goto(e,n=-1e9){for(let r of this.heap)r.goto(e,n);for(let r=this.heap.length>>1;r>=0;r--)$0(this.heap,r);return this.next(),this}forward(e,n){for(let r of this.heap)r.forward(e,n);for(let r=this.heap.length>>1;r>=0;r--)$0(this.heap,r);(this.to-e||this.value.endSide-n)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),$0(this.heap,0)}}}function $0(t,e){for(let n=t[e];;){let r=(e<<1)+1;if(r>=t.length)break;let i=t[r];if(r+1<t.length&&i.compare(t[r+1])>=0&&(i=t[r+1],r++),n.compare(i)<0)break;t[r]=n,t[e]=i,e=r}}class Xu{constructor(e,n,r){this.minPoint=r,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Sd.from(e,n,r)}goto(e,n=-1e9){return this.cursor.goto(e,n),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=n,this.openStart=-1,this.next(),this}forward(e,n){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-n)<0;)this.removeActive(this.minActive);this.cursor.forward(e,n)}removeActive(e){jh(this.active,e),jh(this.activeTo,e),jh(this.activeRank,e),this.minActive=fC(this.active,this.activeTo)}addActive(e){let n=0,{value:r,to:i,rank:s}=this.cursor;for(;n<this.activeRank.length&&this.activeRank[n]<=s;)n++;zh(this.active,n,r),zh(this.activeTo,n,i),zh(this.activeRank,n,s),e&&zh(e,n,this.cursor.from),this.minActive=fC(this.active,this.activeTo)}next(){let e=this.to,n=this.point;this.point=null;let r=this.openStart<0?[]:null;for(;;){let i=this.minActive;if(i>-1&&(this.activeTo[i]-this.cursor.from||this.active[i].endSide-this.cursor.startSide)<0){if(this.activeTo[i]>e){this.to=this.activeTo[i],this.endSide=this.active[i].endSide;break}this.removeActive(i),r&&jh(r,i)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let s=this.cursor.value;if(!s.point)this.addActive(r),this.cursor.next();else if(n&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=s,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=s.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(r){this.openStart=0;for(let i=r.length-1;i>=0&&r[i]<e;i--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let n=[];for(let r=this.active.length-1;r>=0&&!(this.activeRank[r]<this.pointRank);r--)(this.activeTo[r]>e||this.activeTo[r]==e&&this.active[r].endSide>=this.point.endSide)&&n.push(this.active[r]);return n.reverse()}openEnd(e){let n=0;for(let r=this.activeTo.length-1;r>=0&&this.activeTo[r]>e;r--)n++;return n}}function hC(t,e,n,r,i,s){t.goto(e),n.goto(r);let o=r+i,a=r,l=r-e;for(;;){let u=t.to+l-n.to||t.endSide-n.endSide,c=u<0?t.to+l:n.to,d=Math.min(c,o);if(t.point||n.point?t.point&&n.point&&(t.point==n.point||t.point.eq(n.point))&&Qv(t.activeForPoint(t.to),n.activeForPoint(n.to))||s.comparePoint(a,d,t.point,n.point):d>a&&!Qv(t.active,n.active)&&s.compareRange(a,d,t.active,n.active),c>o)break;a=c,u<=0&&t.next(),u>=0&&n.next()}}function Qv(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!=e[n]&&!t[n].eq(e[n]))return!1;return!0}function jh(t,e){for(let n=e,r=t.length-1;n<r;n++)t[n]=t[n+1];t.pop()}function zh(t,e,n){for(let r=t.length-1;r>=e;r--)t[r+1]=t[r];t[e]=n}function fC(t,e){let n=-1,r=1e9;for(let i=0;i<e.length;i++)(e[i]-r||t[i].endSide-t[n].endSide)<0&&(n=i,r=e[i]);return n}function cg(t,e,n=t.length){let r=0;for(let i=0;i<n;)t.charCodeAt(i)==9?(r+=e-r%e,i++):(r++,i=bn(t,i));return r}function G7(t,e,n,r){for(let i=0,s=0;;){if(s>=e)return i;if(i==t.length)break;s+=t.charCodeAt(i)==9?n-s%n:1,i=bn(t,i)}return r===!0?-1:t.length}const ew="",pC=typeof Symbol>"u"?"__"+ew:Symbol.for(ew),tw=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),mC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Do{constructor(e,n){this.rules=[];let{finish:r}=n||{};function i(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function s(o,a,l,u){let c=[],d=/^@(\w+)\b/.exec(o[0]),h=d&&d[1]=="keyframes";if(d&&a==null)return l.push(o[0]+";");for(let f in a){let p=a[f];if(/&/.test(f))s(f.split(/,\s*/).map(g=>o.map(b=>g.replace(/&/,b))).reduce((g,b)=>g.concat(b)),p,l);else if(p&&typeof p=="object"){if(!d)throw new RangeError("The value of a property ("+f+") should be a primitive value.");s(i(f),p,c,h)}else p!=null&&c.push(f.replace(/_.*/,"").replace(/[A-Z]/g,g=>"-"+g.toLowerCase())+": "+p+";")}(c.length||h)&&l.push((r&&!d&&!u?o.map(r):o).join(", ")+" {"+c.join(" ")+"}")}for(let o in e)s(i(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=mC[pC]||1;return mC[pC]=e+1,ew+e.toString(36)}static mount(e,n){(e[tw]||new K7(e)).mount(Array.isArray(n)?n:[n])}}let gC=new Map;class K7{constructor(e){let n=e.ownerDocument||e,r=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&r.CSSStyleSheet){let i=gC.get(n);if(i)return e.adoptedStyleSheets=[i.sheet,...e.adoptedStyleSheets],e[tw]=i;this.sheet=new r.CSSStyleSheet,e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets],gC.set(n,this)}else{this.styleTag=n.createElement("style");let i=e.head||e;i.insertBefore(this.styleTag,i.firstChild)}this.modules=[],e[tw]=this}mount(e){let n=this.sheet,r=0,i=0;for(let s=0;s<e.length;s++){let o=e[s],a=this.modules.indexOf(o);if(a<i&&a>-1&&(this.modules.splice(a,1),i--,a=-1),a==-1){if(this.modules.splice(i++,0,o),n)for(let l=0;l<o.rules.length;l++)n.insertRule(o.rules[l],r++)}else{for(;i<a;)r+=this.modules[i++].rules.length;r+=o.rules.length,i++}}if(!n){let s="";for(let o=0;o<this.modules.length;o++)s+=this.modules[o].getRules()+`
`;this.styleTag.textContent=s}}}var Io={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},kd={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},X7=typeof navigator<"u"&&/Mac/.test(navigator.platform),Z7=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var sn=0;sn<10;sn++)Io[48+sn]=Io[96+sn]=String(sn);for(var sn=1;sn<=24;sn++)Io[sn+111]="F"+sn;for(var sn=65;sn<=90;sn++)Io[sn]=String.fromCharCode(sn+32),kd[sn]=String.fromCharCode(sn);for(var N0 in Io)kd.hasOwnProperty(N0)||(kd[N0]=Io[N0]);function J7(t){var e=X7&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||Z7&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",n=!e&&t.key||(t.shiftKey?kd:Io)[t.keyCode]||t.key||"Unidentified";return n=="Esc"&&(n="Escape"),n=="Del"&&(n="Delete"),n=="Left"&&(n="ArrowLeft"),n=="Up"&&(n="ArrowUp"),n=="Right"&&(n="ArrowRight"),n=="Down"&&(n="ArrowDown"),n}function Jp(t){let e;return t.nodeType==11?e=t.getSelection?t:t.ownerDocument:e=t,e.getSelection()}function nw(t,e){return e?t==e||t.contains(e.nodeType!=1?e.parentNode:e):!1}function Y7(t){let e=t.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Uf(t,e){if(!e.anchorNode)return!1;try{return nw(t,e.anchorNode)}catch{return!1}}function Cd(t){return t.nodeType==3?za(t,0,t.nodeValue.length).getClientRects():t.nodeType==1?t.getClientRects():[]}function Yp(t,e,n,r){return n?yC(t,e,n,r,-1)||yC(t,e,n,r,1):!1}function qp(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e}function yC(t,e,n,r,i){for(;;){if(t==n&&e==r)return!0;if(e==(i<0?0:Lo(t))){if(t.nodeName=="DIV")return!1;let s=t.parentNode;if(!s||s.nodeType!=1)return!1;e=qp(t)+(i<0?0:1),t=s}else if(t.nodeType==1){if(t=t.childNodes[e+(i<0?-1:0)],t.nodeType==1&&t.contentEditable=="false")return!1;e=i<0?Lo(t):0}else return!1}}function Lo(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function B1(t,e){let n=e?t.left:t.right;return{left:n,right:n,top:t.top,bottom:t.bottom}}function q7(t){return{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function Q7(t,e,n,r,i,s,o,a){let l=t.ownerDocument,u=l.defaultView||window;for(let c=t,d=!1;c&&!d;)if(c.nodeType==1){let h,f=c==l.body;if(f)h=q7(u);else{if(/^(fixed|sticky)$/.test(getComputedStyle(c).position)&&(d=!0),c.scrollHeight<=c.clientHeight&&c.scrollWidth<=c.clientWidth){c=c.assignedSlot||c.parentNode;continue}let b=c.getBoundingClientRect();h={left:b.left,right:b.left+c.clientWidth,top:b.top,bottom:b.top+c.clientHeight}}let p=0,g=0;if(i=="nearest")e.top<h.top?(g=-(h.top-e.top+o),n>0&&e.bottom>h.bottom+g&&(g=e.bottom-h.bottom+g+o)):e.bottom>h.bottom&&(g=e.bottom-h.bottom+o,n<0&&e.top-g<h.top&&(g=-(h.top+g-e.top+o)));else{let b=e.bottom-e.top,y=h.bottom-h.top;g=(i=="center"&&b<=y?e.top+b/2-y/2:i=="start"||i=="center"&&n<0?e.top-o:e.bottom-y+o)-h.top}if(r=="nearest"?e.left<h.left?(p=-(h.left-e.left+s),n>0&&e.right>h.right+p&&(p=e.right-h.right+p+s)):e.right>h.right&&(p=e.right-h.right+s,n<0&&e.left<h.left+p&&(p=-(h.left+p-e.left+s))):p=(r=="center"?e.left+(e.right-e.left)/2-(h.right-h.left)/2:r=="start"==a?e.left-s:e.right-(h.right-h.left)+s)-h.left,p||g)if(f)u.scrollBy(p,g);else{let b=0,y=0;if(g){let v=c.scrollTop;c.scrollTop+=g,y=c.scrollTop-v}if(p){let v=c.scrollLeft;c.scrollLeft+=p,b=c.scrollLeft-v}e={left:e.left-b,top:e.top-y,right:e.right-b,bottom:e.bottom-y},b&&Math.abs(b-p)<1&&(r="nearest"),y&&Math.abs(y-g)<1&&(i="nearest")}if(f)break;c=c.assignedSlot||c.parentNode}else if(c.nodeType==11)c=c.host;else break}function e9(t){let e=t.ownerDocument;for(let n=t.parentNode;n&&n!=e.body;)if(n.nodeType==1){if(n.scrollHeight>n.clientHeight||n.scrollWidth>n.clientWidth)return n;n=n.assignedSlot||n.parentNode}else if(n.nodeType==11)n=n.host;else break;return null}class t9{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:n,focusNode:r}=e;this.set(n,Math.min(e.anchorOffset,n?Lo(n):0),r,Math.min(e.focusOffset,r?Lo(r):0))}set(e,n,r,i){this.anchorNode=e,this.anchorOffset=n,this.focusNode=r,this.focusOffset=i}}let rl=null;function MN(t){if(t.setActive)return t.setActive();if(rl)return t.focus(rl);let e=[];for(let n=t;n&&(e.push(n,n.scrollTop,n.scrollLeft),n!=n.ownerDocument);n=n.parentNode);if(t.focus(rl==null?{get preventScroll(){return rl={preventScroll:!0},!0}}:void 0),!rl){rl=!1;for(let n=0;n<e.length;){let r=e[n++],i=e[n++],s=e[n++];r.scrollTop!=i&&(r.scrollTop=i),r.scrollLeft!=s&&(r.scrollLeft=s)}}}let vC;function za(t,e,n=e){let r=vC||(vC=document.createRange());return r.setEnd(t,n),r.setStart(t,e),r}function jl(t,e,n){let r={key:e,code:e,keyCode:n,which:n,cancelable:!0},i=new KeyboardEvent("keydown",r);i.synthetic=!0,t.dispatchEvent(i);let s=new KeyboardEvent("keyup",r);return s.synthetic=!0,t.dispatchEvent(s),i.defaultPrevented||s.defaultPrevented}function n9(t){for(;t;){if(t&&(t.nodeType==9||t.nodeType==11&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}function DN(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function r9(t,e){let n=e.focusNode,r=e.focusOffset;if(!n||e.anchorNode!=n||e.anchorOffset!=r)return!1;for(r=Math.min(r,Lo(n));;)if(r){if(n.nodeType!=1)return!1;let i=n.childNodes[r-1];i.contentEditable=="false"?r--:(n=i,r=Lo(n))}else{if(n==t)return!0;r=qp(n),n=n.parentNode}}function IN(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}class _n{constructor(e,n,r=!0){this.node=e,this.offset=n,this.precise=r}static before(e,n){return new _n(e.parentNode,qp(e),n)}static after(e,n){return new _n(e.parentNode,qp(e)+1,n)}}const j1=[];class ht{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let n=this.posAtStart;for(let r of this.children){if(r==e)return n;n+=r.length+r.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,n){if(this.flags&2){let r=this.dom,i=null,s;for(let o of this.children){if(o.flags&7){if(!o.dom&&(s=i?i.nextSibling:r.firstChild)){let a=ht.get(s);(!a||!a.parent&&a.canReuseDOM(o))&&o.reuseDOM(s)}o.sync(e,n),o.flags&=-8}if(s=i?i.nextSibling:r.firstChild,n&&!n.written&&n.node==r&&s!=o.dom&&(n.written=!0),o.dom.parentNode==r)for(;s&&s!=o.dom;)s=wC(s);else r.insertBefore(o.dom,s);i=o.dom}for(s=i?i.nextSibling:r.firstChild,s&&n&&n.node==r&&(n.written=!0);s;)s=wC(s)}else if(this.flags&1)for(let r of this.children)r.flags&7&&(r.sync(e,n),r.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,n){let r;if(e==this.dom)r=this.dom.childNodes[n];else{let i=Lo(e)==0?0:n==0?-1:1;for(;;){let s=e.parentNode;if(s==this.dom)break;i==0&&s.firstChild!=s.lastChild&&(e==s.firstChild?i=-1:i=1),e=s}i<0?r=e:r=e.nextSibling}if(r==this.dom.firstChild)return 0;for(;r&&!ht.get(r);)r=r.nextSibling;if(!r)return this.length;for(let i=0,s=0;;i++){let o=this.children[i];if(o.dom==r)return s;s+=o.length+o.breakAfter}}domBoundsAround(e,n,r=0){let i=-1,s=-1,o=-1,a=-1;for(let l=0,u=r,c=r;l<this.children.length;l++){let d=this.children[l],h=u+d.length;if(u<e&&h>n)return d.domBoundsAround(e,n,u);if(h>=e&&i==-1&&(i=l,s=u),u>n&&d.dom.parentNode==this.dom){o=l,a=c;break}c=h,u=h+d.breakAfter}return{from:s,to:a<0?r+this.length:a,startDOM:(i?this.children[i-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let n=this.parent;n;n=n.parent){if(e&&(n.flags|=2),n.flags&1)return;n.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this}get rootView(){for(let e=this;;){let n=e.parent;if(!n)return e;e=n}}replaceChildren(e,n,r=j1){this.markDirty();for(let i=e;i<n;i++){let s=this.children[i];s.parent==this&&s.destroy()}this.children.splice(e,n-e,...r);for(let i=0;i<r.length;i++)r[i].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new LN(this.children,e,this.children.length)}childPos(e,n=1){return this.childCursor().findPos(e,n)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,n,r,i,s,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){this.parent=null}}ht.prototype.breakAfter=0;function wC(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class LN{constructor(e,n,r){this.children=e,this.pos=n,this.i=r,this.off=0}findPos(e,n=1){for(;;){if(e>this.pos||e==this.pos&&(n>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let r=this.children[--this.i];this.pos-=r.length+r.breakAfter}}}function BN(t,e,n,r,i,s,o,a,l){let{children:u}=t,c=u.length?u[e]:null,d=s.length?s[s.length-1]:null,h=d?d.breakAfter:o;if(!(e==r&&c&&!o&&!h&&s.length<2&&c.merge(n,i,s.length?d:null,n==0,a,l))){if(r<u.length){let f=u[r];f&&i<f.length?(e==r&&(f=f.split(i),i=0),!h&&d&&f.merge(0,i,d,!0,0,l)?s[s.length-1]=f:(i&&f.merge(0,i,null,!1,0,l),s.push(f))):f!=null&&f.breakAfter&&(d?d.breakAfter=1:o=1),r++}for(c&&(c.breakAfter=o,n>0&&(!o&&s.length&&c.merge(n,c.length,s[0],!1,a,0)?c.breakAfter=s.shift().breakAfter:(n<c.length||c.children.length&&c.children[c.children.length-1].length==0)&&c.merge(n,c.length,null,!1,a,0),e++));e<r&&s.length;)if(u[r-1].become(s[s.length-1]))r--,s.pop(),l=s.length?0:a;else if(u[e].become(s[0]))e++,s.shift(),a=s.length?0:l;else break;!s.length&&e&&r<u.length&&!u[e-1].breakAfter&&u[r].merge(0,0,u[e-1],!1,a,l)&&e--,(e<r||s.length)&&t.replaceChildren(e,r,s)}}function jN(t,e,n,r,i,s){let o=t.childCursor(),{i:a,off:l}=o.findPos(n,1),{i:u,off:c}=o.findPos(e,-1),d=e-n;for(let h of r)d+=h.length;t.length+=d,BN(t,u,c,a,l,r,0,i,s)}const Cl="";class zN{constructor(e,n){this.points=e,this.text="",this.lineSeparator=n.facet(Ue.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Cl}readRange(e,n){if(!e)return this;let r=e.parentNode;for(let i=e;;){this.findPointBefore(r,i);let s=this.text.length;this.readNode(i);let o=i.nextSibling;if(o==n)break;let a=ht.get(i),l=ht.get(o);(a&&l?a.breakAfter:(a?a.breakAfter:bC(i))||bC(o)&&(i.nodeName!="BR"||i.cmIgnore)&&this.text.length>s)&&this.lineBreak(),i=o}return this.findPointBefore(r,n),this}readTextNode(e){let n=e.nodeValue;for(let r of this.points)r.node==e&&(r.pos=this.text.length+Math.min(r.offset,n.length));for(let r=0,i=this.lineSeparator?null:/\r\n?|\n/g;;){let s=-1,o=1,a;if(this.lineSeparator?(s=n.indexOf(this.lineSeparator,r),o=this.lineSeparator.length):(a=i.exec(n))&&(s=a.index,o=a[0].length),this.append(n.slice(r,s<0?n.length:s)),s<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);r=s+o}}readNode(e){if(e.cmIgnore)return;let n=ht.get(e),r=n&&n.overrideDOMText;if(r!=null){this.findPointInside(e,r.length);for(let i=r.iter();!i.next().done;)i.lineBreak?this.lineBreak():this.append(i.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,n){for(let r of this.points)r.node==e&&e.childNodes[r.offset]==n&&(r.pos=this.text.length)}findPointInside(e,n){for(let r of this.points)(e.nodeType==3?r.node==e:e.contains(r.node))&&(r.pos=this.text.length+Math.min(n,r.offset))}}function bC(t){return t.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}class xC{constructor(e,n){this.node=e,this.offset=n,this.pos=-1}}let fr=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},rw=typeof document<"u"?document:{documentElement:{style:{}}};const iw=/Edge\/(\d+)/.exec(fr.userAgent),FN=/MSIE \d/.test(fr.userAgent),sw=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(fr.userAgent),dg=!!(FN||sw||iw),SC=!dg&&/gecko\/(\d+)/i.test(fr.userAgent),O0=!dg&&/Chrome\/(\d+)/.exec(fr.userAgent),kC="webkitFontSmoothing"in rw.documentElement.style,UN=!dg&&/Apple Computer/.test(fr.vendor),CC=UN&&(/Mobile\/\w+/.test(fr.userAgent)||fr.maxTouchPoints>2);var ke={mac:CC||/Mac/.test(fr.platform),windows:/Win/.test(fr.platform),linux:/Linux|X11/.test(fr.platform),ie:dg,ie_version:FN?rw.documentMode||6:sw?+sw[1]:iw?+iw[1]:0,gecko:SC,gecko_version:SC?+(/Firefox\/(\d+)/.exec(fr.userAgent)||[0,0])[1]:0,chrome:!!O0,chrome_version:O0?+O0[1]:0,ios:CC,android:/Android\b/.test(fr.userAgent),webkit:kC,safari:UN,webkit_version:kC?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:rw.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const i9=256;class Zi extends ht{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,n){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(n&&n.node==this.dom&&(n.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,n,r){return this.flags&8||r&&(!(r instanceof Zi)||this.length-(n-e)+r.length>i9||r.flags&8)?!1:(this.text=this.text.slice(0,e)+(r?r.text:"")+this.text.slice(n),this.markDirty(),!0)}split(e){let n=new Zi(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),n.flags|=this.flags&8,n}localPosFromDOM(e,n){return e==this.dom?n:n?this.text.length:0}domAtPos(e){return new _n(this.dom,e)}domBoundsAround(e,n,r){return{from:r,to:r+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,n){return s9(this.dom,e,n)}}class _s extends ht{constructor(e,n=[],r=0){super(),this.mark=e,this.children=n,this.length=r;for(let i of n)i.setParent(this)}setAttrs(e){if(DN(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let n in this.mark.attrs)e.setAttribute(n,this.mark.attrs[n]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,n){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,n)}merge(e,n,r,i,s,o){return r&&(!(r instanceof _s&&r.mark.eq(this.mark))||e&&s<=0||n<this.length&&o<=0)?!1:(jN(this,e,n,r?r.children:[],s-1,o-1),this.markDirty(),!0)}split(e){let n=[],r=0,i=-1,s=0;for(let a of this.children){let l=r+a.length;l>e&&n.push(r<e?a.split(e-r):a),i<0&&r>=e&&(i=s),r=l,s++}let o=this.length-e;return this.length=e,i>-1&&(this.children.length=i,this.markDirty()),new _s(this.mark,n,o)}domAtPos(e){return VN(this,e)}coordsAt(e,n){return WN(this,e,n)}}function s9(t,e,n){let r=t.nodeValue.length;e>r&&(e=r);let i=e,s=e,o=0;e==0&&n<0||e==r&&n>=0?ke.chrome||ke.gecko||(e?(i--,o=1):s<r&&(s++,o=-1)):n<0?i--:s<r&&s++;let a=za(t,i,s).getClientRects();if(!a.length)return null;let l=a[(o?o<0:n>=0)?0:a.length-1];return ke.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(a,u=>u.width)||l),o?B1(l,o<0):l||null}class ga extends ht{constructor(e,n,r){super(),this.widget=e,this.length=n,this.side=r,this.prevWidget=null}static create(e,n,r){return new ga(e,n,r)}split(e){let n=ga.create(this.widget,this.length-e,this.side);return this.length-=e,n}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,n,r,i,s,o){return r&&(!(r instanceof ga)||!this.widget.compare(r.widget)||e>0&&s<=0||n<this.length&&o<=0)?!1:(this.length=e+(r?r.length:0)+(this.length-n),!0)}become(e){return e instanceof ga&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return qe.empty;let e=this;for(;e.parent;)e=e.parent;let{view:n}=e,r=n&&n.state.doc,i=this.posAtStart;return r?r.slice(i,i+this.length):qe.empty}domAtPos(e){return(this.length?e==0:this.side>0)?_n.before(this.dom):_n.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,n){let r=this.widget.coordsAt(this.dom,e,n);if(r)return r;let i=this.dom.getClientRects(),s=null;if(!i.length)return null;let o=this.side?this.side<0:e>0;for(let a=o?i.length-1:0;s=i[a],!(e>0?a==0:a==i.length-1||s.top<s.bottom);a+=o?-1:1);return B1(s,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class cu extends ht{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof cu&&e.side==this.side}split(){return new cu(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?_n.before(this.dom):_n.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return qe.empty}get isHidden(){return!0}}Zi.prototype.children=ga.prototype.children=cu.prototype.children=j1;function VN(t,e){let n=t.dom,{children:r}=t,i=0;for(let s=0;i<r.length;i++){let o=r[i],a=s+o.length;if(!(a==s&&o.getSide()<=0)){if(e>s&&e<a&&o.dom.parentNode==n)return o.domAtPos(e-s);if(e<=s)break;s=a}}for(let s=i;s>0;s--){let o=r[s-1];if(o.dom.parentNode==n)return o.domAtPos(o.length)}for(let s=i;s<r.length;s++){let o=r[s];if(o.dom.parentNode==n)return o.domAtPos(0)}return new _n(n,0)}function HN(t,e,n){let r,{children:i}=t;n>0&&e instanceof _s&&i.length&&(r=i[i.length-1])instanceof _s&&r.mark.eq(e.mark)?HN(r,e.children[0],n-1):(i.push(e),e.setParent(t)),t.length+=e.length}function WN(t,e,n){let r=null,i=-1,s=null,o=-1;function a(u,c){for(let d=0,h=0;d<u.children.length&&h<=c;d++){let f=u.children[d],p=h+f.length;p>=c&&(f.children.length?a(f,c-h):(!s||s.isHidden&&n>0)&&(p>c||h==p&&f.getSide()>0)?(s=f,o=c-h):(h<c||h==p&&f.getSide()<0&&!f.isHidden)&&(r=f,i=c-h)),h=p}}a(t,e);let l=(n<0?r:s)||r||s;return l?l.coordsAt(Math.max(0,l==r?i:o),n):o9(t)}function o9(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let n=Cd(e);return n[n.length-1]||null}function ow(t,e){for(let n in t)n=="class"&&e.class?e.class+=" "+t.class:n=="style"&&e.style?e.style+=";"+t.style:e[n]=t[n];return e}const EC=Object.create(null);function z1(t,e,n){if(t==e)return!0;t||(t=EC),e||(e=EC);let r=Object.keys(t),i=Object.keys(e);if(r.length-(n&&r.indexOf(n)>-1?1:0)!=i.length-(n&&i.indexOf(n)>-1?1:0))return!1;for(let s of r)if(s!=n&&(i.indexOf(s)==-1||t[s]!==e[s]))return!1;return!0}function aw(t,e,n){let r=null;if(e)for(let i in e)n&&i in n||t.removeAttribute(r=i);if(n)for(let i in n)e&&e[i]==n[i]||t.setAttribute(r=i,n[i]);return!!r}function a9(t){let e=Object.create(null);for(let n=0;n<t.attributes.length;n++){let r=t.attributes[n];e[r.name]=r.value}return e}class Xa{eq(e){return!1}updateDOM(e,n){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,n,r){return null}get isHidden(){return!1}destroy(e){}}var Nt=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(Nt||(Nt={}));class Ze extends Ba{constructor(e,n,r,i){super(),this.startSide=e,this.endSide=n,this.widget=r,this.spec=i}get heightRelevant(){return!1}static mark(e){return new eh(e)}static widget(e){let n=Math.max(-1e4,Math.min(1e4,e.side||0)),r=!!e.block;return n+=r&&!e.inlineOrder?n>0?3e8:-4e8:n>0?1e8:-1e8,new Bo(e,n,n,r,e.widget||null,!1)}static replace(e){let n=!!e.block,r,i;if(e.isBlockGap)r=-5e8,i=4e8;else{let{start:s,end:o}=GN(e,n);r=(s?n?-3e8:-1:5e8)-1,i=(o?n?2e8:1:-6e8)+1}return new Bo(e,r,i,n,e.widget||null,!0)}static line(e){return new th(e)}static set(e,n=!1){return yt.of(e,n)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Ze.none=yt.empty;class eh extends Ze{constructor(e){let{start:n,end:r}=GN(e);super(n?-1:5e8,r?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var n,r;return this==e||e instanceof eh&&this.tagName==e.tagName&&(this.class||((n=this.attrs)===null||n===void 0?void 0:n.class))==(e.class||((r=e.attrs)===null||r===void 0?void 0:r.class))&&z1(this.attrs,e.attrs,"class")}range(e,n=e){if(e>=n)throw new RangeError("Mark decorations may not be empty");return super.range(e,n)}}eh.prototype.point=!1;class th extends Ze{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof th&&this.spec.class==e.spec.class&&z1(this.spec.attributes,e.spec.attributes)}range(e,n=e){if(n!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,n)}}th.prototype.mapMode=Jn.TrackBefore;th.prototype.point=!0;class Bo extends Ze{constructor(e,n,r,i,s,o){super(n,r,s,e),this.block=i,this.isReplace=o,this.mapMode=i?n<=0?Jn.TrackBefore:Jn.TrackAfter:Jn.TrackDel}get type(){return this.startSide<this.endSide?Nt.WidgetRange:this.startSide<=0?Nt.WidgetBefore:Nt.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Bo&&l9(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,n=e){if(this.isReplace&&(e>n||e==n&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&n!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,n)}}Bo.prototype.point=!0;function GN(t,e=!1){let{inclusiveStart:n,inclusiveEnd:r}=t;return n==null&&(n=t.inclusive),r==null&&(r=t.inclusive),{start:n??e,end:r??e}}function l9(t,e){return t==e||!!(t&&e&&t.compare(e))}function lw(t,e,n,r=0){let i=n.length-1;i>=0&&n[i]+r>=t?n[i]=Math.max(n[i],e):n.push(t,e)}class Nn extends ht{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,n,r,i,s,o){if(r){if(!(r instanceof Nn))return!1;this.dom||r.transferDOM(this)}return i&&this.setDeco(r?r.attrs:null),jN(this,e,n,r?r.children:[],s,o),!0}split(e){let n=new Nn;if(n.breakAfter=this.breakAfter,this.length==0)return n;let{i:r,off:i}=this.childPos(e);i&&(n.append(this.children[r].split(i),0),this.children[r].merge(i,this.children[r].length,null,!1,0,0),r++);for(let s=r;s<this.children.length;s++)n.append(this.children[s],0);for(;r>0&&this.children[r-1].length==0;)this.children[--r].destroy();return this.children.length=r,this.markDirty(),this.length=e,n}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){z1(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,n){HN(this,e,n)}addLineDeco(e){let n=e.spec.attributes,r=e.spec.class;n&&(this.attrs=ow(n,this.attrs||{})),r&&(this.attrs=ow({class:r},this.attrs||{}))}domAtPos(e){return VN(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,n){var r;this.dom?this.flags&4&&(DN(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(aw(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,n);let i=this.dom.lastChild;for(;i&&ht.get(i)instanceof _s;)i=i.lastChild;if(!i||!this.length||i.nodeName!="BR"&&((r=ht.get(i))===null||r===void 0?void 0:r.isEditable)==!1&&(!ke.ios||!this.children.some(s=>s instanceof Zi))){let s=document.createElement("BR");s.cmIgnore=!0,this.dom.appendChild(s)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,n;for(let r of this.children){if(!(r instanceof Zi)||/[^ -~]/.test(r.text))return null;let i=Cd(r.dom);if(i.length!=1)return null;e+=i[0].width,n=i[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:n}:null}coordsAt(e,n){let r=WN(this,e,n);if(!this.children.length&&r&&this.parent){let{heightOracle:i}=this.parent.view.viewState,s=r.bottom-r.top;if(Math.abs(s-i.lineHeight)<2&&i.textHeight<s){let o=(s-i.textHeight)/2;return{top:r.top+o,bottom:r.bottom-o,left:r.left,right:r.left}}}return r}become(e){return!1}get type(){return Nt.Text}static find(e,n){for(let r=0,i=0;r<e.children.length;r++){let s=e.children[r],o=i+s.length;if(o>=n){if(s instanceof Nn)return s;if(o>n)break}i=o+s.breakAfter}return null}}class Ca extends ht{constructor(e,n,r){super(),this.widget=e,this.length=n,this.type=r,this.breakAfter=0,this.prevWidget=null}merge(e,n,r,i,s,o){return r&&(!(r instanceof Ca)||!this.widget.compare(r.widget)||e>0&&s<=0||n<this.length&&o<=0)?!1:(this.length=e+(r?r.length:0)+(this.length-n),!0)}domAtPos(e){return e==0?_n.before(this.dom):_n.after(this.dom,e==this.length)}split(e){let n=this.length-e;this.length=e;let r=new Ca(this.widget,n,this.type);return r.breakAfter=this.breakAfter,r}get children(){return j1}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):qe.empty}domBoundsAround(){return null}become(e){return e instanceof Ca&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.type=e.type,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,n){return this.widget.coordsAt(this.dom,e,n)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Oc{constructor(e,n,r,i){this.doc=e,this.pos=n,this.end=r,this.disallowBlockEffectsFor=i,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=n}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!e.breakAfter&&!(e instanceof Ca&&e.type==Nt.WidgetBefore)}getLine(){return this.curLine||(this.content.push(this.curLine=new Nn),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Fh(new cu(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,this.posCovered()||this.getLine()}buildText(e,n,r){for(;e>0;){if(this.textOff==this.text.length){let{value:s,lineBreak:o,done:a}=this.cursor.next(this.skip);if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=s,this.textOff=0}let i=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(n.slice(n.length-r)),this.getLine().append(Fh(new Zi(this.text.slice(this.textOff,this.textOff+i)),n),r),this.atCursorPos=!0,this.textOff+=i,e-=i,r=0}}span(e,n,r,i){this.buildText(n-e,r,i),this.pos=n,this.openStart<0&&(this.openStart=i)}point(e,n,r,i,s,o){if(this.disallowBlockEffectsFor[o]&&r instanceof Bo){if(r.block)throw new RangeError("Block decorations may not be specified via plugins");if(n>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=n-e;if(r instanceof Bo)if(r.block){let{type:l}=r;l==Nt.WidgetAfter&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Ca(r.widget||new AC("div"),a,l))}else{let l=ga.create(r.widget||new AC("span"),a,a?0:r.startSide),u=this.atCursorPos&&!l.isEditable&&s<=i.length&&(e<n||r.startSide>0),c=!l.isEditable&&(e<n||s>i.length||r.startSide<=0),d=this.getLine();this.pendingBuffer==2&&!u&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(i),u&&(d.append(Fh(new cu(1),i),s),s=i.length+Math.max(0,s-i.length)),d.append(Fh(l,i),s),this.atCursorPos=c,this.pendingBuffer=c?e<n||s>i.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=i.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(r);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=n),this.openStart<0&&(this.openStart=s)}static build(e,n,r,i,s){let o=new Oc(e,n,r,s);return o.openEnd=yt.spans(i,n,r,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function Fh(t,e){for(let n of e)t=new _s(n,[t],t.length);return t}class AC extends Xa{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}const KN=Se.define(),XN=Se.define(),ZN=Se.define(),JN=Se.define(),uw=Se.define(),YN=Se.define(),qN=Se.define(),QN=Se.define({combine:t=>t.some(e=>e)}),eO=Se.define({combine:t=>t.some(e=>e)});class Qp{constructor(e,n="nearest",r="nearest",i=5,s=5){this.range=e,this.y=n,this.x=r,this.yMargin=i,this.xMargin=s}map(e){return e.empty?this:new Qp(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin)}}const PC=ze.define({map:(t,e)=>t.map(e)});function zr(t,e,n){let r=t.facet(JN);r.length?r[0](e):window.onerror?window.onerror(String(e),n,void 0,void 0,e):n?console.error(n+":",e):console.error(e)}const hg=Se.define({combine:t=>t.length?t[0]:!0});let u9=0;const fc=Se.define();class hn{constructor(e,n,r,i){this.id=e,this.create=n,this.domEventHandlers=r,this.extension=i(this)}static define(e,n){const{eventHandlers:r,provide:i,decorations:s}=n||{};return new hn(u9++,e,r,o=>{let a=[fc.of(o)];return s&&a.push(Ed.of(l=>{let u=l.plugin(o);return u?s(u):Ze.none})),i&&a.push(i(o)),a})}static fromClass(e,n){return hn.define(r=>new e(r),n)}}class _0{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let n=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(n)}catch(r){if(zr(n.state,r,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(n){zr(e.state,n,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var n;if(!((n=this.value)===null||n===void 0)&&n.destroy)try{this.value.destroy()}catch(r){zr(e.state,r,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const tO=Se.define(),F1=Se.define(),Ed=Se.define(),U1=Se.define(),nO=Se.define();function rO(t){let e=0,n=0,r=0,i=0;for(let s of t.state.facet(nO)){let o=s(t);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(n=Math.max(n,o.right)),o.top!=null&&(r=Math.max(r,o.top)),o.bottom!=null&&(i=Math.max(i,o.bottom)))}return{left:e,right:n,top:r,bottom:i}}const pc=Se.define();class Fr{constructor(e,n,r,i){this.fromA=e,this.toA=n,this.fromB=r,this.toB=i}join(e){return new Fr(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let n=e.length,r=this;for(;n>0;n--){let i=e[n-1];if(!(i.fromA>r.toA)){if(i.toA<r.fromA)break;r=r.join(i),e.splice(n-1,1)}}return e.splice(n,0,r),e}static extendWithRanges(e,n){if(n.length==0)return e;let r=[];for(let i=0,s=0,o=0,a=0;;i++){let l=i==e.length?null:e[i],u=o-a,c=l?l.fromB:1e9;for(;s<n.length&&n[s]<c;){let d=n[s],h=n[s+1],f=Math.max(a,d),p=Math.min(c,h);if(f<=p&&new Fr(f+u,p+u,f,p).addToSet(r),h>c)break;s+=2}if(!l)return r;new Fr(l.fromA,l.toA,l.fromB,l.toB).addToSet(r),o=l.toA,a=l.toB}}}class em{constructor(e,n,r){this.view=e,this.state=n,this.transactions=r,this.flags=0,this.startState=e.state,this.changes=Vt.empty(this.startState.doc.length);for(let s of r)this.changes=this.changes.compose(s.changes);let i=[];this.changes.iterChangedRanges((s,o,a,l)=>i.push(new Fr(s,o,a,l))),this.changedRanges=i}static create(e,n,r){return new em(e,n,r)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var Tt=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(Tt||(Tt={}));const cw=Tt.LTR,c9=Tt.RTL;function iO(t){let e=[];for(let n=0;n<t.length;n++)e.push(1<<+t[n]);return e}const d9=iO("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),h9=iO("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),dw=Object.create(null),Si=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),n=t.charCodeAt(1);dw[e]=n,dw[n]=-e}function f9(t){return t<=247?d9[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?h9[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8203?256:64336<=t&&t<=65023?4:t==8204?256:1}const p9=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class zl{constructor(e,n,r){this.from=e,this.to=n,this.level=r}get dir(){return this.level%2?c9:cw}side(e,n){return this.dir==n==e?this.to:this.from}static find(e,n,r,i){let s=-1;for(let o=0;o<e.length;o++){let a=e[o];if(a.from<=n&&a.to>=n){if(a.level==r)return o;(s<0||(i!=0?i<0?a.from<n:a.to>n:e[s].level>a.level))&&(s=o)}}if(s<0)throw new RangeError("Index out of range");return s}}const Ct=[];function m9(t,e){let n=t.length,r=e==cw?1:2,i=e==cw?2:1;if(!t||r==1&&!p9.test(t))return sO(n);for(let o=0,a=r,l=r;o<n;o++){let u=f9(t.charCodeAt(o));u==512?u=a:u==8&&l==4&&(u=16),Ct[o]=u==4?2:u,u&7&&(l=u),a=u}for(let o=0,a=r,l=r;o<n;o++){let u=Ct[o];if(u==128)o<n-1&&a==Ct[o+1]&&a&24?u=Ct[o]=a:Ct[o]=256;else if(u==64){let c=o+1;for(;c<n&&Ct[c]==64;)c++;let d=o&&a==8||c<n&&Ct[c]==8?l==1?1:8:256;for(let h=o;h<c;h++)Ct[h]=d;o=c-1}else u==8&&l==1&&(Ct[o]=1);a=u,u&7&&(l=u)}for(let o=0,a=0,l=0,u,c,d;o<n;o++)if(c=dw[u=t.charCodeAt(o)])if(c<0){for(let h=a-3;h>=0;h-=3)if(Si[h+1]==-c){let f=Si[h+2],p=f&2?r:f&4?f&1?i:r:0;p&&(Ct[o]=Ct[Si[h]]=p),a=h;break}}else{if(Si.length==189)break;Si[a++]=o,Si[a++]=u,Si[a++]=l}else if((d=Ct[o])==2||d==1){let h=d==r;l=h?0:1;for(let f=a-3;f>=0;f-=3){let p=Si[f+2];if(p&2)break;if(h)Si[f+2]|=2;else{if(p&4)break;Si[f+2]|=4}}}for(let o=0;o<n;o++)if(Ct[o]==256){let a=o+1;for(;a<n&&Ct[a]==256;)a++;let l=(o?Ct[o-1]:r)==1,u=(a<n?Ct[a]:r)==1,c=l==u?l?1:2:r;for(let d=o;d<a;d++)Ct[d]=c;o=a-1}let s=[];if(r==1)for(let o=0;o<n;){let a=o,l=Ct[o++]!=1;for(;o<n&&l==(Ct[o]!=1);)o++;if(l)for(let u=o;u>a;){let c=u,d=Ct[--u]!=2;for(;u>a&&d==(Ct[u-1]!=2);)u--;s.push(new zl(u,c,d?2:1))}else s.push(new zl(a,o,0))}else for(let o=0;o<n;){let a=o,l=Ct[o++]==2;for(;o<n&&l==(Ct[o]==2);)o++;s.push(new zl(a,o,l?1:2))}return s}function sO(t){return[new zl(0,t,0)]}let oO="";function g9(t,e,n,r,i){var s;let o=r.head-t.from,a=-1;if(o==0){if(!i||!t.length)return null;e[0].level!=n&&(o=e[0].side(!1,n),a=0)}else if(o==t.length){if(i)return null;let h=e[e.length-1];h.level!=n&&(o=h.side(!0,n),a=e.length-1)}a<0&&(a=zl.find(e,o,(s=r.bidiLevel)!==null&&s!==void 0?s:-1,r.assoc));let l=e[a];o==l.side(i,n)&&(l=e[a+=i?1:-1],o=l.side(!i,n));let u=i==(l.dir==n),c=bn(t.text,o,u);if(oO=t.text.slice(Math.min(o,c),Math.max(o,c)),c!=l.side(i,n))return te.cursor(c+t.from,u?-1:1,l.level);let d=a==(i?e.length-1:0)?null:e[a+(i?1:-1)];return!d&&l.level!=n?te.cursor(i?t.to:t.from,i?-1:1,n):d&&d.level<l.level?te.cursor(d.side(!i,n)+t.from,i?1:-1,d.level):te.cursor(c+t.from,i?-1:1,l.level)}class TC extends ht{constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[],this.hasComposition=null,this.markedForComposition=new Set,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Nn],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new Fr(0,0,0,e.state.doc.length)],0,null)}get length(){return this.view.state.doc.length}update(e){let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:a,toA:l})=>l<this.minWidthFrom||a>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let r=this.view.inputState.composing<0?null:v9(this.view,e.changes);if(this.hasComposition){this.markedForComposition.clear();let{from:a,to:l}=this.hasComposition;n=new Fr(a,l,e.changes.mapPos(a,-1),e.changes.mapPos(l,1)).addToSet(n.slice())}this.hasComposition=r?{from:r.range.fromB,to:r.range.toB}:null,(ke.ie||ke.chrome)&&!r&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let i=this.decorations,s=this.updateDeco(),o=x9(i,s,e.changes);return n=Fr.extendWithRanges(n,o),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,e.startState.doc.length,r),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,n,r){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,n,r);let{observer:i}=this.view;i.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=ke.chrome||ke.ios?{node:i.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||i.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let s=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof Ca&&o.widget instanceof $C&&s.push(o.dom);i.updateGaps(s)}updateChildren(e,n,r){let i=r?r.range.addToSet(e.slice()):e,s=this.childCursor(n);for(let o=i.length-1;;o--){let a=o>=0?i[o]:null;if(!a)break;let{fromA:l,toA:u,fromB:c,toB:d}=a,h,f,p,g;if(r&&r.range.fromB<d&&r.range.toB>c){let S=Oc.build(this.view.state.doc,c,r.range.fromB,this.decorations,this.dynamicDecorationMap),C=Oc.build(this.view.state.doc,r.range.toB,d,this.decorations,this.dynamicDecorationMap);f=S.breakAtStart,p=S.openStart,g=C.openEnd;let E=this.compositionView(r);C.breakAtStart?E.breakAfter=1:C.content.length&&E.merge(E.length,E.length,C.content[0],!1,C.openStart,0)&&(E.breakAfter=C.content[0].breakAfter,C.content.shift()),S.content.length&&E.merge(0,0,S.content[S.content.length-1],!0,0,S.openEnd)&&S.content.pop(),h=S.content.concat(E).concat(C.content)}else({content:h,breakAtStart:f,openStart:p,openEnd:g}=Oc.build(this.view.state.doc,c,d,this.decorations,this.dynamicDecorationMap));let{i:b,off:y}=s.findPos(u,1),{i:v,off:w}=s.findPos(l,-1);BN(this,v,w,b,y,h,f,p,g)}r&&this.fixCompositionDOM(r)}compositionView(e){let n=new Zi(e.text.nodeValue);n.flags|=8;for(let{deco:i}of e.marks)n=new _s(i,[n],n.length);let r=new Nn;return r.append(n,0),r}fixCompositionDOM(e){let n=(s,o)=>{o.flags|=8,this.markedForComposition.add(o);let a=ht.get(s);a!=o&&(a&&(a.dom=null),o.setDOM(s))},r=this.childPos(e.range.fromB,1),i=this.children[r.i];n(e.line,i);for(let s=e.marks.length-1;s>=-1;s--)r=i.childPos(r.off,1),i=i.children[r.i],n(s>=0?e.marks[s].node:e.text,i)}updateSelection(e=!1,n=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let r=this.view.root.activeElement,i=r==this.dom,s=!i&&Uf(this.dom,this.view.observer.selectionRange)&&!(r&&this.dom.contains(r));if(!(i||n||s))return;let o=this.forceSelection;this.forceSelection=!1;let a=this.view.state.selection.main,l=this.domAtPos(a.anchor),u=a.empty?l:this.domAtPos(a.head);if(ke.gecko&&a.empty&&!this.hasComposition&&y9(l)){let d=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(d,l.node.childNodes[l.offset]||null)),l=u=new _n(d,0),o=!0}let c=this.view.observer.selectionRange;(o||!c.focusNode||!Yp(l.node,l.offset,c.anchorNode,c.anchorOffset)||!Yp(u.node,u.offset,c.focusNode,c.focusOffset))&&(this.view.observer.ignore(()=>{ke.android&&ke.chrome&&this.dom.contains(c.focusNode)&&S9(c.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let d=Jp(this.view.root);if(d)if(a.empty){if(ke.gecko){let h=w9(l.node,l.offset);if(h&&h!=3){let f=lO(l.node,l.offset,h==1?1:-1);f&&(l=new _n(f,h==1?0:f.nodeValue.length))}}d.collapse(l.node,l.offset),a.bidiLevel!=null&&c.cursorBidiLevel!=null&&(c.cursorBidiLevel=a.bidiLevel)}else if(d.extend){d.collapse(l.node,l.offset);try{d.extend(u.node,u.offset)}catch{}}else{let h=document.createRange();a.anchor>a.head&&([l,u]=[u,l]),h.setEnd(u.node,u.offset),h.setStart(l.node,l.offset),d.removeAllRanges(),d.addRange(h)}s&&this.view.root.activeElement==this.dom&&(this.dom.blur(),r&&r.focus())}),this.view.observer.setSelectionRange(l,u)),this.impreciseAnchor=l.precise?null:new _n(c.anchorNode,c.anchorOffset),this.impreciseHead=u.precise?null:new _n(c.focusNode,c.focusOffset)}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,n=e.state.selection.main,r=Jp(e.root),{anchorNode:i,anchorOffset:s}=e.observer.selectionRange;if(!r||!n.empty||!n.assoc||!r.modify)return;let o=Nn.find(this,n.head);if(!o)return;let a=o.posAtStart;if(n.head==a||n.head==a+o.length)return;let l=this.coordsAt(n.head,-1),u=this.coordsAt(n.head,1);if(!l||!u||l.bottom>u.top)return;let c=this.domAtPos(n.head+n.assoc);r.collapse(c.node,c.offset),r.modify("move",n.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let d=e.observer.selectionRange;e.docView.posFromDOM(d.anchorNode,d.anchorOffset)!=n.from&&r.collapse(i,s)}nearest(e){for(let n=e;n;){let r=ht.get(n);if(r&&r.rootView==this)return r;n=n.parentNode}return null}posFromDOM(e,n){let r=this.nearest(e);if(!r)throw new RangeError("Trying to find position for a DOM position outside of the document");return r.localPosFromDOM(e,n)+r.posAtStart}domAtPos(e){let{i:n,off:r}=this.childCursor().findPos(e,-1);for(;n<this.children.length-1;){let i=this.children[n];if(r<i.length||i instanceof Nn)break;n++,r=0}return this.children[n].domAtPos(r)}coordsAt(e,n){for(let r=this.length,i=this.children.length-1;;i--){let s=this.children[i],o=r-s.breakAfter-s.length;if(e>o||e==o&&s.type!=Nt.WidgetBefore&&s.type!=Nt.WidgetAfter&&(!i||n==2||this.children[i-1].breakAfter||this.children[i-1].type==Nt.WidgetBefore&&n>-2))return s.coordsAt(e-o,n);r=o}}coordsForChar(e){let{i:n,off:r}=this.childPos(e,1),i=this.children[n];if(!(i instanceof Nn))return null;for(;i.children.length;){let{i:a,off:l}=i.childPos(r,1);for(;;a++){if(a==i.children.length)return null;if((i=i.children[a]).length)break}r=l}if(!(i instanceof Zi))return null;let s=bn(i.text,r);if(s==r)return null;let o=za(i.dom,r,s).getClientRects();return!o.length||o[0].top>=o[0].bottom?null:o[0]}measureVisibleLineHeights(e){let n=[],{from:r,to:i}=e,s=this.view.contentDOM.clientWidth,o=s>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==Tt.LTR;for(let u=0,c=0;c<this.children.length;c++){let d=this.children[c],h=u+d.length;if(h>i)break;if(u>=r){let f=d.dom.getBoundingClientRect();if(n.push(f.height),o){let p=d.dom.lastChild,g=p?Cd(p):[];if(g.length){let b=g[g.length-1],y=l?b.right-f.left:f.right-b.left;y>a&&(a=y,this.minWidth=s,this.minWidthFrom=u,this.minWidthTo=h)}}}u=h+d.breakAfter}return n}textDirectionAt(e){let{i:n}=this.childPos(e,1);return getComputedStyle(this.children[n].dom).direction=="rtl"?Tt.RTL:Tt.LTR}measureTextSize(){for(let s of this.children)if(s instanceof Nn){let o=s.measureTextSize();if(o)return o}let e=document.createElement("div"),n,r,i;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let s=Cd(e.firstChild)[0];n=e.getBoundingClientRect().height,r=s?s.width/27:7,i=s?s.height:n,e.remove()}),{lineHeight:n,charWidth:r,textHeight:i}}childCursor(e=this.length){let n=this.children.length;return n&&(e-=this.children[--n].length),new LN(this.children,e,n)}computeBlockGapDeco(){let e=[],n=this.view.viewState;for(let r=0,i=0;;i++){let s=i==n.viewports.length?null:n.viewports[i],o=s?s.from-1:this.length;if(o>r){let a=n.lineBlockAt(o).bottom-n.lineBlockAt(r).top;e.push(Ze.replace({widget:new $C(a),block:!0,inclusive:!0,isBlockGap:!0}).range(r,o))}if(!s)break;r=s.to+1}return Ze.set(e)}updateDeco(){let e=this.view.state.facet(Ed).map((n,r)=>(this.dynamicDecorationMap[r]=typeof n=="function")?n(this.view):n);for(let n=e.length;n<e.length+3;n++)this.dynamicDecorationMap[n]=!1;return this.decorations=[...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){let{range:n}=e,r=this.coordsAt(n.head,n.empty?n.assoc:n.head>n.anchor?-1:1),i;if(!r)return;!n.empty&&(i=this.coordsAt(n.anchor,n.anchor>n.head?-1:1))&&(r={left:Math.min(r.left,i.left),top:Math.min(r.top,i.top),right:Math.max(r.right,i.right),bottom:Math.max(r.bottom,i.bottom)});let s=rO(this.view),o={left:r.left-s.left,top:r.top-s.top,right:r.right+s.right,bottom:r.bottom+s.bottom};Q7(this.view.scrollDOM,o,n.head<n.anchor?-1:1,e.x,e.y,e.xMargin,e.yMargin,this.view.textDirection==Tt.LTR)}}function y9(t){return t.node.nodeType==1&&t.node.firstChild&&(t.offset==0||t.node.childNodes[t.offset-1].contentEditable=="false")&&(t.offset==t.node.childNodes.length||t.node.childNodes[t.offset].contentEditable=="false")}class $C extends Xa{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function aO(t){let e=t.observer.selectionRange,n=e.focusNode&&lO(e.focusNode,e.focusOffset,0);if(!n)return null;let r=ht.get(n),i,s;if(r instanceof Zi)i=r.posAtStart,s=i+r.length;else e:for(let o=0,a=n;;){for(let u=a.previousSibling,c;u;u=u.previousSibling){if(c=ht.get(u)){i=s=c.posAtEnd+o;break e}let d=new zN([],t.state);if(d.readNode(u),d.text.indexOf(Cl)>-1)return null;o+=d.text.length}if(a=a.parentNode,!a)return null;let l=ht.get(a);if(l){i=s=l.posAtStart+o;break}}return{from:i,to:s,node:n}}function v9(t,e){let n=aO(t);if(!n)return null;let{from:r,to:i,node:s}=n,o=e.mapPos(r,-1),a=e.mapPos(i,1),l=s.nodeValue;if(/[\n\r]/.test(l))return null;if(a-o!=l.length){let h=e.mapPos(r,1),f=e.mapPos(i,-1);if(f-h==l.length)o=h,a=f;else if(t.state.doc.sliceString(a-l.length,a)==l)o=a-l.length;else if(t.state.doc.sliceString(o,o+l.length)==l)a=o+l.length;else return null}let{main:u}=t.state.selection;if(t.state.doc.sliceString(o,a)!=l||o>u.head||a<u.head)return null;let c=[],d=new Fr(r,i,o,a);for(let h=s.parentNode;;h=h.parentNode){let f=ht.get(h);if(f instanceof _s)c.push({node:h,deco:f.mark});else{if(f instanceof Nn||h.nodeName=="DIV"&&h.parentNode==t.contentDOM)return{range:d,text:s,marks:c,line:h};if(h!=t.contentDOM)c.push({node:h,deco:new eh({inclusive:!0,attributes:a9(h),tagName:h.tagName.toLowerCase()})});else return null}}}function lO(t,e,n){if(n<=0)for(let r=t,i=e;;){if(r.nodeType==3)return r;if(r.nodeType==1&&i>0)r=r.childNodes[i-1],i=Lo(r);else break}if(n>=0)for(let r=t,i=e;;){if(r.nodeType==3)return r;if(r.nodeType==1&&i<r.childNodes.length&&n>=0)r=r.childNodes[i],i=0;else break}return null}function w9(t,e){return t.nodeType!=1?0:(e&&t.childNodes[e-1].contentEditable=="false"?1:0)|(e<t.childNodes.length&&t.childNodes[e].contentEditable=="false"?2:0)}class b9{constructor(){this.changes=[]}compareRange(e,n){lw(e,n,this.changes)}comparePoint(e,n){lw(e,n,this.changes)}}function x9(t,e,n){let r=new b9;return yt.compare(t,e,n,r),r.changes}function S9(t,e){for(let n=t;n&&n!=e;n=n.assignedSlot||n.parentNode)if(n.nodeType==1&&n.contentEditable=="false")return!0;return!1}function k9(t,e,n=1){let r=t.charCategorizer(e),i=t.doc.lineAt(e),s=e-i.from;if(i.length==0)return te.cursor(e);s==0?n=1:s==i.length&&(n=-1);let o=s,a=s;n<0?o=bn(i.text,s,!1):a=bn(i.text,s);let l=r(i.text.slice(o,a));for(;o>0;){let u=bn(i.text,o,!1);if(r(i.text.slice(u,o))!=l)break;o=u}for(;a<i.length;){let u=bn(i.text,a);if(r(i.text.slice(a,u))!=l)break;a=u}return te.range(o+i.from,a+i.from)}function C9(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function E9(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function R0(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function NC(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function OC(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function hw(t,e,n){let r,i,s,o,a=!1,l,u,c,d;for(let p=t.firstChild;p;p=p.nextSibling){let g=Cd(p);for(let b=0;b<g.length;b++){let y=g[b];i&&R0(i,y)&&(y=NC(OC(y,i.bottom),i.top));let v=C9(e,y),w=E9(n,y);if(v==0&&w==0)return p.nodeType==3?_C(p,e,n):hw(p,e,n);if(!r||o>w||o==w&&s>v){r=p,i=y,s=v,o=w;let S=w?n<y.top?-1:1:v?e<y.left?-1:1:0;a=!S||(S>0?b<g.length-1:b>0)}v==0?n>y.bottom&&(!c||c.bottom<y.bottom)?(l=p,c=y):n<y.top&&(!d||d.top>y.top)&&(u=p,d=y):c&&R0(c,y)?c=OC(c,y.bottom):d&&R0(d,y)&&(d=NC(d,y.top))}}if(c&&c.bottom>=n?(r=l,i=c):d&&d.top<=n&&(r=u,i=d),!r)return{node:t,offset:0};let h=Math.max(i.left,Math.min(i.right,e));if(r.nodeType==3)return _C(r,h,n);if(a&&r.contentEditable!="false")return hw(r,h,n);let f=Array.prototype.indexOf.call(t.childNodes,r)+(e>=(i.left+i.right)/2?1:0);return{node:t,offset:f}}function _C(t,e,n){let r=t.nodeValue.length,i=-1,s=1e9,o=0;for(let a=0;a<r;a++){let l=za(t,a,a+1).getClientRects();for(let u=0;u<l.length;u++){let c=l[u];if(c.top==c.bottom)continue;o||(o=e-c.left);let d=(c.top>n?c.top-n:n-c.bottom)-1;if(c.left-1<=e&&c.right+1>=e&&d<s){let h=e>=(c.left+c.right)/2,f=h;if((ke.chrome||ke.gecko)&&za(t,a).getBoundingClientRect().left==c.right&&(f=!h),d<=0)return{node:t,offset:a+(f?1:0)};i=a+(f?1:0),s=d}}}return{node:t,offset:i>-1?i:o>0?t.nodeValue.length:0}}function uO(t,e,n,r=-1){var i,s;let o=t.contentDOM.getBoundingClientRect(),a=o.top+t.viewState.paddingTop,l,{docHeight:u}=t.viewState,{x:c,y:d}=e,h=d-a;if(h<0)return 0;if(h>u)return t.state.doc.length;for(let S=t.viewState.heightOracle.textHeight/2,C=!1;l=t.elementAtHeight(h),l.type!=Nt.Text;)for(;h=r>0?l.bottom+S:l.top-S,!(h>=0&&h<=u);){if(C)return n?null:0;C=!0,r=-r}d=a+h;let f=l.from;if(f<t.viewport.from)return t.viewport.from==0?0:n?null:RC(t,o,l,c,d);if(f>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:n?null:RC(t,o,l,c,d);let p=t.dom.ownerDocument,g=t.root.elementFromPoint?t.root:p,b=g.elementFromPoint(c,d);b&&!t.contentDOM.contains(b)&&(b=null),b||(c=Math.max(o.left+1,Math.min(o.right-1,c)),b=g.elementFromPoint(c,d),b&&!t.contentDOM.contains(b)&&(b=null));let y,v=-1;if(b&&((i=t.docView.nearest(b))===null||i===void 0?void 0:i.isEditable)!=!1){if(p.caretPositionFromPoint){let S=p.caretPositionFromPoint(c,d);S&&({offsetNode:y,offset:v}=S)}else if(p.caretRangeFromPoint){let S=p.caretRangeFromPoint(c,d);S&&({startContainer:y,startOffset:v}=S,(!t.contentDOM.contains(y)||ke.safari&&A9(y,v,c)||ke.chrome&&P9(y,v,c))&&(y=void 0))}}if(!y||!t.docView.dom.contains(y)){let S=Nn.find(t.docView,f);if(!S)return h>l.top+l.height/2?l.to:l.from;({node:y,offset:v}=hw(S.dom,c,d))}let w=t.docView.nearest(y);if(!w)return null;if(w.isWidget&&((s=w.dom)===null||s===void 0?void 0:s.nodeType)==1){let S=w.dom.getBoundingClientRect();return e.y<S.top||e.y<=S.bottom&&e.x<=(S.left+S.right)/2?w.posAtStart:w.posAtEnd}else return w.localPosFromDOM(y,v)+w.posAtStart}function RC(t,e,n,r,i){let s=Math.round((r-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&n.height>t.defaultLineHeight*1.5){let a=t.viewState.heightOracle.textHeight,l=Math.floor((i-n.top-(t.defaultLineHeight-a)*.5)/a);s+=l*t.viewState.heightOracle.lineLength}let o=t.state.sliceDoc(n.from,n.to);return n.from+G7(o,s,t.state.tabSize)}function A9(t,e,n){let r;if(t.nodeType!=3||e!=(r=t.nodeValue.length))return!1;for(let i=t.nextSibling;i;i=i.nextSibling)if(i.nodeType!=1||i.nodeName!="BR")return!1;return za(t,r-1,r).getBoundingClientRect().left>n}function P9(t,e,n){if(e!=0)return!1;for(let i=t;;){let s=i.parentNode;if(!s||s.nodeType!=1||s.firstChild!=i)return!1;if(s.classList.contains("cm-line"))break;i=s}let r=t.nodeType==1?t.getBoundingClientRect():za(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect();return n-r.left>5}function fw(t,e){let n=t.lineBlockAt(e);if(Array.isArray(n.type)){for(let r of n.type)if(r.to>e||r.to==e&&(r.to==n.to||r.type==Nt.Text))return r}return n}function T9(t,e,n,r){let i=fw(t,e.head),s=!r||i.type!=Nt.Text||!(t.lineWrapping||i.widgetLineBreaks)?null:t.coordsAtPos(e.assoc<0&&e.head>i.from?e.head-1:e.head);if(s){let o=t.dom.getBoundingClientRect(),a=t.textDirectionAt(i.from),l=t.posAtCoords({x:n==(a==Tt.LTR)?o.right-1:o.left+1,y:(s.top+s.bottom)/2});if(l!=null)return te.cursor(l,n?-1:1)}return te.cursor(n?i.to:i.from,n?-1:1)}function MC(t,e,n,r){let i=t.state.doc.lineAt(e.head),s=t.bidiSpans(i),o=t.textDirectionAt(i.from);for(let a=e,l=null;;){let u=g9(i,s,o,a,n),c=oO;if(!u){if(i.number==(n?t.state.doc.lines:1))return a;c=`
`,i=t.state.doc.line(i.number+(n?1:-1)),s=t.bidiSpans(i),u=te.cursor(n?i.from:i.to)}if(l){if(!l(c))return a}else{if(!r)return u;l=r(c)}a=u}}function $9(t,e,n){let r=t.state.charCategorizer(e),i=r(n);return s=>{let o=r(s);return i==ln.Space&&(i=o),i==o}}function N9(t,e,n,r){let i=e.head,s=n?1:-1;if(i==(n?t.state.doc.length:0))return te.cursor(i,e.assoc);let o=e.goalColumn,a,l=t.contentDOM.getBoundingClientRect(),u=t.coordsAtPos(i),c=t.documentTop;if(u)o==null&&(o=u.left-l.left),a=s<0?u.top:u.bottom;else{let f=t.viewState.lineBlockAt(i);o==null&&(o=Math.min(l.right-l.left,t.defaultCharacterWidth*(i-f.from))),a=(s<0?f.top:f.bottom)+c}let d=l.left+o,h=r??t.viewState.heightOracle.textHeight>>1;for(let f=0;;f+=10){let p=a+(h+f)*s,g=uO(t,{x:d,y:p},!1,s);if(p<l.top||p>l.bottom||(s<0?g<i:g>i))return te.cursor(g,e.assoc,void 0,o)}}function Vf(t,e,n){for(;;){let r=0;for(let i of t)i.between(e-1,e+1,(s,o,a)=>{if(e>s&&e<o){let l=r||n||(e-s<o-e?-1:1);e=l<0?s:o,r=l}});if(!r)return e}}function M0(t,e,n){let r=Vf(t.state.facet(U1).map(i=>i(t)),n.from,e.head>n.from?-1:1);return r==n.from?n:te.cursor(r,r<n.from?1:-1)}class O9{constructor(e){this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.chromeScrollHack=-1,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.registeredEvents=[],this.customHandlers=[],this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null;let n=(r,i)=>{this.ignoreDuringComposition(i)||i.type=="keydown"&&this.keydown(e,i)||(this.mustFlushObserver(i)&&e.observer.forceFlush(),this.runCustomHandlers(i.type,e,i)?i.preventDefault():r(e,i))};for(let r in jt){let i=jt[r];e.contentDOM.addEventListener(r,s=>{DC(e,s)&&n(i,s)},pw[r]),this.registeredEvents.push(r)}e.scrollDOM.addEventListener("mousedown",r=>{if(r.target==e.scrollDOM&&r.clientY>e.contentDOM.getBoundingClientRect().bottom&&(n(jt.mousedown,r),!r.defaultPrevented&&r.button==2)){let i=e.contentDOM.style.minHeight;e.contentDOM.style.minHeight="100%",setTimeout(()=>e.contentDOM.style.minHeight=i,200)}}),e.scrollDOM.addEventListener("drop",r=>{r.target==e.scrollDOM&&r.clientY>e.contentDOM.getBoundingClientRect().bottom&&n(jt.drop,r)}),ke.chrome&&ke.chrome_version==102&&e.scrollDOM.addEventListener("wheel",()=>{this.chromeScrollHack<0?e.contentDOM.style.pointerEvents="none":window.clearTimeout(this.chromeScrollHack),this.chromeScrollHack=setTimeout(()=>{this.chromeScrollHack=-1,e.contentDOM.style.pointerEvents=""},100)},{passive:!0}),this.notifiedFocused=e.hasFocus,ke.safari&&e.contentDOM.addEventListener("input",()=>null)}setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}ensureHandlers(e,n){var r;let i;this.customHandlers=[];for(let s of n)if(i=(r=s.update(e).spec)===null||r===void 0?void 0:r.domEventHandlers){this.customHandlers.push({plugin:s.value,handlers:i});for(let o in i)this.registeredEvents.indexOf(o)<0&&o!="scroll"&&(this.registeredEvents.push(o),e.contentDOM.addEventListener(o,a=>{DC(e,a)&&this.runCustomHandlers(o,e,a)&&a.preventDefault()}))}}runCustomHandlers(e,n,r){for(let i of this.customHandlers){let s=i.handlers[e];if(s)try{if(s.call(i.plugin,r,n)||r.defaultPrevented)return!0}catch(o){zr(n.state,o)}}return!1}runScrollHandlers(e,n){this.lastScrollTop=e.scrollDOM.scrollTop,this.lastScrollLeft=e.scrollDOM.scrollLeft;for(let r of this.customHandlers){let i=r.handlers.scroll;if(i)try{i.call(r.plugin,n,e)}catch(s){zr(e.state,s)}}}keydown(e,n){if(this.lastKeyCode=n.keyCode,this.lastKeyTime=Date.now(),n.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(n.keyCode!=27&&dO.indexOf(n.keyCode)<0&&(e.inputState.lastEscPress=0),ke.android&&ke.chrome&&!n.synthetic&&(n.keyCode==13||n.keyCode==8))return e.observer.delayAndroidKey(n.key,n.keyCode),!0;let r;return ke.ios&&!n.synthetic&&!n.altKey&&!n.metaKey&&((r=cO.find(i=>i.keyCode==n.keyCode))&&!n.ctrlKey||_9.indexOf(n.key)>-1&&n.ctrlKey&&!n.shiftKey)?(this.pendingIOSKey=r||n,setTimeout(()=>this.flushIOSKey(e),250),!0):!1}flushIOSKey(e){let n=this.pendingIOSKey;return n?(this.pendingIOSKey=void 0,jl(e.contentDOM,n.key,n.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:ke.safari&&!ke.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}mustFlushObserver(e){return e.type=="keydown"&&e.keyCode!=229}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}const cO=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],_9="dthko",dO=[16,17,18,20,91,92,224,225],Uh=6;function Vh(t){return Math.max(0,t)*.7+8}function R9(t,e){return Math.max(Math.abs(t.clientX-e.clientX),Math.abs(t.clientY-e.clientY))}class M9{constructor(e,n,r,i){this.view=e,this.startEvent=n,this.style=r,this.mustSelect=i,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=n,this.scrollParent=e9(e.contentDOM),this.atoms=e.state.facet(U1).map(o=>o(e));let s=e.contentDOM.ownerDocument;s.addEventListener("mousemove",this.move=this.move.bind(this)),s.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=n.shiftKey,this.multiple=e.state.facet(Ue.allowMultipleSelections)&&D9(e,n),this.dragging=L9(e,n)&&mO(n)==1?null:!1}start(e){this.dragging===!1&&(e.preventDefault(),this.select(e))}move(e){var n;if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&R9(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let r=0,i=0,s=((n=this.scrollParent)===null||n===void 0?void 0:n.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},o=rO(this.view);e.clientX-o.left<=s.left+Uh?r=-Vh(s.left-e.clientX):e.clientX+o.right>=s.right-Uh&&(r=Vh(e.clientX-s.right)),e.clientY-o.top<=s.top+Uh?i=-Vh(s.top-e.clientY):e.clientY+o.bottom>=s.bottom-Uh&&(i=Vh(e.clientY-s.bottom)),this.setScrollSpeed(r,i)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=null}setScrollSpeed(e,n){this.scrollSpeed={x:e,y:n},e||n?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let n=null;for(let r=0;r<e.ranges.length;r++){let i=e.ranges[r],s=null;if(i.empty){let o=Vf(this.atoms,i.from,0);o!=i.from&&(s=te.cursor(o,-1))}else{let o=Vf(this.atoms,i.from,-1),a=Vf(this.atoms,i.to,1);(o!=i.from||a!=i.to)&&(s=te.range(i.from==i.anchor?o:a,i.from==i.head?o:a))}s&&(n||(n=e.ranges.slice()),n[r]=s)}return n?te.create(n,e.mainIndex):e}select(e){let{view:n}=this,r=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!r.eq(n.state.selection)||r.main.assoc!=n.state.selection.main.assoc&&this.dragging===!1)&&this.view.dispatch({selection:r,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.docChanged&&this.dragging&&(this.dragging=this.dragging.map(e.changes)),this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function D9(t,e){let n=t.state.facet(KN);return n.length?n[0](e):ke.mac?e.metaKey:e.ctrlKey}function I9(t,e){let n=t.state.facet(XN);return n.length?n[0](e):ke.mac?!e.altKey:!e.ctrlKey}function L9(t,e){let{main:n}=t.state.selection;if(n.empty)return!1;let r=Jp(t.root);if(!r||r.rangeCount==0)return!0;let i=r.getRangeAt(0).getClientRects();for(let s=0;s<i.length;s++){let o=i[s];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function DC(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let n=e.target,r;n!=t.contentDOM;n=n.parentNode)if(!n||n.nodeType==11||(r=ht.get(n))&&r.ignoreEvent(e))return!1;return!0}const jt=Object.create(null),pw=Object.create(null),hO=ke.ie&&ke.ie_version<15||ke.ios&&ke.webkit_version<604;function B9(t){let e=t.dom.parentNode;if(!e)return;let n=e.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.focus(),setTimeout(()=>{t.focus(),n.remove(),fO(t,n.value)},50)}function fO(t,e){let{state:n}=t,r,i=1,s=n.toText(e),o=s.lines==n.selection.ranges.length;if(mw!=null&&n.selection.ranges.every(l=>l.empty)&&mw==s.toString()){let l=-1;r=n.changeByRange(u=>{let c=n.doc.lineAt(u.from);if(c.from==l)return{range:u};l=c.from;let d=n.toText((o?s.line(i++).text:e)+n.lineBreak);return{changes:{from:c.from,insert:d},range:te.cursor(u.from+d.length)}})}else o?r=n.changeByRange(l=>{let u=s.line(i++);return{changes:{from:l.from,to:l.to,insert:u.text},range:te.cursor(l.from+u.length)}}):r=n.replaceSelection(s);t.dispatch(r,{userEvent:"input.paste",scrollIntoView:!0})}jt.keydown=(t,e)=>{t.inputState.setSelectionOrigin("select"),e.keyCode==27&&(t.inputState.lastEscPress=Date.now())};jt.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")};jt.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")};pw.touchstart=pw.touchmove={passive:!0};jt.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return;let n=null;for(let r of t.state.facet(ZN))if(n=r(t,e),n)break;if(!n&&e.button==0&&(n=F9(t,e)),n){let r=!t.hasFocus;t.inputState.startMouseSelection(new M9(t,e,n,r)),r&&t.observer.ignore(()=>MN(t.contentDOM)),t.inputState.mouseSelection&&t.inputState.mouseSelection.start(e)}};function IC(t,e,n,r){if(r==1)return te.cursor(e,n);if(r==2)return k9(t.state,e,n);{let i=Nn.find(t.docView,e),s=t.state.doc.lineAt(i?i.posAtEnd:e),o=i?i.posAtStart:s.from,a=i?i.posAtEnd:s.to;return a<t.state.doc.length&&a==s.to&&a++,te.range(o,a)}}let pO=(t,e)=>t>=e.top&&t<=e.bottom,LC=(t,e,n)=>pO(e,n)&&t>=n.left&&t<=n.right;function j9(t,e,n,r){let i=Nn.find(t.docView,e);if(!i)return 1;let s=e-i.posAtStart;if(s==0)return 1;if(s==i.length)return-1;let o=i.coordsAt(s,-1);if(o&&LC(n,r,o))return-1;let a=i.coordsAt(s,1);return a&&LC(n,r,a)?1:o&&pO(r,o)?-1:1}function BC(t,e){let n=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:n,bias:j9(t,n,e.clientX,e.clientY)}}const z9=ke.ie&&ke.ie_version<=11;let jC=null,zC=0,FC=0;function mO(t){if(!z9)return t.detail;let e=jC,n=FC;return jC=t,FC=Date.now(),zC=!e||n>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(zC+1)%3:1}function F9(t,e){let n=BC(t,e),r=mO(e),i=t.state.selection;return{update(s){s.docChanged&&(n.pos=s.changes.mapPos(n.pos),i=i.map(s.changes))},get(s,o,a){let l=BC(t,s),u,c=IC(t,l.pos,l.bias,r);if(n.pos!=l.pos&&!o){let d=IC(t,n.pos,n.bias,r),h=Math.min(d.from,c.from),f=Math.max(d.to,c.to);c=h<c.from?te.range(h,f):te.range(f,h)}return o?i.replaceRange(i.main.extend(c.from,c.to)):a&&r==1&&i.ranges.length>1&&(u=U9(i,l.pos))?u:a?i.addRange(c):te.create([c])}}}function U9(t,e){for(let n=0;n<t.ranges.length;n++){let{from:r,to:i}=t.ranges[n];if(r<=e&&i>=e)return te.create(t.ranges.slice(0,n).concat(t.ranges.slice(n+1)),t.mainIndex==n?0:t.mainIndex-(t.mainIndex>n?1:0))}return null}jt.dragstart=(t,e)=>{let{selection:{main:n}}=t.state,{mouseSelection:r}=t.inputState;r&&(r.dragging=n),e.dataTransfer&&(e.dataTransfer.setData("Text",t.state.sliceDoc(n.from,n.to)),e.dataTransfer.effectAllowed="copyMove")};function UC(t,e,n,r){if(!n)return;let i=t.posAtCoords({x:e.clientX,y:e.clientY},!1);e.preventDefault();let{mouseSelection:s}=t.inputState,o=r&&s&&s.dragging&&I9(t,e)?{from:s.dragging.from,to:s.dragging.to}:null,a={from:i,insert:n},l=t.state.changes(o?[o,a]:a);t.focus(),t.dispatch({changes:l,selection:{anchor:l.mapPos(i,-1),head:l.mapPos(i,1)},userEvent:o?"move.drop":"input.drop"})}jt.drop=(t,e)=>{if(!e.dataTransfer)return;if(t.state.readOnly)return e.preventDefault();let n=e.dataTransfer.files;if(n&&n.length){e.preventDefault();let r=Array(n.length),i=0,s=()=>{++i==n.length&&UC(t,e,r.filter(o=>o!=null).join(t.state.lineBreak),!1)};for(let o=0;o<n.length;o++){let a=new FileReader;a.onerror=s,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(r[o]=a.result),s()},a.readAsText(n[o])}}else UC(t,e,e.dataTransfer.getData("Text"),!0)};jt.paste=(t,e)=>{if(t.state.readOnly)return e.preventDefault();t.observer.flush();let n=hO?null:e.clipboardData;n?(fO(t,n.getData("text/plain")||n.getData("text/uri-text")),e.preventDefault()):B9(t)};function V9(t,e){let n=t.dom.parentNode;if(!n)return;let r=n.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.value=e,r.focus(),r.selectionEnd=e.length,r.selectionStart=0,setTimeout(()=>{r.remove(),t.focus()},50)}function H9(t){let e=[],n=[],r=!1;for(let i of t.selection.ranges)i.empty||(e.push(t.sliceDoc(i.from,i.to)),n.push(i));if(!e.length){let i=-1;for(let{from:s}of t.selection.ranges){let o=t.doc.lineAt(s);o.number>i&&(e.push(o.text),n.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),i=o.number}r=!0}return{text:e.join(t.lineBreak),ranges:n,linewise:r}}let mw=null;jt.copy=jt.cut=(t,e)=>{let{text:n,ranges:r,linewise:i}=H9(t.state);if(!n&&!i)return;mw=i?n:null;let s=hO?null:e.clipboardData;s?(e.preventDefault(),s.clearData(),s.setData("text/plain",n)):V9(t,n),e.type=="cut"&&!t.state.readOnly&&t.dispatch({changes:r,scrollIntoView:!0,userEvent:"delete.cut"})};const gO=Bs.define();function yO(t,e){let n=[];for(let r of t.facet(qN)){let i=r(t,e);i&&n.push(i)}return n?t.update({effects:n,annotations:gO.of(!0)}):null}function vO(t){setTimeout(()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let n=yO(t.state,e);n?t.dispatch(n):t.update([])}},10)}jt.focus=t=>{t.inputState.lastFocusTime=Date.now(),!t.scrollDOM.scrollTop&&(t.inputState.lastScrollTop||t.inputState.lastScrollLeft)&&(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),vO(t)};jt.blur=t=>{t.observer.clearSelectionRange(),vO(t)};jt.compositionstart=jt.compositionupdate=t=>{t.inputState.compositionFirstChange==null&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0)};jt.compositionend=t=>{t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,ke.chrome&&ke.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then(()=>t.observer.flush()):setTimeout(()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])},50)};jt.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()};jt.beforeinput=(t,e)=>{var n;let r;if(ke.chrome&&ke.android&&(r=cO.find(i=>i.inputType==e.inputType))&&(t.observer.delayAndroidKey(r.key,r.keyCode),r.key=="Backspace"||r.key=="Delete")){let i=((n=window.visualViewport)===null||n===void 0?void 0:n.height)||0;setTimeout(()=>{var s;(((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0)>i+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())},100)}};const VC=["pre-wrap","normal","pre-line","break-spaces"];class W9{constructor(e){this.lineWrapping=e,this.doc=qe.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,n){let r=this.doc.lineAt(n).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(r+=Math.max(0,Math.ceil((n-e-r*this.lineLength*.5)/this.lineLength))),this.lineHeight*r}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return VC.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let n=!1;for(let r=0;r<e.length;r++){let i=e[r];i<0?r++:this.heightSamples[Math.floor(i*10)]||(n=!0,this.heightSamples[Math.floor(i*10)]=!0)}return n}refresh(e,n,r,i,s,o){let a=VC.indexOf(e)>-1,l=Math.round(n)!=Math.round(this.lineHeight)||this.lineWrapping!=a;if(this.lineWrapping=a,this.lineHeight=n,this.charWidth=r,this.textHeight=i,this.lineLength=s,l){this.heightSamples={};for(let u=0;u<o.length;u++){let c=o[u];c<0?u++:this.heightSamples[Math.floor(c*10)]=!0}}return l}}class G9{constructor(e,n){this.from=e,this.heights=n,this.index=0}get more(){return this.index<this.heights.length}}class Bi{constructor(e,n,r,i,s){this.from=e,this.length=n,this.top=r,this.height=i,this._content=s}get type(){return typeof this._content=="number"?Nt.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Bo?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let n=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new Bi(this.from,this.length+e.length,this.top,this.height+e.height,n)}}var gt=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(gt||(gt={}));const Hf=.001;class Mn{constructor(e,n,r=2){this.length=e,this.height=n,this.flags=r}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,n){this.height!=n&&(Math.abs(this.height-n)>Hf&&(e.heightChanged=!0),this.height=n)}replace(e,n,r){return Mn.of(r)}decomposeLeft(e,n){n.push(this)}decomposeRight(e,n){n.push(this)}applyChanges(e,n,r,i){let s=this,o=r.doc;for(let a=i.length-1;a>=0;a--){let{fromA:l,toA:u,fromB:c,toB:d}=i[a],h=s.lineAt(l,gt.ByPosNoHeight,r.setDoc(n),0,0),f=h.to>=u?h:s.lineAt(u,gt.ByPosNoHeight,r,0,0);for(d+=f.to-u,u=f.to;a>0&&h.from<=i[a-1].toA;)l=i[a-1].fromA,c=i[a-1].fromB,a--,l<h.from&&(h=s.lineAt(l,gt.ByPosNoHeight,r,0,0));c+=h.from-l,l=h.from;let p=V1.build(r.setDoc(o),e,c,d);s=s.replace(l,u,p)}return s.updateHeight(r,0)}static empty(){return new cr(0,0)}static of(e){if(e.length==1)return e[0];let n=0,r=e.length,i=0,s=0;for(;;)if(n==r)if(i>s*2){let a=e[n-1];a.break?e.splice(--n,1,a.left,null,a.right):e.splice(--n,1,a.left,a.right),r+=1+a.break,i-=a.size}else if(s>i*2){let a=e[r];a.break?e.splice(r,1,a.left,null,a.right):e.splice(r,1,a.left,a.right),r+=2+a.break,s-=a.size}else break;else if(i<s){let a=e[n++];a&&(i+=a.size)}else{let a=e[--r];a&&(s+=a.size)}let o=0;return e[n-1]==null?(o=1,n--):e[n]==null&&(o=1,r++),new K9(Mn.of(e.slice(0,n)),o,Mn.of(e.slice(r)))}}Mn.prototype.size=1;class wO extends Mn{constructor(e,n,r){super(e,n),this.deco=r}blockAt(e,n,r,i){return new Bi(i,this.length,r,this.height,this.deco||0)}lineAt(e,n,r,i,s){return this.blockAt(0,r,i,s)}forEachLine(e,n,r,i,s,o){e<=s+this.length&&n>=s&&o(this.blockAt(0,r,i,s))}updateHeight(e,n=0,r=!1,i){return i&&i.from<=n&&i.more&&this.setHeight(e,i.heights[i.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class cr extends wO{constructor(e,n){super(e,n,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,n,r,i){return new Bi(i,this.length,r,this.height,this.breaks)}replace(e,n,r){let i=r[0];return r.length==1&&(i instanceof cr||i instanceof tn&&i.flags&4)&&Math.abs(this.length-i.length)<10?(i instanceof tn?i=new cr(i.length,this.height):i.height=this.height,this.outdated||(i.outdated=!1),i):Mn.of(r)}updateHeight(e,n=0,r=!1,i){return i&&i.from<=n&&i.more?this.setHeight(e,i.heights[i.index++]):(r||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class tn extends Mn{constructor(e){super(e,0)}heightMetrics(e,n){let r=e.doc.lineAt(n).number,i=e.doc.lineAt(n+this.length).number,s=i-r+1,o,a=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*s);o=l/s,this.length>s+1&&(a=(this.height-l)/(this.length-s-1))}else o=this.height/s;return{firstLine:r,lastLine:i,perLine:o,perChar:a}}blockAt(e,n,r,i){let{firstLine:s,lastLine:o,perLine:a,perChar:l}=this.heightMetrics(n,i);if(n.lineWrapping){let u=i+Math.round(Math.max(0,Math.min(1,(e-r)/this.height))*this.length),c=n.doc.lineAt(u),d=a+c.length*l,h=Math.max(r,e-d/2);return new Bi(c.from,c.length,h,d,0)}else{let u=Math.max(0,Math.min(o-s,Math.floor((e-r)/a))),{from:c,length:d}=n.doc.line(s+u);return new Bi(c,d,r+a*u,a,0)}}lineAt(e,n,r,i,s){if(n==gt.ByHeight)return this.blockAt(e,r,i,s);if(n==gt.ByPosNoHeight){let{from:f,to:p}=r.doc.lineAt(e);return new Bi(f,p-f,0,0,0)}let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(r,s),u=r.doc.lineAt(e),c=a+u.length*l,d=u.number-o,h=i+a*d+l*(u.from-s-d);return new Bi(u.from,u.length,Math.max(i,Math.min(h,i+this.height-c)),c,0)}forEachLine(e,n,r,i,s,o){e=Math.max(e,s),n=Math.min(n,s+this.length);let{firstLine:a,perLine:l,perChar:u}=this.heightMetrics(r,s);for(let c=e,d=i;c<=n;){let h=r.doc.lineAt(c);if(c==e){let p=h.number-a;d+=l*p+u*(e-s-p)}let f=l+u*h.length;o(new Bi(h.from,h.length,d,f,0)),d+=f,c=h.to+1}}replace(e,n,r){let i=this.length-n;if(i>0){let s=r[r.length-1];s instanceof tn?r[r.length-1]=new tn(s.length+i):r.push(null,new tn(i-1))}if(e>0){let s=r[0];s instanceof tn?r[0]=new tn(e+s.length):r.unshift(new tn(e-1),null)}return Mn.of(r)}decomposeLeft(e,n){n.push(new tn(e-1),null)}decomposeRight(e,n){n.push(null,new tn(this.length-e-1))}updateHeight(e,n=0,r=!1,i){let s=n+this.length;if(i&&i.from<=n+this.length&&i.more){let o=[],a=Math.max(n,i.from),l=-1;for(i.from>n&&o.push(new tn(i.from-n-1).updateHeight(e,n));a<=s&&i.more;){let c=e.doc.lineAt(a).length;o.length&&o.push(null);let d=i.heights[i.index++];l==-1?l=d:Math.abs(d-l)>=Hf&&(l=-2);let h=new cr(c,d);h.outdated=!1,o.push(h),a+=c+1}a<=s&&o.push(null,new tn(s-a).updateHeight(e,a));let u=Mn.of(o);return(l<0||Math.abs(u.height-this.height)>=Hf||Math.abs(l-this.heightMetrics(e,n).perLine)>=Hf)&&(e.heightChanged=!0),u}else(r||this.outdated)&&(this.setHeight(e,e.heightForGap(n,n+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class K9 extends Mn{constructor(e,n,r){super(e.length+n+r.length,e.height+r.height,n|(e.outdated||r.outdated?2:0)),this.left=e,this.right=r,this.size=e.size+r.size}get break(){return this.flags&1}blockAt(e,n,r,i){let s=r+this.left.height;return e<s?this.left.blockAt(e,n,r,i):this.right.blockAt(e,n,s,i+this.left.length+this.break)}lineAt(e,n,r,i,s){let o=i+this.left.height,a=s+this.left.length+this.break,l=n==gt.ByHeight?e<o:e<a,u=l?this.left.lineAt(e,n,r,i,s):this.right.lineAt(e,n,r,o,a);if(this.break||(l?u.to<a:u.from>a))return u;let c=n==gt.ByPosNoHeight?gt.ByPosNoHeight:gt.ByPos;return l?u.join(this.right.lineAt(a,c,r,o,a)):this.left.lineAt(a,c,r,i,s).join(u)}forEachLine(e,n,r,i,s,o){let a=i+this.left.height,l=s+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,n,r,i,s,o),n>=l&&this.right.forEachLine(e,n,r,a,l,o);else{let u=this.lineAt(l,gt.ByPos,r,i,s);e<u.from&&this.left.forEachLine(e,u.from-1,r,i,s,o),u.to>=e&&u.from<=n&&o(u),n>u.to&&this.right.forEachLine(u.to+1,n,r,a,l,o)}}replace(e,n,r){let i=this.left.length+this.break;if(n<i)return this.balanced(this.left.replace(e,n,r),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-i,n-i,r));let s=[];e>0&&this.decomposeLeft(e,s);let o=s.length;for(let a of r)s.push(a);if(e>0&&HC(s,o-1),n<this.length){let a=s.length;this.decomposeRight(n,s),HC(s,a)}return Mn.of(s)}decomposeLeft(e,n){let r=this.left.length;if(e<=r)return this.left.decomposeLeft(e,n);n.push(this.left),this.break&&(r++,e>=r&&n.push(null)),e>r&&this.right.decomposeLeft(e-r,n)}decomposeRight(e,n){let r=this.left.length,i=r+this.break;if(e>=i)return this.right.decomposeRight(e-i,n);e<r&&this.left.decomposeRight(e,n),this.break&&e<i&&n.push(null),n.push(this.right)}balanced(e,n){return e.size>2*n.size||n.size>2*e.size?Mn.of(this.break?[e,null,n]:[e,n]):(this.left=e,this.right=n,this.height=e.height+n.height,this.outdated=e.outdated||n.outdated,this.size=e.size+n.size,this.length=e.length+this.break+n.length,this)}updateHeight(e,n=0,r=!1,i){let{left:s,right:o}=this,a=n+s.length+this.break,l=null;return i&&i.from<=n+s.length&&i.more?l=s=s.updateHeight(e,n,r,i):s.updateHeight(e,n,r),i&&i.from<=a+o.length&&i.more?l=o=o.updateHeight(e,a,r,i):o.updateHeight(e,a,r),l?this.balanced(s,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function HC(t,e){let n,r;t[e]==null&&(n=t[e-1])instanceof tn&&(r=t[e+1])instanceof tn&&t.splice(e-1,3,new tn(n.length+1+r.length))}const X9=5;class V1{constructor(e,n){this.pos=e,this.oracle=n,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,n){if(this.lineStart>-1){let r=Math.min(n,this.lineEnd),i=this.nodes[this.nodes.length-1];i instanceof cr?i.length+=r-this.pos:(r>this.pos||!this.isCovered)&&this.nodes.push(new cr(r-this.pos,-1)),this.writtenTo=r,n>r&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=n}point(e,n,r){if(e<n||r.heightRelevant){let i=r.widget?r.widget.estimatedHeight:0,s=r.widget?r.widget.lineBreaks:0;i<0&&(i=this.oracle.lineHeight);let o=n-e;r.block?this.addBlock(new wO(o,i,r)):(o||s||i>=X9)&&this.addLineDeco(i,s,o)}else n>e&&this.span(e,n);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:n}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=n,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new cr(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,n){let r=new tn(n-e);return this.oracle.doc.lineAt(e).to==n&&(r.flags|=4),r}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof cr)return e;let n=new cr(0,-1);return this.nodes.push(n),n}addBlock(e){var n;this.enterLine();let r=(n=e.deco)===null||n===void 0?void 0:n.type;r==Nt.WidgetAfter&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,r!=Nt.WidgetBefore&&(this.covering=e)}addLineDeco(e,n,r){let i=this.ensureLine();i.length+=r,i.collapsed+=r,i.widgetHeight=Math.max(i.widgetHeight,e),i.breaks+=n,this.writtenTo=this.pos=this.pos+r}finish(e){let n=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(n instanceof cr)&&!this.isCovered?this.nodes.push(new cr(0,-1)):(this.writtenTo<this.pos||n==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let r=e;for(let i of this.nodes)i instanceof cr&&i.updateHeight(this.oracle,r),r+=i?i.length:1;return this.nodes}static build(e,n,r,i){let s=new V1(r,e);return yt.spans(n,r,i,s,0),s.finish(r)}}function Z9(t,e,n){let r=new J9;return yt.compare(t,e,n,r,0),r.changes}class J9{constructor(){this.changes=[]}compareRange(){}comparePoint(e,n,r,i){(e<n||r&&r.heightRelevant||i&&i.heightRelevant)&&lw(e,n,this.changes,5)}}function Y9(t,e){let n=t.getBoundingClientRect(),r=t.ownerDocument,i=r.defaultView||window,s=Math.max(0,n.left),o=Math.min(i.innerWidth,n.right),a=Math.max(0,n.top),l=Math.min(i.innerHeight,n.bottom);for(let u=t.parentNode;u&&u!=r.body;)if(u.nodeType==1){let c=u,d=window.getComputedStyle(c);if((c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth)&&d.overflow!="visible"){let h=c.getBoundingClientRect();s=Math.max(s,h.left),o=Math.min(o,h.right),a=Math.max(a,h.top),l=u==t.parentNode?h.bottom:Math.min(l,h.bottom)}u=d.position=="absolute"||d.position=="fixed"?c.offsetParent:c.parentNode}else if(u.nodeType==11)u=u.host;else break;return{left:s-n.left,right:Math.max(s,o)-n.left,top:a-(n.top+e),bottom:Math.max(a,l)-(n.top+e)}}function q9(t,e){let n=t.getBoundingClientRect();return{left:0,right:n.right-n.left,top:e,bottom:n.bottom-(n.top+e)}}class D0{constructor(e,n,r){this.from=e,this.to=n,this.size=r}static same(e,n){if(e.length!=n.length)return!1;for(let r=0;r<e.length;r++){let i=e[r],s=n[r];if(i.from!=s.from||i.to!=s.to||i.size!=s.size)return!1}return!0}draw(e){return Ze.replace({widget:new Q9(this.size,e)}).range(this.from,this.to)}}class Q9 extends Xa{constructor(e,n){super(),this.size=e,this.vertical=n}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class WC{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=GC,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Tt.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let n=e.facet(F1).some(r=>typeof r!="function"&&r.class=="cm-lineWrapping");this.heightOracle=new W9(n),this.stateDeco=e.facet(Ed).filter(r=>typeof r!="function"),this.heightMap=Mn.empty().applyChanges(this.stateDeco,qe.empty,this.heightOracle.setDoc(e.doc),[new Fr(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Ze.set(this.lineGaps.map(r=>r.draw(!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:n}=this.state.selection;for(let r=0;r<=1;r++){let i=r?n.head:n.anchor;if(!e.some(({from:s,to:o})=>i>=s&&i<=o)){let{from:s,to:o}=this.lineBlockAt(i);e.push(new Hh(s,o))}}this.viewports=e.sort((r,i)=>r.from-i.from),this.scaler=this.heightMap.height<=7e6?GC:new nj(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:mc(e,this.scaler))})}update(e,n=null){this.state=e.state;let r=this.stateDeco;this.stateDeco=this.state.facet(Ed).filter(c=>typeof c!="function");let i=e.changedRanges,s=Fr.extendWithRanges(i,Z9(r,this.stateDeco,e?e.changes:Vt.empty(this.state.doc.length))),o=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),s),this.heightMap.height!=o&&(e.flags|=2),a?(this.scrollAnchorPos=e.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let l=s.length?this.mapViewport(this.viewport,e.changes):this.viewport;(n&&(n.range.head<l.from||n.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,n));let u=!e.changes.empty||e.flags&2||l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,this.updateForViewport(),u&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),n&&(this.scrollTarget=n),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(eO)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let n=e.contentDOM,r=window.getComputedStyle(n),i=this.heightOracle,s=r.whiteSpace;this.defaultTextDirection=r.direction=="rtl"?Tt.RTL:Tt.LTR;let o=this.heightOracle.mustRefreshForWrapping(s),a=n.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let u=0,c=0,d=parseInt(r.paddingTop)||0,h=parseInt(r.paddingBottom)||0;(this.paddingTop!=d||this.paddingBottom!=h)&&(this.paddingTop=d,this.paddingBottom=h,u|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(i.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,u|=8),this.scrollTop!=e.scrollDOM.scrollTop&&(this.scrollAnchorHeight=-1,this.scrollTop=e.scrollDOM.scrollTop),this.scrolledToBottom=IN(e.scrollDOM);let f=(this.printing?q9:Y9)(n,this.paddingTop),p=f.top-this.pixelViewport.top,g=f.bottom-this.pixelViewport.bottom;this.pixelViewport=f;let b=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(b!=this.inView&&(this.inView=b,b&&(l=!0)),!this.inView&&!this.scrollTarget)return 0;let y=a.width;if((this.contentDOMWidth!=y||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=a.width,this.editorHeight=e.scrollDOM.clientHeight,u|=8),l){let w=e.docView.measureVisibleLineHeights(this.viewport);if(i.mustRefreshForHeights(w)&&(o=!0),o||i.lineWrapping&&Math.abs(y-this.contentDOMWidth)>i.charWidth){let{lineHeight:S,charWidth:C,textHeight:E}=e.docView.measureTextSize();o=S>0&&i.refresh(s,S,C,E,y/C,w),o&&(e.docView.minWidth=0,u|=8)}p>0&&g>0?c=Math.max(p,g):p<0&&g<0&&(c=Math.min(p,g)),i.heightChanged=!1;for(let S of this.viewports){let C=S.from==this.viewport.from?w:e.docView.measureVisibleLineHeights(S);this.heightMap=(o?Mn.empty().applyChanges(this.stateDeco,qe.empty,this.heightOracle,[new Fr(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(i,0,o,new G9(S.from,C))}i.heightChanged&&(u|=2)}let v=!this.viewportIsAppropriate(this.viewport,c)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return v&&(this.viewport=this.getViewport(c,this.scrollTarget)),this.updateForViewport(),(u&2||v)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),u|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),u}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,n){let r=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),i=this.heightMap,s=this.heightOracle,{visibleTop:o,visibleBottom:a}=this,l=new Hh(i.lineAt(o-r*1e3,gt.ByHeight,s,0,0).from,i.lineAt(a+(1-r)*1e3,gt.ByHeight,s,0,0).to);if(n){let{head:u}=n.range;if(u<l.from||u>l.to){let c=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),d=i.lineAt(u,gt.ByPos,s,0,0),h;n.y=="center"?h=(d.top+d.bottom)/2-c/2:n.y=="start"||n.y=="nearest"&&u<l.from?h=d.top:h=d.bottom-c,l=new Hh(i.lineAt(h-1e3/2,gt.ByHeight,s,0,0).from,i.lineAt(h+c+1e3/2,gt.ByHeight,s,0,0).to)}}return l}mapViewport(e,n){let r=n.mapPos(e.from,-1),i=n.mapPos(e.to,1);return new Hh(this.heightMap.lineAt(r,gt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(i,gt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:n},r=0){if(!this.inView)return!0;let{top:i}=this.heightMap.lineAt(e,gt.ByPos,this.heightOracle,0,0),{bottom:s}=this.heightMap.lineAt(n,gt.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:a}=this;return(e==0||i<=o-Math.max(10,Math.min(-r,250)))&&(n==this.state.doc.length||s>=a+Math.max(10,Math.min(r,250)))&&i>o-2*1e3&&s<a+2*1e3}mapLineGaps(e,n){if(!e.length||n.empty)return e;let r=[];for(let i of e)n.touchesRange(i.from,i.to)||r.push(new D0(n.mapPos(i.from),n.mapPos(i.to),i.size));return r}ensureLineGaps(e,n){let r=this.heightOracle.lineWrapping,i=r?1e4:2e3,s=i>>1,o=i<<1;if(this.defaultTextDirection!=Tt.LTR&&!r)return[];let a=[],l=(u,c,d,h)=>{if(c-u<s)return;let f=this.state.selection.main,p=[f.from];f.empty||p.push(f.to);for(let b of p)if(b>u&&b<c){l(u,b-10,d,h),l(b+10,c,d,h);return}let g=tj(e,b=>b.from>=d.from&&b.to<=d.to&&Math.abs(b.from-u)<s&&Math.abs(b.to-c)<s&&!p.some(y=>b.from<y&&b.to>y));if(!g){if(c<d.to&&n&&r&&n.visibleRanges.some(b=>b.from<=c&&b.to>=c)){let b=n.moveToLineBoundary(te.cursor(c),!1,!0).head;b>u&&(c=b)}g=new D0(u,c,this.gapSize(d,u,c,h))}a.push(g)};for(let u of this.viewportLines){if(u.length<o)continue;let c=ej(u.from,u.to,this.stateDeco);if(c.total<o)continue;let d=this.scrollTarget?this.scrollTarget.range.head:null,h,f;if(r){let p=i/this.heightOracle.lineLength*this.heightOracle.lineHeight,g,b;if(d!=null){let y=Gh(c,d),v=((this.visibleBottom-this.visibleTop)/2+p)/u.height;g=y-v,b=y+v}else g=(this.visibleTop-u.top-p)/u.height,b=(this.visibleBottom-u.top+p)/u.height;h=Wh(c,g),f=Wh(c,b)}else{let p=c.total*this.heightOracle.charWidth,g=i*this.heightOracle.charWidth,b,y;if(d!=null){let v=Gh(c,d),w=((this.pixelViewport.right-this.pixelViewport.left)/2+g)/p;b=v-w,y=v+w}else b=(this.pixelViewport.left-g)/p,y=(this.pixelViewport.right+g)/p;h=Wh(c,b),f=Wh(c,y)}h>u.from&&l(u.from,h,u,c),f<u.to&&l(f,u.to,u,c)}return a}gapSize(e,n,r,i){let s=Gh(i,r)-Gh(i,n);return this.heightOracle.lineWrapping?e.height*s:i.total*this.heightOracle.charWidth*s}updateLineGaps(e){D0.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Ze.set(e.map(n=>n.draw(this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let n=[];yt.spans(e,this.viewport.from,this.viewport.to,{span(i,s){n.push({from:i,to:s})},point(){}},20);let r=n.length!=this.visibleRanges.length||this.visibleRanges.some((i,s)=>i.from!=n[s].from||i.to!=n[s].to);return this.visibleRanges=n,r?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(n=>n.from<=e&&n.to>=e)||mc(this.heightMap.lineAt(e,gt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return mc(this.heightMap.lineAt(this.scaler.fromDOM(e),gt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let n=this.lineBlockAtHeight(e+8);return n.from>=this.viewport.from||this.viewportLines[0].top-e>200?n:this.viewportLines[0]}elementAtHeight(e){return mc(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Hh{constructor(e,n){this.from=e,this.to=n}}function ej(t,e,n){let r=[],i=t,s=0;return yt.spans(n,t,e,{span(){},point(o,a){o>i&&(r.push({from:i,to:o}),s+=o-i),i=a}},20),i<e&&(r.push({from:i,to:e}),s+=e-i),{total:s,ranges:r}}function Wh({total:t,ranges:e},n){if(n<=0)return e[0].from;if(n>=1)return e[e.length-1].to;let r=Math.floor(t*n);for(let i=0;;i++){let{from:s,to:o}=e[i],a=o-s;if(r<=a)return s+r;r-=a}}function Gh(t,e){let n=0;for(let{from:r,to:i}of t.ranges){if(e<=i){n+=e-r;break}n+=i-r}return n/t.total}function tj(t,e){for(let n of t)if(e(n))return n}const GC={toDOM(t){return t},fromDOM(t){return t},scale:1};class nj{constructor(e,n,r){let i=0,s=0,o=0;this.viewports=r.map(({from:a,to:l})=>{let u=n.lineAt(a,gt.ByPos,e,0,0).top,c=n.lineAt(l,gt.ByPos,e,0,0).bottom;return i+=c-u,{from:a,to:l,top:u,bottom:c,domTop:0,domBottom:0}}),this.scale=(7e6-i)/(n.height-i);for(let a of this.viewports)a.domTop=o+(a.top-s)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),s=a.bottom}toDOM(e){for(let n=0,r=0,i=0;;n++){let s=n<this.viewports.length?this.viewports[n]:null;if(!s||e<s.top)return i+(e-r)*this.scale;if(e<=s.bottom)return s.domTop+(e-s.top);r=s.bottom,i=s.domBottom}}fromDOM(e){for(let n=0,r=0,i=0;;n++){let s=n<this.viewports.length?this.viewports[n]:null;if(!s||e<s.domTop)return r+(e-i)/this.scale;if(e<=s.domBottom)return s.top+(e-s.domTop);r=s.bottom,i=s.domBottom}}}function mc(t,e){if(e.scale==1)return t;let n=e.toDOM(t.top),r=e.toDOM(t.bottom);return new Bi(t.from,t.length,n,r-n,Array.isArray(t._content)?t._content.map(i=>mc(i,e)):t._content)}const Kh=Se.define({combine:t=>t.join(" ")}),gw=Se.define({combine:t=>t.indexOf(!0)>-1}),yw=Do.newName(),bO=Do.newName(),xO=Do.newName(),SO={"&light":"."+bO,"&dark":"."+xO};function vw(t,e,n){return new Do(e,{finish(r){return/&/.test(r)?r.replace(/&\w*/,i=>{if(i=="&")return t;if(!n||!n[i])throw new RangeError(`Unsupported selector: ${i}`);return n[i]}):t+" "+r}})}const rj=vw("."+yw,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},SO);class ij{constructor(e,n,r,i){this.typeOver=i,this.bounds=null,this.text="";let{impreciseHead:s,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&n>-1)this.newSel=null;else if(n>-1&&(this.bounds=e.docView.domBoundsAround(n,r,0))){let a=s||o?[]:oj(e),l=new zN(a,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=aj(a,this.bounds.from)}else{let a=e.observer.selectionRange,l=s&&s.node==a.focusNode&&s.offset==a.focusOffset||!nw(e.contentDOM,a.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(a.focusNode,a.focusOffset),u=o&&o.node==a.anchorNode&&o.offset==a.anchorOffset||!nw(e.contentDOM,a.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(a.anchorNode,a.anchorOffset);this.newSel=te.single(u,l)}}}function kO(t,e){let n,{newSel:r}=e,i=t.state.selection.main,s=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:a}=e.bounds,l=i.from,u=null;(s===8||ke.android&&e.text.length<a-o)&&(l=i.to,u="end");let c=sj(t.state.doc.sliceString(o,a,Cl),e.text,l-o,u);c&&(ke.chrome&&s==13&&c.toB==c.from+2&&e.text.slice(c.from,c.toB)==Cl+Cl&&c.toB--,n={from:o+c.from,to:o+c.toA,insert:qe.of(e.text.slice(c.from,c.toB).split(Cl))})}else r&&(!t.hasFocus&&t.state.facet(hg)||r.main.eq(i))&&(r=null);if(!n&&!r)return!1;if(!n&&e.typeOver&&!i.empty&&r&&r.main.empty?n={from:i.from,to:i.to,insert:t.state.doc.slice(i.from,i.to)}:n&&n.from>=i.from&&n.to<=i.to&&(n.from!=i.from||n.to!=i.to)&&i.to-i.from-(n.to-n.from)<=4?n={from:i.from,to:i.to,insert:t.state.doc.slice(i.from,n.from).append(n.insert).append(t.state.doc.slice(n.to,i.to))}:(ke.mac||ke.android)&&n&&n.from==n.to&&n.from==i.head-1&&/^\. ?$/.test(n.insert.toString())&&t.contentDOM.getAttribute("autocorrect")=="off"?(r&&n.insert.length==2&&(r=te.single(r.main.anchor-1,r.main.head-1)),n={from:i.from,to:i.to,insert:qe.of([" "])}):ke.chrome&&n&&n.from==n.to&&n.from==i.head&&n.insert.toString()==`
 `&&t.lineWrapping&&(r&&(r=te.single(r.main.anchor-1,r.main.head-1)),n={from:i.from,to:i.to,insert:qe.of([" "])}),n){let o=t.state;if(ke.ios&&t.inputState.flushIOSKey(t)||ke.android&&(n.from==i.from&&n.to==i.to&&n.insert.length==1&&n.insert.lines==2&&jl(t.contentDOM,"Enter",13)||(n.from==i.from-1&&n.to==i.to&&n.insert.length==0||s==8&&n.insert.length<n.to-n.from)&&jl(t.contentDOM,"Backspace",8)||n.from==i.from&&n.to==i.to+1&&n.insert.length==0&&jl(t.contentDOM,"Delete",46)))return!0;let a=n.insert.toString();if(t.state.facet(YN).some(c=>c(t,n.from,n.to,a)))return!0;t.inputState.composing>=0&&t.inputState.composing++;let l;if(n.from>=i.from&&n.to<=i.to&&n.to-n.from>=(i.to-i.from)/3&&(!r||r.main.empty&&r.main.from==n.from+n.insert.length)&&t.inputState.composing<0){let c=i.from<n.from?o.sliceDoc(i.from,n.from):"",d=i.to>n.to?o.sliceDoc(n.to,i.to):"";l=o.replaceSelection(t.state.toText(c+n.insert.sliceString(0,void 0,t.state.lineBreak)+d))}else{let c=o.changes(n),d=r&&r.main.to<=c.newLength?r.main:void 0;if(o.selection.ranges.length>1&&t.inputState.composing>=0&&n.to<=i.to&&n.to>=i.to-10){let h=t.state.sliceDoc(n.from,n.to),f=aO(t)||t.state.doc.lineAt(i.head),p=i.to-n.to,g=i.to-i.from;l=o.changeByRange(b=>{if(b.from==i.from&&b.to==i.to)return{changes:c,range:d||b.map(c)};let y=b.to-p,v=y-h.length;if(b.to-b.from!=g||t.state.sliceDoc(v,y)!=h||f&&b.to>=f.from&&b.from<=f.to)return{range:b};let w=o.changes({from:v,to:y,insert:n.insert}),S=b.to-i.to;return{changes:w,range:d?te.range(Math.max(0,d.anchor+S),Math.max(0,d.head+S)):b.map(w)}})}else l={changes:c,selection:d&&o.selection.replaceRange(d)}}let u="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,u+=".compose",t.inputState.compositionFirstChange&&(u+=".start",t.inputState.compositionFirstChange=!1)),t.dispatch(l,{scrollIntoView:!0,userEvent:u}),!0}else if(r&&!r.main.eq(i)){let o=!1,a="select";return t.inputState.lastSelectionTime>Date.now()-50&&(t.inputState.lastSelectionOrigin=="select"&&(o=!0),a=t.inputState.lastSelectionOrigin),t.dispatch({selection:r,scrollIntoView:o,userEvent:a}),!0}else return!1}function sj(t,e,n,r){let i=Math.min(t.length,e.length),s=0;for(;s<i&&t.charCodeAt(s)==e.charCodeAt(s);)s++;if(s==i&&t.length==e.length)return null;let o=t.length,a=e.length;for(;o>0&&a>0&&t.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;if(r=="end"){let l=Math.max(0,s-Math.min(o,a));n-=o+l-s}if(o<s&&t.length<e.length){let l=n<=s&&n>=o?s-n:0;s-=l,a=s+(a-o),o=s}else if(a<s){let l=n<=s&&n>=a?s-n:0;s-=l,o=s+(o-a),a=s}return{from:s,toA:o,toB:a}}function oj(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:s}=t.observer.selectionRange;return n&&(e.push(new xC(n,r)),(i!=n||s!=r)&&e.push(new xC(i,s))),e}function aj(t,e){if(t.length==0)return null;let n=t[0].pos,r=t.length==2?t[1].pos:n;return n>-1&&r>-1?te.single(n+e,r+e):null}const lj={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},I0=ke.ie&&ke.ie_version<=11;class uj{constructor(e){this.view=e,this.active=!1,this.selectionRange=new t9,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.resizeContent=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(n=>{for(let r of n)this.queue.push(r);(ke.ie&&ke.ie_version<=11||ke.ios&&e.composing)&&n.some(r=>r.type=="childList"&&r.removedNodes.length||r.type=="characterData"&&r.oldValue.length>r.target.nodeValue.length)?this.flushSoon():this.flush()}),I0&&(this.onCharData=n=>{this.queue.push({target:n.target,type:"characterData",oldValue:n.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var n;((n=this.view.docView)===null||n===void 0?void 0:n.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM),this.resizeContent=new ResizeObserver(()=>this.view.requestMeasure()),this.resizeContent.observe(e.contentDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(n=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),n.length>0&&n[n.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(n=>{n.length>0&&n[n.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runScrollHandlers(this.view,e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((n,r)=>n!=e[r]))){this.gapIntersection.disconnect();for(let n of e)this.gapIntersection.observe(n);this.gaps=e}}onSelectionChange(e){let n=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:r}=this,i=this.selectionRange;if(r.state.facet(hg)?r.root.activeElement!=this.dom:!Uf(r.dom,i))return;let s=i.anchorNode&&r.docView.nearest(i.anchorNode);if(s&&s.ignoreEvent(e)){n||(this.selectionChanged=!1);return}(ke.ie&&ke.ie_version<=11||ke.android&&ke.chrome)&&!r.state.selection.main.empty&&i.focusNode&&Yp(i.focusNode,i.focusOffset,i.anchorNode,i.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,n=ke.safari&&e.root.nodeType==11&&Y7(this.dom.ownerDocument)==this.dom&&cj(this.view)||Jp(e.root);if(!n||this.selectionRange.eq(n))return!1;let r=Uf(this.dom,n);return r&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&r9(this.dom,n)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(n),r&&(this.selectionChanged=!0),!0)}setSelectionRange(e,n){this.selectionRange.set(e.node,e.offset,n.node,n.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,n=null;for(let r=this.dom;r;)if(r.nodeType==1)!n&&e<this.scrollTargets.length&&this.scrollTargets[e]==r?e++:n||(n=this.scrollTargets.slice(0,e)),n&&n.push(r),r=r.assignedSlot||r.parentNode;else if(r.nodeType==11)r=r.host;else break;if(e<this.scrollTargets.length&&!n&&(n=this.scrollTargets.slice(0,e)),n){for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);for(let r of this.scrollTargets=n)r.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,lj),I0&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),I0&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,n){var r;if(!this.delayedAndroidKey){let i=()=>{let s=this.delayedAndroidKey;s&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=s.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&s.force&&jl(this.dom,s.key,s.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(i)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:n,force:this.lastChange<Date.now()-50||!!(!((r=this.delayedAndroidKey)===null||r===void 0)&&r.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let n=-1,r=-1,i=!1;for(let s of e){let o=this.readMutation(s);o&&(o.typeOver&&(i=!0),n==-1?{from:n,to:r}=o:(n=Math.min(o.from,n),r=Math.max(o.to,r)))}return{from:n,to:r,typeOver:i}}readChange(){let{from:e,to:n,typeOver:r}=this.processRecords(),i=this.selectionChanged&&Uf(this.dom,this.selectionRange);return e<0&&!i?null:(e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1,new ij(this.view,e,n,r))}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let n=this.readChange();if(!n)return!1;let r=this.view.state,i=kO(this.view,n);return this.view.state==r&&this.view.update([]),i}readMutation(e){let n=this.view.docView.nearest(e.target);if(!n||n.ignoreMutation(e))return null;if(n.markDirty(e.type=="attributes"),e.type=="attributes"&&(n.flags|=4),e.type=="childList"){let r=KC(n,e.previousSibling||e.target.previousSibling,-1),i=KC(n,e.nextSibling||e.target.nextSibling,1);return{from:r?n.posAfter(r):n.posAtStart,to:i?n.posBefore(i):n.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,n,r,i;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(n=this.gapIntersection)===null||n===void 0||n.disconnect(),(r=this.resizeScroll)===null||r===void 0||r.disconnect(),(i=this.resizeContent)===null||i===void 0||i.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function KC(t,e,n){for(;e;){let r=ht.get(e);if(r&&r.parent==t)return r;let i=e.parentNode;e=i!=t.dom?i:n>0?e.nextSibling:e.previousSibling}return null}function cj(t){let e=null;function n(l){l.preventDefault(),l.stopImmediatePropagation(),e=l.getTargetRanges()[0]}if(t.contentDOM.addEventListener("beforeinput",n,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",n,!0),!e)return null;let r=e.startContainer,i=e.startOffset,s=e.endContainer,o=e.endOffset,a=t.docView.domAtPos(t.state.selection.main.anchor);return Yp(a.node,a.offset,s,o)&&([r,i,s,o]=[s,o,r,i]),{anchorNode:r,anchorOffset:i,focusNode:s,focusOffset:o}}class Ae{constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.style.cssText="position: fixed; top: -10000px",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),this._dispatch=e.dispatch||(n=>this.update([n])),this.dispatch=this.dispatch.bind(this),this._root=e.root||n9(e.parent)||document,this.viewState=new WC(e.state||Ue.create(e)),this.plugins=this.state.facet(fc).map(n=>new _0(n));for(let n of this.plugins)n.update(this);this.observer=new uj(this),this.inputState=new O9(this),this.inputState.ensureHandlers(this,this.plugins),this.docView=new TC(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),e.parent&&e.parent.appendChild(this.dom)}get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}dispatch(...e){let n=e.length==1&&e[0]instanceof Gt?e[0]:this.state.update(...e);this._dispatch(n,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let n=!1,r=!1,i,s=this.state;for(let h of e){if(h.startState!=s)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");s=h.state}if(this.destroyed){this.viewState.state=s;return}let o=this.hasFocus,a=0,l=null;e.some(h=>h.annotation(gO))?(this.inputState.notifiedFocused=o,a=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=yO(s,o),l||(a=1));let u=this.observer.delayedAndroidKey,c=null;if(u?(this.observer.clearDelayedAndroidKey(),c=this.observer.readChange(),(c&&!this.state.doc.eq(s.doc)||!this.state.selection.eq(s.selection))&&(c=null)):this.observer.clear(),s.facet(Ue.phrases)!=this.state.facet(Ue.phrases))return this.setState(s);i=em.create(this,s,e),i.flags|=a;let d=this.viewState.scrollTarget;try{this.updateState=2;for(let h of e){if(d&&(d=d.map(h.changes)),h.scrollIntoView){let{main:f}=h.state.selection;d=new Qp(f.empty?f:te.cursor(f.head,f.head>f.anchor?-1:1))}for(let f of h.effects)f.is(PC)&&(d=f.value)}this.viewState.update(i,d),this.bidiCache=tm.update(this.bidiCache,i.changes),i.empty||(this.updatePlugins(i),this.inputState.update(i)),n=this.docView.update(i),this.state.facet(pc)!=this.styleModules&&this.mountStyles(),r=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(n,e.some(h=>h.isUserEvent("select.pointer")))}finally{this.updateState=0}if(i.startState.facet(Kh)!=i.state.facet(Kh)&&(this.viewState.mustMeasureContent=!0),(n||r||d||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!i.empty)for(let h of this.state.facet(uw))h(i);(l||c)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),c&&!kO(this,c)&&u.force&&jl(this.contentDOM,u.key,u.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let n=this.hasFocus;try{for(let r of this.plugins)r.destroy(this);this.viewState=new WC(e),this.plugins=e.facet(fc).map(r=>new _0(r)),this.pluginMap.clear();for(let r of this.plugins)r.update(this);this.docView=new TC(this),this.inputState.ensureHandlers(this,this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}n&&this.focus(),this.requestMeasure()}updatePlugins(e){let n=e.startState.facet(fc),r=e.state.facet(fc);if(n!=r){let i=[];for(let s of r){let o=n.indexOf(s);if(o<0)i.push(new _0(s));else{let a=this.plugins[o];a.mustUpdate=e,i.push(a)}}for(let s of this.plugins)s.mustUpdate!=e&&s.destroy(this);this.plugins=i,this.pluginMap.clear(),this.inputState.ensureHandlers(this,this.plugins)}else for(let i of this.plugins)i.mustUpdate=e;for(let i=0;i<this.plugins.length;i++)this.plugins[i].update(this)}measure(e=!0){if(this.destroyed)return;this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.measureScheduled=0,e&&this.observer.forceFlush();let n=null,r=this.scrollDOM,{scrollTop:i}=r,{scrollAnchorPos:s,scrollAnchorHeight:o}=this.viewState;i!=this.viewState.scrollTop&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let a=0;;a++){if(o<0)if(IN(r))s=-1,o=this.viewState.heightMap.height;else{let f=this.viewState.scrollAnchorAt(i);s=f.from,o=f.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let u=[];l&4||([this.measureRequests,u]=[u,this.measureRequests]);let c=u.map(f=>{try{return f.read(this)}catch(p){return zr(this.state,p),XC}}),d=em.create(this,this.state,[]),h=!1;d.flags|=l,n?n.flags|=l:n=d,this.updateState=2,d.empty||(this.updatePlugins(d),this.inputState.update(d),this.updateAttrs(),h=this.docView.update(d));for(let f=0;f<u.length;f++)if(c[f]!=XC)try{let p=u[f];p.write&&p.write(c[f],this)}catch(p){zr(this.state,p)}if(h&&this.docView.updateSelection(!0),!d.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null;continue}else{let p=(s<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(s).top)-o;if(p>1||p<-1){i=r.scrollTop=i+p,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(n&&!n.empty)for(let a of this.state.facet(uw))a(n)}get themeClasses(){return yw+" "+(this.state.facet(gw)?xO:bO)+" "+this.state.facet(Kh)}updateAttrs(){let e=ZC(this,tO,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),n={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(hg)?"true":"false",class:"cm-content",style:`${ke.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(n["aria-readonly"]="true"),ZC(this,F1,n);let r=this.observer.ignore(()=>{let i=aw(this.contentDOM,this.contentAttrs,n),s=aw(this.dom,this.editorAttrs,e);return i||s});return this.editorAttrs=e,this.contentAttrs=n,r}showAnnouncements(e){let n=!0;for(let r of e)for(let i of r.effects)if(i.is(Ae.announce)){n&&(this.announceDOM.textContent=""),n=!1;let s=this.announceDOM.appendChild(document.createElement("div"));s.textContent=i.value}}mountStyles(){this.styleModules=this.state.facet(pc),Do.mount(this.root,this.styleModules.concat(rj).reverse())}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let n=0;n<this.measureRequests.length;n++)if(this.measureRequests[n].key===e.key){this.measureRequests[n]=e;return}}this.measureRequests.push(e)}}plugin(e){let n=this.pluginMap.get(e);return(n===void 0||n&&n.spec!=e)&&this.pluginMap.set(e,n=this.plugins.find(r=>r.spec==e)||null),n&&n.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,n,r){return M0(this,e,MC(this,e,n,r))}moveByGroup(e,n){return M0(this,e,MC(this,e,n,r=>$9(this,e.head,r)))}moveToLineBoundary(e,n,r=!0){return T9(this,e,n,r)}moveVertically(e,n,r){return M0(this,e,N9(this,e,n,r))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,n=0){return this.docView.posFromDOM(e,n)}posAtCoords(e,n=!0){return this.readMeasured(),uO(this,e,n)}coordsAtPos(e,n=1){this.readMeasured();let r=this.docView.coordsAt(e,n);if(!r||r.left==r.right)return r;let i=this.state.doc.lineAt(e),s=this.bidiSpans(i),o=s[zl.find(s,e-i.from,-1,n)];return B1(r,o.dir==Tt.LTR==n>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(QN)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>dj)return sO(e.length);let n=this.textDirectionAt(e.from);for(let i of this.bidiCache)if(i.from==e.from&&i.dir==n)return i.order;let r=m9(e.text,n);return this.bidiCache.push(new tm(e.from,e.to,n,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||ke.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{MN(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,n={}){return PC.of(new Qp(typeof e=="number"?te.cursor(e):e,n.y,n.x,n.yMargin,n.xMargin))}static domEventHandlers(e){return hn.define(()=>({}),{eventHandlers:e})}static theme(e,n){let r=Do.newName(),i=[Kh.of(r),pc.of(vw(`.${r}`,e))];return n&&n.dark&&i.push(gw.of(!0)),i}static baseTheme(e){return qd.lowest(pc.of(vw("."+yw,e,SO)))}static findFromDOM(e){var n;let r=e.querySelector(".cm-content"),i=r&&ht.get(r)||ht.get(e);return((n=i==null?void 0:i.rootView)===null||n===void 0?void 0:n.view)||null}}Ae.styleModule=pc;Ae.inputHandler=YN;Ae.focusChangeEffect=qN;Ae.perLineTextDirection=QN;Ae.exceptionSink=JN;Ae.updateListener=uw;Ae.editable=hg;Ae.mouseSelectionStyle=ZN;Ae.dragMovesSelection=XN;Ae.clickAddsSelectionRange=KN;Ae.decorations=Ed;Ae.atomicRanges=U1;Ae.scrollMargins=nO;Ae.darkTheme=gw;Ae.contentAttributes=F1;Ae.editorAttributes=tO;Ae.lineWrapping=Ae.contentAttributes.of({class:"cm-lineWrapping"});Ae.announce=ze.define();const dj=4096,XC={};class tm{constructor(e,n,r,i){this.from=e,this.to=n,this.dir=r,this.order=i}static update(e,n){if(n.empty)return e;let r=[],i=e.length?e[e.length-1].dir:Tt.LTR;for(let s=Math.max(0,e.length-10);s<e.length;s++){let o=e[s];o.dir==i&&!n.touchesRange(o.from,o.to)&&r.push(new tm(n.mapPos(o.from,1),n.mapPos(o.to,-1),o.dir,o.order))}return r}}function ZC(t,e,n){for(let r=t.state.facet(e),i=r.length-1;i>=0;i--){let s=r[i],o=typeof s=="function"?s(t):s;o&&ow(o,n)}return n}const hj=ke.mac?"mac":ke.windows?"win":ke.linux?"linux":"key";function fj(t,e){const n=t.split(/-(?!$)/);let r=n[n.length-1];r=="Space"&&(r=" ");let i,s,o,a;for(let l=0;l<n.length-1;++l){const u=n[l];if(/^(cmd|meta|m)$/i.test(u))a=!0;else if(/^a(lt)?$/i.test(u))i=!0;else if(/^(c|ctrl|control)$/i.test(u))s=!0;else if(/^s(hift)?$/i.test(u))o=!0;else if(/^mod$/i.test(u))e=="mac"?a=!0:s=!0;else throw new Error("Unrecognized modifier name: "+u)}return i&&(r="Alt-"+r),s&&(r="Ctrl-"+r),a&&(r="Meta-"+r),o&&(r="Shift-"+r),r}function Xh(t,e,n){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),n!==!1&&e.shiftKey&&(t="Shift-"+t),t}const pj=qd.default(Ae.domEventHandlers({keydown(t,e){return AO(EO(e.state),t,e,"editor")}})),CO=Se.define({enables:pj}),JC=new WeakMap;function EO(t){let e=t.facet(CO),n=JC.get(e);return n||JC.set(e,n=yj(e.reduce((r,i)=>r.concat(i),[]))),n}function mj(t,e,n){return AO(EO(t.state),e,t,n)}let no=null;const gj=4e3;function yj(t,e=hj){let n=Object.create(null),r=Object.create(null),i=(o,a)=>{let l=r[o];if(l==null)r[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},s=(o,a,l,u,c)=>{var d,h;let f=n[o]||(n[o]=Object.create(null)),p=a.split(/ (?!$)/).map(y=>fj(y,e));for(let y=1;y<p.length;y++){let v=p.slice(0,y).join(" ");i(v,!0),f[v]||(f[v]={preventDefault:!0,stopPropagation:!1,run:[w=>{let S=no={view:w,prefix:v,scope:o};return setTimeout(()=>{no==S&&(no=null)},gj),!0}]})}let g=p.join(" ");i(g,!1);let b=f[g]||(f[g]={preventDefault:!1,stopPropagation:!1,run:((h=(d=f._any)===null||d===void 0?void 0:d.run)===null||h===void 0?void 0:h.slice())||[]});l&&b.run.push(l),u&&(b.preventDefault=!0),c&&(b.stopPropagation=!0)};for(let o of t){let a=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let u of a){let c=n[u]||(n[u]=Object.create(null));c._any||(c._any={preventDefault:!1,stopPropagation:!1,run:[]});for(let d in c)c[d].run.push(o.any)}let l=o[e]||o.key;if(l)for(let u of a)s(u,l,o.run,o.preventDefault,o.stopPropagation),o.shift&&s(u,"Shift-"+l,o.shift,o.preventDefault,o.stopPropagation)}return n}function AO(t,e,n,r){let i=J7(e),s=$n(i,0),o=ii(s)==i.length&&i!=" ",a="",l=!1,u=!1,c=!1;no&&no.view==n&&no.scope==r&&(a=no.prefix+" ",dO.indexOf(e.keyCode)<0&&(u=!0,no=null));let d=new Set,h=b=>{if(b){for(let y of b.run)if(!d.has(y)&&(d.add(y),y(n,e)))return b.stopPropagation&&(c=!0),!0;b.preventDefault&&(b.stopPropagation&&(c=!0),u=!0)}return!1},f=t[r],p,g;return f&&(h(f[a+Xh(i,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(ke.windows&&e.ctrlKey&&e.altKey)&&(p=Io[e.keyCode])&&p!=i?(h(f[a+Xh(p,e,!0)])||e.shiftKey&&(g=kd[e.keyCode])!=i&&g!=p&&h(f[a+Xh(g,e,!1)]))&&(l=!0):o&&e.shiftKey&&h(f[a+Xh(i,e,!0)])&&(l=!0),!l&&h(f._any)&&(l=!0)),u&&(l=!0),l&&c&&e.stopPropagation(),l}class nh{constructor(e,n,r,i,s){this.className=e,this.left=n,this.top=r,this.width=i,this.height=s}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,n){return n.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,n,r){if(r.empty){let i=e.coordsAtPos(r.head,r.assoc||1);if(!i)return[];let s=PO(e);return[new nh(n,i.left-s.left,i.top-s.top,null,i.bottom-i.top)]}else return vj(e,n,r)}}function PO(t){let e=t.scrollDOM.getBoundingClientRect();return{left:(t.textDirection==Tt.LTR?e.left:e.right-t.scrollDOM.clientWidth)-t.scrollDOM.scrollLeft,top:e.top-t.scrollDOM.scrollTop}}function YC(t,e,n){let r=te.cursor(e);return{from:Math.max(n.from,t.moveToLineBoundary(r,!1,!0).from),to:Math.min(n.to,t.moveToLineBoundary(r,!0,!0).from),type:Nt.Text}}function vj(t,e,n){if(n.to<=t.viewport.from||n.from>=t.viewport.to)return[];let r=Math.max(n.from,t.viewport.from),i=Math.min(n.to,t.viewport.to),s=t.textDirection==Tt.LTR,o=t.contentDOM,a=o.getBoundingClientRect(),l=PO(t),u=o.querySelector(".cm-line"),c=u&&window.getComputedStyle(u),d=a.left+(c?parseInt(c.paddingLeft)+Math.min(0,parseInt(c.textIndent)):0),h=a.right-(c?parseInt(c.paddingRight):0),f=fw(t,r),p=fw(t,i),g=f.type==Nt.Text?f:null,b=p.type==Nt.Text?p:null;if(g&&(t.lineWrapping||f.widgetLineBreaks)&&(g=YC(t,r,g)),b&&(t.lineWrapping||p.widgetLineBreaks)&&(b=YC(t,i,b)),g&&b&&g.from==b.from)return v(w(n.from,n.to,g));{let C=g?w(n.from,null,g):S(f,!1),E=b?w(null,n.to,b):S(p,!0),T=[];return(g||f).to<(b||p).from-(g&&b?1:0)||f.widgetLineBreaks>1&&C.bottom+t.defaultLineHeight/2<E.top?T.push(y(d,C.bottom,h,E.top)):C.bottom<E.top&&t.elementAtHeight((C.bottom+E.top)/2).type==Nt.Text&&(C.bottom=E.top=(C.bottom+E.top)/2),v(C).concat(T).concat(v(E))}function y(C,E,T,A){return new nh(e,C-l.left,E-l.top-.01,T-C,A-E+.01)}function v({top:C,bottom:E,horizontal:T}){let A=[];for(let N=0;N<T.length;N+=2)A.push(y(T[N],C,T[N+1],E));return A}function w(C,E,T){let A=1e9,N=-1e9,R=[];function O(I,G,K,ee,F){let _=t.coordsAtPos(I,I==T.to?-2:2),V=t.coordsAtPos(K,K==T.from?2:-2);!_||!V||(A=Math.min(_.top,V.top,A),N=Math.max(_.bottom,V.bottom,N),F==Tt.LTR?R.push(s&&G?d:_.left,s&&ee?h:V.right):R.push(!s&&ee?d:V.left,!s&&G?h:_.right))}let j=C??T.from,z=E??T.to;for(let I of t.visibleRanges)if(I.to>j&&I.from<z)for(let G=Math.max(I.from,j),K=Math.min(I.to,z);;){let ee=t.state.doc.lineAt(G);for(let F of t.bidiSpans(ee)){let _=F.from+ee.from,V=F.to+ee.from;if(_>=K)break;V>G&&O(Math.max(_,G),C==null&&_<=j,Math.min(V,K),E==null&&V>=z,F.dir)}if(G=ee.to+1,G>=K)break}return R.length==0&&O(j,C==null,z,E==null,t.textDirection),{top:A,bottom:N,horizontal:R}}function S(C,E){let T=a.top+(E?C.top:C.bottom);return{top:T,bottom:T,horizontal:[]}}}function wj(t,e){return t.constructor==e.constructor&&t.eq(e)}class bj{constructor(e,n){this.view=e,this.layer=n,this.drawn=[],this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),n.above&&this.dom.classList.add("cm-layer-above"),n.class&&this.dom.classList.add(n.class),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),n.mount&&n.mount(this.dom,e)}update(e){e.startState.facet(Wf)!=e.state.facet(Wf)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&e.view.requestMeasure(this.measureReq)}setOrder(e){let n=0,r=e.facet(Wf);for(;n<r.length&&r[n]!=this.layer;)n++;this.dom.style.zIndex=String((this.layer.above?150:-1)-n)}measure(){return this.layer.markers(this.view)}draw(e){if(e.length!=this.drawn.length||e.some((n,r)=>!wj(n,this.drawn[r]))){let n=this.dom.firstChild,r=0;for(let i of e)i.update&&n&&i.constructor&&this.drawn[r].constructor&&i.update(n,this.drawn[r])?(n=n.nextSibling,r++):this.dom.insertBefore(i.draw(),n);for(;n;){let i=n.nextSibling;n.remove(),n=i}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Wf=Se.define();function TO(t){return[hn.define(e=>new bj(e,t)),Wf.of(t)]}const $O=!ke.ios,Ad=Se.define({combine(t){return Wo(t,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,n)=>Math.min(e,n),drawRangeCursor:(e,n)=>e||n})}});function xj(t={}){return[Ad.of(t),Sj,kj,Cj,eO.of(!0)]}function NO(t){return t.startState.facet(Ad)!=t.state.facet(Ad)}const Sj=TO({above:!0,markers(t){let{state:e}=t,n=e.facet(Ad),r=[];for(let i of e.selection.ranges){let s=i==e.selection.main;if(i.empty?!s||$O:n.drawRangeCursor){let o=s?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",a=i.empty?i:te.cursor(i.head,i.head>i.anchor?-1:1);for(let l of nh.forRange(t,o,a))r.push(l)}}return r},update(t,e){t.transactions.some(r=>r.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let n=NO(t);return n&&qC(t.state,e),t.docChanged||t.selectionSet||n},mount(t,e){qC(e.state,t)},class:"cm-cursorLayer"});function qC(t,e){e.style.animationDuration=t.facet(Ad).cursorBlinkRate+"ms"}const kj=TO({above:!1,markers(t){return t.state.selection.ranges.map(e=>e.empty?[]:nh.forRange(t,"cm-selectionBackground",e)).reduce((e,n)=>e.concat(n))},update(t,e){return t.docChanged||t.selectionSet||t.viewportChanged||NO(t)},class:"cm-selectionLayer"}),OO={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};$O&&(OO[".cm-line"].caretColor="transparent !important");const Cj=qd.highest(Ae.theme(OO));function QC(t,e,n,r,i){e.lastIndex=0;for(let s=t.iterRange(n,r),o=n,a;!s.next().done;o+=s.value.length)if(!s.lineBreak)for(;a=e.exec(s.value);)i(o+a.index,a)}function Ej(t,e){let n=t.visibleRanges;if(n.length==1&&n[0].from==t.viewport.from&&n[0].to==t.viewport.to)return n;let r=[];for(let{from:i,to:s}of n)i=Math.max(t.state.doc.lineAt(i).from,i-e),s=Math.min(t.state.doc.lineAt(s).to,s+e),r.length&&r[r.length-1].to>=i?r[r.length-1].to=s:r.push({from:i,to:s});return r}class Aj{constructor(e){const{regexp:n,decoration:r,decorate:i,boundary:s,maxLength:o=1e3}=e;if(!n.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=n,i)this.addMatch=(a,l,u,c)=>i(c,u,u+a[0].length,a,l);else if(typeof r=="function")this.addMatch=(a,l,u,c)=>{let d=r(a,l,u);d&&c(u,u+a[0].length,d)};else if(r)this.addMatch=(a,l,u,c)=>c(u,u+a[0].length,r);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=s,this.maxLength=o}createDeco(e){let n=new ja,r=n.add.bind(n);for(let{from:i,to:s}of Ej(e,this.maxLength))QC(e.state.doc,this.regexp,i,s,(o,a)=>this.addMatch(a,e,o,r));return n.finish()}updateDeco(e,n){let r=1e9,i=-1;return e.docChanged&&e.changes.iterChanges((s,o,a,l)=>{l>e.view.viewport.from&&a<e.view.viewport.to&&(r=Math.min(a,r),i=Math.max(l,i))}),e.viewportChanged||i-r>1e3?this.createDeco(e.view):i>-1?this.updateRange(e.view,n.map(e.changes),r,i):n}updateRange(e,n,r,i){for(let s of e.visibleRanges){let o=Math.max(s.from,r),a=Math.min(s.to,i);if(a>o){let l=e.state.doc.lineAt(o),u=l.to<a?e.state.doc.lineAt(a):l,c=Math.max(s.from,l.from),d=Math.min(s.to,u.to);if(this.boundary){for(;o>l.from;o--)if(this.boundary.test(l.text[o-1-l.from])){c=o;break}for(;a<u.to;a++)if(this.boundary.test(u.text[a-u.from])){d=a;break}}let h=[],f,p=(g,b,y)=>h.push(y.range(g,b));if(l==u)for(this.regexp.lastIndex=c-l.from;(f=this.regexp.exec(l.text))&&f.index<d-l.from;)this.addMatch(f,e,f.index+l.from,p);else QC(e.state.doc,this.regexp,c,d,(g,b)=>this.addMatch(b,e,g,p));n=n.update({filterFrom:c,filterTo:d,filter:(g,b)=>g<c||b>d,add:h})}}return n}}const ww=/x/.unicode!=null?"gu":"g",Pj=new RegExp(`[\0-\b
--\u2028\u2029\uFEFF-]`,ww),Tj={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let L0=null;function $j(){var t;if(L0==null&&typeof document<"u"&&document.body){let e=document.body.style;L0=((t=e.tabSize)!==null&&t!==void 0?t:e.MozTabSize)!=null}return L0||!1}const Gf=Se.define({combine(t){let e=Wo(t,{render:null,specialChars:Pj,addSpecialChars:null});return(e.replaceTabs=!$j())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,ww)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,ww)),e}});function Nj(t={}){return[Gf.of(t),Oj()]}let eE=null;function Oj(){return eE||(eE=hn.fromClass(class{constructor(t){this.view=t,this.decorations=Ze.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(t.state.facet(Gf)),this.decorations=this.decorator.createDeco(t)}makeDecorator(t){return new Aj({regexp:t.specialChars,decoration:(e,n,r)=>{let{doc:i}=n.state,s=$n(e[0],0);if(s==9){let o=i.lineAt(r),a=n.state.tabSize,l=cg(o.text,a,r-o.from);return Ze.replace({widget:new Dj((a-l%a)*this.view.defaultCharacterWidth)})}return this.decorationCache[s]||(this.decorationCache[s]=Ze.replace({widget:new Mj(t,s)}))},boundary:t.replaceTabs?void 0:/[^]/})}update(t){let e=t.state.facet(Gf);t.startState.facet(Gf)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(t.view)):this.decorations=this.decorator.updateDeco(t,this.decorations)}},{decorations:t=>t.decorations}))}const _j="";function Rj(t){return t>=32?_j:t==10?"":String.fromCharCode(9216+t)}class Mj extends Xa{constructor(e,n){super(),this.options=e,this.code=n}eq(e){return e.code==this.code}toDOM(e){let n=Rj(this.code),r=e.state.phrase("Control character")+" "+(Tj[this.code]||"0x"+this.code.toString(16)),i=this.options.render&&this.options.render(this.code,r,n);if(i)return i;let s=document.createElement("span");return s.textContent=n,s.title=r,s.setAttribute("aria-label",r),s.className="cm-specialChar",s}ignoreEvent(){return!1}}class Dj extends Xa{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}function Ij(){return Bj}const Lj=Ze.line({class:"cm-activeLine"}),Bj=hn.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.docChanged||t.selectionSet)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=-1,n=[];for(let r of t.state.selection.ranges){let i=t.lineBlockAt(r.head);i.from>e&&(n.push(Lj.range(i.from)),e=i.from)}return Ze.set(n)}},{decorations:t=>t.decorations}),Zh="-10000px";class _O{constructor(e,n,r){this.facet=n,this.createTooltipView=r,this.input=e.state.facet(n),this.tooltips=this.input.filter(i=>i),this.tooltipViews=this.tooltips.map(r)}update(e){var n;let r=e.state.facet(this.facet),i=r.filter(o=>o);if(r===this.input){for(let o of this.tooltipViews)o.update&&o.update(e);return!1}let s=[];for(let o=0;o<i.length;o++){let a=i[o],l=-1;if(a){for(let u=0;u<this.tooltips.length;u++){let c=this.tooltips[u];c&&c.create==a.create&&(l=u)}if(l<0)s[o]=this.createTooltipView(a);else{let u=s[o]=this.tooltipViews[l];u.update&&u.update(e)}}}for(let o of this.tooltipViews)s.indexOf(o)<0&&(o.dom.remove(),(n=o.destroy)===null||n===void 0||n.call(o));return this.input=r,this.tooltips=i,this.tooltipViews=s,!0}}function jj(t){let{win:e}=t;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const B0=Se.define({combine:t=>{var e,n,r;return{position:ke.ios?"absolute":((e=t.find(i=>i.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((n=t.find(i=>i.parent))===null||n===void 0?void 0:n.parent)||null,tooltipSpace:((r=t.find(i=>i.tooltipSpace))===null||r===void 0?void 0:r.tooltipSpace)||jj}}}),tE=new WeakMap,RO=hn.fromClass(class{constructor(t){this.view=t,this.inView=!0,this.lastTransaction=0,this.measureTimeout=-1;let e=t.state.facet(B0);this.position=e.position,this.parent=e.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new _O(t,H1,n=>this.createTooltip(n)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(n=>{Date.now()>this.lastTransaction-50&&n.length>0&&n[n.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t);e&&this.observeIntersection();let n=e||t.geometryChanged,r=t.state.facet(B0);if(r.position!=this.position){this.position=r.position;for(let i of this.manager.tooltipViews)i.dom.style.position=this.position;n=!0}if(r.parent!=this.parent){this.parent&&this.container.remove(),this.parent=r.parent,this.createContainer();for(let i of this.manager.tooltipViews)this.container.appendChild(i.dom);n=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);n&&this.maybeMeasure()}createTooltip(t){let e=t.create(this.view);if(e.dom.classList.add("cm-tooltip"),t.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let n=document.createElement("div");n.className="cm-tooltip-arrow",e.dom.appendChild(n)}return e.dom.style.position=this.position,e.dom.style.top=Zh,this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var t,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let n of this.manager.tooltipViews)n.dom.remove(),(t=n.destroy)===null||t===void 0||t.call(n);(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=this.view.dom.getBoundingClientRect();return{editor:t,parent:this.parent?this.container.getBoundingClientRect():t,pos:this.manager.tooltips.map((e,n)=>{let r=this.manager.tooltipViews[n];return r.getCoords?r.getCoords(e.pos):this.view.coordsAtPos(e.pos)}),size:this.manager.tooltipViews.map(({dom:e})=>e.getBoundingClientRect()),space:this.view.state.facet(B0).tooltipSpace(this.view)}}writeMeasure(t){var e;let{editor:n,space:r}=t,i=[];for(let s=0;s<this.manager.tooltips.length;s++){let o=this.manager.tooltips[s],a=this.manager.tooltipViews[s],{dom:l}=a,u=t.pos[s],c=t.size[s];if(!u||u.bottom<=Math.max(n.top,r.top)||u.top>=Math.min(n.bottom,r.bottom)||u.right<Math.max(n.left,r.left)-.1||u.left>Math.min(n.right,r.right)+.1){l.style.top=Zh;continue}let d=o.arrow?a.dom.querySelector(".cm-tooltip-arrow"):null,h=d?7:0,f=c.right-c.left,p=(e=tE.get(a))!==null&&e!==void 0?e:c.bottom-c.top,g=a.offset||Fj,b=this.view.textDirection==Tt.LTR,y=c.width>r.right-r.left?b?r.left:r.right-c.width:b?Math.min(u.left-(d?14:0)+g.x,r.right-f):Math.max(r.left,u.left-f+(d?14:0)-g.x),v=!!o.above;!o.strictSide&&(v?u.top-(c.bottom-c.top)-g.y<r.top:u.bottom+(c.bottom-c.top)+g.y>r.bottom)&&v==r.bottom-u.bottom>u.top-r.top&&(v=!v);let w=(v?u.top-r.top:r.bottom-u.bottom)-h;if(w<p&&a.resize!==!1){if(w<this.view.defaultLineHeight){l.style.top=Zh;continue}tE.set(a,p),l.style.height=(p=w)+"px"}else l.style.height&&(l.style.height="");let S=v?u.top-p-h-g.y:u.bottom+h+g.y,C=y+f;if(a.overlap!==!0)for(let E of i)E.left<C&&E.right>y&&E.top<S+p&&E.bottom>S&&(S=v?E.top-p-2-h:E.bottom+h+2);this.position=="absolute"?(l.style.top=S-t.parent.top+"px",l.style.left=y-t.parent.left+"px"):(l.style.top=S+"px",l.style.left=y+"px"),d&&(d.style.left=`${u.left+(b?g.x:-g.x)-(y+14-7)}px`),a.overlap!==!0&&i.push({left:y,top:S,right:C,bottom:S+p}),l.classList.toggle("cm-tooltip-above",v),l.classList.toggle("cm-tooltip-below",!v),a.positioned&&a.positioned(t.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=Zh}},{eventHandlers:{scroll(){this.maybeMeasure()}}}),zj=Ae.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Fj={x:0,y:0},H1=Se.define({enables:[RO,zj]}),nm=Se.define();class W1{constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new _O(e,nm,n=>this.createHostedView(n))}static create(e){return new W1(e)}createHostedView(e){let n=e.create(this.view);return n.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(n.dom),this.mounted&&n.mount&&n.mount(this.view),n}mount(e){for(let n of this.manager.tooltipViews)n.mount&&n.mount(e);this.mounted=!0}positioned(e){for(let n of this.manager.tooltipViews)n.positioned&&n.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let n of this.manager.tooltipViews)(e=n.destroy)===null||e===void 0||e.call(n)}}const Uj=H1.compute([nm],t=>{let e=t.facet(nm).filter(n=>n);return e.length===0?null:{pos:Math.min(...e.map(n=>n.pos)),end:Math.max(...e.filter(n=>n.end!=null).map(n=>n.end)),create:W1.create,above:e[0].above,arrow:e.some(n=>n.arrow)}});class Vj{constructor(e,n,r,i,s){this.view=e,this.source=n,this.field=r,this.setHover=i,this.hoverTime=s,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{lastMove:e}=this,n=this.view.contentDOM.contains(e.target)?this.view.posAtCoords(e):null;if(n==null)return;let r=this.view.coordsAtPos(n);if(r==null||e.y<r.top||e.y>r.bottom||e.x<r.left-this.view.defaultCharacterWidth||e.x>r.right+this.view.defaultCharacterWidth)return;let i=this.view.bidiSpans(this.view.state.doc.lineAt(n)).find(a=>a.from<=n&&a.to>=n),s=i&&i.dir==Tt.RTL?-1:1,o=this.source(this.view,n,e.x<r.left?-s:s);if(o!=null&&o.then){let a=this.pending={pos:n};o.then(l=>{this.pending==a&&(this.pending=null,l&&this.view.dispatch({effects:this.setHover.of(l)}))},l=>zr(this.view.state,l,"hover tooltip"))}else o&&this.view.dispatch({effects:this.setHover.of(o)})}mousemove(e){var n;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let r=this.active;if(r&&!nE(this.lastMove.target)||this.pending){let{pos:i}=r||this.pending,s=(n=r==null?void 0:r.end)!==null&&n!==void 0?n:i;(i==s?this.view.posAtCoords(this.lastMove)!=i:!Hj(this.view,i,s,e.clientX,e.clientY,6))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1,this.active&&!nE(e.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}function nE(t){for(let e=t;e;e=e.parentNode)if(e.nodeType==1&&e.classList.contains("cm-tooltip"))return!0;return!1}function Hj(t,e,n,r,i,s){let o=document.createRange(),a=t.domAtPos(e),l=t.domAtPos(n);o.setEnd(l.node,l.offset),o.setStart(a.node,a.offset);let u=o.getClientRects();o.detach();for(let c=0;c<u.length;c++){let d=u[c];if(Math.max(d.top-i,i-d.bottom,d.left-r,r-d.right)<=s)return!0}return!1}function Wj(t,e={}){let n=ze.define(),r=Cn.define({create(){return null},update(i,s){if(i&&(e.hideOnChange&&(s.docChanged||s.selection)||e.hideOn&&e.hideOn(s,i)))return null;if(i&&s.docChanged){let o=s.changes.mapPos(i.pos,-1,Jn.TrackDel);if(o==null)return null;let a=Object.assign(Object.create(null),i);a.pos=o,i.end!=null&&(a.end=s.changes.mapPos(i.end)),i=a}for(let o of s.effects)o.is(n)&&(i=o.value),o.is(Kj)&&(i=null);return i},provide:i=>nm.from(i)});return[r,hn.define(i=>new Vj(i,t,r,n,e.hoverTime||300)),Uj]}function Gj(t,e){let n=t.plugin(RO);if(!n)return null;let r=n.manager.tooltips.indexOf(e);return r<0?null:n.manager.tooltipViews[r]}const Kj=ze.define(),rE=Se.define({combine(t){let e,n;for(let r of t)e=e||r.topContainer,n=n||r.bottomContainer;return{topContainer:e,bottomContainer:n}}});function Pd(t,e){let n=t.plugin(MO),r=n?n.specs.indexOf(e):-1;return r>-1?n.panels[r]:null}const MO=hn.fromClass(class{constructor(t){this.input=t.state.facet(Td),this.specs=this.input.filter(n=>n),this.panels=this.specs.map(n=>n(t));let e=t.state.facet(rE);this.top=new Jh(t,!0,e.topContainer),this.bottom=new Jh(t,!1,e.bottomContainer),this.top.sync(this.panels.filter(n=>n.top)),this.bottom.sync(this.panels.filter(n=>!n.top));for(let n of this.panels)n.dom.classList.add("cm-panel"),n.mount&&n.mount()}update(t){let e=t.state.facet(rE);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Jh(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Jh(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let n=t.state.facet(Td);if(n!=this.input){let r=n.filter(l=>l),i=[],s=[],o=[],a=[];for(let l of r){let u=this.specs.indexOf(l),c;u<0?(c=l(t.view),a.push(c)):(c=this.panels[u],c.update&&c.update(t)),i.push(c),(c.top?s:o).push(c)}this.specs=r,this.panels=i,this.top.sync(s),this.bottom.sync(o);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let r of this.panels)r.update&&r.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>Ae.scrollMargins.of(e=>{let n=e.plugin(t);return n&&{top:n.top.scrollMargin(),bottom:n.bottom.scrollMargin()}})});class Jh{constructor(e,n,r){this.view=e,this.top=n,this.container=r,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let n of this.panels)n.destroy&&e.indexOf(n)<0&&n.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let n=this.container||this.view.dom;n.insertBefore(this.dom,this.top?n.firstChild:null)}let e=this.dom.firstChild;for(let n of this.panels)if(n.dom.parentNode==this.dom){for(;e!=n.dom;)e=iE(e);e=e.nextSibling}else this.dom.insertBefore(n.dom,e);for(;e;)e=iE(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function iE(t){let e=t.nextSibling;return t.remove(),e}const Td=Se.define({enables:MO});class jo extends Ba{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}jo.prototype.elementClass="";jo.prototype.toDOM=void 0;jo.prototype.mapMode=Jn.TrackBefore;jo.prototype.startSide=jo.prototype.endSide=-1;jo.prototype.point=!0;const Kf=Se.define(),Xf=Se.define(),bw=Se.define({combine:t=>t.some(e=>e)});function Xj(t){let e=[Zj];return t&&t.fixed===!1&&e.push(bw.of(!0)),e}const Zj=hn.fromClass(class{constructor(t){this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight+"px",this.gutters=t.state.facet(Xf).map(e=>new oE(t,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!t.state.facet(bw),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}update(t){if(this.updateGutters(t)){let e=this.prevViewport,n=t.view.viewport,r=Math.min(e.to,n.to)-Math.max(e.from,n.from);this.syncGutters(r<(n.to-n.from)*.8)}t.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(bw)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&this.dom.remove();let n=yt.iter(this.view.state.facet(Kf),this.view.viewport.from),r=[],i=this.gutters.map(s=>new Jj(s,this.view.viewport,-this.view.documentPadding.top));for(let s of this.view.viewportLineBlocks)if(r.length&&(r=[]),Array.isArray(s.type)){let o=!0;for(let a of s.type)if(a.type==Nt.Text&&o){xw(n,r,a.from);for(let l of i)l.line(this.view,a,r);o=!1}else if(a.widget)for(let l of i)l.widget(this.view,a)}else if(s.type==Nt.Text){xw(n,r,s.from);for(let o of i)o.line(this.view,s,r)}for(let s of i)s.finish();t&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(t){let e=t.startState.facet(Xf),n=t.state.facet(Xf),r=t.docChanged||t.heightChanged||t.viewportChanged||!yt.eq(t.startState.facet(Kf),t.state.facet(Kf),t.view.viewport.from,t.view.viewport.to);if(e==n)for(let i of this.gutters)i.update(t)&&(r=!0);else{r=!0;let i=[];for(let s of n){let o=e.indexOf(s);o<0?i.push(new oE(this.view,s)):(this.gutters[o].update(t),i.push(this.gutters[o]))}for(let s of this.gutters)s.dom.remove(),i.indexOf(s)<0&&s.destroy();for(let s of i)this.dom.appendChild(s.dom);this.gutters=i}return r}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove()}},{provide:t=>Ae.scrollMargins.of(e=>{let n=e.plugin(t);return!n||n.gutters.length==0||!n.fixed?null:e.textDirection==Tt.LTR?{left:n.dom.offsetWidth}:{right:n.dom.offsetWidth}})});function sE(t){return Array.isArray(t)?t:[t]}function xw(t,e,n){for(;t.value&&t.from<=n;)t.from==n&&e.push(t.value),t.next()}class Jj{constructor(e,n,r){this.gutter=e,this.height=r,this.i=0,this.cursor=yt.iter(e.markers,n.from)}addElement(e,n,r){let{gutter:i}=this,s=n.top-this.height;if(this.i==i.elements.length){let o=new DO(e,n.height,s,r);i.elements.push(o),i.dom.appendChild(o.dom)}else i.elements[this.i].update(e,n.height,s,r);this.height=n.bottom,this.i++}line(e,n,r){let i=[];xw(this.cursor,i,n.from),r.length&&(i=i.concat(r));let s=this.gutter.config.lineMarker(e,n,i);s&&i.unshift(s);let o=this.gutter;i.length==0&&!o.config.renderEmptyElements||this.addElement(e,n,i)}widget(e,n){let r=this.gutter.config.widgetMarker(e,n.widget,n);r&&this.addElement(e,n,[r])}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let n=e.elements.pop();e.dom.removeChild(n.dom),n.destroy()}}}class oE{constructor(e,n){this.view=e,this.config=n,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let r in n.domEventHandlers)this.dom.addEventListener(r,i=>{let s=i.target,o;if(s!=this.dom&&this.dom.contains(s)){for(;s.parentNode!=this.dom;)s=s.parentNode;let l=s.getBoundingClientRect();o=(l.top+l.bottom)/2}else o=i.clientY;let a=e.lineBlockAtHeight(o-e.documentTop);n.domEventHandlers[r](e,a,i)&&i.preventDefault()});this.markers=sE(n.markers(e)),n.initialSpacer&&(this.spacer=new DO(e,0,0,[n.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let n=this.markers;if(this.markers=sE(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let i=this.config.updateSpacer(this.spacer.markers[0],e);i!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[i])}let r=e.view.viewport;return!yt.eq(this.markers,n,r.from,r.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class DO{constructor(e,n,r,i){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,n,r,i)}update(e,n,r,i){this.height!=n&&(this.dom.style.height=(this.height=n)+"px"),this.above!=r&&(this.dom.style.marginTop=(this.above=r)?r+"px":""),Yj(this.markers,i)||this.setMarkers(e,i)}setMarkers(e,n){let r="cm-gutterElement",i=this.dom.firstChild;for(let s=0,o=0;;){let a=o,l=s<n.length?n[s++]:null,u=!1;if(l){let c=l.elementClass;c&&(r+=" "+c);for(let d=o;d<this.markers.length;d++)if(this.markers[d].compare(l)){a=d,u=!0;break}}else a=this.markers.length;for(;o<a;){let c=this.markers[o++];if(c.toDOM){c.destroy(i);let d=i.nextSibling;i.remove(),i=d}}if(!l)break;l.toDOM&&(u?i=i.nextSibling:this.dom.insertBefore(l.toDOM(e),i)),u&&o++}this.dom.className=r,this.markers=n}destroy(){this.setMarkers(null,[])}}function Yj(t,e){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!t[n].compare(e[n]))return!1;return!0}const qj=Se.define(),El=Se.define({combine(t){return Wo(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,n){let r=Object.assign({},e);for(let i in n){let s=r[i],o=n[i];r[i]=s?(a,l,u)=>s(a,l,u)||o(a,l,u):o}return r}})}});class j0 extends jo{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function z0(t,e){return t.state.facet(El).formatNumber(e,t.state)}const Qj=Xf.compute([El],t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(qj)},lineMarker(e,n,r){return r.some(i=>i.toDOM)?null:new j0(z0(e,e.state.doc.lineAt(n.from).number))},widgetMarker:()=>null,lineMarkerChange:e=>e.startState.facet(El)!=e.state.facet(El),initialSpacer(e){return new j0(z0(e,aE(e.state.doc.lines)))},updateSpacer(e,n){let r=z0(n.view,aE(n.view.state.doc.lines));return r==e.number?e:new j0(r)},domEventHandlers:t.facet(El).domEventHandlers}));function ez(t={}){return[El.of(t),Xj(),Qj]}function aE(t){let e=9;for(;e<t;)e=e*10+9;return e}const tz=new class extends jo{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},nz=Kf.compute(["selection"],t=>{let e=[],n=-1;for(let r of t.selection.ranges){let i=t.doc.lineAt(r.head).from;i>n&&(n=i,e.push(tz.range(i)))}return yt.of(e)});function rz(){return nz}const IO=new Qd;function LO(t){window.codemirror&&window.codemirror.dispatch({effects:IO.reconfigure(Ue.readOnly.of(t))})}const Sw=ze.define(),iz=Cn.define({create(){return Ze.none},update(t,e){let n=t.map(e.changes);for(const r of e.effects)r.is(Sw)&&(n=Ze.none,r.value!==null&&(n=n.update({add:[sz.range(r.value)]})));return n},provide:t=>Ae.decorations.from(t)}),sz=Ze.line({class:"!bg-mantis-400/10"});function BO(t){if(window.codemirror)if(t===null)window.codemirror.dispatch({effects:Sw.of(null)});else{const e=window.codemirror.state.doc.lineAt(t).from;window.codemirror.dispatch({effects:Sw.of(e)})}}const oz=1,lE=5e3,Pi=new Map,_c=[];function az(){let t=0;for(const e of Pi.keys())e>t&&(t=e);return t+1}function lz(){let t=1/0;for(const e of Pi.keys())e<t&&(t=e);return t}function ho(t,e=!0){switch(t.type){case"ADD_TOAST":{const{toastId:n,toast:r}=t,i=r.duration??lE,s=Number.isFinite(i)?setTimeout(()=>ho({type:"DISMISS_TOAST",toastId:n}),i):null;Pi.set(n,{...r,timeout:s,otherProps:{open:!0,onOpenChange:o=>{o||ho({type:"DISMISS_TOAST",toastId:n})}}}),Pi.size>oz&&ho({type:"DISMISS_TOAST",toastId:lz()},!1);break}case"UPDATE_TOAST":{const{toastId:n,toast:r}=t,i=Pi.get(n);if(!i)return;if(typeof r.duration=="number"){i.timeout!==null&&clearTimeout(i.timeout);const s=r.duration??lE,o=Number.isFinite(s)?setTimeout(()=>ho({type:"DISMISS_TOAST",toastId:n}),s):null;Pi.set(n,{...i,...r,timeout:o})}else Pi.set(n,{...i,...r});break}case"DISMISS_TOAST":{const{toastId:n}=t,r=Pi.get(n);if(!r)return;r.timeout!==null&&clearTimeout(r.timeout),Pi.delete(n);break}default:{const n=t;throw new Error(`Unhandled action: ${n}`)}}if(e&&_c.length>0){const n=Array.from(Pi.entries()).map(([r,i])=>({...i,id:r})).sort((r,i)=>i.id-r.id);for(const r of _c)r(n)}}function Kn(t){const e=az(),n=i=>ho({type:"UPDATE_TOAST",toastId:e,toast:{...i}}),r=()=>ho({type:"DISMISS_TOAST",toastId:e});return ho({type:"ADD_TOAST",toastId:e,toast:t}),{id:e,dismiss:r,update:n}}function uz(){const[t,e]=m.useState([]);return m.useEffect(()=>(_c.push(e),()=>{const n=_c.indexOf(e);n>-1&&_c.splice(n,1)}),[]),{toastList:t,toast:Kn,dismiss:n=>ho({type:"DISMISS_TOAST",toastId:n})}}const F0=Ce(B.zero(16)),U0=Ce(B.zero(16)),V0=Ce(B.zero(16)),H0=Ce(B.zero(16)),W0=Ce(B.zero(16)),G0=Ce(B.zero(16)),cz=Ce(B.zero(8)),K0=Ce(B.zero(16)),X0=Ce(B.zero(16)),Z0=Ce(B.zero(16)),J0=Ce(B.zero(16)),Y0=Ce(B.zero(16)),q0=Ce(B.zero(16)),jO=Ce(B.zero(16)),rm=Ce(B.zero(8)),kr=t=>Ce(e=>e(t).low,(e,n,r)=>{const i=e(t),s=typeof r=="function"?r(i.low):r;n(t,i.withLow(s))}),Cr=t=>Ce(e=>e(t).high,(e,n,r)=>{const i=e(t),s=typeof r=="function"?r(i.high):r;n(t,i.withHigh(s))}),mt={AX:F0,AL:kr(F0),AH:Cr(F0),BX:U0,BL:kr(U0),BH:Cr(U0),CX:V0,CL:kr(V0),CH:Cr(V0),DX:H0,DL:kr(H0),DH:Cr(H0),SP:W0,"SP.l":kr(W0),"SP.h":Cr(W0),IP:G0,"IP.l":kr(G0),"IP.h":Cr(G0),IR:cz,ri:K0,"ri.l":kr(K0),"ri.h":Cr(K0),id:X0,"id.l":kr(X0),"id.h":Cr(X0),left:Z0,"left.l":kr(Z0),"left.h":Cr(Z0),right:J0,"right.l":kr(J0),"right.h":Cr(J0),result:Y0,"result.l":kr(Y0),"result.h":Cr(Y0),FLAGS:q0,"FLAGS.l":kr(q0),"FLAGS.h":Cr(q0),MAR:jO,MBR:rm},Ti=Ce({phase:"stopped"}),zO=Ce("ADD");function dz(t){Q.set(mt.AX,B.fromUnsigned(t.cpu.AX,16)),Q.set(mt.BX,B.fromUnsigned(t.cpu.BX,16)),Q.set(mt.CX,B.fromUnsigned(t.cpu.CX,16)),Q.set(mt.DX,B.fromUnsigned(t.cpu.DX,16)),Q.set(mt.SP,B.fromUnsigned(t.cpu.SP,16)),Q.set(mt.IP,B.fromUnsigned(t.cpu.IP,16)),Q.set(mt.IR,B.fromUnsigned(t.cpu.IR,8)),Q.set(mt.ri,B.fromUnsigned(t.cpu.ri,16)),Q.set(mt.id,B.fromUnsigned(t.cpu.id,16)),Q.set(mt.left,B.fromUnsigned(t.cpu.left,16)),Q.set(mt.right,B.fromUnsigned(t.cpu.right,16)),Q.set(mt.result,B.fromUnsigned(t.cpu.result,16)),Q.set(mt.FLAGS,B.fromUnsigned(t.cpu.FLAGS,16)),Q.set(mt.MAR,B.fromUnsigned(t.cpu.MAR,16)),Q.set(mt.MBR,B.fromUnsigned(t.cpu.MBR,8)),Q.set(Ti,{phase:"stopped"})}var hz=Object.defineProperty,fz=(t,e)=>{for(var n in e)hz(t,n,{get:e[n],enumerable:!0})},vi={};fz(vi,{assign:()=>yz,colors:()=>Eo,createStringInterpolator:()=>q1,skipAnimation:()=>XO,to:()=>KO,willAdvance:()=>Q1});var G1=ih(),Le=t=>rh(t,G1),K1=ih();Le.write=t=>rh(t,K1);var fg=ih();Le.onStart=t=>rh(t,fg);var X1=ih();Le.onFrame=t=>rh(t,X1);var Z1=ih();Le.onFinish=t=>rh(t,Z1);var Fl=[];Le.setTimeout=(t,e)=>{const n=Le.now()+e,r=()=>{const s=Fl.findIndex(o=>o.cancel==r);~s&&Fl.splice(s,1),po-=~s?1:0},i={time:n,handler:t,cancel:r};return Fl.splice(FO(n),0,i),po+=1,UO(),i};var FO=t=>~(~Fl.findIndex(e=>e.time>t)||~Fl.length);Le.cancel=t=>{fg.delete(t),X1.delete(t),Z1.delete(t),G1.delete(t),K1.delete(t)};Le.sync=t=>{kw=!0,Le.batchedUpdates(t),kw=!1};Le.throttle=t=>{let e;function n(){try{t(...e)}finally{e=null}}function r(...i){e=i,Le.onStart(n)}return r.handler=t,r.cancel=()=>{fg.delete(n),e=null},r};var J1=typeof window<"u"?window.requestAnimationFrame:()=>{};Le.use=t=>J1=t;Le.now=typeof performance<"u"?()=>performance.now():Date.now;Le.batchedUpdates=t=>t();Le.catch=console.error;Le.frameLoop="always";Le.advance=()=>{Le.frameLoop!=="demand"?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):HO()};var fo=-1,po=0,kw=!1;function rh(t,e){kw?(e.delete(t),t(0)):(e.add(t),UO())}function UO(){fo<0&&(fo=0,Le.frameLoop!=="demand"&&J1(VO))}function pz(){fo=-1}function VO(){~fo&&(J1(VO),Le.batchedUpdates(HO))}function HO(){const t=fo;fo=Le.now();const e=FO(fo);if(e&&(WO(Fl.splice(0,e),n=>n.handler()),po-=e),!po){pz();return}fg.flush(),G1.flush(t?Math.min(64,fo-t):16.667),X1.flush(),K1.flush(),Z1.flush()}function ih(){let t=new Set,e=t;return{add(n){po+=e==t&&!t.has(n)?1:0,t.add(n)},delete(n){return po-=e==t&&t.has(n)?1:0,t.delete(n)},flush(n){e.size&&(t=new Set,po-=e.size,WO(e,r=>r(n)&&t.add(r)),po+=t.size,e=t)}}}function WO(t,e){t.forEach(n=>{try{e(n)}catch(r){Le.catch(r)}})}function mz(){}var gz=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),he={arr:Array.isArray,obj:t=>!!t&&t.constructor.name==="Object",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",und:t=>t===void 0};function Qi(t,e){if(he.arr(t)){if(!he.arr(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return t===e}var on=(t,e)=>t.forEach(e);function zo(t,e,n){if(he.arr(t)){for(let r=0;r<t.length;r++)e.call(n,t[r],`${r}`);return}for(const r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r)}var mo=t=>he.und(t)?[]:he.arr(t)?t:[t];function GO(t,e){if(t.size){const n=Array.from(t);t.clear(),on(n,e)}}var Yh=(t,...e)=>GO(t,n=>n(...e)),Y1=()=>typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),q1,KO,Eo=null,XO=!1,Q1=mz,yz=t=>{t.to&&(KO=t.to),t.now&&(Le.now=t.now),t.colors!==void 0&&(Eo=t.colors),t.skipAnimation!=null&&(XO=t.skipAnimation),t.createStringInterpolator&&(q1=t.createStringInterpolator),t.requestAnimationFrame&&Le.use(t.requestAnimationFrame),t.batchedUpdates&&(Le.batchedUpdates=t.batchedUpdates),t.willAdvance&&(Q1=t.willAdvance),t.frameLoop&&(Le.frameLoop=t.frameLoop)},Rc=new Set,Dr=[],Q0=[],im=0,pg={get idle(){return!Rc.size&&!Dr.length},start(t){im>t.priority?(Rc.add(t),Le.onStart(vz)):(ZO(t),Le(Cw))},advance:Cw,sort(t){if(im)Le.onFrame(()=>pg.sort(t));else{const e=Dr.indexOf(t);~e&&(Dr.splice(e,1),JO(t))}},clear(){Dr=[],Rc.clear()}};function vz(){Rc.forEach(ZO),Rc.clear(),Le(Cw)}function ZO(t){Dr.includes(t)||JO(t)}function JO(t){Dr.splice(wz(Dr,e=>e.priority>t.priority),0,t)}function Cw(t){const e=Q0;for(let n=0;n<Dr.length;n++){const r=Dr[n];im=r.priority,r.idle||(Q1(r),r.advance(t),r.idle||e.push(r))}return im=0,Q0=Dr,Q0.length=0,Dr=e,Dr.length>0}function wz(t,e){const n=t.findIndex(e);return n<0?t.length:n}var bz=(t,e,n)=>Math.min(Math.max(n,t),e),xz={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},oi="[-+]?\\d*\\.?\\d+",sm=oi+"%";function mg(...t){return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}var Sz=new RegExp("rgb"+mg(oi,oi,oi)),kz=new RegExp("rgba"+mg(oi,oi,oi,oi)),Cz=new RegExp("hsl"+mg(oi,sm,sm)),Ez=new RegExp("hsla"+mg(oi,sm,sm,oi)),Az=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Pz=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,Tz=/^#([0-9a-fA-F]{6})$/,$z=/^#([0-9a-fA-F]{8})$/;function Nz(t){let e;return typeof t=="number"?t>>>0===t&&t>=0&&t<=4294967295?t:null:(e=Tz.exec(t))?parseInt(e[1]+"ff",16)>>>0:Eo&&Eo[t]!==void 0?Eo[t]:(e=Sz.exec(t))?(il(e[1])<<24|il(e[2])<<16|il(e[3])<<8|255)>>>0:(e=kz.exec(t))?(il(e[1])<<24|il(e[2])<<16|il(e[3])<<8|dE(e[4]))>>>0:(e=Az.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+"ff",16)>>>0:(e=$z.exec(t))?parseInt(e[1],16)>>>0:(e=Pz.exec(t))?parseInt(e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+e[4]+e[4],16)>>>0:(e=Cz.exec(t))?(uE(cE(e[1]),qh(e[2]),qh(e[3]))|255)>>>0:(e=Ez.exec(t))?(uE(cE(e[1]),qh(e[2]),qh(e[3]))|dE(e[4]))>>>0:null}function ey(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function uE(t,e,n){const r=n<.5?n*(1+e):n+e-n*e,i=2*n-r,s=ey(i,r,t+1/3),o=ey(i,r,t),a=ey(i,r,t-1/3);return Math.round(s*255)<<24|Math.round(o*255)<<16|Math.round(a*255)<<8}function il(t){const e=parseInt(t,10);return e<0?0:e>255?255:e}function cE(t){return(parseFloat(t)%360+360)%360/360}function dE(t){const e=parseFloat(t);return e<0?0:e>1?255:Math.round(e*255)}function qh(t){const e=parseFloat(t);return e<0?0:e>100?1:e/100}function hE(t){let e=Nz(t);if(e===null)return t;e=e||0;const n=(e&4278190080)>>>24,r=(e&16711680)>>>16,i=(e&65280)>>>8,s=(e&255)/255;return`rgba(${n}, ${r}, ${i}, ${s})`}var $d=(t,e,n)=>{if(he.fun(t))return t;if(he.arr(t))return $d({range:t,output:e,extrapolate:n});if(he.str(t.output[0]))return q1(t);const r=t,i=r.output,s=r.range||[0,1],o=r.extrapolateLeft||r.extrapolate||"extend",a=r.extrapolateRight||r.extrapolate||"extend",l=r.easing||(u=>u);return u=>{const c=_z(u,s);return Oz(u,s[c],s[c+1],i[c],i[c+1],l,o,a,r.map)}};function Oz(t,e,n,r,i,s,o,a,l){let u=l?l(t):t;if(u<e){if(o==="identity")return u;o==="clamp"&&(u=e)}if(u>n){if(a==="identity")return u;a==="clamp"&&(u=n)}return r===i?r:e===n?t<=e?r:i:(e===-1/0?u=-u:n===1/0?u=u-e:u=(u-e)/(n-e),u=s(u),r===-1/0?u=-u:i===1/0?u=u+r:u=u*(i-r)+r,u)}function _z(t,e){for(var n=1;n<e.length-1&&!(e[n]>=t);++n);return n-1}var Rz=(t,e="end")=>n=>{n=e==="end"?Math.min(n,.999):Math.max(n,.001);const r=n*t,i=e==="end"?Math.floor(r):Math.ceil(r);return bz(0,1,i/t)},om=1.70158,Qh=om*1.525,fE=om+1,pE=2*Math.PI/3,mE=2*Math.PI/4.5,ef=t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,YO={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>1-(1-t)*(1-t),easeInOutQuad:t=>t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2,easeInCubic:t=>t*t*t,easeOutCubic:t=>1-Math.pow(1-t,3),easeInOutCubic:t=>t<.5?4*t*t*t:1-Math.pow(-2*t+2,3)/2,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1-Math.pow(1-t,4),easeInOutQuart:t=>t<.5?8*t*t*t*t:1-Math.pow(-2*t+2,4)/2,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1-Math.pow(1-t,5),easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1-Math.pow(-2*t+2,5)/2,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t===0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t===1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t===0?0:t===1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2,easeInCirc:t=>1-Math.sqrt(1-Math.pow(t,2)),easeOutCirc:t=>Math.sqrt(1-Math.pow(t-1,2)),easeInOutCirc:t=>t<.5?(1-Math.sqrt(1-Math.pow(2*t,2)))/2:(Math.sqrt(1-Math.pow(-2*t+2,2))+1)/2,easeInBack:t=>fE*t*t*t-om*t*t,easeOutBack:t=>1+fE*Math.pow(t-1,3)+om*Math.pow(t-1,2),easeInOutBack:t=>t<.5?Math.pow(2*t,2)*((Qh+1)*2*t-Qh)/2:(Math.pow(2*t-2,2)*((Qh+1)*(t*2-2)+Qh)+2)/2,easeInElastic:t=>t===0?0:t===1?1:-Math.pow(2,10*t-10)*Math.sin((t*10-10.75)*pE),easeOutElastic:t=>t===0?0:t===1?1:Math.pow(2,-10*t)*Math.sin((t*10-.75)*pE)+1,easeInOutElastic:t=>t===0?0:t===1?1:t<.5?-(Math.pow(2,20*t-10)*Math.sin((20*t-11.125)*mE))/2:Math.pow(2,-20*t+10)*Math.sin((20*t-11.125)*mE)/2+1,easeInBounce:t=>1-ef(1-t),easeOutBounce:ef,easeInOutBounce:t=>t<.5?(1-ef(1-2*t))/2:(1+ef(2*t-1))/2,steps:Rz},Nd=Symbol.for("FluidValue.get"),du=Symbol.for("FluidValue.observers"),Mr=t=>!!(t&&t[Nd]),Xn=t=>t&&t[Nd]?t[Nd]():t,gE=t=>t[du]||null;function Mz(t,e){t.eventObserved?t.eventObserved(e):t(e)}function Od(t,e){const n=t[du];n&&n.forEach(r=>{Mz(r,e)})}var qO=class{constructor(t){if(!t&&!(t=this.get))throw Error("Unknown getter");Dz(this,t)}},Dz=(t,e)=>QO(t,Nd,e);function gg(t,e){if(t[Nd]){let n=t[du];n||QO(t,du,n=new Set),n.has(e)||(n.add(e),t.observerAdded&&t.observerAdded(n.size,e))}return e}function _d(t,e){const n=t[du];if(n&&n.has(e)){const r=n.size-1;r?n.delete(e):t[du]=null,t.observerRemoved&&t.observerRemoved(r,e)}}var QO=(t,e,n)=>Object.defineProperty(t,e,{value:n,writable:!0,configurable:!0}),Zf=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Iz=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,yE=new RegExp(`(${Zf.source})(%|[a-z]+)`,"i"),Lz=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,yg=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,e_=t=>{const[e,n]=Bz(t);if(!e||Y1())return t;const r=window.getComputedStyle(document.documentElement).getPropertyValue(e);if(r)return r.trim();if(n&&n.startsWith("--")){const i=window.getComputedStyle(document.documentElement).getPropertyValue(n);return i||t}else{if(n&&yg.test(n))return e_(n);if(n)return n}return t},Bz=t=>{const e=yg.exec(t);if(!e)return[,];const[,n,r]=e;return[n,r]},ty,jz=(t,e,n,r,i)=>`rgba(${Math.round(e)}, ${Math.round(n)}, ${Math.round(r)}, ${i})`,t_=t=>{ty||(ty=Eo?new RegExp(`(${Object.keys(Eo).join("|")})(?!\\w)`,"g"):/^\b$/);const e=t.output.map(s=>Xn(s).replace(yg,e_).replace(Iz,hE).replace(ty,hE)),n=e.map(s=>s.match(Zf).map(Number)),i=n[0].map((s,o)=>n.map(a=>{if(!(o in a))throw Error('The arity of each "output" value must be equal');return a[o]})).map(s=>$d({...t,output:s}));return s=>{var l;const o=!yE.test(e[0])&&((l=e.find(u=>yE.test(u)))==null?void 0:l.replace(Zf,""));let a=0;return e[0].replace(Zf,()=>`${i[a++](s)}${o||""}`).replace(Lz,jz)}},n_="react-spring: ",r_=t=>{const e=t;let n=!1;if(typeof e!="function")throw new TypeError(`${n_}once requires a function parameter`);return(...r)=>{n||(e(...r),n=!0)}},zz=r_(console.warn);function Fz(){zz(`${n_}The "interpolate" function is deprecated in v9 (use "to" instead)`)}r_(console.warn);function vg(t){return he.str(t)&&(t[0]=="#"||/\d/.test(t)||!Y1()&&yg.test(t)||t in(Eo||{}))}var i_=Y1()?m.useEffect:m.useLayoutEffect,Uz=()=>{const t=m.useRef(!1);return i_(()=>(t.current=!0,()=>{t.current=!1}),[]),t};function Vz(){const t=m.useState()[1],e=Uz();return()=>{e.current&&t(Math.random())}}function Hz(t,e){const[n]=m.useState(()=>({inputs:e,result:t()})),r=m.useRef(),i=r.current;let s=i;return s?e&&s.inputs&&Wz(e,s.inputs)||(s={inputs:e,result:t()}):s=n,m.useEffect(()=>{r.current=s,i==n&&(n.inputs=n.result=void 0)},[s]),s.result}function Wz(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}var Gz=t=>m.useEffect(t,Kz),Kz=[],Rd=Symbol.for("Animated:node"),Xz=t=>!!t&&t[Rd]===t,$i=t=>t&&t[Rd],ex=(t,e)=>gz(t,Rd,e),wg=t=>t&&t[Rd]&&t[Rd].getPayload(),s_=class{constructor(){ex(this,this)}getPayload(){return this.payload||[]}},sh=class extends s_{constructor(t){super(),this._value=t,this.done=!0,this.durationProgress=0,he.num(this._value)&&(this.lastPosition=this._value)}static create(t){return new sh(t)}getPayload(){return[this]}getValue(){return this._value}setValue(t,e){return he.num(t)&&(this.lastPosition=t,e&&(t=Math.round(t/e)*e,this.done&&(this.lastPosition=t))),this._value===t?!1:(this._value=t,!0)}reset(){const{done:t}=this;this.done=!1,he.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,t&&(this.lastVelocity=null),this.v0=null)}},Md=class extends sh{constructor(t){super(0),this._string=null,this._toString=$d({output:[t,t]})}static create(t){return new Md(t)}getValue(){const t=this._string;return t??(this._string=this._toString(this._value))}setValue(t){if(he.str(t)){if(t==this._string)return!1;this._string=t,this._value=1}else if(super.setValue(t))this._string=null;else return!1;return!0}reset(t){t&&(this._toString=$d({output:[this.getValue(),t]})),this._value=0,super.reset()}},am={dependencies:null},bg=class extends s_{constructor(t){super(),this.source=t,this.setValue(t)}getValue(t){const e={};return zo(this.source,(n,r)=>{Xz(n)?e[r]=n.getValue(t):Mr(n)?e[r]=Xn(n):t||(e[r]=n)}),e}setValue(t){this.source=t,this.payload=this._makePayload(t)}reset(){this.payload&&on(this.payload,t=>t.reset())}_makePayload(t){if(t){const e=new Set;return zo(t,this._addToPayload,e),Array.from(e)}}_addToPayload(t){am.dependencies&&Mr(t)&&am.dependencies.add(t);const e=wg(t);e&&on(e,n=>this.add(n))}},o_=class extends bg{constructor(t){super(t)}static create(t){return new o_(t)}getValue(){return this.source.map(t=>t.getValue())}setValue(t){const e=this.getPayload();return t.length==e.length?e.map((n,r)=>n.setValue(t[r])).some(Boolean):(super.setValue(t.map(Zz)),!0)}};function Zz(t){return(vg(t)?Md:sh).create(t)}function Ew(t){const e=$i(t);return e?e.constructor:he.arr(t)?o_:vg(t)?Md:sh}var vE=(t,e)=>{const n=!he.fun(t)||t.prototype&&t.prototype.isReactComponent;return m.forwardRef((r,i)=>{const s=m.useRef(null),o=n&&m.useCallback(p=>{s.current=qz(i,p)},[i]),[a,l]=Yz(r,e),u=Vz(),c=()=>{const p=s.current;if(n&&!p)return;(p?e.applyAnimatedValues(p,a.getValue(!0)):!1)===!1&&u()},d=new Jz(c,l),h=m.useRef();i_(()=>(h.current=d,on(l,p=>gg(p,d)),()=>{h.current&&(on(h.current.deps,p=>_d(p,h.current)),Le.cancel(h.current.update))})),m.useEffect(c,[]),Gz(()=>()=>{const p=h.current;on(p.deps,g=>_d(g,p))});const f=e.getComponentProps(a.getValue());return m.createElement(t,{...f,ref:o})})},Jz=class{constructor(t,e){this.update=t,this.deps=e}eventObserved(t){t.type=="change"&&Le.write(this.update)}};function Yz(t,e){const n=new Set;return am.dependencies=n,t.style&&(t={...t,style:e.createAnimatedStyle(t.style)}),t=new bg(t),am.dependencies=null,[t,n]}function qz(t,e){return t&&(he.fun(t)?t(e):t.current=e),e}var wE=Symbol.for("AnimatedComponent"),Qz=(t,{applyAnimatedValues:e=()=>!1,createAnimatedStyle:n=i=>new bg(i),getComponentProps:r=i=>i}={})=>{const i={applyAnimatedValues:e,createAnimatedStyle:n,getComponentProps:r},s=o=>{const a=bE(o)||"Anonymous";return he.str(o)?o=s[o]||(s[o]=vE(o,i)):o=o[wE]||(o[wE]=vE(o,i)),o.displayName=`Animated(${a})`,o};return zo(t,(o,a)=>{he.arr(t)&&(a=bE(o)),s[a]=s(o)}),{animated:s}},bE=t=>he.str(t)?t:t&&he.str(t.displayName)?t.displayName:he.fun(t)&&t.name||null;function la(t,...e){return he.fun(t)?t(...e):t}var Mc=(t,e)=>t===!0||!!(e&&t&&(he.fun(t)?t(e):mo(t).includes(e))),a_=(t,e)=>he.obj(t)?e&&t[e]:t,eF=(t,e)=>t.default===!0?t[e]:t.default?t.default[e]:void 0,tF=t=>t,l_=(t,e=tF)=>{let n=nF;t.default&&t.default!==!0&&(t=t.default,n=Object.keys(t));const r={};for(const i of n){const s=e(t[i],i);he.und(s)||(r[i]=s)}return r},nF=["config","onProps","onStart","onChange","onPause","onResume","onRest"],rF={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function iF(t){const e={};let n=0;if(zo(t,(r,i)=>{rF[i]||(e[i]=r,n++)}),n)return e}function u_(t){const e=iF(t);if(e){const n={to:e};return zo(t,(r,i)=>i in e||(n[i]=r)),n}return{...t}}function Dd(t){return t=Xn(t),he.arr(t)?t.map(Dd):vg(t)?vi.createStringInterpolator({range:[0,1],output:[t,t]})(1):t}function Aw(t){return he.fun(t)||he.arr(t)&&he.obj(t[0])}var sF={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},Pw={...sF.default,mass:1,damping:1,easing:YO.linear,clamp:!1},oF=class{constructor(){this.velocity=0,Object.assign(this,Pw)}};function aF(t,e,n){n&&(n={...n},xE(n,e),e={...n,...e}),xE(t,e),Object.assign(t,e);for(const o in Pw)t[o]==null&&(t[o]=Pw[o]);let{frequency:r,damping:i}=t;const{mass:s}=t;return he.und(r)||(r<.01&&(r=.01),i<0&&(i=0),t.tension=Math.pow(2*Math.PI/r,2)*s,t.friction=4*Math.PI*i*s/r),t}function xE(t,e){if(!he.und(e.decay))t.duration=void 0;else{const n=!he.und(e.tension)||!he.und(e.friction);(n||!he.und(e.frequency)||!he.und(e.damping)||!he.und(e.mass))&&(t.duration=void 0,t.decay=void 0),n&&(t.frequency=void 0)}}var SE=[],lF=class{constructor(){this.changed=!1,this.values=SE,this.toValues=null,this.fromValues=SE,this.config=new oF,this.immediate=!1}};function uF(t,{key:e,props:n,defaultProps:r,state:i,actions:s}){return new Promise((o,a)=>{let l,u,c=Mc(n.cancel??(r==null?void 0:r.cancel),e);if(c)f();else{he.und(n.pause)||(i.paused=Mc(n.pause,e));let p=r==null?void 0:r.pause;p!==!0&&(p=i.paused||Mc(p,e)),l=la(n.delay||0,e),p?(i.resumeQueue.add(h),s.pause()):(s.resume(),h())}function d(){i.resumeQueue.add(h),i.timeouts.delete(u),u.cancel(),l=u.time-Le.now()}function h(){l>0&&!vi.skipAnimation?(i.delayed=!0,u=Le.setTimeout(f,l),i.pauseQueue.add(d),i.timeouts.add(u)):f()}function f(){i.delayed&&(i.delayed=!1),i.pauseQueue.delete(d),i.timeouts.delete(u),t<=(i.cancelId||0)&&(c=!0);try{s.start({...n,callId:t,cancel:c},o)}catch(p){a(p)}}})}var cF=(t,e)=>e.length==1?e[0]:e.some(n=>n.cancelled)?Dc(t.get()):e.every(n=>n.noop)?c_(t.get()):ri(t.get(),e.every(n=>n.finished)),c_=t=>({value:t,noop:!0,finished:!0,cancelled:!1}),ri=(t,e,n=!1)=>({value:t,finished:e,cancelled:n}),Dc=t=>({value:t,cancelled:!0,finished:!1});function dF(t,e,n,r){const{callId:i,parentId:s,onRest:o}=e,{asyncTo:a,promise:l}=n;return!s&&t===a&&!e.reset?l:n.promise=(async()=>{n.asyncId=i,n.asyncTo=t;const u=l_(e,(b,y)=>y==="onRest"?void 0:b);let c,d;const h=new Promise((b,y)=>(c=b,d=y)),f=b=>{const y=i<=(n.cancelId||0)&&Dc(r)||i!==n.asyncId&&ri(r,!1);if(y)throw b.result=y,d(b),b},p=(b,y)=>{const v=new kE,w=new CE;return(async()=>{if(vi.skipAnimation)throw Tw(n),w.result=ri(r,!1),d(w),w;f(v);const S=he.obj(b)?{...b}:{...y,to:b};S.parentId=i,zo(u,(E,T)=>{he.und(S[T])&&(S[T]=E)});const C=await r.start(S);return f(v),n.paused&&await new Promise(E=>{n.resumeQueue.add(E)}),C})()};let g;if(vi.skipAnimation)return Tw(n),ri(r,!1);try{let b;he.arr(t)?b=(async y=>{for(const v of y)await p(v)})(t):b=Promise.resolve(t(p,r.stop.bind(r))),await Promise.all([b.then(c),h]),g=ri(r.get(),!0,!1)}catch(b){if(b instanceof kE)g=b.result;else if(b instanceof CE)g=b.result;else throw b}finally{i==n.asyncId&&(n.asyncId=s,n.asyncTo=s?a:void 0,n.promise=s?l:void 0)}return he.fun(o)&&Le.batchedUpdates(()=>{o(g,r,r.item)}),g})()}function Tw(t,e){GO(t.timeouts,n=>n.cancel()),t.pauseQueue.clear(),t.resumeQueue.clear(),t.asyncId=t.asyncTo=t.promise=void 0,e&&(t.cancelId=e)}var kE=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},CE=class extends Error{constructor(){super("SkipAnimationSignal")}},$w=t=>t instanceof tx,hF=1,tx=class extends qO{constructor(){super(...arguments),this.id=hF++,this._priority=0}get priority(){return this._priority}set priority(t){this._priority!=t&&(this._priority=t,this._onPriorityChange(t))}get(){const t=$i(this);return t&&t.getValue()}to(...t){return vi.to(this,t)}interpolate(...t){return Fz(),vi.to(this,t)}toJSON(){return this.get()}observerAdded(t){t==1&&this._attach()}observerRemoved(t){t==0&&this._detach()}_attach(){}_detach(){}_onChange(t,e=!1){Od(this,{type:"change",parent:this,value:t,idle:e})}_onPriorityChange(t){this.idle||pg.sort(this),Od(this,{type:"priority",parent:this,priority:t})}},Fa=Symbol.for("SpringPhase"),d_=1,Nw=2,Ow=4,ny=t=>(t[Fa]&d_)>0,Hs=t=>(t[Fa]&Nw)>0,Zu=t=>(t[Fa]&Ow)>0,EE=(t,e)=>e?t[Fa]|=Nw|d_:t[Fa]&=~Nw,AE=(t,e)=>e?t[Fa]|=Ow:t[Fa]&=~Ow,pt=class extends tx{constructor(t,e){if(super(),this.animation=new lF,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!he.und(t)||!he.und(e)){const n=he.obj(t)?{...t}:{...e,from:t};he.und(n.default)&&(n.default=!0),this.start(n)}}get idle(){return!(Hs(this)||this._state.asyncTo)||Zu(this)}get goal(){return Xn(this.animation.to)}get velocity(){const t=$i(this);return t instanceof sh?t.lastVelocity||0:t.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return ny(this)}get isAnimating(){return Hs(this)}get isPaused(){return Zu(this)}get isDelayed(){return this._state.delayed}advance(t){let e=!0,n=!1;const r=this.animation;let{toValues:i}=r;const{config:s}=r,o=wg(r.to);!o&&Mr(r.to)&&(i=mo(Xn(r.to))),r.values.forEach((u,c)=>{if(u.done)return;const d=u.constructor==Md?1:o?o[c].lastPosition:i[c];let h=r.immediate,f=d;if(!h){if(f=u.lastPosition,s.tension<=0){u.done=!0;return}let p=u.elapsedTime+=t;const g=r.fromValues[c],b=u.v0!=null?u.v0:u.v0=he.arr(s.velocity)?s.velocity[c]:s.velocity;let y;const v=s.precision||(g==d?.005:Math.min(1,Math.abs(d-g)*.001));if(he.und(s.duration))if(s.decay){const w=s.decay===!0?.998:s.decay,S=Math.exp(-(1-w)*p);f=g+b/(1-w)*(1-S),h=Math.abs(u.lastPosition-f)<=v,y=b*S}else{y=u.lastVelocity==null?b:u.lastVelocity;const w=s.restVelocity||v/10,S=s.clamp?0:s.bounce,C=!he.und(S),E=g==d?u.v0>0:g<d;let T,A=!1;const N=1,R=Math.ceil(t/N);for(let O=0;O<R&&(T=Math.abs(y)>w,!(!T&&(h=Math.abs(d-f)<=v,h)));++O){C&&(A=f==d||f>d==E,A&&(y=-y*S,f=d));const j=-s.tension*1e-6*(f-d),z=-s.friction*.001*y,I=(j+z)/s.mass;y=y+I*N,f=f+y*N}}else{let w=1;s.duration>0&&(this._memoizedDuration!==s.duration&&(this._memoizedDuration=s.duration,u.durationProgress>0&&(u.elapsedTime=s.duration*u.durationProgress,p=u.elapsedTime+=t)),w=(s.progress||0)+p/this._memoizedDuration,w=w>1?1:w<0?0:w,u.durationProgress=w),f=g+s.easing(w)*(d-g),y=(f-u.lastPosition)/t,h=w==1}u.lastVelocity=y,Number.isNaN(f)&&(console.warn("Got NaN while animating:",this),h=!0)}o&&!o[c].done&&(h=!1),h?u.done=!0:e=!1,u.setValue(f,s.round)&&(n=!0)});const a=$i(this),l=a.getValue();if(e){const u=Xn(r.to);(l!==u||n)&&!s.decay?(a.setValue(u),this._onChange(u)):n&&s.decay&&this._onChange(l),this._stop()}else n&&this._onChange(l)}set(t){return Le.batchedUpdates(()=>{this._stop(),this._focus(t),this._set(t)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(Hs(this)){const{to:t,config:e}=this.animation;Le.batchedUpdates(()=>{this._onStart(),e.decay||this._set(t,!1),this._stop()})}return this}update(t){return(this.queue||(this.queue=[])).push(t),this}start(t,e){let n;return he.und(t)?(n=this.queue||[],this.queue=[]):n=[he.obj(t)?t:{...e,to:t}],Promise.all(n.map(r=>this._update(r))).then(r=>cF(this,r))}stop(t){const{to:e}=this.animation;return this._focus(this.get()),Tw(this._state,t&&this._lastCallId),Le.batchedUpdates(()=>this._stop(e,t)),this}reset(){this._update({reset:!0})}eventObserved(t){t.type=="change"?this._start():t.type=="priority"&&(this.priority=t.priority+1)}_prepareNode(t){const e=this.key||"";let{to:n,from:r}=t;n=he.obj(n)?n[e]:n,(n==null||Aw(n))&&(n=void 0),r=he.obj(r)?r[e]:r,r==null&&(r=void 0);const i={to:n,from:r};return ny(this)||(t.reverse&&([n,r]=[r,n]),r=Xn(r),he.und(r)?$i(this)||this._set(n):this._set(r)),i}_update({...t},e){const{key:n,defaultProps:r}=this;t.default&&Object.assign(r,l_(t,(o,a)=>/^on/.test(a)?a_(o,n):o)),TE(this,t,"onProps"),Yu(this,"onProps",t,this);const i=this._prepareNode(t);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");const s=this._state;return uF(++this._lastCallId,{key:n,props:t,defaultProps:r,state:s,actions:{pause:()=>{Zu(this)||(AE(this,!0),Yh(s.pauseQueue),Yu(this,"onPause",ri(this,Ju(this,this.animation.to)),this))},resume:()=>{Zu(this)&&(AE(this,!1),Hs(this)&&this._resume(),Yh(s.resumeQueue),Yu(this,"onResume",ri(this,Ju(this,this.animation.to)),this))},start:this._merge.bind(this,i)}}).then(o=>{if(t.loop&&o.finished&&!(e&&o.noop)){const a=fF(t);if(a)return this._update(a,!0)}return o})}_merge(t,e,n){if(e.cancel)return this.stop(!0),n(Dc(this));const r=!he.und(t.to),i=!he.und(t.from);if(r||i)if(e.callId>this._lastToId)this._lastToId=e.callId;else return n(Dc(this));const{key:s,defaultProps:o,animation:a}=this,{to:l,from:u}=a;let{to:c=l,from:d=u}=t;i&&!r&&(!e.default||he.und(c))&&(c=d),e.reverse&&([c,d]=[d,c]);const h=!Qi(d,u);h&&(a.from=d),d=Xn(d);const f=!Qi(c,l);f&&this._focus(c);const p=Aw(e.to),{config:g}=a,{decay:b,velocity:y}=g;(r||i)&&(g.velocity=0),e.config&&!p&&aF(g,la(e.config,s),e.config!==o.config?la(o.config,s):void 0);let v=$i(this);if(!v||he.und(c))return n(ri(this,!0));const w=he.und(e.reset)?i&&!e.default:!he.und(d)&&Mc(e.reset,s),S=w?d:this.get(),C=Dd(c),E=he.num(C)||he.arr(C)||vg(C),T=!p&&(!E||Mc(o.immediate||e.immediate,s));if(f){const O=Ew(c);if(O!==v.constructor)if(T)v=this._set(C);else throw Error(`Cannot animate between ${v.constructor.name} and ${O.name}, as the "to" prop suggests`)}const A=v.constructor;let N=Mr(c),R=!1;if(!N){const O=w||!ny(this)&&h;(f||O)&&(R=Qi(Dd(S),C),N=!R),(!Qi(a.immediate,T)&&!T||!Qi(g.decay,b)||!Qi(g.velocity,y))&&(N=!0)}if(R&&Hs(this)&&(a.changed&&!w?N=!0:N||this._stop(l)),!p&&((N||Mr(l))&&(a.values=v.getPayload(),a.toValues=Mr(c)?null:A==Md?[1]:mo(C)),a.immediate!=T&&(a.immediate=T,!T&&!w&&this._set(l)),N)){const{onRest:O}=a;on(mF,z=>TE(this,e,z));const j=ri(this,Ju(this,l));Yh(this._pendingCalls,j),this._pendingCalls.add(n),a.changed&&Le.batchedUpdates(()=>{var z;a.changed=!w,O==null||O(j,this),w?la(o.onRest,j):(z=a.onStart)==null||z.call(a,j,this)})}w&&this._set(S),p?n(dF(e.to,e,this._state,this)):N?this._start():Hs(this)&&!f?this._pendingCalls.add(n):n(c_(S))}_focus(t){const e=this.animation;t!==e.to&&(gE(this)&&this._detach(),e.to=t,gE(this)&&this._attach())}_attach(){let t=0;const{to:e}=this.animation;Mr(e)&&(gg(e,this),$w(e)&&(t=e.priority+1)),this.priority=t}_detach(){const{to:t}=this.animation;Mr(t)&&_d(t,this)}_set(t,e=!0){const n=Xn(t);if(!he.und(n)){const r=$i(this);if(!r||!Qi(n,r.getValue())){const i=Ew(n);!r||r.constructor!=i?ex(this,i.create(n)):r.setValue(n),r&&Le.batchedUpdates(()=>{this._onChange(n,e)})}}return $i(this)}_onStart(){const t=this.animation;t.changed||(t.changed=!0,Yu(this,"onStart",ri(this,Ju(this,t.to)),this))}_onChange(t,e){e||(this._onStart(),la(this.animation.onChange,t,this)),la(this.defaultProps.onChange,t,this),super._onChange(t,e)}_start(){const t=this.animation;$i(this).reset(Xn(t.to)),t.immediate||(t.fromValues=t.values.map(e=>e.lastPosition)),Hs(this)||(EE(this,!0),Zu(this)||this._resume())}_resume(){vi.skipAnimation?this.finish():pg.start(this)}_stop(t,e){if(Hs(this)){EE(this,!1);const n=this.animation;on(n.values,i=>{i.done=!0}),n.toValues&&(n.onChange=n.onPause=n.onResume=void 0),Od(this,{type:"idle",parent:this});const r=e?Dc(this.get()):ri(this.get(),Ju(this,t??n.to));Yh(this._pendingCalls,r),n.changed&&(n.changed=!1,Yu(this,"onRest",r,this))}}};function Ju(t,e){const n=Dd(e),r=Dd(t.get());return Qi(r,n)}function fF(t,e=t.loop,n=t.to){const r=la(e);if(r){const i=r!==!0&&u_(r),s=(i||t).reverse,o=!i||i.reset;return pF({...t,loop:e,default:!1,pause:void 0,to:!s||Aw(n)?n:void 0,from:o?t.from:void 0,reset:o,...i})}}function pF(t){const{to:e,from:n}=t=u_(t),r=new Set;return he.obj(e)&&PE(e,r),he.obj(n)&&PE(n,r),t.keys=r.size?Array.from(r):null,t}function PE(t,e){zo(t,(n,r)=>n!=null&&e.add(r))}var mF=["onStart","onRest","onChange","onPause","onResume"];function TE(t,e,n){t.animation[n]=e[n]!==eF(e,n)?a_(e[n],t.key):void 0}function Yu(t,e,...n){var r,i,s,o;(i=(r=t.animation)[e])==null||i.call(r,...n),(o=(s=t.defaultProps)[e])==null||o.call(s,...n)}var nx=({children:t,...e})=>{const n=m.useContext(lm),r=e.pause||!!n.pause,i=e.immediate||!!n.immediate;e=Hz(()=>({pause:r,immediate:i}),[r,i]);const{Provider:s}=lm;return m.createElement(s,{value:e},t)},lm=gF(nx,{});nx.Provider=lm.Provider;nx.Consumer=lm.Consumer;function gF(t,e){return Object.assign(t,m.createContext(e)),t.Provider._context=t,t.Consumer._context=t,t}var yF=class extends tx{constructor(t,e){super(),this.source=t,this.idle=!0,this._active=new Set,this.calc=$d(...e);const n=this._get(),r=Ew(n);ex(this,r.create(n))}advance(t){const e=this._get(),n=this.get();Qi(e,n)||($i(this).setValue(e),this._onChange(e,this.idle)),!this.idle&&$E(this._active)&&ry(this)}_get(){const t=he.arr(this.source)?this.source.map(Xn):mo(Xn(this.source));return this.calc(...t)}_start(){this.idle&&!$E(this._active)&&(this.idle=!1,on(wg(this),t=>{t.done=!1}),vi.skipAnimation?(Le.batchedUpdates(()=>this.advance()),ry(this)):pg.start(this))}_attach(){let t=1;on(mo(this.source),e=>{Mr(e)&&gg(e,this),$w(e)&&(e.idle||this._active.add(e),t=Math.max(t,e.priority+1))}),this.priority=t,this._start()}_detach(){on(mo(this.source),t=>{Mr(t)&&_d(t,this)}),this._active.clear(),ry(this)}eventObserved(t){t.type=="change"?t.idle?this.advance():(this._active.add(t.parent),this._start()):t.type=="idle"?this._active.delete(t.parent):t.type=="priority"&&(this.priority=mo(this.source).reduce((e,n)=>Math.max(e,($w(n)?n.priority:0)+1),0))}};function vF(t){return t.idle!==!1}function $E(t){return!t.size||Array.from(t).every(vF)}function ry(t){t.idle||(t.idle=!0,on(wg(t),e=>{e.done=!0}),Od(t,{type:"idle",parent:t}))}vi.assign({createStringInterpolator:t_,to:(t,e)=>new yF(t,e)});var h_=/^--/;function wF(t,e){return e==null||typeof e=="boolean"||e===""?"":typeof e=="number"&&e!==0&&!h_.test(t)&&!(Ic.hasOwnProperty(t)&&Ic[t])?e+"px":(""+e).trim()}var NE={};function bF(t,e){if(!t.nodeType||!t.setAttribute)return!1;const n=t.nodeName==="filter"||t.parentNode&&t.parentNode.nodeName==="filter",{style:r,children:i,scrollTop:s,scrollLeft:o,viewBox:a,...l}=e,u=Object.values(l),c=Object.keys(l).map(d=>n||t.hasAttribute(d)?d:NE[d]||(NE[d]=d.replace(/([A-Z])/g,h=>"-"+h.toLowerCase())));i!==void 0&&(t.textContent=i);for(const d in r)if(r.hasOwnProperty(d)){const h=wF(d,r[d]);h_.test(d)?t.style.setProperty(d,h):t.style[d]=h}c.forEach((d,h)=>{t.setAttribute(d,u[h])}),s!==void 0&&(t.scrollTop=s),o!==void 0&&(t.scrollLeft=o),a!==void 0&&t.setAttribute("viewBox",a)}var Ic={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xF=(t,e)=>t+e.charAt(0).toUpperCase()+e.substring(1),SF=["Webkit","Ms","Moz","O"];Ic=Object.keys(Ic).reduce((t,e)=>(SF.forEach(n=>t[xF(n,e)]=t[e]),t),Ic);var kF=/^(matrix|translate|scale|rotate|skew)/,CF=/^(translate)/,EF=/^(rotate|skew)/,iy=(t,e)=>he.num(t)&&t!==0?t+e:t,Jf=(t,e)=>he.arr(t)?t.every(n=>Jf(n,e)):he.num(t)?t===e:parseFloat(t)===e,AF=class extends bg{constructor({x:t,y:e,z:n,...r}){const i=[],s=[];(t||e||n)&&(i.push([t||0,e||0,n||0]),s.push(o=>[`translate3d(${o.map(a=>iy(a,"px")).join(",")})`,Jf(o,0)])),zo(r,(o,a)=>{if(a==="transform")i.push([o||""]),s.push(l=>[l,l===""]);else if(kF.test(a)){if(delete r[a],he.und(o))return;const l=CF.test(a)?"px":EF.test(a)?"deg":"";i.push(mo(o)),s.push(a==="rotate3d"?([u,c,d,h])=>[`rotate3d(${u},${c},${d},${iy(h,l)})`,Jf(h,0)]:u=>[`${a}(${u.map(c=>iy(c,l)).join(",")})`,Jf(u,a.startsWith("scale")?1:0)])}}),i.length&&(r.transform=new PF(i,s)),super(r)}},PF=class extends qO{constructor(t,e){super(),this.inputs=t,this.transforms=e,this._value=null}get(){return this._value||(this._value=this._get())}_get(){let t="",e=!0;return on(this.inputs,(n,r)=>{const i=Xn(n[0]),[s,o]=this.transforms[r](he.arr(i)?i:n.map(Xn));t+=" "+s,e=e&&o}),e?"none":t}observerAdded(t){t==1&&on(this.inputs,e=>on(e,n=>Mr(n)&&gg(n,this)))}observerRemoved(t){t==0&&on(this.inputs,e=>on(e,n=>Mr(n)&&_d(n,this)))}eventObserved(t){t.type=="change"&&(this._value=null),Od(this,t)}},TF=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"];vi.assign({batchedUpdates:Ds.unstable_batchedUpdates,createStringInterpolator:t_,colors:xz});var $F=Qz(TF,{applyAnimatedValues:bF,createAnimatedStyle:t=>new AF(t),getComponentProps:({scrollTop:t,scrollLeft:e,...n})=>n}),Dt=$F.animated;const ot={blue:{500:"#3b82f6"},mantis:{400:"#82bd69"},red:{500:"#ef4444"},stone:{600:"#57534e",700:"#44403c",800:"#292524"},white:"#ffffff"},He=(t=ot.stone[800])=>({backgroundColor:new pt(t),opacity:new pt(1)}),Kt=()=>({strokeDashoffset:new pt(1),opacity:new pt(1)}),rx={bus:{address:{stroke:new pt(ot.stone[700])},data:{stroke:new pt(ot.stone[700])},rd:{stroke:new pt(ot.stone[700])},wr:{stroke:new pt(ot.stone[700])},iom:Kt(),mem:{stroke:new pt(ot.red[500])},handshake:Kt(),pic:Kt(),pio:Kt(),timer:Kt(),intr:Kt(),inta:Kt(),int0:Kt(),int1:Kt(),int2:Kt(),"switches->pio":Kt(),"pio->leds":Kt(),printer:{data:Kt(),strobe:Kt(),busy:Kt()}},clock:{angle:new pt(0)},cpu:{internalBus:{address:{strokeDashoffset:new pt(1),opacity:new pt(1),path:new pt("")},data:{strokeDashoffset:new pt(1),opacity:new pt(1),path:new pt("")}},alu:{operands:Kt(),results:Kt(),cog:{rot:new pt(0)},operation:{backgroundColor:new pt(ot.stone[800])}},decoder:{path:Kt(),progress:{progress:new pt(0),opacity:new pt(1)}},AX:He(),BX:He(),CX:He(),DX:He(),SP:He(),IP:He(),IR:He(),ri:He(),id:He(),left:He(),right:He(),result:He(),FLAGS:He(),MAR:He(),MBR:He()},handshake:{DATA:He(),STATE:He()},memory:{"operating-cell":{color:new pt(ot.white)}},pic:{IMR:He(),IRR:He(),ISR:He(),INT0:He(),INT1:He(),INT2:He(),INT3:He(),INT4:He(),INT5:He(),INT6:He(),INT7:He()},pio:{PA:He(),PB:He(),CA:He(),CB:He()},printer:{printing:{progress:new pt(0),opacity:new pt(1)}},timer:{CONT:He(),COMP:He()}};function nt(t){return XT(rx,t)}function f_(t){const e={};for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];r instanceof pt?e[n]=r.get():e[n]=f_(r)}return e}const NF=f_(rx);function p_(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];r instanceof pt?r.set(e[n]):p_(t[n],e[n])}}const OF=()=>p_(rx,NF),Id=new Set;async function Ge(t,e){const n=Q.get(xn);if(n.type==="stopped")return null;if(n.type==="paused")return await new Promise(s=>{const o=Q.sub(xn,()=>{o(),s()})}),await Ge(t,e);const r=gi();if(!r.animations&&!e.forceMs)return null;const i={duration:e.forceMs?e.duration:e.duration*r.executionUnit,easing:YO[e.easing]};return Array.isArray(t)||(t=[t]),await Promise.all(t.map(async({key:s,from:o,to:a})=>{if(a===void 0&&o===void 0)return null;const l=nt(s);if(a===void 0)return l.set(o);{Id.add(s);const u=await nt(s).start({from:o,to:a,config:i});return Id.delete(s),u}}))}const _F=()=>Id.forEach(t=>nt(t).pause()),RF=()=>Id.forEach(t=>nt(t).resume());function MF(){Id.forEach(t=>nt(t).stop(!0)),setTimeout(()=>OF(),10)}async function Nr(t,e=ot.mantis[400]){return await Ge({key:`${t}.backgroundColor`,to:e},{duration:1,easing:"easeOutQuart"})}async function Or(t){return await Ge({key:`${t}.backgroundColor`,to:ot.stone[800]},{duration:1,easing:"easeOutQuart"})}async function hu(t){await Ge({key:"bus.data.stroke",to:ot.mantis[400]},{duration:5,easing:"easeOutSine"}),await Nr("cpu.MBR"),Q.set(rm,t),await Or("cpu.MBR")}async function Ur(t,e){return await Ge([{key:`${t}.strokeDashoffset`,from:1,to:0},{key:`${t}.opacity`,from:1}],{duration:e,easing:"easeInOutSine"})}async function On(t){return await Ge({key:`${t}.opacity`,to:0},{duration:1,easing:"easeInSine"})}async function DF(t){switch(t.type){case"bus:io.selected":{await Promise.all([Ge({key:"bus.mem.stroke",to:ot.stone[700]},{duration:1,easing:"easeInSine"}),Ur(`bus.${t.chip}`,15)]);return}case"bus:io.error":{fu(t.error);return}case"bus:reset":{await Promise.all([Ge([{key:"bus.address.stroke",to:ot.stone[700]},{key:"bus.data.stroke",to:ot.stone[700]},{key:"bus.rd.stroke",to:ot.stone[700]},{key:"bus.wr.stroke",to:ot.stone[700]}],{duration:1,easing:"easeInSine"}),Ge({key:"bus.mem.stroke",to:ot.red[500]},{duration:1,easing:"easeOutSine"}),On("bus.iom"),On("bus.handshake"),On("bus.pio"),On("bus.pic"),On("bus.timer")]);return}default:return t}}async function IF(t){switch(t.type){case"clock:tick":return;default:return t.type}}function LF(t){switch(t){case"IP":return"M 551 309 H 575 V 349 H 598";case"SP":return"M 551 349 H 598";case"ri":return"M 544 388 H 575 V 349 H 598";default:throw new Error(`Invalid register ${t}`)}}function BF(){const{path:t,...e}=nt("cpu.internalBus.address");return x.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0",children:[x.jsx("path",{className:"fill-none stroke-stone-700 stroke-bus",strokeLinejoin:"round",d:["M 551 309 H 575 V 349","M 551 349 H 575","M 544 388 H 575 V 349","M 551 349 H 598"].join(" ")}),x.jsx(Dt.path,{d:t,className:"fill-none stroke-blue-500 stroke-bus",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:e})]})}var ix={exports:{}},Ul=typeof Reflect=="object"?Reflect:null,OE=Ul&&typeof Ul.apply=="function"?Ul.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},Yf;Ul&&typeof Ul.ownKeys=="function"?Yf=Ul.ownKeys:Object.getOwnPropertySymbols?Yf=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Yf=function(e){return Object.getOwnPropertyNames(e)};function jF(t){console&&console.warn&&console.warn(t)}var m_=Number.isNaN||function(e){return e!==e};function rt(){rt.init.call(this)}ix.exports=rt;ix.exports.once=VF;rt.EventEmitter=rt;rt.prototype._events=void 0;rt.prototype._eventsCount=0;rt.prototype._maxListeners=void 0;var _E=10;function xg(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(rt,"defaultMaxListeners",{enumerable:!0,get:function(){return _E},set:function(t){if(typeof t!="number"||t<0||m_(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");_E=t}});rt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};rt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||m_(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function g_(t){return t._maxListeners===void 0?rt.defaultMaxListeners:t._maxListeners}rt.prototype.getMaxListeners=function(){return g_(this)};rt.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")OE(l,this,n);else for(var u=l.length,c=x_(l,u),r=0;r<u;++r)OE(c[r],this,n);return!0};function y_(t,e,n,r){var i,s,o;if(xg(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),o===void 0)o=s[e]=n,++t._eventsCount;else if(typeof o=="function"?o=s[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),i=g_(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,jF(a)}return t}rt.prototype.addListener=function(e,n){return y_(this,e,n,!1)};rt.prototype.on=rt.prototype.addListener;rt.prototype.prependListener=function(e,n){return y_(this,e,n,!0)};function zF(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function v_(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=zF.bind(r);return i.listener=n,r.wrapFn=i,i}rt.prototype.once=function(e,n){return xg(n),this.on(e,v_(this,e,n)),this};rt.prototype.prependOnceListener=function(e,n){return xg(n),this.prependListener(e,v_(this,e,n)),this};rt.prototype.removeListener=function(e,n){var r,i,s,o,a;if(xg(n),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){a=r[o].listener,s=o;break}if(s<0)return this;s===0?r.shift():FF(r,s),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};rt.prototype.off=rt.prototype.removeListener;rt.prototype.removeAllListeners=function(e){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var s=Object.keys(r),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(e,n[i]);return this};function w_(t,e,n){var r=t._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?UF(i):x_(i,i.length)}rt.prototype.listeners=function(e){return w_(this,e,!0)};rt.prototype.rawListeners=function(e){return w_(this,e,!1)};rt.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):b_.call(t,e)};rt.prototype.listenerCount=b_;function b_(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}rt.prototype.eventNames=function(){return this._eventsCount>0?Yf(this._events):[]};function x_(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function FF(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function UF(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function VF(t,e){return new Promise(function(n,r){function i(o){t.removeListener(e,s),r(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),n([].slice.call(arguments))}S_(t,e,s,{once:!0}),e!=="error"&&HF(t,i,{once:!0})})}function HF(t,e,n){typeof t.on=="function"&&S_(t,"error",e,n)}function S_(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){r.once&&t.removeEventListener(e,i),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var WF=ix.exports;function Ji(t){if(typeof t!="function")throw new Error("obliterator/iterator: expecting a function!");this.next=t}typeof Symbol<"u"&&(Ji.prototype[Symbol.iterator]=function(){return this});Ji.of=function(){var t=arguments,e=t.length,n=0;return new Ji(function(){return n>=e?{done:!0}:{done:!1,value:t[n++]}})};Ji.empty=function(){var t=new Ji(function(){return{done:!0}});return t};Ji.fromSequence=function(t){var e=0,n=t.length;return new Ji(function(){return e>=n?{done:!0}:{done:!1,value:t[e++]}})};Ji.is=function(t){return t instanceof Ji?!0:typeof t=="object"&&t!==null&&typeof t.next=="function"};var Sg=Ji;const Kr=Cu(Sg);var kg={};kg.ARRAY_BUFFER_SUPPORT=typeof ArrayBuffer<"u";kg.SYMBOL_SUPPORT=typeof Symbol<"u";var GF=Sg,k_=kg,KF=k_.ARRAY_BUFFER_SUPPORT,XF=k_.SYMBOL_SUPPORT;function ZF(t){return typeof t=="string"||Array.isArray(t)||KF&&ArrayBuffer.isView(t)?GF.fromSequence(t):typeof t!="object"||t===null?null:XF&&typeof t[Symbol.iterator]=="function"?t[Symbol.iterator]():typeof t.next=="function"?t:null}var C_=function(e){var n=ZF(e);if(!n)throw new Error("obliterator: target is not iterable nor a valid iterator.");return n},JF=C_,YF=function(e,n){for(var r=arguments.length>1?n:1/0,i=r!==1/0?new Array(r):[],s,o=0,a=JF(e);;){if(o===r)return i;if(s=a.next(),s.done)return o!==n&&(i.length=o),i;i[o++]=s.value}};const E_=Cu(YF);var qF=Sg,QF=C_,eU=function(){var e=arguments,n=null,r=-1;return new qF(function(){var s=null;do{if(n===null){if(r++,r>=e.length)return{done:!0};n=QF(e[r])}if(s=n.next(),s.done===!0){n=null;continue}break}while(!0);return s})};const ks=Cu(eU);function tU(){const t=arguments[0];for(let e=1,n=arguments.length;e<n;e++)if(arguments[e])for(const r in arguments[e])t[r]=arguments[e][r];return t}let Ht=tU;typeof Object.assign=="function"&&(Ht=Object.assign);function Vr(t,e,n,r){const i=t._nodes.get(e);let s=null;return i&&(r==="mixed"?s=i.out&&i.out[n]||i.undirected&&i.undirected[n]:r==="directed"?s=i.out&&i.out[n]:s=i.undirected&&i.undirected[n]),s}function an(t){return typeof t=="object"&&t!==null}function A_(t){let e;for(e in t)return!1;return!0}function Er(t,e,n){Object.defineProperty(t,e,{enumerable:!1,configurable:!1,writable:!0,value:n})}function Jr(t,e,n){const r={enumerable:!0,configurable:!0};typeof n=="function"?r.get=n:(r.value=n,r.writable=!1),Object.defineProperty(t,e,r)}function RE(t){return!(!an(t)||t.attributes&&!Array.isArray(t.attributes))}function nU(){let t=Math.floor(Math.random()*256)&255;return()=>t++}class sx extends Error{constructor(e){super(),this.name="GraphError",this.message=e}}class de extends sx{constructor(e){super(e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,de.prototype.constructor)}}class ue extends sx{constructor(e){super(e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,ue.prototype.constructor)}}class Te extends sx{constructor(e){super(e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Te.prototype.constructor)}}function P_(t,e){this.key=t,this.attributes=e,this.clear()}P_.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function T_(t,e){this.key=t,this.attributes=e,this.clear()}T_.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function $_(t,e){this.key=t,this.attributes=e,this.clear()}$_.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function _u(t,e,n,r,i){this.key=e,this.attributes=i,this.undirected=t,this.source=n,this.target=r}_u.prototype.attach=function(){let t="out",e="in";this.undirected&&(t=e="undirected");const n=this.source.key,r=this.target.key;this.source[t][r]=this,!(this.undirected&&n===r)&&(this.target[e][n]=this)};_u.prototype.attachMulti=function(){let t="out",e="in";const n=this.source.key,r=this.target.key;this.undirected&&(t=e="undirected");const i=this.source[t],s=i[r];if(typeof s>"u"){i[r]=this,this.undirected&&n===r||(this.target[e][n]=this);return}s.previous=this,this.next=s,i[r]=this,this.target[e][n]=this};_u.prototype.detach=function(){const t=this.source.key,e=this.target.key;let n="out",r="in";this.undirected&&(n=r="undirected"),delete this.source[n][e],delete this.target[r][t]};_u.prototype.detachMulti=function(){const t=this.source.key,e=this.target.key;let n="out",r="in";this.undirected&&(n=r="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[n][e],delete this.target[r][t]):(this.next.previous=void 0,this.source[n][e]=this.next,this.target[r][t]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const N_=0,O_=1,rU=2,__=3;function js(t,e,n,r,i,s,o){let a,l,u,c;if(r=""+r,n===N_){if(a=t._nodes.get(r),!a)throw new ue(`Graph.${e}: could not find the "${r}" node in the graph.`);u=i,c=s}else if(n===__){if(i=""+i,l=t._edges.get(i),!l)throw new ue(`Graph.${e}: could not find the "${i}" edge in the graph.`);const d=l.source.key,h=l.target.key;if(r===d)a=l.target;else if(r===h)a=l.source;else throw new ue(`Graph.${e}: the "${r}" node is not attached to the "${i}" edge (${d}, ${h}).`);u=s,c=o}else{if(l=t._edges.get(r),!l)throw new ue(`Graph.${e}: could not find the "${r}" edge in the graph.`);n===O_?a=l.source:a=l.target,u=i,c=s}return[a,u,c]}function iU(t,e,n){t.prototype[e]=function(r,i,s){const[o,a]=js(this,e,n,r,i,s);return o.attributes[a]}}function sU(t,e,n){t.prototype[e]=function(r,i){const[s]=js(this,e,n,r,i);return s.attributes}}function oU(t,e,n){t.prototype[e]=function(r,i,s){const[o,a]=js(this,e,n,r,i,s);return o.attributes.hasOwnProperty(a)}}function aU(t,e,n){t.prototype[e]=function(r,i,s,o){const[a,l,u]=js(this,e,n,r,i,s,o);return a.attributes[l]=u,this.emit("nodeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:l}),this}}function lU(t,e,n){t.prototype[e]=function(r,i,s,o){const[a,l,u]=js(this,e,n,r,i,s,o);if(typeof u!="function")throw new de(`Graph.${e}: updater should be a function.`);const c=a.attributes,d=u(c[l]);return c[l]=d,this.emit("nodeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:l}),this}}function uU(t,e,n){t.prototype[e]=function(r,i,s){const[o,a]=js(this,e,n,r,i,s);return delete o.attributes[a],this.emit("nodeAttributesUpdated",{key:o.key,type:"remove",attributes:o.attributes,name:a}),this}}function cU(t,e,n){t.prototype[e]=function(r,i,s){const[o,a]=js(this,e,n,r,i,s);if(!an(a))throw new de(`Graph.${e}: provided attributes are not a plain object.`);return o.attributes=a,this.emit("nodeAttributesUpdated",{key:o.key,type:"replace",attributes:o.attributes}),this}}function dU(t,e,n){t.prototype[e]=function(r,i,s){const[o,a]=js(this,e,n,r,i,s);if(!an(a))throw new de(`Graph.${e}: provided attributes are not a plain object.`);return Ht(o.attributes,a),this.emit("nodeAttributesUpdated",{key:o.key,type:"merge",attributes:o.attributes,data:a}),this}}function hU(t,e,n){t.prototype[e]=function(r,i,s){const[o,a]=js(this,e,n,r,i,s);if(typeof a!="function")throw new de(`Graph.${e}: provided updater is not a function.`);return o.attributes=a(o.attributes),this.emit("nodeAttributesUpdated",{key:o.key,type:"update",attributes:o.attributes}),this}}const fU=[{name:t=>`get${t}Attribute`,attacher:iU},{name:t=>`get${t}Attributes`,attacher:sU},{name:t=>`has${t}Attribute`,attacher:oU},{name:t=>`set${t}Attribute`,attacher:aU},{name:t=>`update${t}Attribute`,attacher:lU},{name:t=>`remove${t}Attribute`,attacher:uU},{name:t=>`replace${t}Attributes`,attacher:cU},{name:t=>`merge${t}Attributes`,attacher:dU},{name:t=>`update${t}Attributes`,attacher:hU}];function pU(t){fU.forEach(function({name:e,attacher:n}){n(t,e("Node"),N_),n(t,e("Source"),O_),n(t,e("Target"),rU),n(t,e("Opposite"),__)})}function mU(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Te(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Te(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,a=""+i;if(i=arguments[2],s=Vr(this,o,a,n),!s)throw new ue(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Te(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,s=this._edges.get(r),!s)throw new ue(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return s.attributes[i]}}function gU(t,e,n){t.prototype[e]=function(r){let i;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Te(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new Te(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+r,o=""+arguments[1];if(i=Vr(this,s,o,n),!i)throw new ue(`Graph.${e}: could not find an edge for the given path ("${s}" - "${o}").`)}else{if(n!=="mixed")throw new Te(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,i=this._edges.get(r),!i)throw new ue(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return i.attributes}}function yU(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Te(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Te(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,a=""+i;if(i=arguments[2],s=Vr(this,o,a,n),!s)throw new ue(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Te(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,s=this._edges.get(r),!s)throw new ue(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return s.attributes.hasOwnProperty(i)}}function vU(t,e,n){t.prototype[e]=function(r,i,s){let o;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Te(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Te(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,l=""+i;if(i=arguments[2],s=arguments[3],o=Vr(this,a,l,n),!o)throw new ue(`Graph.${e}: could not find an edge for the given path ("${a}" - "${l}").`)}else{if(n!=="mixed")throw new Te(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new ue(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return o.attributes[i]=s,this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:i}),this}}function wU(t,e,n){t.prototype[e]=function(r,i,s){let o;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Te(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new Te(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+r,l=""+i;if(i=arguments[2],s=arguments[3],o=Vr(this,a,l,n),!o)throw new ue(`Graph.${e}: could not find an edge for the given path ("${a}" - "${l}").`)}else{if(n!=="mixed")throw new Te(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,o=this._edges.get(r),!o)throw new ue(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(typeof s!="function")throw new de(`Graph.${e}: updater should be a function.`);return o.attributes[i]=s(o.attributes[i]),this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:i}),this}}function bU(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Te(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Te(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,a=""+i;if(i=arguments[2],s=Vr(this,o,a,n),!s)throw new ue(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Te(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,s=this._edges.get(r),!s)throw new ue(`Graph.${e}: could not find the "${r}" edge in the graph.`)}return delete s.attributes[i],this.emit("edgeAttributesUpdated",{key:s.key,type:"remove",attributes:s.attributes,name:i}),this}}function xU(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Te(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Te(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,a=""+i;if(i=arguments[2],s=Vr(this,o,a,n),!s)throw new ue(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Te(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,s=this._edges.get(r),!s)throw new ue(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(!an(i))throw new de(`Graph.${e}: provided attributes are not a plain object.`);return s.attributes=i,this.emit("edgeAttributesUpdated",{key:s.key,type:"replace",attributes:s.attributes}),this}}function SU(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Te(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Te(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,a=""+i;if(i=arguments[2],s=Vr(this,o,a,n),!s)throw new ue(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Te(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,s=this._edges.get(r),!s)throw new ue(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(!an(i))throw new de(`Graph.${e}: provided attributes are not a plain object.`);return Ht(s.attributes,i),this.emit("edgeAttributesUpdated",{key:s.key,type:"merge",attributes:s.attributes,data:i}),this}}function kU(t,e,n){t.prototype[e]=function(r,i){let s;if(this.type!=="mixed"&&n!=="mixed"&&n!==this.type)throw new Te(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new Te(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+r,a=""+i;if(i=arguments[2],s=Vr(this,o,a,n),!s)throw new ue(`Graph.${e}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(n!=="mixed")throw new Te(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(r=""+r,s=this._edges.get(r),!s)throw new ue(`Graph.${e}: could not find the "${r}" edge in the graph.`)}if(typeof i!="function")throw new de(`Graph.${e}: provided updater is not a function.`);return s.attributes=i(s.attributes),this.emit("edgeAttributesUpdated",{key:s.key,type:"update",attributes:s.attributes}),this}}const CU=[{name:t=>`get${t}Attribute`,attacher:mU},{name:t=>`get${t}Attributes`,attacher:gU},{name:t=>`has${t}Attribute`,attacher:yU},{name:t=>`set${t}Attribute`,attacher:vU},{name:t=>`update${t}Attribute`,attacher:wU},{name:t=>`remove${t}Attribute`,attacher:bU},{name:t=>`replace${t}Attributes`,attacher:xU},{name:t=>`merge${t}Attributes`,attacher:SU},{name:t=>`update${t}Attributes`,attacher:kU}];function EU(t){CU.forEach(function({name:e,attacher:n}){n(t,e("Edge"),"mixed"),n(t,e("DirectedEdge"),"directed"),n(t,e("UndirectedEdge"),"undirected")})}const AU=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function PU(t,e,n,r){let i=!1;for(const s in e){if(s===r)continue;const o=e[s];if(i=n(o.key,o.attributes,o.source.key,o.target.key,o.source.attributes,o.target.attributes,o.undirected),t&&i)return o.key}}function TU(t,e,n,r){let i,s,o,a=!1;for(const l in e)if(l!==r){i=e[l];do{if(s=i.source,o=i.target,a=n(i.key,i.attributes,s.key,o.key,s.attributes,o.attributes,i.undirected),t&&a)return i.key;i=i.next}while(i!==void 0)}}function sy(t,e){const n=Object.keys(t),r=n.length;let i,s=0;return new Kr(function(){do if(i)i=i.next;else{if(s>=r)return{done:!0};const a=n[s++];if(a===e){i=void 0;continue}i=t[a]}while(!i);return{done:!1,value:{edge:i.key,attributes:i.attributes,source:i.source.key,target:i.target.key,sourceAttributes:i.source.attributes,targetAttributes:i.target.attributes,undirected:i.undirected}}})}function $U(t,e,n,r){const i=e[n];if(!i)return;const s=i.source,o=i.target;if(r(i.key,i.attributes,s.key,o.key,s.attributes,o.attributes,i.undirected)&&t)return i.key}function NU(t,e,n,r){let i=e[n];if(!i)return;let s=!1;do{if(s=r(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected),t&&s)return i.key;i=i.next}while(i!==void 0)}function oy(t,e){let n=t[e];return n.next!==void 0?new Kr(function(){if(!n)return{done:!0};const r={edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected};return n=n.next,{done:!1,value:r}}):Kr.of({edge:n.key,attributes:n.attributes,source:n.source.key,target:n.target.key,sourceAttributes:n.source.attributes,targetAttributes:n.target.attributes,undirected:n.undirected})}function OU(t,e){if(t.size===0)return[];if(e==="mixed"||e===t.type)return typeof Array.from=="function"?Array.from(t._edges.keys()):E_(t._edges.keys(),t._edges.size);const n=e==="undirected"?t.undirectedSize:t.directedSize,r=new Array(n),i=e==="undirected",s=t._edges.values();let o=0,a,l;for(;a=s.next(),a.done!==!0;)l=a.value,l.undirected===i&&(r[o++]=l.key);return r}function R_(t,e,n,r){if(e.size===0)return;const i=n!=="mixed"&&n!==e.type,s=n==="undirected";let o,a,l=!1;const u=e._edges.values();for(;o=u.next(),o.done!==!0;){if(a=o.value,i&&a.undirected!==s)continue;const{key:c,attributes:d,source:h,target:f}=a;if(l=r(c,d,h.key,f.key,h.attributes,f.attributes,a.undirected),t&&l)return c}}function _U(t,e){if(t.size===0)return Kr.empty();const n=e!=="mixed"&&e!==t.type,r=e==="undirected",i=t._edges.values();return new Kr(function(){let o,a;for(;;){if(o=i.next(),o.done)return o;if(a=o.value,!(n&&a.undirected!==r))break}return{value:{edge:a.key,attributes:a.attributes,source:a.source.key,target:a.target.key,sourceAttributes:a.source.attributes,targetAttributes:a.target.attributes,undirected:a.undirected},done:!1}})}function ox(t,e,n,r,i,s){const o=e?TU:PU;let a;if(n!=="undirected"&&(r!=="out"&&(a=o(t,i.in,s),t&&a)||r!=="in"&&(a=o(t,i.out,s,r?void 0:i.key),t&&a))||n!=="directed"&&(a=o(t,i.undirected,s),t&&a))return a}function RU(t,e,n,r){const i=[];return ox(!1,t,e,n,r,function(s){i.push(s)}),i}function MU(t,e,n){let r=Kr.empty();return t!=="undirected"&&(e!=="out"&&typeof n.in<"u"&&(r=ks(r,sy(n.in))),e!=="in"&&typeof n.out<"u"&&(r=ks(r,sy(n.out,e?void 0:n.key)))),t!=="directed"&&typeof n.undirected<"u"&&(r=ks(r,sy(n.undirected))),r}function ax(t,e,n,r,i,s,o){const a=n?NU:$U;let l;if(e!=="undirected"&&(typeof i.in<"u"&&r!=="out"&&(l=a(t,i.in,s,o),t&&l)||typeof i.out<"u"&&r!=="in"&&(r||i.key!==s)&&(l=a(t,i.out,s,o),t&&l))||e!=="directed"&&typeof i.undirected<"u"&&(l=a(t,i.undirected,s,o),t&&l))return l}function DU(t,e,n,r,i){const s=[];return ax(!1,t,e,n,r,i,function(o){s.push(o)}),s}function IU(t,e,n,r){let i=Kr.empty();return t!=="undirected"&&(typeof n.in<"u"&&e!=="out"&&r in n.in&&(i=ks(i,oy(n.in,r))),typeof n.out<"u"&&e!=="in"&&r in n.out&&(e||n.key!==r)&&(i=ks(i,oy(n.out,r)))),t!=="directed"&&typeof n.undirected<"u"&&r in n.undirected&&(i=ks(i,oy(n.undirected,r))),i}function LU(t,e){const{name:n,type:r,direction:i}=e;t.prototype[n]=function(s,o){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];if(!arguments.length)return OU(this,r);if(arguments.length===1){s=""+s;const a=this._nodes.get(s);if(typeof a>"u")throw new ue(`Graph.${n}: could not find the "${s}" node in the graph.`);return RU(this.multi,r==="mixed"?this.type:r,i,a)}if(arguments.length===2){s=""+s,o=""+o;const a=this._nodes.get(s);if(!a)throw new ue(`Graph.${n}:  could not find the "${s}" source node in the graph.`);if(!this._nodes.has(o))throw new ue(`Graph.${n}:  could not find the "${o}" target node in the graph.`);return DU(r,this.multi,i,a,o)}throw new de(`Graph.${n}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function BU(t,e){const{name:n,type:r,direction:i}=e,s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(u,c,d){if(!(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)){if(arguments.length===1)return d=u,R_(!1,this,r,d);if(arguments.length===2){u=""+u,d=c;const h=this._nodes.get(u);if(typeof h>"u")throw new ue(`Graph.${s}: could not find the "${u}" node in the graph.`);return ox(!1,this.multi,r==="mixed"?this.type:r,i,h,d)}if(arguments.length===3){u=""+u,c=""+c;const h=this._nodes.get(u);if(!h)throw new ue(`Graph.${s}:  could not find the "${u}" source node in the graph.`);if(!this._nodes.has(c))throw new ue(`Graph.${s}:  could not find the "${c}" target node in the graph.`);return ax(!1,r,this.multi,i,h,c,d)}throw new de(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const o="map"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(){const u=Array.prototype.slice.call(arguments),c=u.pop();let d;if(u.length===0){let h=0;r!=="directed"&&(h+=this.undirectedSize),r!=="undirected"&&(h+=this.directedSize),d=new Array(h);let f=0;u.push((p,g,b,y,v,w,S)=>{d[f++]=c(p,g,b,y,v,w,S)})}else d=[],u.push((h,f,p,g,b,y,v)=>{d.push(c(h,f,p,g,b,y,v))});return this[s].apply(this,u),d};const a="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[a]=function(){const u=Array.prototype.slice.call(arguments),c=u.pop(),d=[];return u.push((h,f,p,g,b,y,v)=>{c(h,f,p,g,b,y,v)&&d.push(h)}),this[s].apply(this,u),d};const l="reduce"+n[0].toUpperCase()+n.slice(1);t.prototype[l]=function(){let u=Array.prototype.slice.call(arguments);if(u.length<2||u.length>4)throw new de(`Graph.${l}: invalid number of arguments (expecting 2, 3 or 4 and got ${u.length}).`);if(typeof u[u.length-1]=="function"&&typeof u[u.length-2]!="function")throw new de(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let c,d;u.length===2?(c=u[0],d=u[1],u=[]):u.length===3?(c=u[1],d=u[2],u=[u[0]]):u.length===4&&(c=u[2],d=u[3],u=[u[0],u[1]]);let h=d;return u.push((f,p,g,b,y,v,w)=>{h=c(h,f,p,g,b,y,v,w)}),this[s].apply(this,u),h}}function jU(t,e){const{name:n,type:r,direction:i}=e,s="find"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(l,u,c){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return!1;if(arguments.length===1)return c=l,R_(!0,this,r,c);if(arguments.length===2){l=""+l,c=u;const d=this._nodes.get(l);if(typeof d>"u")throw new ue(`Graph.${s}: could not find the "${l}" node in the graph.`);return ox(!0,this.multi,r==="mixed"?this.type:r,i,d,c)}if(arguments.length===3){l=""+l,u=""+u;const d=this._nodes.get(l);if(!d)throw new ue(`Graph.${s}:  could not find the "${l}" source node in the graph.`);if(!this._nodes.has(u))throw new ue(`Graph.${s}:  could not find the "${u}" target node in the graph.`);return ax(!0,r,this.multi,i,d,u,c)}throw new de(`Graph.${s}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const o="some"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[o]=function(){const l=Array.prototype.slice.call(arguments),u=l.pop();return l.push((d,h,f,p,g,b,y)=>u(d,h,f,p,g,b,y)),!!this[s].apply(this,l)};const a="every"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[a]=function(){const l=Array.prototype.slice.call(arguments),u=l.pop();return l.push((d,h,f,p,g,b,y)=>!u(d,h,f,p,g,b,y)),!this[s].apply(this,l)}}function zU(t,e){const{name:n,type:r,direction:i}=e,s=n.slice(0,-1)+"Entries";t.prototype[s]=function(o,a){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return Kr.empty();if(!arguments.length)return _U(this,r);if(arguments.length===1){o=""+o;const l=this._nodes.get(o);if(!l)throw new ue(`Graph.${s}: could not find the "${o}" node in the graph.`);return MU(r,i,l)}if(arguments.length===2){o=""+o,a=""+a;const l=this._nodes.get(o);if(!l)throw new ue(`Graph.${s}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(a))throw new ue(`Graph.${s}:  could not find the "${a}" target node in the graph.`);return IU(r,i,l,a)}throw new de(`Graph.${s}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function FU(t){AU.forEach(e=>{LU(t,e),BU(t,e),jU(t,e),zU(t,e)})}const UU=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function Cg(){this.A=null,this.B=null}Cg.prototype.wrap=function(t){this.A===null?this.A=t:this.B===null&&(this.B=t)};Cg.prototype.has=function(t){return this.A!==null&&t in this.A||this.B!==null&&t in this.B};function qu(t,e,n,r,i){for(const s in r){const o=r[s],a=o.source,l=o.target,u=a===n?l:a;if(e&&e.has(u.key))continue;const c=i(u.key,u.attributes);if(t&&c)return u.key}}function lx(t,e,n,r,i){if(e!=="mixed"){if(e==="undirected")return qu(t,null,r,r.undirected,i);if(typeof n=="string")return qu(t,null,r,r[n],i)}const s=new Cg;let o;if(e!=="undirected"){if(n!=="out"){if(o=qu(t,null,r,r.in,i),t&&o)return o;s.wrap(r.in)}if(n!=="in"){if(o=qu(t,s,r,r.out,i),t&&o)return o;s.wrap(r.out)}}if(e!=="directed"&&(o=qu(t,s,r,r.undirected,i),t&&o))return o}function VU(t,e,n){if(t!=="mixed"){if(t==="undirected")return Object.keys(n.undirected);if(typeof e=="string")return Object.keys(n[e])}const r=[];return lx(!1,t,e,n,function(i){r.push(i)}),r}function Qu(t,e,n){const r=Object.keys(n),i=r.length;let s=0;return new Kr(function(){let a=null;do{if(s>=i)return t&&t.wrap(n),{done:!0};const l=n[r[s++]],u=l.source,c=l.target;if(a=u===e?c:u,t&&t.has(a.key)){a=null;continue}}while(a===null);return{done:!1,value:{neighbor:a.key,attributes:a.attributes}}})}function HU(t,e,n){if(t!=="mixed"){if(t==="undirected")return Qu(null,n,n.undirected);if(typeof e=="string")return Qu(null,n,n[e])}let r=Kr.empty();const i=new Cg;return t!=="undirected"&&(e!=="out"&&(r=ks(r,Qu(i,n,n.in))),e!=="in"&&(r=ks(r,Qu(i,n,n.out)))),t!=="directed"&&(r=ks(r,Qu(i,n,n.undirected))),r}function WU(t,e){const{name:n,type:r,direction:i}=e;t.prototype[n]=function(s){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return[];s=""+s;const o=this._nodes.get(s);if(typeof o>"u")throw new ue(`Graph.${n}: could not find the "${s}" node in the graph.`);return VU(r==="mixed"?this.type:r,i,o)}}function GU(t,e){const{name:n,type:r,direction:i}=e,s="forEach"+n[0].toUpperCase()+n.slice(1,-1);t.prototype[s]=function(u,c){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return;u=""+u;const d=this._nodes.get(u);if(typeof d>"u")throw new ue(`Graph.${s}: could not find the "${u}" node in the graph.`);lx(!1,r==="mixed"?this.type:r,i,d,c)};const o="map"+n[0].toUpperCase()+n.slice(1);t.prototype[o]=function(u,c){const d=[];return this[s](u,(h,f)=>{d.push(c(h,f))}),d};const a="filter"+n[0].toUpperCase()+n.slice(1);t.prototype[a]=function(u,c){const d=[];return this[s](u,(h,f)=>{c(h,f)&&d.push(h)}),d};const l="reduce"+n[0].toUpperCase()+n.slice(1);t.prototype[l]=function(u,c,d){if(arguments.length<3)throw new de(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let h=d;return this[s](u,(f,p)=>{h=c(h,f,p)}),h}}function KU(t,e){const{name:n,type:r,direction:i}=e,s=n[0].toUpperCase()+n.slice(1,-1),o="find"+s;t.prototype[o]=function(u,c){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return;u=""+u;const d=this._nodes.get(u);if(typeof d>"u")throw new ue(`Graph.${o}: could not find the "${u}" node in the graph.`);return lx(!0,r==="mixed"?this.type:r,i,d,c)};const a="some"+s;t.prototype[a]=function(u,c){return!!this[o](u,c)};const l="every"+s;t.prototype[l]=function(u,c){return!this[o](u,(h,f)=>!c(h,f))}}function XU(t,e){const{name:n,type:r,direction:i}=e,s=n.slice(0,-1)+"Entries";t.prototype[s]=function(o){if(r!=="mixed"&&this.type!=="mixed"&&r!==this.type)return Kr.empty();o=""+o;const a=this._nodes.get(o);if(typeof a>"u")throw new ue(`Graph.${s}: could not find the "${o}" node in the graph.`);return HU(r==="mixed"?this.type:r,i,a)}}function ZU(t){UU.forEach(e=>{WU(t,e),GU(t,e),KU(t,e),XU(t,e)})}function tf(t,e,n,r,i){const s=r._nodes.values(),o=r.type;let a,l,u,c,d,h,f;for(;a=s.next(),a.done!==!0;){let p=!1;if(l=a.value,o!=="undirected"){c=l.out;for(u in c){d=c[u];do{if(h=d.target,p=!0,f=i(l.key,h.key,l.attributes,h.attributes,d.key,d.attributes,d.undirected),t&&f)return d;d=d.next}while(d)}}if(o!=="directed"){c=l.undirected;for(u in c)if(!(e&&l.key>u)){d=c[u];do{if(h=d.target,h.key!==u&&(h=d.source),p=!0,f=i(l.key,h.key,l.attributes,h.attributes,d.key,d.attributes,d.undirected),t&&f)return d;d=d.next}while(d)}}if(n&&!p&&(f=i(l.key,null,l.attributes,null,null,null,null),t&&f))return null}}function JU(t,e){const n={key:t};return A_(e.attributes)||(n.attributes=Ht({},e.attributes)),n}function YU(t,e,n){const r={key:e,source:n.source.key,target:n.target.key};return A_(n.attributes)||(r.attributes=Ht({},n.attributes)),t==="mixed"&&n.undirected&&(r.undirected=!0),r}function qU(t){if(!an(t))throw new de('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in t))throw new de("Graph.import: serialized node is missing its key.");if("attributes"in t&&(!an(t.attributes)||t.attributes===null))throw new de("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function QU(t){if(!an(t))throw new de('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in t))throw new de("Graph.import: serialized edge is missing its source.");if(!("target"in t))throw new de("Graph.import: serialized edge is missing its target.");if("attributes"in t&&(!an(t.attributes)||t.attributes===null))throw new de("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in t&&typeof t.undirected!="boolean")throw new de("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const eV=nU(),tV=new Set(["directed","undirected","mixed"]),ME=new Set(["domain","_events","_eventsCount","_maxListeners"]),nV=[{name:t=>`${t}Edge`,generateKey:!0},{name:t=>`${t}DirectedEdge`,generateKey:!0,type:"directed"},{name:t=>`${t}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:t=>`${t}EdgeWithKey`},{name:t=>`${t}DirectedEdgeWithKey`,type:"directed"},{name:t=>`${t}UndirectedEdgeWithKey`,type:"undirected"}],rV={allowSelfLoops:!0,multi:!1,type:"mixed"};function iV(t,e,n){if(n&&!an(n))throw new de(`Graph.addNode: invalid attributes. Expecting an object but got "${n}"`);if(e=""+e,n=n||{},t._nodes.has(e))throw new Te(`Graph.addNode: the "${e}" node already exist in the graph.`);const r=new t.NodeDataClass(e,n);return t._nodes.set(e,r),t.emit("nodeAdded",{key:e,attributes:n}),r}function DE(t,e,n){const r=new t.NodeDataClass(e,n);return t._nodes.set(e,r),t.emit("nodeAdded",{key:e,attributes:n}),r}function M_(t,e,n,r,i,s,o,a){if(!r&&t.type==="undirected")throw new Te(`Graph.${e}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(r&&t.type==="directed")throw new Te(`Graph.${e}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(a&&!an(a))throw new de(`Graph.${e}: invalid attributes. Expecting an object but got "${a}"`);if(s=""+s,o=""+o,a=a||{},!t.allowSelfLoops&&s===o)throw new Te(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const l=t._nodes.get(s),u=t._nodes.get(o);if(!l)throw new ue(`Graph.${e}: source node "${s}" not found.`);if(!u)throw new ue(`Graph.${e}: target node "${o}" not found.`);const c={key:null,undirected:r,source:s,target:o,attributes:a};if(n)i=t._edgeKeyGenerator();else if(i=""+i,t._edges.has(i))throw new Te(`Graph.${e}: the "${i}" edge already exists in the graph.`);if(!t.multi&&(r?typeof l.undirected[o]<"u":typeof l.out[o]<"u"))throw new Te(`Graph.${e}: an edge linking "${s}" to "${o}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const d=new _u(r,i,l,u,a);t._edges.set(i,d);const h=s===o;return r?(l.undirectedDegree++,u.undirectedDegree++,h&&(l.undirectedLoops++,t._undirectedSelfLoopCount++)):(l.outDegree++,u.inDegree++,h&&(l.directedLoops++,t._directedSelfLoopCount++)),t.multi?d.attachMulti():d.attach(),r?t._undirectedSize++:t._directedSize++,c.key=i,t.emit("edgeAdded",c),i}function sV(t,e,n,r,i,s,o,a,l){if(!r&&t.type==="undirected")throw new Te(`Graph.${e}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(r&&t.type==="directed")throw new Te(`Graph.${e}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(a){if(l){if(typeof a!="function")throw new de(`Graph.${e}: invalid updater function. Expecting a function but got "${a}"`)}else if(!an(a))throw new de(`Graph.${e}: invalid attributes. Expecting an object but got "${a}"`)}s=""+s,o=""+o;let u;if(l&&(u=a,a=void 0),!t.allowSelfLoops&&s===o)throw new Te(`Graph.${e}: source & target are the same ("${s}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let c=t._nodes.get(s),d=t._nodes.get(o),h,f;if(!n&&(h=t._edges.get(i),h)){if((h.source.key!==s||h.target.key!==o)&&(!r||h.source.key!==o||h.target.key!==s))throw new Te(`Graph.${e}: inconsistency detected when attempting to merge the "${i}" edge with "${s}" source & "${o}" target vs. ("${h.source.key}", "${h.target.key}").`);f=h}if(!f&&!t.multi&&c&&(f=r?c.undirected[o]:c.out[o]),f){const v=[f.key,!1,!1,!1];if(l?!u:!a)return v;if(l){const w=f.attributes;f.attributes=u(w),t.emit("edgeAttributesUpdated",{type:"replace",key:f.key,attributes:f.attributes})}else Ht(f.attributes,a),t.emit("edgeAttributesUpdated",{type:"merge",key:f.key,attributes:f.attributes,data:a});return v}a=a||{},l&&u&&(a=u(a));const p={key:null,undirected:r,source:s,target:o,attributes:a};if(n)i=t._edgeKeyGenerator();else if(i=""+i,t._edges.has(i))throw new Te(`Graph.${e}: the "${i}" edge already exists in the graph.`);let g=!1,b=!1;c||(c=DE(t,s,{}),g=!0,s===o&&(d=c,b=!0)),d||(d=DE(t,o,{}),b=!0),h=new _u(r,i,c,d,a),t._edges.set(i,h);const y=s===o;return r?(c.undirectedDegree++,d.undirectedDegree++,y&&(c.undirectedLoops++,t._undirectedSelfLoopCount++)):(c.outDegree++,d.inDegree++,y&&(c.directedLoops++,t._directedSelfLoopCount++)),t.multi?h.attachMulti():h.attach(),r?t._undirectedSize++:t._directedSize++,p.key=i,t.emit("edgeAdded",p),[i,!0,g,b]}function sl(t,e){t._edges.delete(e.key);const{source:n,target:r,attributes:i}=e,s=e.undirected,o=n===r;s?(n.undirectedDegree--,r.undirectedDegree--,o&&(n.undirectedLoops--,t._undirectedSelfLoopCount--)):(n.outDegree--,r.inDegree--,o&&(n.directedLoops--,t._directedSelfLoopCount--)),t.multi?e.detachMulti():e.detach(),s?t._undirectedSize--:t._directedSize--,t.emit("edgeDropped",{key:e.key,attributes:i,source:n.key,target:r.key,undirected:s})}class at extends WF.EventEmitter{constructor(e){if(super(),e=Ht({},rV,e),typeof e.multi!="boolean")throw new de(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${e.multi}".`);if(!tV.has(e.type))throw new de(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${e.type}".`);if(typeof e.allowSelfLoops!="boolean")throw new de(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${e.allowSelfLoops}".`);const n=e.type==="mixed"?P_:e.type==="directed"?T_:$_;Er(this,"NodeDataClass",n);const r="geid_"+eV()+"_";let i=0;const s=()=>{let o;do o=r+i++;while(this._edges.has(o));return o};Er(this,"_attributes",{}),Er(this,"_nodes",new Map),Er(this,"_edges",new Map),Er(this,"_directedSize",0),Er(this,"_undirectedSize",0),Er(this,"_directedSelfLoopCount",0),Er(this,"_undirectedSelfLoopCount",0),Er(this,"_edgeKeyGenerator",s),Er(this,"_options",e),ME.forEach(o=>Er(this,o,this[o])),Jr(this,"order",()=>this._nodes.size),Jr(this,"size",()=>this._edges.size),Jr(this,"directedSize",()=>this._directedSize),Jr(this,"undirectedSize",()=>this._undirectedSize),Jr(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),Jr(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),Jr(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),Jr(this,"multi",this._options.multi),Jr(this,"type",this._options.type),Jr(this,"allowSelfLoops",this._options.allowSelfLoops),Jr(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(e){return this._nodes.has(""+e)}hasDirectedEdge(e,n){if(this.type==="undirected")return!1;if(arguments.length===1){const r=""+e,i=this._edges.get(r);return!!i&&!i.undirected}else if(arguments.length===2){e=""+e,n=""+n;const r=this._nodes.get(e);return r?r.out.hasOwnProperty(n):!1}throw new de(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(e,n){if(this.type==="directed")return!1;if(arguments.length===1){const r=""+e,i=this._edges.get(r);return!!i&&i.undirected}else if(arguments.length===2){e=""+e,n=""+n;const r=this._nodes.get(e);return r?r.undirected.hasOwnProperty(n):!1}throw new de(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(e,n){if(arguments.length===1){const r=""+e;return this._edges.has(r)}else if(arguments.length===2){e=""+e,n=""+n;const r=this._nodes.get(e);return r?typeof r.out<"u"&&r.out.hasOwnProperty(n)||typeof r.undirected<"u"&&r.undirected.hasOwnProperty(n):!1}throw new de(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(e,n){if(this.type==="undirected")return;if(e=""+e,n=""+n,this.multi)throw new Te("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const r=this._nodes.get(e);if(!r)throw new ue(`Graph.directedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ue(`Graph.directedEdge: could not find the "${n}" target node in the graph.`);const i=r.out&&r.out[n]||void 0;if(i)return i.key}undirectedEdge(e,n){if(this.type==="directed")return;if(e=""+e,n=""+n,this.multi)throw new Te("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const r=this._nodes.get(e);if(!r)throw new ue(`Graph.undirectedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ue(`Graph.undirectedEdge: could not find the "${n}" target node in the graph.`);const i=r.undirected&&r.undirected[n]||void 0;if(i)return i.key}edge(e,n){if(this.multi)throw new Te("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new ue(`Graph.edge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(n))throw new ue(`Graph.edge: could not find the "${n}" target node in the graph.`);const i=r.out&&r.out[n]||r.undirected&&r.undirected[n]||void 0;if(i)return i.key}areDirectedNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new ue(`Graph.areDirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in r.in||n in r.out}areOutNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new ue(`Graph.areOutNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in r.out}areInNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new ue(`Graph.areInNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:n in r.in}areUndirectedNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new ue(`Graph.areUndirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="directed"?!1:n in r.undirected}areNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new ue(`Graph.areNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&(n in r.in||n in r.out)||this.type!=="directed"&&n in r.undirected}areInboundNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new ue(`Graph.areInboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in r.in||this.type!=="directed"&&n in r.undirected}areOutboundNeighbors(e,n){e=""+e,n=""+n;const r=this._nodes.get(e);if(!r)throw new ue(`Graph.areOutboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&n in r.out||this.type!=="directed"&&n in r.undirected}inDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ue(`Graph.inDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree}outDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ue(`Graph.outDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree}directedDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ue(`Graph.directedDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree}undirectedDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ue(`Graph.undirectedDegree: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree}inboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ue(`Graph.inboundDegree: could not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=n.undirectedDegree),this.type!=="undirected"&&(r+=n.inDegree),r}outboundDegree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ue(`Graph.outboundDegree: could not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=n.undirectedDegree),this.type!=="undirected"&&(r+=n.outDegree),r}degree(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ue(`Graph.degree: could not find the "${e}" node in the graph.`);let r=0;return this.type!=="directed"&&(r+=n.undirectedDegree),this.type!=="undirected"&&(r+=n.inDegree+n.outDegree),r}inDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ue(`Graph.inDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree-n.directedLoops}outDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ue(`Graph.outDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.outDegree-n.directedLoops}directedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ue(`Graph.directedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:n.inDegree+n.outDegree-n.directedLoops*2}undirectedDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ue(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:n.undirectedDegree-n.undirectedLoops*2}inboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ue(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=n.undirectedDegree,i+=n.undirectedLoops*2),this.type!=="undirected"&&(r+=n.inDegree,i+=n.directedLoops),r-i}outboundDegreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ue(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=n.undirectedDegree,i+=n.undirectedLoops*2),this.type!=="undirected"&&(r+=n.outDegree,i+=n.directedLoops),r-i}degreeWithoutSelfLoops(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ue(`Graph.degreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let r=0,i=0;return this.type!=="directed"&&(r+=n.undirectedDegree,i+=n.undirectedLoops*2),this.type!=="undirected"&&(r+=n.inDegree+n.outDegree,i+=n.directedLoops*2),r-i}source(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ue(`Graph.source: could not find the "${e}" edge in the graph.`);return n.source.key}target(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ue(`Graph.target: could not find the "${e}" edge in the graph.`);return n.target.key}extremities(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ue(`Graph.extremities: could not find the "${e}" edge in the graph.`);return[n.source.key,n.target.key]}opposite(e,n){e=""+e,n=""+n;const r=this._edges.get(n);if(!r)throw new ue(`Graph.opposite: could not find the "${n}" edge in the graph.`);const i=r.source.key,s=r.target.key;if(e===i)return s;if(e===s)return i;throw new ue(`Graph.opposite: the "${e}" node is not attached to the "${n}" edge (${i}, ${s}).`)}hasExtremity(e,n){e=""+e,n=""+n;const r=this._edges.get(e);if(!r)throw new ue(`Graph.hasExtremity: could not find the "${e}" edge in the graph.`);return r.source.key===n||r.target.key===n}isUndirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ue(`Graph.isUndirected: could not find the "${e}" edge in the graph.`);return n.undirected}isDirected(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ue(`Graph.isDirected: could not find the "${e}" edge in the graph.`);return!n.undirected}isSelfLoop(e){e=""+e;const n=this._edges.get(e);if(!n)throw new ue(`Graph.isSelfLoop: could not find the "${e}" edge in the graph.`);return n.source===n.target}addNode(e,n){return iV(this,e,n).key}mergeNode(e,n){if(n&&!an(n))throw new de(`Graph.mergeNode: invalid attributes. Expecting an object but got "${n}"`);e=""+e,n=n||{};let r=this._nodes.get(e);return r?(n&&(Ht(r.attributes,n),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:r.attributes,data:n})),[e,!1]):(r=new this.NodeDataClass(e,n),this._nodes.set(e,r),this.emit("nodeAdded",{key:e,attributes:n}),[e,!0])}updateNode(e,n){if(n&&typeof n!="function")throw new de(`Graph.updateNode: invalid updater function. Expecting a function but got "${n}"`);e=""+e;let r=this._nodes.get(e);if(r){if(n){const s=r.attributes;r.attributes=n(s),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:r.attributes})}return[e,!1]}const i=n?n({}):{};return r=new this.NodeDataClass(e,i),this._nodes.set(e,r),this.emit("nodeAdded",{key:e,attributes:i}),[e,!0]}dropNode(e){e=""+e;const n=this._nodes.get(e);if(!n)throw new ue(`Graph.dropNode: could not find the "${e}" node in the graph.`);let r;if(this.type!=="undirected"){for(const i in n.out){r=n.out[i];do sl(this,r),r=r.next;while(r)}for(const i in n.in){r=n.in[i];do sl(this,r),r=r.next;while(r)}}if(this.type!=="directed")for(const i in n.undirected){r=n.undirected[i];do sl(this,r),r=r.next;while(r)}this._nodes.delete(e),this.emit("nodeDropped",{key:e,attributes:n.attributes})}dropEdge(e){let n;if(arguments.length>1){const r=""+arguments[0],i=""+arguments[1];if(n=Vr(this,r,i,this.type),!n)throw new ue(`Graph.dropEdge: could not find the "${r}" -> "${i}" edge in the graph.`)}else if(e=""+e,n=this._edges.get(e),!n)throw new ue(`Graph.dropEdge: could not find the "${e}" edge in the graph.`);return sl(this,n),this}dropDirectedEdge(e,n){if(arguments.length<2)throw new Te("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Te("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");e=""+e,n=""+n;const r=Vr(this,e,n,"directed");if(!r)throw new ue(`Graph.dropDirectedEdge: could not find a "${e}" -> "${n}" edge in the graph.`);return sl(this,r),this}dropUndirectedEdge(e,n){if(arguments.length<2)throw new Te("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new Te("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const r=Vr(this,e,n,"undirected");if(!r)throw new ue(`Graph.dropUndirectedEdge: could not find a "${e}" -> "${n}" edge in the graph.`);return sl(this,r),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const e=this._nodes.values();let n;for(;n=e.next(),n.done!==!0;)n.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(e){return this._attributes[e]}getAttributes(){return this._attributes}hasAttribute(e){return this._attributes.hasOwnProperty(e)}setAttribute(e,n){return this._attributes[e]=n,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}updateAttribute(e,n){if(typeof n!="function")throw new de("Graph.updateAttribute: updater should be a function.");const r=this._attributes[e];return this._attributes[e]=n(r),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}removeAttribute(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),this}replaceAttributes(e){if(!an(e))throw new de("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(e){if(!an(e))throw new de("Graph.mergeAttributes: provided attributes are not a plain object.");return Ht(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this}updateAttributes(e){if(typeof e!="function")throw new de("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(e,n){if(typeof e!="function")throw new de("Graph.updateEachNodeAttributes: expecting an updater function.");if(n&&!RE(n))throw new de("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._nodes.values();let i,s;for(;i=r.next(),i.done!==!0;)s=i.value,s.attributes=e(s.key,s.attributes);this.emit("eachNodeAttributesUpdated",{hints:n||null})}updateEachEdgeAttributes(e,n){if(typeof e!="function")throw new de("Graph.updateEachEdgeAttributes: expecting an updater function.");if(n&&!RE(n))throw new de("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const r=this._edges.values();let i,s,o,a;for(;i=r.next(),i.done!==!0;)s=i.value,o=s.source,a=s.target,s.attributes=e(s.key,s.attributes,o.key,a.key,o.attributes,a.attributes,s.undirected);this.emit("eachEdgeAttributesUpdated",{hints:n||null})}forEachAdjacencyEntry(e){if(typeof e!="function")throw new de("Graph.forEachAdjacencyEntry: expecting a callback.");tf(!1,!1,!1,this,e)}forEachAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new de("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");tf(!1,!1,!0,this,e)}forEachAssymetricAdjacencyEntry(e){if(typeof e!="function")throw new de("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");tf(!1,!0,!1,this,e)}forEachAssymetricAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new de("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");tf(!1,!0,!0,this,e)}nodes(){return typeof Array.from=="function"?Array.from(this._nodes.keys()):E_(this._nodes.keys(),this._nodes.size)}forEachNode(e){if(typeof e!="function")throw new de("Graph.forEachNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)i=r.value,e(i.key,i.attributes)}findNode(e){if(typeof e!="function")throw new de("Graph.findNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)if(i=r.value,e(i.key,i.attributes))return i.key}mapNodes(e){if(typeof e!="function")throw new de("Graph.mapNode: expecting a callback.");const n=this._nodes.values();let r,i;const s=new Array(this.order);let o=0;for(;r=n.next(),r.done!==!0;)i=r.value,s[o++]=e(i.key,i.attributes);return s}someNode(e){if(typeof e!="function")throw new de("Graph.someNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)if(i=r.value,e(i.key,i.attributes))return!0;return!1}everyNode(e){if(typeof e!="function")throw new de("Graph.everyNode: expecting a callback.");const n=this._nodes.values();let r,i;for(;r=n.next(),r.done!==!0;)if(i=r.value,!e(i.key,i.attributes))return!1;return!0}filterNodes(e){if(typeof e!="function")throw new de("Graph.filterNodes: expecting a callback.");const n=this._nodes.values();let r,i;const s=[];for(;r=n.next(),r.done!==!0;)i=r.value,e(i.key,i.attributes)&&s.push(i.key);return s}reduceNodes(e,n){if(typeof e!="function")throw new de("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new de("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let r=n;const i=this._nodes.values();let s,o;for(;s=i.next(),s.done!==!0;)o=s.value,r=e(r,o.key,o.attributes);return r}nodeEntries(){const e=this._nodes.values();return new Kr(()=>{const n=e.next();if(n.done)return n;const r=n.value;return{value:{node:r.key,attributes:r.attributes},done:!1}})}export(){const e=new Array(this._nodes.size);let n=0;this._nodes.forEach((i,s)=>{e[n++]=JU(s,i)});const r=new Array(this._edges.size);return n=0,this._edges.forEach((i,s)=>{r[n++]=YU(this.type,s,i)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:e,edges:r}}import(e,n=!1){if(e instanceof at)return e.forEachNode((l,u)=>{n?this.mergeNode(l,u):this.addNode(l,u)}),e.forEachEdge((l,u,c,d,h,f,p)=>{n?p?this.mergeUndirectedEdgeWithKey(l,c,d,u):this.mergeDirectedEdgeWithKey(l,c,d,u):p?this.addUndirectedEdgeWithKey(l,c,d,u):this.addDirectedEdgeWithKey(l,c,d,u)}),this;if(!an(e))throw new de("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!an(e.attributes))throw new de("Graph.import: invalid attributes. Expecting a plain object.");n?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}let r,i,s,o,a;if(e.nodes){if(s=e.nodes,!Array.isArray(s))throw new de("Graph.import: invalid nodes. Expecting an array.");for(r=0,i=s.length;r<i;r++){o=s[r],qU(o);const{key:l,attributes:u}=o;n?this.mergeNode(l,u):this.addNode(l,u)}}if(e.edges){let l=!1;if(this.type==="undirected"&&(l=!0),s=e.edges,!Array.isArray(s))throw new de("Graph.import: invalid edges. Expecting an array.");for(r=0,i=s.length;r<i;r++){a=s[r],QU(a);const{source:u,target:c,attributes:d,undirected:h=l}=a;let f;"key"in a?(f=n?h?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:h?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,f.call(this,a.key,u,c,d)):(f=n?h?this.mergeUndirectedEdge:this.mergeDirectedEdge:h?this.addUndirectedEdge:this.addDirectedEdge,f.call(this,u,c,d))}}return this}nullCopy(e){const n=new at(Ht({},this._options,e));return n.replaceAttributes(Ht({},this.getAttributes())),n}emptyCopy(e){const n=this.nullCopy(e);return this._nodes.forEach((r,i)=>{const s=Ht({},r.attributes);r=new n.NodeDataClass(i,s),n._nodes.set(i,r)}),n}copy(e){if(e=e||{},typeof e.type=="string"&&e.type!==this.type&&e.type!=="mixed")throw new Te(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${e.type}" because this would mean losing information about the current graph.`);if(typeof e.multi=="boolean"&&e.multi!==this.multi&&e.multi!==!0)throw new Te("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof e.allowSelfLoops=="boolean"&&e.allowSelfLoops!==this.allowSelfLoops&&e.allowSelfLoops!==!0)throw new Te("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const n=this.emptyCopy(e),r=this._edges.values();let i,s;for(;i=r.next(),i.done!==!0;)s=i.value,M_(n,"copy",!1,s.undirected,s.key,s.source.key,s.target.key,Ht({},s.attributes));return n}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const e={};this._nodes.forEach((s,o)=>{e[o]=s.attributes});const n={},r={};this._edges.forEach((s,o)=>{const a=s.undirected?"--":"->";let l="",u=s.source.key,c=s.target.key,d;s.undirected&&u>c&&(d=u,u=c,c=d);const h=`(${u})${a}(${c})`;o.startsWith("geid_")?this.multi&&(typeof r[h]>"u"?r[h]=0:r[h]++,l+=`${r[h]}. `):l+=`[${o}]: `,l+=h,n[l]=s.attributes});const i={};for(const s in this)this.hasOwnProperty(s)&&!ME.has(s)&&typeof this[s]!="function"&&typeof s!="symbol"&&(i[s]=this[s]);return i.attributes=this._attributes,i.nodes=e,i.edges=n,Er(i,"constructor",this.constructor),i}}typeof Symbol<"u"&&(at.prototype[Symbol.for("nodejs.util.inspect.custom")]=at.prototype.inspect);nV.forEach(t=>{["add","merge","update"].forEach(e=>{const n=t.name(e),r=e==="add"?M_:sV;t.generateKey?at.prototype[n]=function(i,s,o){return r(this,n,!0,(t.type||this.type)==="undirected",null,i,s,o,e==="update")}:at.prototype[n]=function(i,s,o,a){return r(this,n,!1,(t.type||this.type)==="undirected",i,s,o,a,e==="update")}})});pU(at);EU(at);FU(at);ZU(at);class D_ extends at{constructor(e){const n=Ht({type:"directed"},e);if("multi"in n&&n.multi!==!1)throw new de("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="directed")throw new de('DirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class ux extends at{constructor(e){const n=Ht({type:"undirected"},e);if("multi"in n&&n.multi!==!1)throw new de("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(n.type!=="undirected")throw new de('UndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class I_ extends at{constructor(e){const n=Ht({multi:!0},e);if("multi"in n&&n.multi!==!0)throw new de("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(n)}}class L_ extends at{constructor(e){const n=Ht({type:"directed",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new de("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="directed")throw new de('MultiDirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}class B_ extends at{constructor(e){const n=Ht({type:"undirected",multi:!0},e);if("multi"in n&&n.multi!==!0)throw new de("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(n.type!=="undirected")throw new de('MultiUndirectedGraph.from: inconsistent "'+n.type+'" type in given options!');super(n)}}function Ru(t){t.from=function(e,n){const r=Ht({},e.options,n),i=new t(r);return i.import(e),i}}Ru(at);Ru(D_);Ru(ux);Ru(I_);Ru(L_);Ru(B_);at.Graph=at;at.DirectedGraph=D_;at.UndirectedGraph=ux;at.MultiGraph=I_;at.MultiDirectedGraph=L_;at.MultiUndirectedGraph=B_;at.InvalidArgumentsGraphError=de;at.NotFoundGraphError=ue;at.UsageGraphError=Te;var oV=function(e){return e!==null&&typeof e=="object"&&typeof e.addUndirectedEdgeWithKey=="function"&&typeof e.dropNode=="function"&&typeof e.multi=="boolean"},j_=kg,aV=j_.ARRAY_BUFFER_SUPPORT,lV=j_.SYMBOL_SUPPORT,uV=function(e,n){var r,i,s,o,a;if(!e)throw new Error("obliterator/forEach: invalid iterable.");if(typeof n!="function")throw new Error("obliterator/forEach: expecting a callback.");if(Array.isArray(e)||aV&&ArrayBuffer.isView(e)||typeof e=="string"||e.toString()==="[object Arguments]"){for(s=0,o=e.length;s<o;s++)n(e[s],s);return}if(typeof e.forEach=="function"){e.forEach(n);return}if(lV&&Symbol.iterator in e&&typeof e.next!="function"&&(e=e[Symbol.iterator]()),typeof e.next=="function"){for(r=e,s=0;a=r.next(),a.done!==!0;)n(a.value,s),s++;return}for(i in e)e.hasOwnProperty(i)&&n(e[i],i)},z_=Sg,cV=uV;function zt(){this.clear()}zt.prototype.clear=function(){this.items=[],this.offset=0,this.size=0};zt.prototype.enqueue=function(t){return this.items.push(t),++this.size};zt.prototype.dequeue=function(){if(this.size){var t=this.items[this.offset];return++this.offset*2>=this.items.length&&(this.items=this.items.slice(this.offset),this.offset=0),this.size--,t}};zt.prototype.peek=function(){if(this.size)return this.items[this.offset]};zt.prototype.forEach=function(t,e){e=arguments.length>1?e:this;for(var n=this.offset,r=0,i=this.items.length;n<i;n++,r++)t.call(e,this.items[n],r,this)};zt.prototype.toArray=function(){return this.items.slice(this.offset)};zt.prototype.values=function(){var t=this.items,e=this.offset;return new z_(function(){if(e>=t.length)return{done:!0};var n=t[e];return e++,{value:n,done:!1}})};zt.prototype.entries=function(){var t=this.items,e=this.offset,n=0;return new z_(function(){if(e>=t.length)return{done:!0};var r=t[e];return e++,{value:[n++,r],done:!1}})};typeof Symbol<"u"&&(zt.prototype[Symbol.iterator]=zt.prototype.values);zt.prototype.toString=function(){return this.toArray().join(",")};zt.prototype.toJSON=function(){return this.toArray()};zt.prototype.inspect=function(){var t=this.toArray();return Object.defineProperty(t,"constructor",{value:zt,enumerable:!1}),t};typeof Symbol<"u"&&(zt.prototype[Symbol.for("nodejs.util.inspect.custom")]=zt.prototype.inspect);zt.from=function(t){var e=new zt;return cV(t,function(n){e.enqueue(n)}),e};zt.of=function(){return zt.from(arguments)};var dV=function(e,n){var r=n.length;if(r!==0){var i=e.length;e.length+=r;for(var s=0;s<r;s++)e[i+s]=n[s]}},F_=oV,hV=dV;function fV(t,e,n){if(!F_(t))throw new Error("graphology-shortest-path: invalid graphology instance.");if(arguments.length<3)throw new Error("graphology-shortest-path: invalid number of arguments. Expecting at least 3.");if(!t.hasNode(e))throw new Error('graphology-shortest-path: the "'+e+'" source node does not exist in the given graph.');if(!t.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" target node does not exist in the given graph.');if(e=""+e,n=""+n,e===n)return[e];var r=t.inboundNeighbors.bind(t),i=t.outboundNeighbors.bind(t),s={},o={};s[e]=null,o[n]=null;var a=[e],l=[n],u,c,d,h,f,p,g,b,y=!1;e:for(;a.length&&l.length;)if(a.length<=l.length){for(u=a,a=[],f=0,g=u.length;f<g;f++)for(c=u[f],d=i(c),p=0,b=d.length;p<b;p++)if(h=d[p],h in s||(a.push(h),s[h]=c),h in o){y=!0;break e}}else for(u=l,l=[],f=0,g=u.length;f<g;f++)for(c=u[f],d=r(c),p=0,b=d.length;p<b;p++)if(h=d[p],h in o||(l.push(h),o[h]=c),h in s){y=!0;break e}if(!y)return null;for(var v=[];h;)v.unshift(h),h=s[h];for(h=o[v[v.length-1]];h;)v.push(h),h=o[h];return v.length?v:null}function U_(t,e,n){if(!F_(e))throw new Error("graphology-shortest-path: invalid graphology instance.");if(!e.hasNode(n))throw new Error('graphology-shortest-path: the "'+n+'" source node does not exist in the given graph.');n=""+n;var r=new Set,i={},s=0;i[n]=0;for(var o=[n],a,l,u;o.length!==0;){var c=[];for(a=0,l=o.length;a<l;a++)u=o[a],!r.has(u)&&(r.add(u),hV(c,e[t](u)),i[u]=s);s++,o=c}return i}U_.bind(null,"outboundNeighbors");U_.bind(null,"neighbors");var pV=fV;const xe=new ux({allowSelfLoops:!1});xe.addNode("MBR",{position:[610,250]});xe.addNode("AX",{position:[522,45]});xe.addNode("BX",{position:[522,85]});xe.addNode("CX",{position:[522,125]});xe.addNode("DX",{position:[522,165]});xe.addNode("id",{position:[522,205]});xe.addNode("IP",{position:[451,309]});xe.addNode("SP",{position:[451,349]});xe.addNode("ri",{position:[451,388]});xe.addNode("result",{position:[370,130]});xe.addNode("FLAGS",{position:[250,225]});xe.addNode("IR",{position:[205,272]});xe.addNode("left",{position:[60,85]});xe.addNode("right",{position:[60,145]});xe.addNode("AX join",{position:[492,45]});xe.addNode("BX join",{position:[492,85]});xe.addNode("CX join",{position:[492,125]});xe.addNode("DX join",{position:[492,165]});xe.addNode("id join",{position:[492,205]});xe.addNode("data mbr join",{position:[492,250]});xe.addNode("IP join",{position:[421,309]});xe.addNode("SP join",{position:[421,349]});xe.addNode("ri join",{position:[421,388]});xe.addNode("addresses mbr join",{position:[421,250]});xe.addNode("result mbr join",{position:[370,250]});xe.addNode("FLAGS mbr join",{position:[250,250]});xe.addNode("IR mbr join",{position:[205,250]});xe.addNode("left join",{position:[30,85]});xe.addNode("right join",{position:[30,145]});xe.addNode("operands mbr join",{position:[30,250]});xe.addUndirectedEdge("AX","AX join");xe.addUndirectedEdge("BX","BX join");xe.addUndirectedEdge("CX","CX join");xe.addUndirectedEdge("DX","DX join");xe.addUndirectedEdge("id","id join");xe.addUndirectedEdge("AX join","BX join");xe.addUndirectedEdge("BX join","CX join");xe.addUndirectedEdge("CX join","DX join");xe.addUndirectedEdge("DX join","id join");xe.addUndirectedEdge("id join","data mbr join");xe.addUndirectedEdge("data mbr join","MBR");xe.addUndirectedEdge("IP","IP join");xe.addUndirectedEdge("SP","SP join");xe.addUndirectedEdge("ri","ri join");xe.addUndirectedEdge("IP join","SP join");xe.addUndirectedEdge("SP join","ri join");xe.addUndirectedEdge("IP join","addresses mbr join");xe.addUndirectedEdge("addresses mbr join","data mbr join");xe.addUndirectedEdge("result","result mbr join");xe.addUndirectedEdge("result mbr join","addresses mbr join");xe.addUndirectedEdge("FLAGS","FLAGS mbr join");xe.addUndirectedEdge("FLAGS mbr join","result mbr join");xe.addUndirectedEdge("IR","IR mbr join");xe.addUndirectedEdge("IR mbr join","FLAGS mbr join");xe.addUndirectedEdge("left","left join");xe.addUndirectedEdge("right","right join");xe.addUndirectedEdge("left join","right join");xe.addUndirectedEdge("right join","operands mbr join");xe.addUndirectedEdge("operands mbr join","IR mbr join");function mV(t,e){const n=pV(xe,t,e);if(!n)throw new Error(`No path from ${t} to ${e}`);const r=xe.getNodeAttribute(n[0],"position");let i=`M ${r[0]} ${r[1]}`;for(let s=1;s<n.length;s++){const[o,a]=xe.getNodeAttribute(n[s],"position");i+=` L ${o} ${a}`}return i}function gV(){const{path:t,...e}=nt("cpu.internalBus.data");return x.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0",children:[x.jsx("path",{className:"fill-none stroke-stone-700 stroke-bus",strokeLinejoin:"round",d:["M 60 85 H 30","V 250 H 610","M 60 145 H 30","M 370 130 V 250","M 250 225 V 250","M 173 85 H 220","M 182 145 H 220","M 272 115 h 28","M 250 145 v 46","M 205 250 V 272","M 205 300 V 320","M 451 388 H 421","V 250","M 451 349 H 421","M 451 309 H 421","M 522 45 H 492","V 250","M 522 85 H 492","M 522 125 H 492","M 522 165 H 492","M 522 205 H 492"].join(" ")}),x.jsx(Dt.path,{d:t,className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:e})]})}const ay=(t,e)=>{const n=mV(t,e);return Ge([{key:"cpu.internalBus.data.path",from:n},{key:"cpu.internalBus.data.opacity",from:1},{key:"cpu.internalBus.data.strokeDashoffset",from:1,to:0}],{duration:5,easing:"easeInOutSine"})},ly=()=>Ge({key:"cpu.internalBus.data.opacity",to:0},{duration:1,easing:"easeInSine"});async function yV(t){switch(t.type){case"cpu:alu.execute":{const e={duration:3,easing:"easeInOutSine"};await Ge([{key:"cpu.alu.operands.opacity",from:1},{key:"cpu.alu.operands.strokeDashoffset",from:1,to:0}],e),Q.set(zO,t.operation),await Promise.all([Ge({key:"cpu.alu.operation.backgroundColor",to:ot.mantis[400]},{duration:1,easing:"easeOutQuart"}),Ge({key:"cpu.alu.cog.rot",to:6},{duration:10,easing:"easeInOutCubic"})]),await Promise.all([Ge({key:"cpu.alu.operation.backgroundColor",to:ot.stone[800]},{duration:1,easing:"easeOutQuart"}),Ge([{key:"cpu.alu.results.opacity",from:1},{key:"cpu.alu.results.strokeDashoffset",from:1,to:0}],e)]),await Promise.all([Nr("cpu.result"),Nr("cpu.FLAGS")]),Q.set(mt.FLAGS,t.flags),Q.set(mt.result,t.result),await Promise.all([Or("cpu.result"),Or("cpu.FLAGS")]),await Ge([{key:"cpu.alu.operands.opacity",to:0},{key:"cpu.alu.results.opacity",to:0}],{duration:1,easing:"easeInSine"});return}case"cpu:cycle.end":return;case"cpu:cycle.interrupt":{Q.set(Ti,e=>"metadata"in e?{...e,phase:"interrupt"}:e),await Ge([{key:"cpu.id.opacity",to:1},{key:"cpu.ri.opacity",to:1}],{duration:.5,easing:"easeInOutQuad"});return}case"cpu:cycle.start":{BO(t.instruction.position.start),Q.set(Ti,{phase:"fetching",metadata:t.instruction}),await Ge([{key:"cpu.id.opacity",to:t.instruction.willUse.id?1:.4},{key:"cpu.ri.opacity",to:t.instruction.willUse.ri?1:.4}],{duration:.5,easing:"easeInOutQuad"});return}case"cpu:cycle.update":{Q.set(Ti,e=>"metadata"in e?{...e,phase:t.phase==="execute"?"executing":t.phase==="writeback"?"writeback":t.next==="fetch-operands"?"fetching-operands":t.next==="execute"?"executing":t.next==="writeback"?"writeback":e.phase}:e);return}case"cpu:decode":{await Ge([{key:"cpu.decoder.path.opacity",from:1},{key:"cpu.decoder.path.strokeDashoffset",from:1,to:0}],{duration:3,easing:"easeInOutSine"}),await Ge([{key:"cpu.decoder.progress.opacity",from:1},{key:"cpu.decoder.progress.progress",from:0,to:1}],{duration:3,easing:"easeInOutSine"}),await Ge([{key:"cpu.decoder.path.opacity",to:0},{key:"cpu.decoder.progress.opacity",to:0}],{duration:1,easing:"easeInSine"});return}case"cpu:error":{Q.set(Ti,{phase:"stopped",error:t.error}),fu(t.error);return}case"cpu:halt":case"cpu:int.0":{Q.set(Ti,{phase:"stopped"}),fu();return}case"cpu:int.3":{Rw();return}case"cpu:int.6":{Q.set(Ti,{phase:"int6"});return}case"cpu:int.7":{Q.set(Ti,{phase:"int7"});return}case"cpu:inta.off":{await On("bus.inta");return}case"cpu:inta.on":{await Ur("bus.inta",10);return}case"cpu:rd.on":case"cpu:wr.on":{const e=t.type.slice(4,6);await Ge({key:`bus.${e}.stroke`,to:ot.red[500]},{duration:5,easing:"easeOutSine"});return}case"cpu:iom.on":{await Ur("bus.iom",15);return}case"cpu:mar.set":{await Ge([{key:"cpu.internalBus.address.path",from:LF(t.register)},{key:"cpu.internalBus.address.opacity",from:1},{key:"cpu.internalBus.address.strokeDashoffset",from:1,to:0}],{duration:5,easing:"easeInOutSine"}),await Nr("cpu.MAR",ot.blue[500]),Q.set(jO,Q.get(mt[t.register])),await Ge({key:"bus.address.stroke",to:ot.blue[500]},{duration:5,easing:"easeOutSine"}),await Promise.all([Or("cpu.MAR"),Ge({key:"cpu.internalBus.address.opacity",to:0},{duration:1,easing:"easeInSine"})]);return}case"cpu:mbr.get":{const[e]=oa(t.register);await ay("MBR",e),await Nr(`cpu.${e}`),Q.set(mt[t.register],Q.get(rm)),await Promise.all([Or(`cpu.${e}`),ly()]);return}case"cpu:mbr.set":{const[e]=oa(t.register);await ay(e,"MBR"),await Nr("cpu.MBR"),Q.set(rm,Q.get(mt[t.register])),await Ge({key:"bus.data.stroke",to:ot.mantis[400]},{duration:5,easing:"easeOutSine"}),await Promise.all([Or("cpu.MBR"),ly()]);return}case"cpu:register.copy":{const[e]=oa(t.src),[n]=oa(t.dest);e!==n&&await ay(e,n),await Nr(`cpu.${n}`),Q.set(mt[t.dest],Q.get(mt[t.src])),await Promise.all([Or(`cpu.${n}`),e!==n&&ly()]);return}case"cpu:register.update":{const[e]=oa(t.register);await Nr(`cpu.${e}`),Q.set(mt[t.register],t.value),await Or(`cpu.${e}`);return}default:return t}}async function vV(t){switch(t.type){case"f10:press":await Ur("bus.int0",2),await On("bus.int0");return;default:return t.type}}const cx=Ce(B.zero(8)),dx=Ce(B.zero(8));function wV(t){"handshake"in t.io&&(Q.set(cx,B.fromUnsigned(t.io.handshake.DATA,8)),Q.set(dx,B.fromUnsigned(t.io.handshake.STATE,8)))}async function bV(t){switch(t.type){case"handshake:read":return;case"handshake:read.ok":{await hu(t.value);return}case"handshake:write":case"handshake:register.update":{switch(await Nr(`handshake.${t.register}`),t.register){case"DATA":{Q.set(cx,t.value);break}case"STATE":{Q.set(dx,t.value);break}default:return t.register}await Or(`handshake.${t.register}`);return}case"handshake:write.ok":return;case"handshake:int.off":{await On("bus.int2");return}case"handshake:int.on":{await Ur("bus.int2",10);return}default:return t}}async function xV(t){switch(t.type){case"keyboard:listen-key":{Q.set(xn,e=>e.type!=="running"||e.waitingForInput?e:{...e,waitingForInput:!0}),await new Promise(e=>{Q.sub(xn,()=>{const n=Q.get(xn);(n.type!=="running"||!n.waitingForInput)&&e()})});return}case"keyboard:read":return;default:return t}}const hx=Ce(B.zero(8));function SV(t){"leds"in t.io&&Q.set(hx,B.fromUnsigned(t.io.leds,8))}async function kV(t){switch(t.type){case"leds:update":{await Ur("bus.pio->leds",2),Q.set(hx,t.state),await On("bus.pio->leds");return}default:return t.type}}const fx=Ce(new Array(be.MAX_ADDRESS+1).fill(B.zero(8))),Ld=Ce(be.from(8192)),V_=Ce(null),nf=16,CV=Ce(t=>{const e=t(V_)??t(Ld);let n=e.value-e.value%nf,r=n+nf-1;r>be.MAX_ADDRESS&&(r=be.MAX_ADDRESS,n=r-nf+1);const i=t(fx),s=[];for(let o=0;o<nf;o++)s.push({address:be.from(n+o),value:i[n+o]});return s});function EV(t){Q.set(fx,t.memory.map(e=>B.fromUnsigned(e,8))),Q.set(Ld,be.from(8192))}async function AV(t){switch(t.type){case"memory:read":return;case"memory:read.ok":{Q.set(Ld,be.from(t.address)),await Ge({key:"memory.operating-cell.color",to:ot.mantis[400]},{duration:1,easing:"easeOutQuart"}),await hu(t.value),await Ge({key:"memory.operating-cell.color",to:ot.white},{duration:1,easing:"easeOutQuart"});return}case"memory:write":return;case"memory:write.ok":{Q.set(Ld,be.from(t.address)),await Ge({key:"memory.operating-cell.color",to:ot.mantis[400]},{duration:1,easing:"easeOutQuart"}),Q.set(fx,e=>[...e.slice(0,t.address.value),t.value,...e.slice(t.address.value+1)]),await Ge({key:"memory.operating-cell.color",to:ot.white},{duration:1,easing:"easeOutQuart"});return}case"memory:read.error":case"memory:write.error":{fu(t.error);return}default:return t}}const px=Ce(B.fromUnsigned(255,8)),mx=Ce(B.fromUnsigned(0,8)),gx=Ce(B.fromUnsigned(0,8)),um=[Ce(B.zero(8)),Ce(B.zero(8)),Ce(B.zero(8)),Ce(B.zero(8)),Ce(B.zero(8)),Ce(B.zero(8)),Ce(B.zero(8)),Ce(B.zero(8))];function PV(t){if("pic"in t.io){Q.set(px,B.fromUnsigned(t.io.pic.IMR,8)),Q.set(mx,B.fromUnsigned(t.io.pic.IRR,8)),Q.set(gx,B.fromUnsigned(t.io.pic.ISR,8));for(let e=0;e<um.length;e++)Q.set(um[e],B.fromUnsigned(t.io.pic.lines[e],8))}}async function TV(t){switch(t.type){case"pic:read":return;case"pic:read.ok":{await hu(t.value);return}case"pic:write":return;case"pic:register.update":{switch(await Nr(`pic.${t.register}`),t.register){case"IMR":{Q.set(px,t.value);break}case"IRR":{Q.set(mx,t.value);break}case"ISR":{Q.set(gx,t.value);break}case"INT0":case"INT1":case"INT2":case"INT3":case"INT4":case"INT5":case"INT6":case"INT7":{const e=Number(t.register.slice(3));Q.set(um[e],t.value);break}default:return t}await Or(`pic.${t.register}`);return}case"pic:write.ok":return;case"pic:intr.off":{await On("bus.intr");return}case"pic:intr.on":{await Ur("bus.intr",10);return}case"pic:int.send":{await hu(t.number);return}default:return t}}const yx=Ce(B.zero(8)),vx=Ce(B.zero(8)),wx=Ce(B.zero(8)),bx=Ce(B.zero(8));function $V(t){"pio"in t.io&&(Q.set(yx,B.fromUnsigned(t.io.pio.PA,8)),Q.set(vx,B.fromUnsigned(t.io.pio.PB,8)),Q.set(wx,B.fromUnsigned(t.io.pio.CA,8)),Q.set(bx,B.fromUnsigned(t.io.pio.CB,8)))}async function NV(t){switch(t.type){case"pio:read":return;case"pio:read.ok":{await hu(t.value);return}case"pio:write":return;case"pio:register.update":{switch(await Nr(`pio.${t.register}`),t.register){case"PA":{Q.set(yx,t.value);break}case"PB":{Q.set(vx,t.value);break}case"CA":{Q.set(wx,t.value);break}case"CB":{Q.set(bx,t.value);break}default:return t.register}await Or(`pio.${t.register}`);return}case"pio:write.ok":return;default:return t}}const cm=Ce([]),dm=Ce("");function OV(t){"printer"in t.io&&(Q.set(cm,t.io.printer.buffer.map(e=>B.fromUnsigned(e,8))),Q.set(dm,t.io.printer.paper))}async function _V(t){switch(t.type){case"printer:buffer.add":{Q.set(cm,e=>[...e,t.char]);return}case"printer:buffer.pop":{Q.set(cm,e=>e.slice(1));return}case"printer:busy.off":{await On("bus.printer.busy");return}case"printer:busy.on":{await Ur("bus.printer.busy",15);return}case"printer:data.read":{await Ur("bus.printer.data",15),await On("bus.printer.data");return}case"printer:paper.print":{Q.set(dm,e=>e+t.char);return}case"printer:paper.replace":{Q.set(dm,"");return}case"printer:strobe.off":{await On("bus.printer.strobe");return}case"printer:strobe.on":{await Ur("bus.printer.strobe",15);return}default:return t}}const xx=Ce("");function RV(t){"screen"in t.io&&Q.set(xx,t.io.screen)}async function MV(t){switch(t.type){case"screen:send-char":{Q.set(xx,t.output);return}default:return t.type}}const Sx=Ce(B.zero(8));function DV(t){"switches"in t.io&&Q.set(Sx,B.fromUnsigned(t.io.switches,8))}async function IV(t){switch(t.type){case"switches:toggle":{Q.set(Sx,e=>e.withBit(t.index,!e.bit(t.index))),await Ur("bus.switches->pio",2),await On("bus.switches->pio");return}default:return t.type}}const kx=Ce(B.zero(8)),Cx=Ce(B.zero(8));function LV(t){"timer"in t.io&&(Q.set(kx,B.fromUnsigned(t.io.timer.CONT,8)),Q.set(Cx,B.fromUnsigned(t.io.timer.COMP,8)))}async function BV(t){switch(t.type){case"timer:read":return;case"timer:read.ok":{await hu(t.value);return}case"timer:write":return;case"timer:register.update":{switch(await Nr(`timer.${t.register}`),t.register){case"CONT":{Q.set(kx,t.value);break}case"COMP":{Q.set(Cx,t.value);break}default:return t.register}await Or(`timer.${t.register}`);return}case"timer:write.ok":return;case"timer:int.off":{await On("bus.int1");return}case"timer:int.on":{await Ur("bus.int1",10);return}default:return t}}const _w=new Set;async function jV(t){FV(t);const[e]=t.type.split(":",2);switch(_w.add(t.type),e){case"bus":{await DF(t);break}case"clock":{await IF(t);break}case"cpu":{await yV(t);break}case"f10":{await vV(t);break}case"handshake":{await bV(t);break}case"keyboard":{await xV(t);break}case"leds":{await kV(t);break}case"memory":{await AV(t);break}case"pic":{await TV(t);break}case"pio":{await NV(t);break}case"printer":{await _V(t);break}case"screen":{await MV(t);break}case"switches":{await IV(t);break}case"timer":{await BV(t);break}default:return e}_w.delete(t.type)}function IE(...t){for(const e of t)if(_w.has(e))return!0;return!1}const zV={bus:"#2563eb",clock:"#65a30d",cpu:"#dc2626",f10:"#65a30d",handshake:"#2563eb",keyboard:"#65a30d",leds:"#65a30d",memory:"#f59e0b",pic:"#2563eb",pio:"#2563eb",printer:"#65a30d",screen:"#65a30d",switches:"#65a30d",timer:"#2563eb"};function FV(t){const[e,n]=t.type.split(":",2);console.group(`%c ${e} %c ${n}`,`background: ${zV[e]}; color: #fff; font-weight: bold;`,"background: unset; color: unset; font-weight: normal;");for(const r in t)if(r!=="type"&&Object.prototype.hasOwnProperty.call(t,r)){const i=t[r];i instanceof B?console.log(`${r}: %c${i.toString("hex")}h %c(Byte)`,"color: #8b5cf6;","color: #737373;"):i instanceof be?console.log(`${r}: %c${i.toString()} %c(MemoryAddress)`,"color: #8b5cf6;","color: #737373;"):i instanceof br?console.log(`${r}: %c${i.toString()} %c(IOAddress)`,"color: #8b5cf6;","color: #737373;"):typeof i=="number"?console.log(`${r}: %c${i.toString(16)}h %c(number)`,"color: #8b5cf6;","color: #737373;"):typeof i=="string"?console.log(`${r}: %c"${i}" %c(string)`,"color: #f97316;","color: #737373;"):typeof i=="boolean"?console.log(`${r}: %c${i}`,"color: #06b6d4;"):i===null?console.log(`${r}: %cnull`,"color: #b91c1c;"):console.log(`${r}:`,i)}console.groupEnd()}const gn=new $7,xn=Ce({type:"stopped"});function UV(t){const e=t.translate(gi().language);Kn({title:e,variant:"error"})}function fu(t){t&&UV(t),BO(null),LO(!1),Q.set(xn,{type:"stopped",error:t}),Q.set(Ti,{phase:"stopped",error:t}),MF()}function Rw(){Q.set(xn,{type:"paused"}),_F()}function VV(){Kn({title:eg(gi().language,"messages.assemble-error"),variant:"error"})}function ol(){Kn({title:eg(gi().language,"messages.invalid-action"),variant:"error"})}function HV(t){dz(t),EV(t),wV(t),PV(t),$V(t),LV(t),SV(t),OV(t),RV(t),DV(t)}async function ua(t){try{for(;;){const e=Q.get(xn),n=gi();if(e.type==="stopped")break;if(e.type==="paused"){await new Promise(i=>{const s=Q.sub(xn,()=>{s(),i()})});continue}const r=t.next();if(r.done)break;await jV(r.value),r.value.type==="cpu:cycle.update"||r.value.type==="cpu:cycle.interrupt"?e.until==="cycle-change"?Rw():n.animations||await new Promise(i=>setTimeout(i,n.executionUnit)):r.value.type==="cpu:cycle.end"&&(e.until==="end-of-instruction"?Rw():n.animations||await new Promise(i=>setTimeout(i,n.executionUnit)))}t.return()}catch(e){const n=Qe.from(e);fu(n)}}async function WV(...t){const e=t[0],n=Q.get(xn);switch(e){case"cpu.run":{if(n.type==="running")return ol();const r=t[1];if(n.type==="stopped"){if(!window.codemirror)return;const i=window.codemirror.state.doc.toString(),s=uN(i);if(!s.success)return VV();LO(!0),gn.loadProgram({program:s,data:gi().dataOnLoad,devices:gi().devices}),HV(gn.getComputerState()),Q.set(xn,{type:"running",until:r,waitingForInput:!1}),ua(gn.startCPU()),GV(),KV()}else Q.set(xn,{type:"running",until:r,waitingForInput:!1}),RF();return}case"cpu.stop":{fu();return}case"f10.press":{if(!gn.devices.f10.connected()||n.type!=="running")return ol();if(IE("f10:press"))return;ua(gn.devices.f10.press());return}case"switch.toggle":{if(n.type!=="running"||!gn.devices.switches.connected())return ol();if(IE("switches:toggle"))return;const r=t[1];ua(gn.devices.switches.toggle(r));return}case"keyboard.sendChar":{if(n.type!=="running"||!n.waitingForInput)return ol();gn.devices.keyboard.readChar(B.fromChar(t[1])),Q.set(xn,{...n,waitingForInput:!1});return}case"screen.clean":{if(!gn.devices.screen.connected())return ol();ua(gn.devices.screen.clear());return}case"printer.clean":{if(!gn.devices.printer.connected())return ol();ua(gn.devices.printer.clear());return}default:return e}}async function GV(){if(gn.devices.clock.connected())for(;Q.get(xn).type!=="stopped";){const t=gi().clockSpeed;await Ge({key:"clock.angle",from:0,to:360},{duration:t,forceMs:!0,easing:"linear"}),ua(gn.devices.clock.tick())}}async function KV(){if(gn.devices.printer.connected())for(;Q.get(xn).type!=="stopped";){const t=gi().printerSpeed;await Ge([{key:"printer.printing.opacity",from:1},{key:"printer.printing.progress",from:0,to:1}],{duration:t,forceMs:!0,easing:"easeInOutSine"}),await Ge({key:"printer.printing.opacity",to:0},{duration:1,easing:"easeInSine"}),ua(gn.devices.printer.print())}}function qt(){const t=dn(xn),e=E6(),n=m.useMemo(()=>({preset:e,clock:e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",f10:e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",keyboard:e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",handshake:e==="handshake",leds:e==="pio-switches-and-leds",pic:e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",pio:e==="pio-switches-and-leds"||e==="pio-printer",printer:e==="pio-printer"||e==="handshake",screen:e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake",switches:e==="pio-switches-and-leds",timer:e==="pio-switches-and-leds"||e==="pio-printer"||e==="handshake"}),[e]);return{status:t,dispatch:WV,devices:n}}function XV({className:t}){const e=lt(),{status:n,dispatch:r}=qt(),i=m.useCallback(()=>{n.type!=="running"&&r("cpu.run","cycle-change")},[n.type,r]);xa("F7",a=>{a.preventDefault(),i()},void 0,[i]);const s=m.useCallback(()=>{n.type!=="running"&&r("cpu.run","end-of-instruction")},[n.type,r]);xa("F8",a=>{a.preventDefault(),s()},void 0,[s]);const o=m.useCallback(()=>{n.type!=="running"&&r("cpu.run","infinity")},[n.type,r]);return xa("F4",a=>{a.preventDefault(),o()},void 0,[o]),x.jsxs("div",{className:Me("flex items-center justify-center gap-4",t),children:[x.jsxs(sN,{children:[x.jsx(oN,{asChild:!0,children:x.jsx("button",{disabled:n.type==="running",className:"inline-flex h-9 items-center justify-center whitespace-nowrap rounded-md bg-mantis-500 px-3 text-sm text-white ring-offset-stone-900 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mantis-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",children:n.type==="stopped"?x.jsxs(x.Fragment,{children:[x.jsx("span",{className:"icon-[lucide--play] mr-2 h-4 w-4"}),e("control.action.start")]}):n.type==="paused"?x.jsxs(x.Fragment,{children:[x.jsx("span",{className:"icon-[lucide--play] mr-2 h-4 w-4"}),e("control.action.continue")]}):x.jsxs(x.Fragment,{children:[x.jsx("span",{className:"icon-[lucide--refresh-cw] mr-2 h-4 w-4 animate-spin"}),e("control.action.running")]})})}),x.jsxs(C1,{className:"w-56",align:"start",children:[x.jsxs(ka,{disabled:n.type==="running",onClick:i,children:[x.jsx("span",{className:"icon-[lucide--chevron-right] mr-2 h-4 w-4"}),e("control.action.run.cycle-change"),x.jsx("div",{className:"grow"}),x.jsx("kbd",{className:"text-stone-600",children:"F7"})]}),x.jsxs(ka,{disabled:n.type==="running",onClick:s,children:[x.jsx("span",{className:"icon-[lucide--chevrons-right] mr-2 h-4 w-4"}),e("control.action.run.end-of-instruction"),x.jsx("div",{className:"grow"}),x.jsx("kbd",{className:"text-stone-600",children:"F8"})]}),x.jsxs(ka,{disabled:n.type==="running",onClick:o,children:[x.jsx("span",{className:"icon-[lucide--infinity] mr-2 h-4 w-4"}),e("control.action.run.infinity"),x.jsx("div",{className:"grow"}),x.jsx("kbd",{className:"text-stone-600",children:"F4"})]})]})]}),x.jsxs("button",{disabled:n.type==="stopped",onClick:()=>r("cpu.stop"),className:"inline-flex h-9 items-center justify-center whitespace-nowrap rounded-md bg-mantis-500 px-3 text-sm text-white ring-offset-stone-900 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-mantis-500 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",children:[x.jsx("span",{className:"icon-[lucide--stop-circle] mr-2 h-4 w-4"}),e("control.action.stop")]})]})}function hm(t,[e,n]){return Math.min(n,Math.max(e,t))}function Ex(t){const e=m.useRef({value:t,previous:t});return m.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}const Ax=m.forwardRef((t,e)=>m.createElement(Fe.span,re({},t,{ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}))),ZV=[" ","Enter","ArrowUp","ArrowDown"],JV=[" ","Enter"],Eg="Select",[Ag,Px,YV]=Xd(Eg),[Mu,IY]=wi(Eg,[YV,Ou]),Tx=Ou(),[qV,Za]=Mu(Eg),[QV,eH]=Mu(Eg),tH=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:i,onOpenChange:s,value:o,defaultValue:a,onValueChange:l,dir:u,name:c,autoComplete:d,disabled:h,required:f}=t,p=Tx(e),[g,b]=m.useState(null),[y,v]=m.useState(null),[w,S]=m.useState(!1),C=Zd(u),[E=!1,T]=$s({prop:r,defaultProp:i,onChange:s}),[A,N]=$s({prop:o,defaultProp:a,onChange:l}),R=m.useRef(null),O=g?!!g.closest("form"):!0,[j,z]=m.useState(new Set),I=Array.from(j).map(G=>G.props.value).join(";");return m.createElement(p1,p,m.createElement(qV,{required:f,scope:e,trigger:g,onTriggerChange:b,valueNode:y,onValueNodeChange:v,valueNodeHasChildren:w,onValueNodeHasChildrenChange:S,contentId:_a(),value:A,onValueChange:N,open:E,onOpenChange:T,dir:C,triggerPointerDownPosRef:R,disabled:h},m.createElement(Ag.Provider,{scope:e},m.createElement(QV,{scope:t.__scopeSelect,onNativeOptionAdd:m.useCallback(G=>{z(K=>new Set(K).add(G))},[]),onNativeOptionRemove:m.useCallback(G=>{z(K=>{const ee=new Set(K);return ee.delete(G),ee})},[])},n)),O?m.createElement(W_,{key:I,"aria-hidden":!0,required:f,tabIndex:-1,name:c,autoComplete:d,value:A,onChange:G=>N(G.target.value),disabled:h},A===void 0?m.createElement("option",{value:""}):null,Array.from(j)):null))},nH="SelectTrigger",rH=m.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...i}=t,s=Tx(n),o=Za(nH,n),a=o.disabled||r,l=Je(e,o.onTriggerChange),u=Px(n),[c,d,h]=G_(p=>{const g=u().filter(v=>!v.disabled),b=g.find(v=>v.value===o.value),y=K_(g,p,b);y!==void 0&&o.onValueChange(y.value)}),f=()=>{a||(o.onOpenChange(!0),h())};return m.createElement(m1,re({asChild:!0},s),m.createElement(Fe.button,re({type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":o.value===void 0?"":void 0},i,{ref:l,onClick:fe(i.onClick,p=>{p.currentTarget.focus()}),onPointerDown:fe(i.onPointerDown,p=>{const g=p.target;g.hasPointerCapture(p.pointerId)&&g.releasePointerCapture(p.pointerId),p.button===0&&p.ctrlKey===!1&&(f(),o.triggerPointerDownPosRef.current={x:Math.round(p.pageX),y:Math.round(p.pageY)},p.preventDefault())}),onKeyDown:fe(i.onKeyDown,p=>{const g=c.current!=="";!(p.ctrlKey||p.altKey||p.metaKey)&&p.key.length===1&&d(p.key),!(g&&p.key===" ")&&ZV.includes(p.key)&&(f(),p.preventDefault())})})))}),iH="SelectValue",sH=m.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:i,children:s,placeholder:o,...a}=t,l=Za(iH,n),{onValueNodeHasChildrenChange:u}=l,c=s!==void 0,d=Je(e,l.onValueNodeChange);return Gr(()=>{u(c)},[u,c]),m.createElement(Fe.span,re({},a,{ref:d,style:{pointerEvents:"none"}}),l.value===void 0&&o!==void 0?o:s)}),oH=m.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...i}=t;return m.createElement(Fe.span,re({"aria-hidden":!0},i,{ref:e}),r||"")}),aH=t=>m.createElement(ig,re({asChild:!0},t)),pu="SelectContent",lH=m.forwardRef((t,e)=>{const n=Za(pu,t.__scopeSelect),[r,i]=m.useState();if(Gr(()=>{i(new DocumentFragment)},[]),!n.open){const s=r;return s?Ds.createPortal(m.createElement(H_,{scope:t.__scopeSelect},m.createElement(Ag.Slot,{scope:t.__scopeSelect},m.createElement("div",null,t.children))),s):null}return m.createElement(uH,re({},t,{ref:e}))}),es=10,[H_,Pg]=Mu(pu),uH=m.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:s,onPointerDownOutside:o,side:a,sideOffset:l,align:u,alignOffset:c,arrowPadding:d,collisionBoundary:h,collisionPadding:f,sticky:p,hideWhenDetached:g,avoidCollisions:b,...y}=t,v=Za(pu,n),[w,S]=m.useState(null),[C,E]=m.useState(null),T=Je(e,k=>S(k)),[A,N]=m.useState(null),[R,O]=m.useState(null),j=Px(n),[z,I]=m.useState(!1),G=m.useRef(!1);m.useEffect(()=>{if(w)return y1(w)},[w]),l1();const K=m.useCallback(k=>{const[$,...D]=j().map(X=>X.ref.current),[M]=D.slice(-1),U=document.activeElement;for(const X of k)if(X===U||(X==null||X.scrollIntoView({block:"nearest"}),X===$&&C&&(C.scrollTop=0),X===M&&C&&(C.scrollTop=C.scrollHeight),X==null||X.focus(),document.activeElement!==U))return},[j,C]),ee=m.useCallback(()=>K([A,w]),[K,A,w]);m.useEffect(()=>{z&&ee()},[z,ee]);const{onOpenChange:F,triggerPointerDownPosRef:_}=v;m.useEffect(()=>{if(w){let k={x:0,y:0};const $=M=>{var U,X,Y,q;k={x:Math.abs(Math.round(M.pageX)-((U=(X=_.current)===null||X===void 0?void 0:X.x)!==null&&U!==void 0?U:0)),y:Math.abs(Math.round(M.pageY)-((Y=(q=_.current)===null||q===void 0?void 0:q.y)!==null&&Y!==void 0?Y:0))}},D=M=>{k.x<=10&&k.y<=10?M.preventDefault():w.contains(M.target)||F(!1),document.removeEventListener("pointermove",$),_.current=null};return _.current!==null&&(document.addEventListener("pointermove",$),document.addEventListener("pointerup",D,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",$),document.removeEventListener("pointerup",D,{capture:!0})}}},[w,F,_]),m.useEffect(()=>{const k=()=>F(!1);return window.addEventListener("blur",k),window.addEventListener("resize",k),()=>{window.removeEventListener("blur",k),window.removeEventListener("resize",k)}},[F]);const[V,Z]=G_(k=>{const $=j().filter(U=>!U.disabled),D=$.find(U=>U.ref.current===document.activeElement),M=K_($,k,D);M&&setTimeout(()=>M.ref.current.focus())}),ne=m.useCallback((k,$,D)=>{const M=!G.current&&!D;(v.value!==void 0&&v.value===$||M)&&(N(k),M&&(G.current=!0))},[v.value]),me=m.useCallback(()=>w==null?void 0:w.focus(),[w]),H=m.useCallback((k,$,D)=>{const M=!G.current&&!D;(v.value!==void 0&&v.value===$||M)&&O(k)},[v.value]),L=r==="popper"?LE:cH,W=L===LE?{side:a,sideOffset:l,align:u,alignOffset:c,arrowPadding:d,collisionBoundary:h,collisionPadding:f,sticky:p,hideWhenDetached:g,avoidCollisions:b}:{};return m.createElement(H_,{scope:n,content:w,viewport:C,onViewportChange:E,itemRefCallback:ne,selectedItem:A,onItemLeave:me,itemTextRefCallback:H,focusSelectedItem:ee,selectedItemText:R,position:r,isPositioned:z,searchRef:V},m.createElement(v1,{as:Oa,allowPinchZoom:!0},m.createElement(u1,{asChild:!0,trapped:v.open,onMountAutoFocus:k=>{k.preventDefault()},onUnmountAutoFocus:fe(i,k=>{var $;($=v.trigger)===null||$===void 0||$.focus({preventScroll:!0}),k.preventDefault()})},m.createElement(tg,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:o,onFocusOutside:k=>k.preventDefault(),onDismiss:()=>v.onOpenChange(!1)},m.createElement(L,re({role:"listbox",id:v.contentId,"data-state":v.open?"open":"closed",dir:v.dir,onContextMenu:k=>k.preventDefault()},y,W,{onPlaced:()=>I(!0),ref:T,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:fe(y.onKeyDown,k=>{const $=k.ctrlKey||k.altKey||k.metaKey;if(k.key==="Tab"&&k.preventDefault(),!$&&k.key.length===1&&Z(k.key),["ArrowUp","ArrowDown","Home","End"].includes(k.key)){let M=j().filter(U=>!U.disabled).map(U=>U.ref.current);if(["ArrowUp","End"].includes(k.key)&&(M=M.slice().reverse()),["ArrowUp","ArrowDown"].includes(k.key)){const U=k.target,X=M.indexOf(U);M=M.slice(X+1)}setTimeout(()=>K(M)),k.preventDefault()}})}))))))}),cH=m.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...i}=t,s=Za(pu,n),o=Pg(pu,n),[a,l]=m.useState(null),[u,c]=m.useState(null),d=Je(e,T=>c(T)),h=Px(n),f=m.useRef(!1),p=m.useRef(!0),{viewport:g,selectedItem:b,selectedItemText:y,focusSelectedItem:v}=o,w=m.useCallback(()=>{if(s.trigger&&s.valueNode&&a&&u&&g&&b&&y){const T=s.trigger.getBoundingClientRect(),A=u.getBoundingClientRect(),N=s.valueNode.getBoundingClientRect(),R=y.getBoundingClientRect();if(s.dir!=="rtl"){const U=R.left-A.left,X=N.left-U,Y=T.left-X,q=T.width+Y,oe=Math.max(q,A.width),Be=window.innerWidth-es,we=hm(X,[es,Be-oe]);a.style.minWidth=q+"px",a.style.left=we+"px"}else{const U=A.right-R.right,X=window.innerWidth-N.right-U,Y=window.innerWidth-T.right-X,q=T.width+Y,oe=Math.max(q,A.width),Be=window.innerWidth-es,we=hm(X,[es,Be-oe]);a.style.minWidth=q+"px",a.style.right=we+"px"}const O=h(),j=window.innerHeight-es*2,z=g.scrollHeight,I=window.getComputedStyle(u),G=parseInt(I.borderTopWidth,10),K=parseInt(I.paddingTop,10),ee=parseInt(I.borderBottomWidth,10),F=parseInt(I.paddingBottom,10),_=G+K+z+F+ee,V=Math.min(b.offsetHeight*5,_),Z=window.getComputedStyle(g),ne=parseInt(Z.paddingTop,10),me=parseInt(Z.paddingBottom,10),H=T.top+T.height/2-es,L=j-H,W=b.offsetHeight/2,k=b.offsetTop+W,$=G+K+k,D=_-$;if($<=H){const U=b===O[O.length-1].ref.current;a.style.bottom="0px";const X=u.clientHeight-g.offsetTop-g.offsetHeight,Y=Math.max(L,W+(U?me:0)+X+ee),q=$+Y;a.style.height=q+"px"}else{const U=b===O[0].ref.current;a.style.top="0px";const Y=Math.max(H,G+g.offsetTop+(U?ne:0)+W)+D;a.style.height=Y+"px",g.scrollTop=$-H+g.offsetTop}a.style.margin=`${es}px 0`,a.style.minHeight=V+"px",a.style.maxHeight=j+"px",r==null||r(),requestAnimationFrame(()=>f.current=!0)}},[h,s.trigger,s.valueNode,a,u,g,b,y,s.dir,r]);Gr(()=>w(),[w]);const[S,C]=m.useState();Gr(()=>{u&&C(window.getComputedStyle(u).zIndex)},[u]);const E=m.useCallback(T=>{T&&p.current===!0&&(w(),v==null||v(),p.current=!1)},[w,v]);return m.createElement(dH,{scope:n,contentWrapper:a,shouldExpandOnScrollRef:f,onScrollButtonChange:E},m.createElement("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S}},m.createElement(Fe.div,re({},i,{ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}}))))}),LE=m.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:i=es,...s}=t,o=Tx(n);return m.createElement(g1,re({},o,s,{ref:e,align:r,collisionPadding:i,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}}))}),[dH,hH]=Mu(pu,{}),BE="SelectViewport",fH=m.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=Pg(BE,n),s=hH(BE,n),o=Je(e,i.onViewportChange),a=m.useRef(0);return m.createElement(m.Fragment,null,m.createElement("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"}}),m.createElement(Ag.Slot,{scope:n},m.createElement(Fe.div,re({"data-radix-select-viewport":"",role:"presentation"},r,{ref:o,style:{position:"relative",flex:1,overflow:"auto",...r.style},onScroll:fe(r.onScroll,l=>{const u=l.currentTarget,{contentWrapper:c,shouldExpandOnScrollRef:d}=s;if(d!=null&&d.current&&c){const h=Math.abs(a.current-u.scrollTop);if(h>0){const f=window.innerHeight-es*2,p=parseFloat(c.style.minHeight),g=parseFloat(c.style.height),b=Math.max(p,g);if(b<f){const y=b+h,v=Math.min(f,y),w=y-v;c.style.height=v+"px",c.style.bottom==="0px"&&(u.scrollTop=w>0?w:0,c.style.justifyContent="flex-end")}}}a.current=u.scrollTop})}))))}),pH="SelectGroup";Mu(pH);const Mw="SelectItem",[mH,gH]=Mu(Mw),yH=m.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:i=!1,textValue:s,...o}=t,a=Za(Mw,n),l=Pg(Mw,n),u=a.value===r,[c,d]=m.useState(s??""),[h,f]=m.useState(!1),p=Je(e,y=>{var v;return(v=l.itemRefCallback)===null||v===void 0?void 0:v.call(l,y,r,i)}),g=_a(),b=()=>{i||(a.onValueChange(r),a.onOpenChange(!1))};return m.createElement(mH,{scope:n,value:r,disabled:i,textId:g,isSelected:u,onItemTextChange:m.useCallback(y=>{d(v=>{var w;return v||((w=y==null?void 0:y.textContent)!==null&&w!==void 0?w:"").trim()})},[])},m.createElement(Ag.ItemSlot,{scope:n,value:r,disabled:i,textValue:c},m.createElement(Fe.div,re({role:"option","aria-labelledby":g,"data-highlighted":h?"":void 0,"aria-selected":u&&h,"data-state":u?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1},o,{ref:p,onFocus:fe(o.onFocus,()=>f(!0)),onBlur:fe(o.onBlur,()=>f(!1)),onPointerUp:fe(o.onPointerUp,b),onPointerMove:fe(o.onPointerMove,y=>{if(i){var v;(v=l.onItemLeave)===null||v===void 0||v.call(l)}else y.currentTarget.focus({preventScroll:!0})}),onPointerLeave:fe(o.onPointerLeave,y=>{if(y.currentTarget===document.activeElement){var v;(v=l.onItemLeave)===null||v===void 0||v.call(l)}}),onKeyDown:fe(o.onKeyDown,y=>{var v;((v=l.searchRef)===null||v===void 0?void 0:v.current)!==""&&y.key===" "||(JV.includes(y.key)&&b(),y.key===" "&&y.preventDefault())})}))))}),rf="SelectItemText",vH=m.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:i,...s}=t,o=Za(rf,n),a=Pg(rf,n),l=gH(rf,n),u=eH(rf,n),[c,d]=m.useState(null),h=Je(e,y=>d(y),l.onItemTextChange,y=>{var v;return(v=a.itemTextRefCallback)===null||v===void 0?void 0:v.call(a,y,l.value,l.disabled)}),f=c==null?void 0:c.textContent,p=m.useMemo(()=>m.createElement("option",{key:l.value,value:l.value,disabled:l.disabled},f),[l.disabled,l.value,f]),{onNativeOptionAdd:g,onNativeOptionRemove:b}=u;return Gr(()=>(g(p),()=>b(p)),[g,b,p]),m.createElement(m.Fragment,null,m.createElement(Fe.span,re({id:l.textId},s,{ref:h})),l.isSelected&&o.valueNode&&!o.valueNodeHasChildren?Ds.createPortal(s.children,o.valueNode):null)}),W_=m.forwardRef((t,e)=>{const{value:n,...r}=t,i=m.useRef(null),s=Je(e,i),o=Ex(n);return m.useEffect(()=>{const a=i.current,l=window.HTMLSelectElement.prototype,c=Object.getOwnPropertyDescriptor(l,"value").set;if(o!==n&&c){const d=new Event("change",{bubbles:!0});c.call(a,n),a.dispatchEvent(d)}},[o,n]),m.createElement(Ax,{asChild:!0},m.createElement("select",re({},r,{ref:s,defaultValue:n})))});W_.displayName="BubbleSelect";function G_(t){const e=Dn(t),n=m.useRef(""),r=m.useRef(0),i=m.useCallback(o=>{const a=n.current+o;e(a),function l(u){n.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(a)},[e]),s=m.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return m.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,i,s]}function K_(t,e,n){const i=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let o=wH(t,Math.max(s,0));i.length===1&&(o=o.filter(u=>u!==n));const l=o.find(u=>u.textValue.toLowerCase().startsWith(i.toLowerCase()));return l!==n?l:void 0}function wH(t,e){return t.map((n,r)=>t[(e+r)%t.length])}const bH=tH,X_=rH,xH=sH,SH=oH,kH=aH,Z_=lH,CH=fH,J_=yH,EH=vH,uy=bH,cy=xH,qf=m.forwardRef(({className:t,children:e,...n},r)=>x.jsxs(X_,{ref:r,className:Me("flex h-10 items-center justify-between rounded-md border border-stone-600 bg-stone-900 px-3 py-2 text-sm ring-offset-stone-800 placeholder:text-stone-500 focus:outline-none focus:ring-2 focus:ring-stone-600 focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...n,children:[e,x.jsx(SH,{asChild:!0,children:x.jsx("span",{className:"icon-[lucide--chevron-down] h-4 w-4 opacity-50"})})]}));qf.displayName=X_.displayName;const Qf=m.forwardRef(({className:t,children:e,position:n="popper",...r},i)=>x.jsx(kH,{children:x.jsx(Z_,{ref:i,className:Me("relative z-50 min-w-[8rem] overflow-hidden rounded-md border border-stone-600 bg-stone-900 text-white shadow-md",t),position:n,...r,children:x.jsx(CH,{className:"p-1",children:e})})}));Qf.displayName=Z_.displayName;const gc=m.forwardRef(({className:t,children:e,...n},r)=>x.jsx(J_,{ref:r,className:Me("w-full cursor-default select-none rounded-sm px-2 py-1.5 text-sm outline-none transition-colors duration-75 focus:bg-stone-800 focus:text-mantis-400 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:x.jsx(EH,{children:e})}));gc.displayName=J_.displayName;const Y_=["PageUp","PageDown"],q_=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Q_={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},oh="Slider",[Dw,AH,PH]=Xd(oh),[eR,LY]=wi(oh,[PH]),[TH,Tg]=eR(oh),$H=m.forwardRef((t,e)=>{const{name:n,min:r=0,max:i=100,step:s=1,orientation:o="horizontal",disabled:a=!1,minStepsBetweenThumbs:l=0,defaultValue:u=[r],value:c,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:f=!1,...p}=t,[g,b]=m.useState(null),y=Je(e,I=>b(I)),v=m.useRef(new Set),w=m.useRef(0),S=o==="horizontal",C=g?!!g.closest("form"):!0,E=S?NH:OH,[T=[],A]=$s({prop:c,defaultProp:u,onChange:I=>{var G;(G=[...v.current][w.current])===null||G===void 0||G.focus(),d(I)}}),N=m.useRef(T);function R(I){const G=zH(T,I);z(I,G)}function O(I){z(I,w.current)}function j(){const I=N.current[w.current];T[w.current]!==I&&h(T)}function z(I,G,{commit:K}={commit:!1}){const ee=HH(s),F=WH(Math.round((I-r)/s)*s+r,ee),_=hm(F,[r,i]);A((V=[])=>{const Z=BH(V,_,G);if(VH(Z,l*s)){w.current=Z.indexOf(_);const ne=String(Z)!==String(V);return ne&&K&&h(Z),ne?Z:V}else return V})}return m.createElement(TH,{scope:t.__scopeSlider,disabled:a,min:r,max:i,valueIndexToChangeRef:w,thumbs:v.current,values:T,orientation:o},m.createElement(Dw.Provider,{scope:t.__scopeSlider},m.createElement(Dw.Slot,{scope:t.__scopeSlider},m.createElement(E,re({"aria-disabled":a,"data-disabled":a?"":void 0},p,{ref:y,onPointerDown:fe(p.onPointerDown,()=>{a||(N.current=T)}),min:r,max:i,inverted:f,onSlideStart:a?void 0:R,onSlideMove:a?void 0:O,onSlideEnd:a?void 0:j,onHomeKeyDown:()=>!a&&z(r,0,{commit:!0}),onEndKeyDown:()=>!a&&z(i,T.length-1,{commit:!0}),onStepKeyDown:({event:I,direction:G})=>{if(!a){const F=Y_.includes(I.key)||I.shiftKey&&q_.includes(I.key)?10:1,_=w.current,V=T[_],Z=s*F*G;z(V+Z,_,{commit:!0})}}})))),C&&T.map((I,G)=>m.createElement(LH,{key:G,name:n?n+(T.length>1?"[]":""):void 0,value:I})))}),[tR,nR]=eR(oh,{startEdge:"left",endEdge:"right",size:"width",direction:1}),NH=m.forwardRef((t,e)=>{const{min:n,max:r,dir:i,inverted:s,onSlideStart:o,onSlideMove:a,onSlideEnd:l,onStepKeyDown:u,...c}=t,[d,h]=m.useState(null),f=Je(e,w=>h(w)),p=m.useRef(),g=Zd(i),b=g==="ltr",y=b&&!s||!b&&s;function v(w){const S=p.current||d.getBoundingClientRect(),C=[0,S.width],T=$x(C,y?[n,r]:[r,n]);return p.current=S,T(w-S.left)}return m.createElement(tR,{scope:t.__scopeSlider,startEdge:y?"left":"right",endEdge:y?"right":"left",direction:y?1:-1,size:"width"},m.createElement(rR,re({dir:g,"data-orientation":"horizontal"},c,{ref:f,style:{...c.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:w=>{const S=v(w.clientX);o==null||o(S)},onSlideMove:w=>{const S=v(w.clientX);a==null||a(S)},onSlideEnd:()=>{p.current=void 0,l==null||l()},onStepKeyDown:w=>{const C=Q_[y?"from-left":"from-right"].includes(w.key);u==null||u({event:w,direction:C?-1:1})}})))}),OH=m.forwardRef((t,e)=>{const{min:n,max:r,inverted:i,onSlideStart:s,onSlideMove:o,onSlideEnd:a,onStepKeyDown:l,...u}=t,c=m.useRef(null),d=Je(e,c),h=m.useRef(),f=!i;function p(g){const b=h.current||c.current.getBoundingClientRect(),y=[0,b.height],w=$x(y,f?[r,n]:[n,r]);return h.current=b,w(g-b.top)}return m.createElement(tR,{scope:t.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1},m.createElement(rR,re({"data-orientation":"vertical"},u,{ref:d,style:{...u.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:g=>{const b=p(g.clientY);s==null||s(b)},onSlideMove:g=>{const b=p(g.clientY);o==null||o(b)},onSlideEnd:()=>{h.current=void 0,a==null||a()},onStepKeyDown:g=>{const y=Q_[f?"from-bottom":"from-top"].includes(g.key);l==null||l({event:g,direction:y?-1:1})}})))}),rR=m.forwardRef((t,e)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:i,onSlideEnd:s,onHomeKeyDown:o,onEndKeyDown:a,onStepKeyDown:l,...u}=t,c=Tg(oh,n);return m.createElement(Fe.span,re({},u,{ref:e,onKeyDown:fe(t.onKeyDown,d=>{d.key==="Home"?(o(d),d.preventDefault()):d.key==="End"?(a(d),d.preventDefault()):Y_.concat(q_).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:fe(t.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),c.thumbs.has(h)?h.focus():r(d)}),onPointerMove:fe(t.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&i(d)}),onPointerUp:fe(t.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),s(d))})}))}),_H="SliderTrack",RH=m.forwardRef((t,e)=>{const{__scopeSlider:n,...r}=t,i=Tg(_H,n);return m.createElement(Fe.span,re({"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation},r,{ref:e}))}),jE="SliderRange",MH=m.forwardRef((t,e)=>{const{__scopeSlider:n,...r}=t,i=Tg(jE,n),s=nR(jE,n),o=m.useRef(null),a=Je(e,o),l=i.values.length,u=i.values.map(h=>iR(h,i.min,i.max)),c=l>1?Math.min(...u):0,d=100-Math.max(...u);return m.createElement(Fe.span,re({"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0},r,{ref:a,style:{...t.style,[s.startEdge]:c+"%",[s.endEdge]:d+"%"}}))}),zE="SliderThumb",DH=m.forwardRef((t,e)=>{const n=AH(t.__scopeSlider),[r,i]=m.useState(null),s=Je(e,a=>i(a)),o=m.useMemo(()=>r?n().findIndex(a=>a.ref.current===r):-1,[n,r]);return m.createElement(IH,re({},t,{ref:s,index:o}))}),IH=m.forwardRef((t,e)=>{const{__scopeSlider:n,index:r,...i}=t,s=Tg(zE,n),o=nR(zE,n),[a,l]=m.useState(null),u=Je(e,b=>l(b)),c=f1(a),d=s.values[r],h=d===void 0?0:iR(d,s.min,s.max),f=jH(r,s.values.length),p=c==null?void 0:c[o.size],g=p?FH(p,h,o.direction):0;return m.useEffect(()=>{if(a)return s.thumbs.add(a),()=>{s.thumbs.delete(a)}},[a,s.thumbs]),m.createElement("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${h}% + ${g}px)`}},m.createElement(Dw.ItemSlot,{scope:t.__scopeSlider},m.createElement(Fe.span,re({role:"slider","aria-label":t["aria-label"]||f,"aria-valuemin":s.min,"aria-valuenow":d,"aria-valuemax":s.max,"aria-orientation":s.orientation,"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,tabIndex:s.disabled?void 0:0},i,{ref:u,style:d===void 0?{display:"none"}:t.style,onFocus:fe(t.onFocus,()=>{s.valueIndexToChangeRef.current=r})}))))}),LH=t=>{const{value:e,...n}=t,r=m.useRef(null),i=Ex(e);return m.useEffect(()=>{const s=r.current,o=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(o,"value").set;if(i!==e&&l){const u=new Event("input",{bubbles:!0});l.call(s,e),s.dispatchEvent(u)}},[i,e]),m.createElement("input",re({style:{display:"none"}},n,{ref:r,defaultValue:e}))};function BH(t=[],e,n){const r=[...t];return r[n]=e,r.sort((i,s)=>i-s)}function iR(t,e,n){const s=100/(n-e)*(t-e);return hm(s,[0,100])}function jH(t,e){return e>2?`Value ${t+1} of ${e}`:e===2?["Minimum","Maximum"][t]:void 0}function zH(t,e){if(t.length===1)return 0;const n=t.map(i=>Math.abs(i-e)),r=Math.min(...n);return n.indexOf(r)}function FH(t,e,n){const r=t/2,s=$x([0,50],[0,r]);return(r-s(e)*n)*n}function UH(t){return t.slice(0,-1).map((e,n)=>t[n+1]-e)}function VH(t,e){if(e>0){const n=UH(t);return Math.min(...n)>=e}return!0}function $x(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function HH(t){return(String(t).split(".")[1]||"").length}function WH(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}const sR=$H,GH=RH,KH=MH,XH=DH,ep=m.forwardRef(({className:t,...e},n)=>x.jsxs(sR,{ref:n,className:Me("relative flex touch-none select-none items-center",t),...e,children:[x.jsx(GH,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-stone-900",children:x.jsx(KH,{className:"absolute h-full bg-mantis-400"})}),x.jsx(XH,{className:"block h-5 w-5 rounded-full border-2 border-stone-900 bg-mantis-400 ring-offset-stone-800 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-stone-600 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));ep.displayName=sR.displayName;const oR="Switch",[ZH,BY]=wi(oR),[JH,YH]=ZH(oR),qH=m.forwardRef((t,e)=>{const{__scopeSwitch:n,name:r,checked:i,defaultChecked:s,required:o,disabled:a,value:l="on",onCheckedChange:u,...c}=t,[d,h]=m.useState(null),f=Je(e,v=>h(v)),p=m.useRef(!1),g=d?!!d.closest("form"):!0,[b=!1,y]=$s({prop:i,defaultProp:s,onChange:u});return m.createElement(JH,{scope:n,checked:b,disabled:a},m.createElement(Fe.button,re({type:"button",role:"switch","aria-checked":b,"aria-required":o,"data-state":aR(b),"data-disabled":a?"":void 0,disabled:a,value:l},c,{ref:f,onClick:fe(t.onClick,v=>{y(w=>!w),g&&(p.current=v.isPropagationStopped(),p.current||v.stopPropagation())})})),g&&m.createElement(tW,{control:d,bubbles:!p.current,name:r,value:l,checked:b,required:o,disabled:a,style:{transform:"translateX(-100%)"}}))}),QH="SwitchThumb",eW=m.forwardRef((t,e)=>{const{__scopeSwitch:n,...r}=t,i=YH(QH,n);return m.createElement(Fe.span,re({"data-state":aR(i.checked),"data-disabled":i.disabled?"":void 0},r,{ref:e}))}),tW=t=>{const{control:e,checked:n,bubbles:r=!0,...i}=t,s=m.useRef(null),o=Ex(n),a=f1(e);return m.useEffect(()=>{const l=s.current,u=window.HTMLInputElement.prototype,d=Object.getOwnPropertyDescriptor(u,"checked").set;if(o!==n&&d){const h=new Event("click",{bubbles:r});d.call(l,n),l.dispatchEvent(h)}},[o,n,r]),m.createElement("input",re({type:"checkbox","aria-hidden":!0,defaultChecked:n},i,{tabIndex:-1,ref:s,style:{...t.style,...a,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function aR(t){return t?"checked":"unchecked"}const lR=qH,nW=eW,Nx=m.forwardRef(({className:t,...e},n)=>x.jsx(lR,{className:Me("peer inline-flex h-[24px] w-[44px] shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-stone-600 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-mantis-400 data-[state=unchecked]:bg-stone-900",t),...e,ref:n,children:x.jsx(nW,{className:Me("pointer-events-none block h-5 w-5 rounded-full bg-white shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Nx.displayName=lR.displayName;const Ox=Ce(!1);function uR({className:t}){const e=lt(),[n,r]=S6(),{status:i}=qt();return x.jsxs("div",{className:Me("overflow-auto scrollbar-stone-700",t),children:[x.jsxs("h3",{className:"flex items-center gap-2 border-b border-stone-600 py-2 pl-4 text-xl font-semibold",children:[x.jsx("span",{className:"icon-[lucide--settings] h-6 w-6"})," ",e("settings.title")]}),x.jsxs(Yo,{children:[x.jsx(qo,{children:x.jsxs(Qo,{children:[x.jsx("span",{className:"icon-[lucide--languages] h-6 w-6"}),e("settings.language.label")]})}),x.jsxs(uy,{value:n.language,onValueChange:s=>r(o=>({...o,language:s})),children:[x.jsx(qf,{className:"w-32",children:x.jsx(cy,{})}),x.jsxs(Qf,{children:[x.jsx(gc,{value:"en",children:x.jsxs("span",{className:"inline-flex items-center gap-2",children:[x.jsx("span",{className:"icon-[circle-flags--uk] h-4 w-4"})," English"]})}),x.jsx(gc,{value:"es",children:x.jsxs("span",{className:"inline-flex items-center gap-2",children:[x.jsx("span",{className:"icon-[circle-flags--ar] h-4 w-4"})," Espaol"]})})]})]})]}),x.jsx("hr",{className:"border-stone-600"}),x.jsxs(Yo,{children:[x.jsxs(qo,{children:[x.jsxs(Qo,{children:[x.jsx("span",{className:"icon-[lucide--memory-stick] h-6 w-6"}),e("settings.dataOnLoad.label")]}),x.jsx(dy,{children:e("settings.dataOnLoad.description")})]}),x.jsxs(uy,{value:n.dataOnLoad,onValueChange:s=>r(o=>({...o,dataOnLoad:s})),children:[x.jsx(qf,{className:"w-32 min-w-[theme(width.32)]",children:x.jsx(cy,{})}),x.jsx(Qf,{children:s$.map(s=>x.jsx(gc,{value:s,children:e(`settings.dataOnLoad.${s}`)},s))})]})]}),x.jsxs(Yo,{children:[x.jsxs(qo,{children:[x.jsxs(Qo,{children:[x.jsx("span",{className:"icon-[lucide--monitor-smartphone] h-6 w-6"}),e("settings.devices.label")]}),x.jsx(dy,{children:e("settings.devices.description")})]}),x.jsxs(uy,{value:n.devices,onValueChange:s=>r(o=>({...o,devices:s})),disabled:i.type!=="stopped",children:[x.jsx(qf,{className:"w-52 min-w-[theme(width.52)]",children:x.jsx(cy,{})}),x.jsx(Qf,{children:o$.map(s=>x.jsx(gc,{value:s,children:e(`settings.devices.${s}`)},s))})]})]}),x.jsx("hr",{className:"border-stone-600"}),x.jsxs(Yo,{children:[x.jsxs(qo,{children:[x.jsxs(Qo,{children:[x.jsx("span",{className:"icon-[lucide--rotate-3d] h-6 w-6"}),e("settings.animations.label")]}),x.jsx(dy,{children:e("settings.animations.description")})]}),x.jsx(Nx,{className:"ml-8",checked:n.animations,onCheckedChange:s=>r(o=>({...o,animations:s}))})]}),x.jsxs(Yo,{children:[x.jsx(qo,{children:x.jsxs(Qo,{children:[x.jsx("span",{className:"icon-[lucide--gauge] h-6 w-6"}),e("settings.speeds.executionUnit")]})}),x.jsx(ep,{className:"w-44",...hy({value:n.executionUnit,onValueChange:s=>r(o=>({...o,executionUnit:s})),min:500,max:1})})]}),x.jsxs(Yo,{children:[x.jsx(qo,{children:x.jsxs(Qo,{children:[x.jsx("span",{className:"icon-[lucide--clock] h-6 w-6"}),e("settings.speeds.clockSpeed")]})}),x.jsx(ep,{className:"w-44",...hy({value:n.clockSpeed,onValueChange:s=>r(o=>({...o,clockSpeed:s})),min:3e3,max:100})})]}),x.jsxs(Yo,{children:[x.jsx(qo,{children:x.jsxs(Qo,{children:[x.jsx("span",{className:"icon-[lucide--printer] h-6 w-6"}),e("settings.speeds.printerSpeed")]})}),x.jsx(ep,{className:"w-44",...hy({value:n.printerSpeed,onValueChange:s=>r(o=>({...o,printerSpeed:s})),min:2e4,max:500})})]})]})}function Yo({children:t}){return x.jsx("div",{className:"m-4 flex items-center justify-between gap-4",children:t})}function qo({children:t}){return x.jsx("div",{className:"grow",children:t})}function Qo({children:t}){return x.jsx("p",{className:"flex items-center gap-2 font-medium",children:t})}function dy({children:t}){return x.jsx("p",{className:"mt-1 text-xs text-stone-400",children:t})}function hy({value:t,onValueChange:e,min:n,max:r}){const i=Math.log(n),o=(Math.log(r)-i)/100;return{value:[(Math.log(t)-i)/o],onValueChange:a=>e(Math.exp(i+o*a[0])),min:0,max:100}}function rW(){const t=lt(),[e,n]=Tu(Ox);return x.jsxs("header",{className:"relative p-2 text-sm text-white",children:[x.jsx(XV,{className:" absolute inset-0"}),x.jsxs("div",{className:"flex items-center justify-between",children:[x.jsxs("div",{className:"flex select-none items-center justify-center",children:[x.jsx("img",{src:"/favicon.svg",className:"mr-2 h-10 w-10"}),x.jsxs("h1",{className:"text-xl font-bold max-sm:hidden",children:["Von",x.jsx("span",{className:"text-mantis-400",children:"Sim"})]})]}),x.jsx("button",{className:Me("h-min w-min rounded-full p-2 transition-colors focus:outline-stone-400",e?"bg-stone-700 hover:bg-stone-600 focus:bg-stone-600":"hover:bg-stone-800 focus:bg-stone-800"),title:t("settings.title"),onClick:()=>n(!e),children:x.jsx("span",{className:"icon-[lucide--settings] block h-6 w-6"})})]})]})}const cR="ToastProvider",[_x,iW,sW]=Xd("Toast"),[dR,jY]=wi("Toast",[sW]),[oW,$g]=dR(cR),hR=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:i="right",swipeThreshold:s=50,children:o}=t,[a,l]=m.useState(null),[u,c]=m.useState(0),d=m.useRef(!1),h=m.useRef(!1);return m.createElement(_x.Provider,{scope:e},m.createElement(oW,{scope:e,label:n,duration:r,swipeDirection:i,swipeThreshold:s,toastCount:u,viewport:a,onViewportChange:l,onToastAdd:m.useCallback(()=>c(f=>f+1),[]),onToastRemove:m.useCallback(()=>c(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h},o))};hR.propTypes={label(t){if(t.label&&typeof t.label=="string"&&!t.label.trim()){const e=`Invalid prop \`label\` supplied to \`${cR}\`. Expected non-empty \`string\`.`;return new Error(e)}return null}};const aW="ToastViewport",lW=["F8"],Iw="toast.viewportPause",Lw="toast.viewportResume",uW=m.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=lW,label:i="Notifications ({hotkey})",...s}=t,o=$g(aW,n),a=iW(n),l=m.useRef(null),u=m.useRef(null),c=m.useRef(null),d=m.useRef(null),h=Je(e,d,o.onViewportChange),f=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=o.toastCount>0;m.useEffect(()=>{const b=y=>{var v;r.every(S=>y[S]||y.code===S)&&((v=d.current)===null||v===void 0||v.focus())};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[r]),m.useEffect(()=>{const b=l.current,y=d.current;if(p&&b&&y){const v=()=>{if(!o.isClosePausedRef.current){const E=new CustomEvent(Iw);y.dispatchEvent(E),o.isClosePausedRef.current=!0}},w=()=>{if(o.isClosePausedRef.current){const E=new CustomEvent(Lw);y.dispatchEvent(E),o.isClosePausedRef.current=!1}},S=E=>{!b.contains(E.relatedTarget)&&w()},C=()=>{b.contains(document.activeElement)||w()};return b.addEventListener("focusin",v),b.addEventListener("focusout",S),b.addEventListener("pointermove",v),b.addEventListener("pointerleave",C),window.addEventListener("blur",v),window.addEventListener("focus",w),()=>{b.removeEventListener("focusin",v),b.removeEventListener("focusout",S),b.removeEventListener("pointermove",v),b.removeEventListener("pointerleave",C),window.removeEventListener("blur",v),window.removeEventListener("focus",w)}}},[p,o.isClosePausedRef]);const g=m.useCallback(({tabbingDirection:b})=>{const v=a().map(w=>{const S=w.ref.current,C=[S,...EW(S)];return b==="forwards"?C:C.reverse()});return(b==="forwards"?v.reverse():v).flat()},[a]);return m.useEffect(()=>{const b=d.current;if(b){const y=v=>{const w=v.altKey||v.ctrlKey||v.metaKey;if(v.key==="Tab"&&!w){const A=document.activeElement,N=v.shiftKey;if(v.target===b&&N){var C;(C=u.current)===null||C===void 0||C.focus();return}const j=g({tabbingDirection:N?"backwards":"forwards"}),z=j.findIndex(I=>I===A);if(fy(j.slice(z+1)))v.preventDefault();else{var E,T;N?(E=u.current)===null||E===void 0||E.focus():(T=c.current)===null||T===void 0||T.focus()}}};return b.addEventListener("keydown",y),()=>b.removeEventListener("keydown",y)}},[a,g]),m.createElement(F6,{ref:l,role:"region","aria-label":i.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:p?void 0:"none"}},p&&m.createElement(FE,{ref:u,onFocusFromOutsideViewport:()=>{const b=g({tabbingDirection:"forwards"});fy(b)}}),m.createElement(_x.Slot,{scope:n},m.createElement(Fe.ol,re({tabIndex:-1},s,{ref:h}))),p&&m.createElement(FE,{ref:c,onFocusFromOutsideViewport:()=>{const b=g({tabbingDirection:"backwards"});fy(b)}}))}),cW="ToastFocusProxy",FE=m.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...i}=t,s=$g(cW,n);return m.createElement(Ax,re({"aria-hidden":!0,tabIndex:0},i,{ref:e,style:{position:"fixed"},onFocus:o=>{var a;const l=o.relatedTarget;!((a=s.viewport)!==null&&a!==void 0&&a.contains(l))&&r()}}))}),Ng="Toast",dW="toast.swipeStart",hW="toast.swipeMove",fW="toast.swipeCancel",pW="toast.swipeEnd",mW=m.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:i,onOpenChange:s,...o}=t,[a=!0,l]=$s({prop:r,defaultProp:i,onChange:s});return m.createElement(Is,{present:n||a},m.createElement(fR,re({open:a},o,{ref:e,onClose:()=>l(!1),onPause:Dn(t.onPause),onResume:Dn(t.onResume),onSwipeStart:fe(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:fe(t.onSwipeMove,u=>{const{x:c,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${c}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:fe(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:fe(t.onSwipeEnd,u=>{const{x:c,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${c}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})))}),[gW,yW]=dR(Ng,{onClose(){}}),fR=m.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:i,open:s,onClose:o,onEscapeKeyDown:a,onPause:l,onResume:u,onSwipeStart:c,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:f,...p}=t,g=$g(Ng,n),[b,y]=m.useState(null),v=Je(e,I=>y(I)),w=m.useRef(null),S=m.useRef(null),C=i||g.duration,E=m.useRef(0),T=m.useRef(C),A=m.useRef(0),{onToastAdd:N,onToastRemove:R}=g,O=Dn(()=>{var I;(b==null?void 0:b.contains(document.activeElement))&&((I=g.viewport)===null||I===void 0||I.focus()),o()}),j=m.useCallback(I=>{!I||I===1/0||(window.clearTimeout(A.current),E.current=new Date().getTime(),A.current=window.setTimeout(O,I))},[O]);m.useEffect(()=>{const I=g.viewport;if(I){const G=()=>{j(T.current),u==null||u()},K=()=>{const ee=new Date().getTime()-E.current;T.current=T.current-ee,window.clearTimeout(A.current),l==null||l()};return I.addEventListener(Iw,K),I.addEventListener(Lw,G),()=>{I.removeEventListener(Iw,K),I.removeEventListener(Lw,G)}}},[g.viewport,C,l,u,j]),m.useEffect(()=>{s&&!g.isClosePausedRef.current&&j(C)},[s,C,g.isClosePausedRef,j]),m.useEffect(()=>(N(),()=>R()),[N,R]);const z=m.useMemo(()=>b?yR(b):null,[b]);return g.viewport?m.createElement(m.Fragment,null,z&&m.createElement(vW,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0},z),m.createElement(gW,{scope:n,onClose:O},Ds.createPortal(m.createElement(_x.ItemSlot,{scope:n},m.createElement(z6,{asChild:!0,onEscapeKeyDown:fe(a,()=>{g.isFocusedToastEscapeKeyDownRef.current||O(),g.isFocusedToastEscapeKeyDownRef.current=!1})},m.createElement(Fe.li,re({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":g.swipeDirection},p,{ref:v,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:fe(t.onKeyDown,I=>{I.key==="Escape"&&(a==null||a(I.nativeEvent),I.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,O()))}),onPointerDown:fe(t.onPointerDown,I=>{I.button===0&&(w.current={x:I.clientX,y:I.clientY})}),onPointerMove:fe(t.onPointerMove,I=>{if(!w.current)return;const G=I.clientX-w.current.x,K=I.clientY-w.current.y,ee=!!S.current,F=["left","right"].includes(g.swipeDirection),_=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,V=F?_(0,G):0,Z=F?0:_(0,K),ne=I.pointerType==="touch"?10:2,me={x:V,y:Z},H={originalEvent:I,delta:me};ee?(S.current=me,sf(hW,d,H,{discrete:!1})):UE(me,g.swipeDirection,ne)?(S.current=me,sf(dW,c,H,{discrete:!1}),I.target.setPointerCapture(I.pointerId)):(Math.abs(G)>ne||Math.abs(K)>ne)&&(w.current=null)}),onPointerUp:fe(t.onPointerUp,I=>{const G=S.current,K=I.target;if(K.hasPointerCapture(I.pointerId)&&K.releasePointerCapture(I.pointerId),S.current=null,w.current=null,G){const ee=I.currentTarget,F={originalEvent:I,delta:G};UE(G,g.swipeDirection,g.swipeThreshold)?sf(pW,f,F,{discrete:!0}):sf(fW,h,F,{discrete:!0}),ee.addEventListener("click",_=>_.preventDefault(),{once:!0})}})})))),g.viewport))):null});fR.propTypes={type(t){if(t.type&&!["foreground","background"].includes(t.type)){const e=`Invalid prop \`type\` supplied to \`${Ng}\`. Expected \`foreground | background\`.`;return new Error(e)}return null}};const vW=t=>{const{__scopeToast:e,children:n,...r}=t,i=$g(Ng,e),[s,o]=m.useState(!1),[a,l]=m.useState(!1);return kW(()=>o(!0)),m.useEffect(()=>{const u=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(u)},[]),a?null:m.createElement(ig,{asChild:!0},m.createElement(Ax,r,s&&m.createElement(m.Fragment,null,i.label," ",n)))},wW=m.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return m.createElement(Fe.div,re({},r,{ref:e}))}),bW=m.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return m.createElement(Fe.div,re({},r,{ref:e}))}),xW="ToastAction",pR=m.forwardRef((t,e)=>{const{altText:n,...r}=t;return n?m.createElement(gR,{altText:n,asChild:!0},m.createElement(mR,re({},r,{ref:e}))):null});pR.propTypes={altText(t){return t.altText?null:new Error(`Missing prop \`altText\` expected on \`${xW}\``)}};const SW="ToastClose",mR=m.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,i=yW(SW,n);return m.createElement(gR,{asChild:!0},m.createElement(Fe.button,re({type:"button"},r,{ref:e,onClick:fe(t.onClick,i.onClose)})))}),gR=m.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...i}=t;return m.createElement(Fe.div,re({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0},i,{ref:e}))});function yR(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),CW(r)){const i=r.ariaHidden||r.hidden||r.style.display==="none",s=r.dataset.radixToastAnnounceExclude==="";if(!i)if(s){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...yR(r))}}),e}function sf(t,e,n,{discrete:r}){const i=n.originalEvent.currentTarget,s=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?Qb(i,s):i.dispatchEvent(s)}const UE=(t,e,n=0)=>{const r=Math.abs(t.x),i=Math.abs(t.y),s=r>i;return e==="left"||e==="right"?s&&r>n:!s&&i>n};function kW(t=()=>{}){const e=Dn(t);Gr(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function CW(t){return t.nodeType===t.ELEMENT_NODE}function EW(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function fy(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}const AW=hR,vR=uW,wR=mW,bR=wW,xR=bW,SR=pR,kR=mR,PW=AW,CR=m.forwardRef(({className:t,...e},n)=>x.jsx(vR,{ref:n,className:Me("fixed inset-x-0 top-12 z-[100] mx-auto flex max-h-screen w-full flex-col p-4 md:max-w-[420px]",t),...e}));CR.displayName=vR.displayName;const ER=m.forwardRef(({className:t,variant:e="default",...n},r)=>x.jsx(wR,{ref:r,"data-variant":e,className:Me("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-bottom-full data-[state=open]:slide-in-from-top-full",e==="default"&&"border border-stone-600 bg-stone-900 text-white",e==="error"&&"group bg-red-900 text-red-50",t),...n}));ER.displayName=wR.displayName;const AR=m.forwardRef(({className:t,...e},n)=>x.jsx(SR,{ref:n,className:Me("inline-flex h-8 shrink-0 items-center justify-center rounded-md bg-mantis-500 px-3 text-sm font-medium ring-offset-stone-900 transition-colors hover:bg-mantis-400 focus:outline-none focus:ring-2 focus:ring-stone-600 focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50","group-data-[variant=error]:border group-data-[variant=error]:border-white/40 group-data-[variant=error]:hover:border-white/30  group-data-[variant=error]:hover:bg-red-700 group-data-[variant=error]:hover:text-white group-data-[variant=error]:focus:ring-white",t),...e}));AR.displayName=SR.displayName;const PR=m.forwardRef(({className:t,...e},n)=>x.jsx(kR,{ref:n,className:Me("text-current/50 absolute right-2 top-2 rounded-md p-1 opacity-0 transition-opacity hover:text-current focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-data-[variant=error]:text-red-300 group-data-[variant=error]:hover:text-red-50 group-data-[variant=error]:focus:ring-red-400 group-data-[variant=error]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:x.jsx("span",{className:"icon-[lucide--x] block h-4 w-4"})}));PR.displayName=kR.displayName;const TR=m.forwardRef(({className:t,...e},n)=>x.jsx(bR,{ref:n,className:Me("text-sm font-semibold",t),...e}));TR.displayName=bR.displayName;const $R=m.forwardRef(({className:t,...e},n)=>x.jsx(xR,{ref:n,className:Me("text-sm opacity-90",t),...e}));$R.displayName=xR.displayName;var Lr=function(t,e){return Number(t.toFixed(e))},TW=function(t,e){return typeof t=="number"?t:e},bt=function(t,e,n){n&&typeof n=="function"&&n(t,e)},$W=function(t){return-Math.cos(t*Math.PI)/2+.5},NW=function(t){return t},OW=function(t){return t*t},_W=function(t){return t*(2-t)},RW=function(t){return t<.5?2*t*t:-1+(4-2*t)*t},MW=function(t){return t*t*t},DW=function(t){return--t*t*t+1},IW=function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},LW=function(t){return t*t*t*t},BW=function(t){return 1- --t*t*t*t},jW=function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},zW=function(t){return t*t*t*t*t},FW=function(t){return 1+--t*t*t*t*t},UW=function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t},NR={easeOut:$W,linear:NW,easeInQuad:OW,easeOutQuad:_W,easeInOutQuad:RW,easeInCubic:MW,easeOutCubic:DW,easeInOutCubic:IW,easeInQuart:LW,easeOutQuart:BW,easeInOutQuart:jW,easeInQuint:zW,easeOutQuint:FW,easeInOutQuint:UW},OR=function(t){typeof t=="number"&&cancelAnimationFrame(t)},ji=function(t){t.mounted&&(OR(t.animation),t.animate=!1,t.animation=null,t.velocity=null)};function _R(t,e,n,r){if(t.mounted){var i=new Date().getTime(),s=1;ji(t),t.animation=function(){if(!t.mounted)return OR(t.animation);var o=new Date().getTime()-i,a=o/n,l=NR[e],u=l(a);o>=n?(r(s),t.animation=null):t.animation&&(r(u),requestAnimationFrame(t.animation))},requestAnimationFrame(t.animation)}}function VW(t){var e=t.scale,n=t.positionX,r=t.positionY;return!(Number.isNaN(e)||Number.isNaN(n)||Number.isNaN(r))}function Go(t,e,n,r){var i=VW(e);if(!(!t.mounted||!i)){var s=t.setTransformState,o=t.transformState,a=o.scale,l=o.positionX,u=o.positionY,c=e.scale-a,d=e.positionX-l,h=e.positionY-u;n===0?s(e.scale,e.positionX,e.positionY):_R(t,r,n,function(f){var p=a+c*f,g=l+d*f,b=u+h*f;s(p,g,b)})}}function HW(t,e,n){var r=t.offsetWidth,i=t.offsetHeight,s=e.offsetWidth,o=e.offsetHeight,a=s*n,l=o*n,u=r-a,c=i-l;return{wrapperWidth:r,wrapperHeight:i,newContentWidth:a,newDiffWidth:u,newContentHeight:l,newDiffHeight:c}}var WW=function(t,e,n,r,i,s,o){var a=t>e?n*(o?1:.5):0,l=r>i?s*(o?1:.5):0,u=t-e-a,c=a,d=r-i-l,h=l;return{minPositionX:u,maxPositionX:c,minPositionY:d,maxPositionY:h}},Rx=function(t,e){var n=t.wrapperComponent,r=t.contentComponent,i=t.setup.centerZoomedOut;if(!n||!r)throw new Error("Components are not mounted");var s=HW(n,r,e),o=s.wrapperWidth,a=s.wrapperHeight,l=s.newContentWidth,u=s.newDiffWidth,c=s.newContentHeight,d=s.newDiffHeight,h=WW(o,l,u,a,c,d,!!i);return h},Bw=function(t,e,n,r){return r?t<e?Lr(e,2):t>n?Lr(n,2):Lr(t,2):Lr(t,2)},mu=function(t,e){var n=Rx(t,e);return t.bounds=n,n};function Og(t,e,n,r,i,s,o){var a=n.minPositionX,l=n.minPositionY,u=n.maxPositionX,c=n.maxPositionY,d=0,h=0;o&&(d=i,h=s);var f=Bw(t,a-d,u+d,r),p=Bw(e,l-h,c+h,r);return{x:f,y:p}}function _g(t,e,n,r,i,s){var o=t.transformState,a=o.scale,l=o.positionX,u=o.positionY,c=r-a;if(typeof e!="number"||typeof n!="number")return console.error("Mouse X and Y position were not provided!"),{x:l,y:u};var d=l-e*c,h=u-n*c,f=Og(d,h,i,s,0,0,null);return f}function ah(t,e,n,r,i){var s=i?r:0,o=e-s;return!Number.isNaN(n)&&t>=n?n:!Number.isNaN(e)&&t<=o?o:t}var VE=function(t,e){var n=t.setup.panning.excluded,r=t.isInitialized,i=t.wrapperComponent,s=e.target,o=i==null?void 0:i.contains(s),a=r&&s&&o;if(!a)return!1;var l=Rg(s,n);return!l},HE=function(t){var e=t.isInitialized,n=t.isPanning,r=t.setup,i=r.panning.disabled,s=e&&n&&!i;return!!s},GW=function(t,e){var n=t.transformState,r=n.positionX,i=n.positionY;t.isPanning=!0;var s=e.clientX,o=e.clientY;t.startCoords={x:s-r,y:o-i}},KW=function(t,e){var n=e.touches,r=t.transformState,i=r.positionX,s=r.positionY;t.isPanning=!0;var o=n.length===1;if(o){var a=n[0].clientX,l=n[0].clientY;t.startCoords={x:a-i,y:l-s}}};function XW(t){var e=t.transformState,n=e.positionX,r=e.positionY,i=e.scale,s=t.setup,o=s.disabled,a=s.limitToBounds,l=s.centerZoomedOut,u=t.wrapperComponent;if(!(o||!u||!t.bounds)){var c=t.bounds,d=c.maxPositionX,h=c.minPositionX,f=c.maxPositionY,p=c.minPositionY,g=n>d||n<h,b=r>f||r<p,y=n>d?u.offsetWidth:t.setup.minPositionX||0,v=r>f?u.offsetHeight:t.setup.minPositionY||0,w=_g(t,y,v,i,t.bounds,a||l),S=w.x,C=w.y;return{scale:i,positionX:g?S:n,positionY:b?C:r}}}function ZW(t,e,n,r,i){var s=t.setup.limitToBounds,o=t.wrapperComponent,a=t.bounds,l=t.transformState,u=l.scale,c=l.positionX,d=l.positionY;if(!(o===null||a===null||e===c&&n===d)){var h=Og(e,n,a,s,r,i,o),f=h.x,p=h.y;t.setTransformState(u,f,p)}}var JW=function(t,e,n){var r=t.startCoords,i=t.transformState,s=t.setup.panning,o=s.lockAxisX,a=s.lockAxisY,l=i.positionX,u=i.positionY;if(!r)return{x:l,y:u};var c=e-r.x,d=n-r.y,h=o?l:c,f=a?u:d;return{x:h,y:f}},fm=function(t,e){var n=t.setup,r=t.transformState,i=r.scale,s=n.minScale,o=n.disablePadding;return e>0&&i>=s&&!o?e:0},YW=function(t){var e=t.mounted,n=t.setup,r=n.disabled,i=n.velocityAnimation,s=t.transformState.scale,o=i.disabled,a=!o||s>1||!r||e;return!!a},qW=function(t){var e=t.mounted,n=t.velocity,r=t.bounds,i=t.setup,s=i.disabled,o=i.velocityAnimation,a=t.transformState.scale,l=o.disabled,u=!l||a>1||!s||e;return!(!u||!n||!r)};function QW(t,e){var n=t.setup.velocityAnimation,r=n.equalToMove,i=n.animationTime,s=n.sensitivity;return r?i*e*s:i}function WE(t,e,n,r,i,s,o,a,l,u){if(i){if(e>o&&n>o){var c=o+(t-o)*u;return c>l?l:c<o?o:c}if(e<s&&n<s){var c=s+(t-s)*u;return c<a?a:c>s?s:c}}return r?e:Bw(t,s,o,i)}function eG(t,e){var n=1;return e?Math.min(n,t.offsetWidth/window.innerWidth):n}function tG(t,e){var n=YW(t);if(n){var r=t.lastMousePosition,i=t.velocityTime,s=t.setup,o=t.wrapperComponent,a=s.velocityAnimation.equalToMove,l=Date.now();if(r&&i&&o){var u=eG(o,a),c=e.x-r.x,d=e.y-r.y,h=c/u,f=d/u,p=l-i,g=c*c+d*d,b=Math.sqrt(g)/p;t.velocity={velocityX:h,velocityY:f,total:b}}t.lastMousePosition=e,t.velocityTime=l}}function nG(t){var e=t.velocity,n=t.bounds,r=t.setup,i=t.wrapperComponent,s=qW(t);if(!(!s||!e||!n||!i)){var o=e.velocityX,a=e.velocityY,l=e.total,u=n.maxPositionX,c=n.minPositionX,d=n.maxPositionY,h=n.minPositionY,f=r.limitToBounds,p=r.alignmentAnimation,g=r.zoomAnimation,b=r.panning,y=b.lockAxisY,v=b.lockAxisX,w=g.animationType,S=p.sizeX,C=p.sizeY,E=p.velocityAlignmentTime,T=E,A=QW(t,l),N=Math.max(A,T),R=fm(t,S),O=fm(t,C),j=R*i.offsetWidth/100,z=O*i.offsetHeight/100,I=u+j,G=c-j,K=d+z,ee=h-z,F=t.transformState,_=new Date().getTime();_R(t,w,N,function(V){var Z=t.transformState,ne=Z.scale,me=Z.positionX,H=Z.positionY,L=new Date().getTime()-_,W=L/T,k=NR[p.animationType],$=1-k(Math.min(1,W)),D=1-V,M=me+o*D,U=H+a*D,X=WE(M,F.positionX,me,v,f,c,u,G,I,$),Y=WE(U,F.positionY,H,y,f,h,d,ee,K,$);(me!==M||H!==U)&&t.setTransformState(ne,X,Y)})}}function GE(t,e){var n=t.transformState.scale;ji(t),mu(t,n),window.TouchEvent!==void 0&&e instanceof TouchEvent?KW(t,e):GW(t,e)}function RR(t){var e=t.transformState.scale,n=t.setup,r=n.minScale,i=n.alignmentAnimation,s=i.disabled,o=i.sizeX,a=i.sizeY,l=i.animationTime,u=i.animationType,c=s||e<r||!o&&!a;if(!c){var d=XW(t);d&&Go(t,d,l,u)}}function KE(t,e,n){var r=t.startCoords,i=t.setup,s=i.alignmentAnimation,o=s.sizeX,a=s.sizeY;if(r){var l=JW(t,e,n),u=l.x,c=l.y,d=fm(t,o),h=fm(t,a);tG(t,{x:u,y:c}),ZW(t,u,c,d,h)}}function rG(t){if(t.isPanning){var e=t.setup.panning.velocityDisabled,n=t.velocity,r=t.wrapperComponent,i=t.contentComponent;t.isPanning=!1,t.animate=!1,t.animation=null;var s=r==null?void 0:r.getBoundingClientRect(),o=i==null?void 0:i.getBoundingClientRect(),a=(s==null?void 0:s.width)||0,l=(s==null?void 0:s.height)||0,u=(o==null?void 0:o.width)||0,c=(o==null?void 0:o.height)||0,d=a<u||l<c,h=!e&&n&&(n==null?void 0:n.total)>.1&&d;h?nG(t):RR(t)}}function Mx(t,e,n,r){var i=t.setup,s=i.minScale,o=i.maxScale,a=i.limitToBounds,l=ah(Lr(e,2),s,o,0,!1),u=mu(t,l),c=_g(t,n,r,l,u,a),d=c.x,h=c.y;return{scale:l,positionX:d,positionY:h}}function MR(t,e,n){var r=t.transformState.scale,i=t.wrapperComponent,s=t.setup,o=s.minScale,a=s.limitToBounds,l=s.zoomAnimation,u=l.disabled,c=l.animationTime,d=l.animationType,h=u||r>=o;if((r>=1||a)&&RR(t),!(h||!i||!t.mounted)){var f=e||i.offsetWidth/2,p=n||i.offsetHeight/2,g=Mx(t,o,f,p);g&&Go(t,g,c,d)}}var Ao=function(){return Ao=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Ao.apply(this,arguments)};function XE(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var of={previousScale:1,scale:1,positionX:0,positionY:0},ec={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},DR=function(t){var e,n,r,i;return{previousScale:(e=t.initialScale)!==null&&e!==void 0?e:of.scale,scale:(n=t.initialScale)!==null&&n!==void 0?n:of.scale,positionX:(r=t.initialPositionX)!==null&&r!==void 0?r:of.positionX,positionY:(i=t.initialPositionY)!==null&&i!==void 0?i:of.positionY}},ZE=function(t){var e=Ao({},ec);return Object.keys(t).forEach(function(n){var r=typeof t[n]<"u",i=typeof ec[n]<"u";if(i&&r){var s=Object.prototype.toString.call(ec[n]),o=s==="[object Object]",a=s==="[object Array]";o?e[n]=Ao(Ao({},ec[n]),t[n]):a?e[n]=XE(XE([],ec[n],!0),t[n],!0):e[n]=t[n]}}),e},IR=function(t,e,n){var r=t.transformState.scale,i=t.wrapperComponent,s=t.setup,o=s.maxScale,a=s.minScale,l=s.zoomAnimation,u=s.smooth,c=l.size;if(!i)throw new Error("Wrapper is not mounted");var d=u?r*Math.exp(e*n):r+e*n,h=ah(Lr(d,3),a,o,c,!1);return h};function LR(t,e,n,r,i){var s=t.wrapperComponent,o=t.transformState,a=o.scale,l=o.positionX,u=o.positionY;if(!s)return console.error("No WrapperComponent found");var c=s.offsetWidth,d=s.offsetHeight,h=(c/2-l)/a,f=(d/2-u)/a,p=IR(t,e,n),g=Mx(t,p,h,f);if(!g)return console.error("Error during zoom event. New transformation state was not calculated.");Go(t,g,r,i)}function BR(t,e,n,r){var i=t.setup,s=t.wrapperComponent,o=i.limitToBounds,a=DR(t.props),l=t.transformState,u=l.scale,c=l.positionX,d=l.positionY;if(s){var h=Rx(t,a.scale),f=Og(a.positionX,a.positionY,h,o,0,0,s),p={scale:a.scale,positionX:f.x,positionY:f.y};u===a.scale&&c===a.positionX&&d===a.positionY||(r==null||r(),Go(t,p,e,n))}}function iG(t,e,n,r){var i=t.getBoundingClientRect(),s=e.getBoundingClientRect(),o=n.getBoundingClientRect(),a=s.x*r.scale,l=s.y*r.scale;return{x:(i.x-o.x+a)/r.scale,y:(i.y-o.y+l)/r.scale}}function sG(t,e,n){var r=t.wrapperComponent,i=t.contentComponent,s=t.transformState,o=t.setup,a=o.limitToBounds,l=o.minScale,u=o.maxScale;if(!r||!i)return s;var c=r.getBoundingClientRect(),d=e.getBoundingClientRect(),h=iG(e,r,i,s),f=h.x,p=h.y,g=d.width/s.scale,b=d.height/s.scale,y=r.offsetWidth/g,v=r.offsetHeight/b,w=ah(n||Math.min(y,v),l,u,0,!1),S=(c.width-g*w)/2,C=(c.height-b*w)/2,E=(c.left-f)*w+S,T=(c.top-p)*w+C,A=Rx(t,w),N=Og(E,T,A,a,0,0,r),R=N.x,O=N.y;return{positionX:R,positionY:O,scale:w}}var oG=function(t){return function(e,n,r){e===void 0&&(e=.5),n===void 0&&(n=300),r===void 0&&(r="easeOut"),LR(t,1,e,n,r)}},aG=function(t){return function(e,n,r){e===void 0&&(e=.5),n===void 0&&(n=300),r===void 0&&(r="easeOut"),LR(t,-1,e,n,r)}},lG=function(t){return function(e,n,r,i,s){i===void 0&&(i=300),s===void 0&&(s="easeOut");var o=t.transformState,a=o.positionX,l=o.positionY,u=o.scale,c=t.wrapperComponent,d=t.contentComponent,h=t.setup.disabled;if(!(h||!c||!d)){var f={positionX:Number.isNaN(e)?a:e,positionY:Number.isNaN(n)?l:n,scale:Number.isNaN(r)?u:r};Go(t,f,i,s)}}},uG=function(t){return function(e,n){e===void 0&&(e=200),n===void 0&&(n="easeOut"),BR(t,e,n)}},cG=function(t){return function(e,n,r){n===void 0&&(n=200),r===void 0&&(r="easeOut");var i=t.transformState,s=t.wrapperComponent,o=t.contentComponent;if(s&&o){var a=jR(e||i.scale,s,o);Go(t,a,n,r)}}},dG=function(t){return function(e,n,r,i){r===void 0&&(r=600),i===void 0&&(i="easeOut"),ji(t);var s=t.wrapperComponent,o=typeof e=="string"?document.getElementById(e):e;if(s&&o&&s.contains(o)){var a=sG(t,o,n);Go(t,a,r,i)}}},jw=function(t){return{instance:t,zoomIn:oG(t),zoomOut:aG(t),setTransform:lG(t),resetTransform:uG(t),centerView:cG(t),zoomToElement:dG(t)}},hG=function(t){return{instance:t,state:t.transformState}},st=function(t){var e={};return Object.assign(e,hG(t)),Object.assign(e,jw(t)),e},py=!1;function my(){try{var t={get passive(){return py=!0,!1}};return t}catch{return py=!1,py}}var Rg=function(t,e){var n=t.tagName.toUpperCase(),r=e.find(function(s){return s.toUpperCase()===n});if(r)return!0;var i=e.find(function(s){return t.classList.contains(s)});return!!i},zw=function(t){t&&clearTimeout(t)},fG=function(t,e,n){return"translate(".concat(t,"px, ").concat(e,"px) scale(").concat(n,")")},jR=function(t,e,n){var r=n.offsetWidth*t,i=n.offsetHeight*t,s=(e.offsetWidth-r)/2,o=(e.offsetHeight-i)/2;return{scale:t,positionX:s,positionY:o}};function pG(t){return function(e){t.forEach(function(n){typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var mG=function(t,e){var n=t.setup.wheel,r=n.disabled,i=n.wheelDisabled,s=n.touchPadDisabled,o=n.excluded,a=t.isInitialized,l=t.isPanning,u=e.target,c=a&&!l&&!r&&u;if(!c||i&&!e.ctrlKey||s&&e.ctrlKey)return!1;var d=Rg(u,o);return!d},gG=function(t){return t?t.deltaY<0?1:-1:0};function yG(t,e){var n=gG(t),r=TW(e,n);return r}function zR(t,e,n){var r=e.getBoundingClientRect(),i=0,s=0;if("clientX"in t)i=(t.clientX-r.left)/n,s=(t.clientY-r.top)/n;else{var o=t.touches[0];i=(o.clientX-r.left)/n,s=(o.clientY-r.top)/n}return(Number.isNaN(i)||Number.isNaN(s))&&console.error("No mouse or touch offset found"),{x:i,y:s}}var vG=function(t,e,n,r,i){var s=t.transformState.scale,o=t.wrapperComponent,a=t.setup,l=a.maxScale,u=a.minScale,c=a.zoomAnimation,d=a.disablePadding,h=c.size,f=c.disabled;if(!o)throw new Error("Wrapper is not mounted");var p=s+e*n;if(i)return p;var g=r?!1:!f,b=ah(Lr(p,3),u,l,h,g&&!d);return b},wG=function(t,e){var n=t.previousWheelEvent,r=t.transformState.scale,i=t.setup,s=i.maxScale,o=i.minScale;return n?r<s||r>o||Math.sign(n.deltaY)!==Math.sign(e.deltaY)||n.deltaY>0&&n.deltaY<e.deltaY||n.deltaY<0&&n.deltaY>e.deltaY||Math.sign(n.deltaY)!==Math.sign(e.deltaY):!1},bG=function(t,e){var n=t.setup.pinch,r=n.disabled,i=n.excluded,s=t.isInitialized,o=e.target,a=s&&!r&&o;if(!a)return!1;var l=Rg(o,i);return!l},xG=function(t){var e=t.setup.pinch.disabled,n=t.isInitialized,r=t.pinchStartDistance,i=n&&!e&&r;return!!i},SG=function(t,e,n){var r=n.getBoundingClientRect(),i=t.touches,s=Lr(i[0].clientX-r.left,5),o=Lr(i[0].clientY-r.top,5),a=Lr(i[1].clientX-r.left,5),l=Lr(i[1].clientY-r.top,5);return{x:(s+a)/2/e,y:(o+l)/2/e}},FR=function(t){return Math.sqrt(Math.pow(t.touches[0].pageX-t.touches[1].pageX,2)+Math.pow(t.touches[0].pageY-t.touches[1].pageY,2))},kG=function(t,e){var n=t.pinchStartScale,r=t.pinchStartDistance,i=t.setup,s=i.maxScale,o=i.minScale,a=i.zoomAnimation,l=i.disablePadding,u=a.size,c=a.disabled;if(!n||r===null||!e)throw new Error("Pinch touches distance was not provided");if(e<0)return t.transformState.scale;var d=e/r,h=d*n;return ah(Lr(h,2),o,s,u,!c&&!l)},CG=160,EG=100,AG=function(t,e){var n=t.props,r=n.onWheelStart,i=n.onZoomStart;t.wheelStopEventTimer||(ji(t),bt(st(t),e,r),bt(st(t),e,i))},PG=function(t,e){var n=t.props,r=n.onWheel,i=n.onZoom,s=t.contentComponent,o=t.setup,a=t.transformState,l=a.scale,u=o.limitToBounds,c=o.centerZoomedOut,d=o.zoomAnimation,h=o.wheel,f=o.disablePadding,p=o.smooth,g=d.size,b=d.disabled,y=h.step,v=h.smoothStep;if(!s)throw new Error("Component not mounted");e.preventDefault(),e.stopPropagation();var w=yG(e,null),S=p?v*Math.abs(e.deltaY):y,C=vG(t,w,S,!e.ctrlKey);if(l!==C){var E=mu(t,C),T=zR(e,s,l),A=b||g===0||c||f,N=u&&A,R=_g(t,T.x,T.y,C,E,N),O=R.x,j=R.y;t.previousWheelEvent=e,t.setTransformState(C,O,j),bt(st(t),e,r),bt(st(t),e,i)}},TG=function(t,e){var n=t.props,r=n.onWheelStop,i=n.onZoomStop;zw(t.wheelAnimationTimer),t.wheelAnimationTimer=setTimeout(function(){t.mounted&&(MR(t,e.x,e.y),t.wheelAnimationTimer=null)},EG);var s=wG(t,e);s&&(zw(t.wheelStopEventTimer),t.wheelStopEventTimer=setTimeout(function(){t.mounted&&(t.wheelStopEventTimer=null,bt(st(t),e,r),bt(st(t),e,i))},CG))},$G=function(t,e){var n=FR(e);t.pinchStartDistance=n,t.lastDistance=n,t.pinchStartScale=t.transformState.scale,t.isPanning=!1,ji(t)},NG=function(t,e){var n=t.contentComponent,r=t.pinchStartDistance,i=t.transformState.scale,s=t.setup,o=s.limitToBounds,a=s.centerZoomedOut,l=s.zoomAnimation,u=l.disabled,c=l.size;if(!(r===null||!n)){var d=SG(e,i,n);if(!(!Number.isFinite(d.x)||!Number.isFinite(d.y))){var h=FR(e),f=kG(t,h);if(f!==i){var p=mu(t,f),g=u||c===0||a,b=o&&g,y=_g(t,d.x,d.y,f,p,b),v=y.x,w=y.y;t.pinchMidpoint=d,t.lastDistance=h,t.setTransformState(f,v,w)}}}},OG=function(t){var e=t.pinchMidpoint;t.velocity=null,t.lastDistance=null,t.pinchMidpoint=null,t.pinchStartScale=null,t.pinchStartDistance=null,MR(t,e==null?void 0:e.x,e==null?void 0:e.y)},UR=function(t,e){var n=t.props.onZoomStop,r=t.setup.doubleClick.animationTime;zw(t.doubleClickStopEventTimer),t.doubleClickStopEventTimer=setTimeout(function(){t.doubleClickStopEventTimer=null,bt(st(t),e,n)},r)},_G=function(t,e){var n=t.props,r=n.onZoomStart,i=n.onZoom,s=t.setup.doubleClick,o=s.animationTime,a=s.animationType;bt(st(t),e,r),BR(t,o,a,function(){return bt(st(t),e,i)}),UR(t,e)};function RG(t,e){var n=t.setup,r=t.doubleClickStopEventTimer,i=t.transformState,s=t.contentComponent,o=i.scale,a=t.props,l=a.onZoomStart,u=a.onZoom,c=n.doubleClick,d=c.disabled,h=c.mode,f=c.step,p=c.animationTime,g=c.animationType;if(!d&&!r){if(h==="reset")return _G(t,e);if(!s)return console.error("No ContentComponent found");var b=h==="zoomOut"?-1:1,y=IR(t,b,f);if(o!==y){bt(st(t),e,l);var v=zR(e,s,o),w=Mx(t,y,v.x,v.y);if(!w)return console.error("Error during zoom event. New transformation state was not calculated.");bt(st(t),e,u),Go(t,w,p,g),UR(t,e)}}}var MG=function(t,e){var n=t.isInitialized,r=t.setup,i=t.wrapperComponent,s=r.doubleClick,o=s.disabled,a=s.excluded,l=e.target,u=i==null?void 0:i.contains(l),c=n&&l&&u&&!o;if(!c)return!1;var d=Rg(l,a);return!d},DG=function(){function t(e){var n=this;this.mounted=!0,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){n.initializeWindowEvents()},this.unmount=function(){n.cleanupWindowEvents()},this.update=function(r){mu(n,n.transformState.scale),n.setup=ZE(r)},this.initializeWindowEvents=function(){var r,i=my(),s=(r=n.wrapperComponent)===null||r===void 0?void 0:r.ownerDocument,o=s==null?void 0:s.defaultView;o==null||o.addEventListener("mousedown",n.onPanningStart,i),o==null||o.addEventListener("mousemove",n.onPanning,i),o==null||o.addEventListener("mouseup",n.onPanningStop,i),s==null||s.addEventListener("mouseleave",n.clearPanning,i),o==null||o.addEventListener("keyup",n.setKeyUnPressed,i),o==null||o.addEventListener("keydown",n.setKeyPressed,i)},this.cleanupWindowEvents=function(){var r,i,s=my(),o=(r=n.wrapperComponent)===null||r===void 0?void 0:r.ownerDocument,a=o==null?void 0:o.defaultView;a==null||a.removeEventListener("mousedown",n.onPanningStart,s),a==null||a.removeEventListener("mousemove",n.onPanning,s),a==null||a.removeEventListener("mouseup",n.onPanningStop,s),o==null||o.removeEventListener("mouseleave",n.clearPanning,s),a==null||a.removeEventListener("keyup",n.setKeyUnPressed,s),a==null||a.removeEventListener("keydown",n.setKeyPressed,s),document.removeEventListener("mouseleave",n.clearPanning,s),ji(n),(i=n.observer)===null||i===void 0||i.disconnect()},this.handleInitializeWrapperEvents=function(r){var i=my();r.addEventListener("wheel",n.onWheelZoom,i),r.addEventListener("dblclick",n.onDoubleClick,i),r.addEventListener("touchstart",n.onTouchPanningStart,i),r.addEventListener("touchmove",n.onTouchPanning,i),r.addEventListener("touchend",n.onTouchPanningStop,i)},this.handleInitialize=function(r){var i=n.setup.centerOnInit;n.applyTransformation(),n.onInitCallbacks.forEach(function(s){return s(st(n))}),i&&(n.setCenter(),n.observer=new ResizeObserver(function(){var s;n.onInitCallbacks.forEach(function(o){return o(st(n))}),n.setCenter(),(s=n.observer)===null||s===void 0||s.disconnect()}),n.observer.observe(r))},this.onWheelZoom=function(r){var i=n.setup.disabled;if(!i){var s=mG(n,r);if(s){var o=n.isPressingKeys(n.setup.wheel.activationKeys);o&&(AG(n,r),PG(n,r),TG(n,r))}}},this.onPanningStart=function(r){var i=n.setup.disabled,s=n.props.onPanningStart;if(!i){var o=VE(n,r);if(o){var a=n.isPressingKeys(n.setup.panning.activationKeys);a&&(r.preventDefault(),r.stopPropagation(),ji(n),GE(n,r),bt(st(n),r,s))}}},this.onPanning=function(r){var i=n.setup.disabled,s=n.props.onPanning;if(!i){var o=HE(n);if(o){var a=n.isPressingKeys(n.setup.panning.activationKeys);a&&(r.preventDefault(),r.stopPropagation(),KE(n,r.clientX,r.clientY),bt(st(n),r,s))}}},this.onPanningStop=function(r){var i=n.props.onPanningStop;n.isPanning&&(rG(n),bt(st(n),r,i))},this.onPinchStart=function(r){var i=n.setup.disabled,s=n.props,o=s.onPinchingStart,a=s.onZoomStart;if(!i){var l=bG(n,r);l&&($G(n,r),ji(n),bt(st(n),r,o),bt(st(n),r,a))}},this.onPinch=function(r){var i=n.setup.disabled,s=n.props,o=s.onPinching,a=s.onZoom;if(!i){var l=xG(n);l&&(r.preventDefault(),r.stopPropagation(),NG(n,r),bt(st(n),r,o),bt(st(n),r,a))}},this.onPinchStop=function(r){var i=n.props,s=i.onPinchingStop,o=i.onZoomStop;n.pinchStartScale&&(OG(n),bt(st(n),r,s),bt(st(n),r,o))},this.onTouchPanningStart=function(r){var i=n.setup.disabled,s=n.props.onPanningStart;if(!i){var o=VE(n,r);if(o){var a=n.lastTouch&&+new Date-n.lastTouch<200;if(a&&r.touches.length===1)n.onDoubleClick(r);else{n.lastTouch=+new Date,ji(n);var l=r.touches,u=l.length===1,c=l.length===2;u&&(ji(n),GE(n,r),bt(st(n),r,s)),c&&n.onPinchStart(r)}}}},this.onTouchPanning=function(r){var i=n.setup.disabled,s=n.props.onPanning;if(n.isPanning&&r.touches.length===1){if(i)return;var o=HE(n);if(!o)return;r.preventDefault(),r.stopPropagation();var a=r.touches[0];KE(n,a.clientX,a.clientY),bt(st(n),r,s)}else r.touches.length>1&&n.onPinch(r)},this.onTouchPanningStop=function(r){n.onPanningStop(r),n.onPinchStop(r)},this.onDoubleClick=function(r){var i=n.setup.disabled;if(!i){var s=MG(n,r);s&&RG(n,r)}},this.clearPanning=function(r){n.isPanning&&n.onPanningStop(r)},this.setKeyPressed=function(r){n.pressedKeys[r.key]=!0},this.setKeyUnPressed=function(r){n.pressedKeys[r.key]=!1},this.isPressingKeys=function(r){return r.length?!!r.find(function(i){return n.pressedKeys[i]}):!0},this.setTransformState=function(r,i,s){var o=n.props.onTransformed;if(!Number.isNaN(r)&&!Number.isNaN(i)&&!Number.isNaN(s)){r!==n.transformState.scale&&(n.transformState.previousScale=n.transformState.scale,n.transformState.scale=r),n.transformState.positionX=i,n.transformState.positionY=s,n.applyTransformation();var a=st(n);n.onChangeCallbacks.forEach(function(l){return l(a)}),bt(a,{scale:r,positionX:i,positionY:s},o)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(n.wrapperComponent&&n.contentComponent){var r=jR(n.transformState.scale,n.wrapperComponent,n.contentComponent);n.setTransformState(r.scale,r.positionX,r.positionY)}},this.handleTransformStyles=function(r,i,s){return n.props.customTransform?n.props.customTransform(r,i,s):fG(r,i,s)},this.applyTransformation=function(){if(!(!n.mounted||!n.contentComponent)){var r=n.transformState,i=r.scale,s=r.positionX,o=r.positionY,a=n.handleTransformStyles(s,o,i);n.contentComponent.style.transform=a}},this.getContext=function(){return st(n)},this.onChange=function(r){return n.onChangeCallbacks.has(r)||n.onChangeCallbacks.add(r),function(){n.onChangeCallbacks.delete(r)}},this.onInit=function(r){return n.onInitCallbacks.has(r)||n.onInitCallbacks.add(r),function(){n.onInitCallbacks.delete(r)}},this.init=function(r,i){n.cleanupWindowEvents(),n.wrapperComponent=r,n.contentComponent=i,mu(n,n.transformState.scale),n.handleInitializeWrapperEvents(r),n.handleInitialize(i),n.initializeWindowEvents(),n.isInitialized=!0;var s=st(n);bt(s,void 0,n.props.onInit)},this.props=e,this.setup=ZE(this.props),this.transformState=DR(this.props)}return t}(),Dx=Lt.createContext(null),IG=function(t,e){return typeof t=="function"?t(e):t},LG=Lt.forwardRef(function(t,e){var n=m.useRef(new DG(t)).current,r=IG(t.children,jw(n));return m.useImperativeHandle(e,function(){return jw(n)},[n]),m.useEffect(function(){n.update(t)},[n,t]),Lt.createElement(Dx.Provider,{value:n},r)});Lt.forwardRef(function(t,e){var n=m.useRef(null),r=m.useContext(Dx);return m.useEffect(function(){return r.onChange(function(i){if(n.current){var s=0,o=0;n.current.style.transform=r.handleTransformStyles(s,o,1/i.instance.transformState.scale)}})},[r]),Lt.createElement("div",Ao({},t,{ref:pG([n,e])}))});function BG(t,e){e===void 0&&(e={});var n=e.insertAt;if(!(!t||typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",n==="top"&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}}var jG=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,JE={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};BG(jG);var zG=function(t){var e=t.children,n=t.wrapperClass,r=n===void 0?"":n,i=t.contentClass,s=i===void 0?"":i,o=t.wrapperStyle,a=t.contentStyle,l=t.wrapperProps,u=l===void 0?{}:l,c=t.contentProps,d=c===void 0?{}:c,h=m.useContext(Dx).init,f=m.useRef(null),p=m.useRef(null);return m.useEffect(function(){var g=f.current,b=p.current;g!==null&&b!==null&&h&&h(g,b)},[]),Lt.createElement("div",Ao({},u,{ref:f,className:"react-transform-wrapper ".concat(JE.wrapper," ").concat(r),style:o}),Lt.createElement("div",Ao({},d,{ref:p,className:"react-transform-component ".concat(JE.content," ").concat(s),style:a}),e))};function FG({wrapperRef:t}){const e=lt();return x.jsxs("div",{className:"absolute right-2 top-2 flex flex-col rounded-lg border border-stone-600 bg-stone-900 shadow",children:[x.jsx("button",{className:"m-0.5 flex h-8 w-8 items-center justify-center rounded-t-lg text-white transition-colors hover:enabled:bg-stone-800",onClick:()=>{var n;return(n=t.current)==null?void 0:n.zoomIn()},title:e("control.zoom.in"),children:x.jsx("span",{className:"icon-[lucide--zoom-in] h-4 w-4"})}),x.jsx("hr",{className:"border-stone-600"}),x.jsx("button",{className:"m-0.5 flex h-8 w-8 items-center justify-center rounded-b-lg text-white transition-colors hover:enabled:bg-stone-800",onClick:()=>{var n;return(n=t.current)==null?void 0:n.zoomOut()},title:e("control.zoom.out"),children:x.jsx("span",{className:"icon-[lucide--zoom-out] h-4 w-4"})})]})}function UG(){const t=lt(),{devices:e}=qt();return e.preset==="no-devices"?null:x.jsx("div",{className:"absolute left-[500px] top-[525px] z-10 h-[70px] w-[250px] rounded-lg border border-stone-600 bg-stone-900",children:x.jsx("span",{className:"block w-min whitespace-nowrap rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-lg text-white",children:t("computer.chip-select.name")})})}function VG(){const{devices:t}=qt(),e=["M 380 420 H 800",t.preset!=="no-devices"&&"M 780 420 V 805",t.preset!=="no-devices"&&"M 450 805 H 900",t.preset!=="no-devices"&&"M 583 805 V 875"].filter(Boolean).join(" "),n=["M 380 440 H 800",t.preset!=="no-devices"&&"M 790 440 V 815",t.preset!=="no-devices"&&"M 450 815 H 900",t.preset!=="no-devices"&&"M 573 815 V 875"].filter(Boolean).join(" "),r="M 750 545 H 860 V 460";return x.jsxs("svg",{className:"pointer-events-none absolute inset-0 z-[15] h-full w-full",children:[x.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:e}),x.jsx(Dt.path,{className:"fill-none stroke-[4px]",strokeLinejoin:"round",d:e,style:nt("bus.rd")}),x.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:n}),x.jsx(Dt.path,{className:"fill-none stroke-[4px]",strokeLinejoin:"round",d:n,style:nt("bus.wr")}),t.preset!=="no-devices"&&x.jsxs(x.Fragment,{children:[x.jsx(Xt,{springs:"bus.iom",d:"M 380 460 H 675 V 525"}),x.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:r}),x.jsx(Dt.path,{className:"fill-none stroke-[4px]",strokeLinejoin:"round",d:r,style:nt("bus.mem")})]}),t.pic&&x.jsx(Xt,{springs:"bus.pic",d:"M 521 595 V 730 H 450"}),t.timer&&x.jsx(Xt,{springs:"bus.timer",d:"M 563 595 V 875"}),t.pio&&x.jsx(Xt,{springs:"bus.pio",d:"M 612 595 V 730 H 900"}),t.handshake&&x.jsx(Xt,{springs:"bus.handshake",d:"M 635 595 V 730 H 900"}),t.pic&&x.jsxs(x.Fragment,{children:[x.jsx(Xt,{springs:"bus.intr",d:"M 110 700 V 470"}),x.jsx(Xt,{springs:"bus.inta",d:"M 160 470 V 700"})]}),t.pic&&t.f10&&x.jsx(Xt,{springs:"bus.int0",d:"M 145 950 V 900"}),t.pic&&t.timer&&x.jsx(Xt,{springs:"bus.int1",d:"M 500 955 H 400 V 900"}),t.pic&&t.handshake&&x.jsx(Xt,{springs:"bus.int2",d:"M 930 866 V 1050 H 300 V 900"}),t.preset==="pio-switches-and-leds"&&x.jsxs(x.Fragment,{children:[x.jsx(Xt,{springs:"bus.switches->pio",d:"M 1300 768 H 1120"}),x.jsx(Xt,{springs:"bus.pio->leds",d:"M 1120 858 H 1300"})]}),t.preset==="pio-printer"&&x.jsxs(x.Fragment,{children:[x.jsx(Xt,{springs:"bus.printer.strobe",d:"M 1120 767 H 1250"}),x.jsx(Xt,{springs:"bus.printer.busy",d:"M 1250 782 H 1120"}),x.jsx(Xt,{springs:"bus.printer.data",d:"M 1120 837 H 1250"})]}),t.preset==="handshake"&&x.jsxs(x.Fragment,{children:[x.jsx(Xt,{springs:"bus.printer.strobe",d:"M 1120 767 H 1250"}),x.jsx(Xt,{springs:"bus.printer.busy",d:"M 1250 782 H 1120"}),x.jsx(Xt,{springs:"bus.printer.data",d:"M 1120 837 H 1250"})]})]})}function Xt({d:t,springs:e}){return x.jsxs(x.Fragment,{children:[x.jsx("path",{className:"fill-none stroke-stone-900 stroke-[6px]",strokeLinejoin:"round",d:t}),x.jsx("path",{className:"fill-none stroke-stone-700 stroke-[4px]",strokeLinejoin:"round",d:t}),x.jsx(Dt.path,{d:t,className:"fill-none stroke-red-500 stroke-[4px]",strokeLinejoin:"round",pathLength:1,strokeDasharray:1,style:nt(e)})]})}function HG(){const t=lt(),{devices:e}=qt();return x.jsxs(x.Fragment,{children:[x.jsx(rr,{className:"left-[384px] top-[403px]",children:"rd"}),x.jsx(rr,{className:"left-[384px] top-[423px]",children:"wr"}),e.preset!=="no-devices"&&x.jsxs(x.Fragment,{children:[x.jsx(rr,{className:"left-[384px] top-[443px]",children:"io/m"}),x.jsx(rr,{className:"left-[715px] top-[538px]",children:t("computer.chip-select.mem")})]}),e.pic&&x.jsx(rr,{className:"left-[510px] top-[573px]",children:t("computer.chip-select.pic")}),e.timer&&x.jsx(rr,{className:"left-[545px] top-[573px]",children:t("computer.chip-select.timer")}),e.pio&&x.jsx(rr,{className:"left-[600px] top-[573px]",children:t("computer.chip-select.pio")}),e.handshake&&x.jsx(rr,{className:"left-[600px] top-[573px]",children:t("computer.chip-select.handshake")}),e.pic&&x.jsxs(x.Fragment,{children:[x.jsx(rr,{className:"left-[75px] top-[478px]",children:"intr"}),x.jsx(rr,{className:"left-[125px] top-[478px]",children:"inta"})]}),e.printer&&x.jsxs(x.Fragment,{children:[x.jsx(rr,{className:"left-[1260px] top-[758px]",children:"strobe"}),x.jsx(rr,{className:"left-[1260px] top-[773px]",children:"busy"}),x.jsx(rr,{className:"left-[1260px] top-[828px]",children:"data"})]})]})}function rr({className:t,children:e}){return x.jsx("span",{className:Me("pointer-events-none absolute z-[15] block font-mono text-xs font-bold tracking-wider text-stone-400",t),children:e})}function WG(){const{devices:t}=qt(),e=["M 699 349 H 800",t.preset!=="no-devices"&&"M 725 349 V 770",t.preset!=="no-devices"&&"M 450 770 H 900",t.preset!=="no-devices"&&"M 618 770 V 875"].filter(Boolean).join(" "),n=["M 687 249 H 800",t.preset!=="no-devices"&&"M 765 249 V 790",t.preset!=="no-devices"&&"M 450 790 H 900",t.preset!=="no-devices"&&"M 598 790 V 875"].filter(Boolean).join(" ");return x.jsxs("svg",{className:"pointer-events-none absolute inset-0 z-[5] h-full w-full",children:[x.jsx("path",{className:"fill-none stroke-stone-900 stroke-[14px]",strokeLinejoin:"round",d:n}),x.jsx(Dt.path,{className:"fill-none stroke-[12px]",strokeLinejoin:"round",d:n,style:nt("bus.data")}),x.jsx("path",{className:"fill-none stroke-stone-900 stroke-[14px]",strokeLinejoin:"round",d:e}),x.jsx(Dt.path,{className:"fill-none stroke-[12px]",strokeLinejoin:"round",d:e,style:nt("bus.address")})]})}function GG(){return x.jsxs(x.Fragment,{children:[x.jsx(WG,{}),x.jsx(VG,{}),x.jsx(HG,{}),x.jsx(UG,{})]})}function KG(){const{devices:t}=qt();if(!t.clock)return null;const e=nt("clock.angle");return x.jsx("div",{className:"absolute left-[520px] top-[930px] z-10 h-12 w-12 rounded-full border border-stone-600 bg-stone-800 p-1 [&_*]:z-20",children:x.jsxs("svg",{viewBox:"0 0 24 24",strokeLinecap:"round",strokeLinejoin:"round",className:"h-full w-full fill-none stroke-white stroke-2",children:[x.jsx("circle",{cx:"12",cy:"12",r:"10"}),x.jsx(Dt.line,{x1:e.to(n=>12+6*Math.sin(n*Math.PI/180)),y1:e.to(n=>12-6*Math.cos(n*Math.PI/180)),x2:12,y2:12})]})})}const VR="Popover",[HR,zY]=wi(VR,[Ou]),Ix=Ou(),[XG,Du]=HR(VR),ZG=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:i,onOpenChange:s,modal:o=!1}=t,a=Ix(e),l=m.useRef(null),[u,c]=m.useState(!1),[d=!1,h]=$s({prop:r,defaultProp:i,onChange:s});return m.createElement(p1,a,m.createElement(XG,{scope:e,contentId:_a(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:m.useCallback(()=>h(f=>!f),[h]),hasCustomAnchor:u,onCustomAnchorAdd:m.useCallback(()=>c(!0),[]),onCustomAnchorRemove:m.useCallback(()=>c(!1),[]),modal:o},n))},JG="PopoverTrigger",YG=m.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=Du(JG,n),s=Ix(n),o=Je(e,i.triggerRef),a=m.createElement(Fe.button,re({type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":KR(i.open)},r,{ref:o,onClick:fe(t.onClick,i.onOpenToggle)}));return i.hasCustomAnchor?a:m.createElement(m1,re({asChild:!0},s),a)}),WR="PopoverPortal",[qG,QG]=HR(WR,{forceMount:void 0}),eK=t=>{const{__scopePopover:e,forceMount:n,children:r,container:i}=t,s=Du(WR,e);return m.createElement(qG,{scope:e,forceMount:n},m.createElement(Is,{present:n||s.open},m.createElement(ig,{asChild:!0,container:i},r)))},Bd="PopoverContent",tK=m.forwardRef((t,e)=>{const n=QG(Bd,t.__scopePopover),{forceMount:r=n.forceMount,...i}=t,s=Du(Bd,t.__scopePopover);return m.createElement(Is,{present:r||s.open},s.modal?m.createElement(nK,re({},i,{ref:e})):m.createElement(rK,re({},i,{ref:e})))}),nK=m.forwardRef((t,e)=>{const n=Du(Bd,t.__scopePopover),r=m.useRef(null),i=Je(e,r),s=m.useRef(!1);return m.useEffect(()=>{const o=r.current;if(o)return y1(o)},[]),m.createElement(v1,{as:Oa,allowPinchZoom:!0},m.createElement(GR,re({},t,{ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:fe(t.onCloseAutoFocus,o=>{var a;o.preventDefault(),s.current||(a=n.triggerRef.current)===null||a===void 0||a.focus()}),onPointerDownOutside:fe(t.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,u=a.button===2||l;s.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:fe(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})))}),rK=m.forwardRef((t,e)=>{const n=Du(Bd,t.__scopePopover),r=m.useRef(!1),i=m.useRef(!1);return m.createElement(GR,re({},t,{ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var o;if((o=t.onCloseAutoFocus)===null||o===void 0||o.call(t,s),!s.defaultPrevented){var a;r.current||(a=n.triggerRef.current)===null||a===void 0||a.focus(),s.preventDefault()}r.current=!1,i.current=!1},onInteractOutside:s=>{var o,a;(o=t.onInteractOutside)===null||o===void 0||o.call(t,s),s.defaultPrevented||(r.current=!0,s.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const l=s.target;((a=n.triggerRef.current)===null||a===void 0?void 0:a.contains(l))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&i.current&&s.preventDefault()}}))}),GR=m.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:s,disableOutsidePointerEvents:o,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:u,onInteractOutside:c,...d}=t,h=Du(Bd,n),f=Ix(n);return l1(),m.createElement(u1,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:s},m.createElement(tg,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:c,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:u,onDismiss:()=>h.onOpenChange(!1)},m.createElement(g1,re({"data-state":KR(h.open),role:"dialog",id:h.contentId},f,d,{ref:e,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}}))))});function KR(t){return t?"open":"closed"}const iK=ZG,sK=YG,oK=eK,XR=tK,ZR=iK,JR=sK,Lx=m.forwardRef(({className:t,align:e="center",sideOffset:n=4,...r},i)=>x.jsx(oK,{children:x.jsx(XR,{ref:i,align:e,sideOffset:n,className:Me("z-50 w-72 rounded-md border border-stone-600 bg-stone-900 text-white shadow-md outline-none transition-opacity data-[state=closed]:opacity-0 data-[state=open]:opacity-100",t),...r})}));Lx.displayName=XR.displayName;function gr({name:t,title:e,valueAtom:n,springs:r,emphasis:i=!1,className:s}){const o=lt(),a=dn(n),l=a.low,u=a.is16bits()?a.high:null;return x.jsxs(ZR,{children:[x.jsx(JR,{asChild:!0,children:x.jsxs(Dt.button,{title:e,className:Me("flex w-min cursor-pointer items-center rounded-md border bg-stone-800 px-2 py-1 font-mono leading-none transition-opacity",i?"border-mantis-400 text-lg":"border-stone-600 text-base",s),style:nt(r),children:[x.jsx("span",{className:"mr-2 font-bold",children:t}),u&&x.jsx("span",{className:"mr-0.5 rounded bg-stone-900 p-0.5 font-light",children:u.toString("hex")}),x.jsx("span",{className:"rounded bg-stone-900 p-0.5 font-light",children:l.toString("hex")})]})}),x.jsxs(Lx,{className:"w-60",children:[x.jsx("p",{className:"px-4 py-2 font-medium text-white",children:e}),x.jsx("hr",{className:"border-stone-600"}),x.jsx("ul",{className:"px-4 py-2 text-sm",children:["hex","bin","uint","int","safe-ascii"].map(c=>x.jsxs("li",{children:[x.jsx("b",{className:"font-medium",children:o(`generics.byte-representation.${c}`)}),":"," ",x.jsx("span",{className:"font-mono text-mantis-400",children:a.toString(c)})]},c))})]})]})}function aK(){const t=dn(mt.FLAGS),e=dn(zO),n=t.bit(0),r=t.bit(6),i=t.bit(7),s=t.bit(9),o=t.bit(11);return x.jsxs(x.Fragment,{children:[x.jsxs("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0",children:[x.jsx(Dt.path,{className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",d:"M 173 85 H 220",pathLength:1,strokeDasharray:1,style:nt("cpu.alu.operands")}),x.jsx(Dt.path,{className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",d:"M 182 145 H 220",pathLength:1,strokeDasharray:1,style:nt("cpu.alu.operands")}),x.jsx(Dt.path,{className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",d:"M 272 115 h 28",pathLength:1,strokeDasharray:1,style:nt("cpu.alu.results")}),x.jsx(Dt.path,{className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",d:"M 250 145 v 46",pathLength:1,strokeDasharray:1,style:nt("cpu.alu.results")}),x.jsx("path",{d:"M 220 65 v 40 l 17.32 10 l -17.32 10 v 40 l 51.96 -30 v -40 Z",className:"fill-stone-800 stroke-stone-600",strokeLinejoin:"round"})]}),x.jsx(Dt.span,{className:"icon-[lucide--settings] absolute left-[242px] top-[103px] block h-6 w-6 text-stone-300",style:{transform:nt("cpu.alu.cog").rot.to(a=>`rotate(${a*60}deg)`)}}),x.jsx(Dt.span,{className:"absolute left-[260px] top-[50px] flex w-min items-center rounded-md border border-stone-600 px-2 py-1 font-mono leading-none",style:nt("cpu.alu.operation"),children:e}),x.jsxs(Dt.div,{className:"absolute left-[165px] top-[190px] flex w-min items-center gap-1 rounded-md border border-mantis-400 bg-stone-800 px-2 py-1 font-mono leading-none",style:nt("cpu.FLAGS"),children:[x.jsx("span",{className:Me("rounded p-1 font-light",n?"bg-mantis-400":"bg-stone-900"),children:"CF"}),x.jsx("span",{className:Me("rounded p-1 font-light",r?"bg-mantis-400":"bg-stone-900"),children:"ZF"}),x.jsx("span",{className:Me("rounded p-1 font-light",i?"bg-mantis-400":"bg-stone-900"),children:"SF"}),x.jsx("span",{className:Me("rounded p-1 font-light",s?"bg-mantis-400":"bg-stone-900"),children:"IF"}),x.jsx("span",{className:Me("rounded p-1 font-light",o?"bg-mantis-400":"bg-stone-900"),children:"OF"})]})]})}function lK(){const t=lt(),{status:e}=qt(),n=dn(Ti),r=m.useMemo(()=>{if(!("metadata"in n)||n.metadata.operands.length===0)return"";if(n.phase==="fetching-operands"){let s=" __";for(let o=1;o<n.metadata.operands.length;o++)s+=", __";return s}else return" "+n.metadata.operands.join(", ")},[n]),i=m.useMemo(()=>e.type==="running"&&e.waitingForInput?"waiting-for-input":e.type==="stopped"?e.error?"stopped-error":"stopped":n.phase==="stopped"&&n.error?"stopped-error":n.phase,[e,n]);return x.jsxs(x.Fragment,{children:[x.jsx("svg",{viewBox:"0 0 650 500",className:"pointer-events-none absolute inset-0",children:x.jsx(Dt.path,{className:"fill-none stroke-mantis-400 stroke-bus",strokeLinejoin:"round",d:"M 205 300 V 320",pathLength:1,strokeDasharray:1,style:nt("cpu.decoder.path")})}),x.jsx("div",{className:"absolute bottom-[172px] left-[30px] flex w-full items-start",children:x.jsx("span",{className:"block w-min whitespace-nowrap rounded-t-lg border border-b-0 border-stone-600 bg-mantis-500 px-2 pb-3 pt-1 text-xs tracking-wide text-white",children:t("computer.cpu.control-unit")})}),x.jsxs("div",{className:"absolute bottom-[30px] left-[30px] flex h-[150px] w-[350px] flex-col items-center rounded-lg border border-stone-600 bg-stone-800",children:[x.jsxs("div",{className:"overflow-hidden rounded-b-lg border border-t-0 border-stone-600 bg-stone-900 px-4",children:[x.jsx("span",{className:"text-sm leading-none",children:t("computer.cpu.decoder")}),x.jsx("div",{className:"my-1 h-1 w-full overflow-hidden rounded-full bg-stone-600",children:x.jsx(Dt.div,{className:"h-full bg-mantis-400",style:{width:nt("cpu.decoder.progress.progress").to(s=>`${s*100}%`),opacity:nt("cpu.decoder.progress.opacity")}})})]}),x.jsx("span",{className:Me("mt-4 w-48 rounded-lg border border-stone-600 py-2 text-center text-sm leading-none transition-colors",i==="stopped-error"?"bg-red-500":i==="waiting-for-input"?"bg-amber-600":i==="int6"||i==="int7"?"bg-blue-600":"bg-stone-900"),children:t(`computer.cpu.status.${i}`)}),x.jsx("div",{className:"mt-4 w-64 overflow-hidden rounded-lg border border-stone-600 bg-stone-900 py-2",children:x.jsx("p",{className:"text-center font-mono",children:!("metadata"in n)||n.phase==="fetching"?x.jsx("span",{className:"italic text-stone-400",children:"???"}):x.jsxs(x.Fragment,{children:[x.jsx("span",{className:"text-mantis-400",children:n.metadata.name}),x.jsx("span",{className:"text-white",children:r})]})})})]})]})}function uK(){const t=lt();return x.jsxs("div",{className:"absolute left-0 top-0 z-10 h-[500px] w-[650px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[x.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-3xl text-white",children:t("computer.cpu.name")}),x.jsx(BF,{}),x.jsx(gV,{}),x.jsx(Fn,{name:"left",className:"left-[60px] top-[70px]"}),x.jsx(Fn,{name:"right",className:"left-[60px] top-[130px]"}),x.jsx(Fn,{name:"result",className:"left-[300px] top-[100px]"}),x.jsx(aK,{}),x.jsx(Fn,{name:"AX",emphasis:!0,className:"left-[520px] top-[30px]"}),x.jsx(Fn,{name:"BX",emphasis:!0,className:"left-[520px] top-[70px]"}),x.jsx(Fn,{name:"CX",emphasis:!0,className:"left-[520px] top-[110px]"}),x.jsx(Fn,{name:"DX",emphasis:!0,className:"left-[520px] top-[150px]"}),x.jsx(Fn,{name:"id",className:"left-[520px] top-[190px]"}),x.jsx(Fn,{name:"MBR",className:"right-[-38px] top-[233px]"}),x.jsx(Fn,{name:"IR",className:"left-[171px] top-[270px]"}),x.jsx(lK,{}),x.jsx(Fn,{name:"IP",emphasis:!0,className:"left-[450px] top-[292px]"}),x.jsx(Fn,{name:"SP",emphasis:!0,className:"left-[450px] top-[332px]"}),x.jsx(Fn,{name:"ri",className:"left-[450px] top-[372px]"}),x.jsx(Fn,{name:"MAR",className:"right-[-51px] top-[333px]"})]})}function Fn({name:t,emphasis:e,className:n}){const r=lt();return x.jsx(gr,{name:t,valueAtom:mt[t],springs:`cpu.${t}`,emphasis:e,title:r("computer.cpu.register",t),className:Me("absolute",n)})}const cK="_pushable_1q0ek_2",dK="_front_1q0ek_15",hK="_shadow_1q0ek_20",fK="_edge_1q0ek_52",af={pushable:cK,front:dK,shadow:hK,edge:fK};function pK(){const t=lt(),{status:e,dispatch:n,devices:r}=qt();return xa("F10",i=>{i.preventDefault(),r.f10&&n("f10.press")},void 0,[n,r.f10]),r.f10?x.jsx("div",{className:"absolute left-[50px] top-[950px] z-10 flex h-min w-48 flex-col rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:x.jsxs("button",{className:af.pushable,disabled:e.type!=="running",onClick:()=>n("f10.press"),children:[x.jsx("div",{className:af.shadow}),x.jsx("div",{className:af.edge}),x.jsx("span",{className:af.front,children:t("computer.f10")})]})}):null}function mK(){const t=lt(),{devices:e}=qt();return e.handshake?x.jsxs("div",{className:"absolute left-[900px] top-[700px] z-10 h-min w-[220px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[x.jsx("span",{className:"block h-min w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.handshake.name")}),x.jsx(gr,{name:t("computer.handshake.state"),title:t("generics.io-register","STATE",65),valueAtom:dx,springs:"handshake.STATE",className:"mx-auto my-4"}),x.jsx("hr",{className:"border-stone-600"}),x.jsx(gr,{name:t("computer.handshake.data"),title:t("generics.io-register","DATA",64),valueAtom:cx,springs:"handshake.DATA",className:"mx-auto my-4"})]}):null}var YR={exports:{}};/*!
 * 
 *   react-simple-keyboard v3.6.53 (index.modern.js - Modern Browsers bundle)
 *   https://github.com/hodgef/react-simple-keyboard
 *
 *   NOTE: This modern browsers bundle (index.modern.js) removes all polyfills
 *   included in the standard version. Use this if you are supporting
 *   modern browsers only. Otherwise, use the standard version (index.js).
 *
 *   Copyright (c) Francisco Hodge (https://github.com/hodgef) and project contributors.
 *
 *   This source code is licensed under the MIT license found in the
 *   LICENSE file in the root directory of this source tree.
 *
 */(function(t,e){(function(n,r){t.exports=r(m)})(PD,function(n){return function(){var r={689:function(a){a.exports=function(){var l={d:function(H,L){for(var W in L)l.o(L,W)&&!l.o(H,W)&&Object.defineProperty(H,W,{enumerable:!0,get:L[W]})},o:function(H,L){return Object.prototype.hasOwnProperty.call(H,L)},r:function(H){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(H,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(H,"__esModule",{value:!0})}},u={};function c(H){return function(L){if(Array.isArray(L))return h(L)}(H)||function(L){if(typeof Symbol<"u"&&L[Symbol.iterator]!=null||L["@@iterator"]!=null)return Array.from(L)}(H)||d(H)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function d(H,L){if(H){if(typeof H=="string")return h(H,L);var W=Object.prototype.toString.call(H).slice(8,-1);return W==="Object"&&H.constructor&&(W=H.constructor.name),W==="Map"||W==="Set"?Array.from(H):W==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(W)?h(H,L):void 0}}function h(H,L){(L==null||L>H.length)&&(L=H.length);for(var W=0,k=new Array(L);W<L;W++)k[W]=H[W];return k}function f(H){return f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},f(H)}function p(H,L){for(var W=0;W<L.length;W++){var k=L[W];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(H,b(k.key),k)}}function g(H,L,W){return(L=b(L))in H?Object.defineProperty(H,L,{value:W,enumerable:!0,configurable:!0,writable:!0}):H[L]=W,H}function b(H){var L=function(W,k){if(f(W)!=="object"||W===null)return W;var $=W[Symbol.toPrimitive];if($!==void 0){var D=$.call(W,k||"default");if(f(D)!=="object")return D;throw new TypeError("@@toPrimitive must return a primitive value.")}return(k==="string"?String:Number)(W)}(H,"string");return f(L)==="symbol"?L:String(L)}l.r(u),l.d(u,{SimpleKeyboard:function(){return ne},default:function(){return me}});var y=function(){function H($){var D=$.getOptions,M=$.getCaretPosition,U=$.getCaretPositionEnd,X=$.dispatch;(function(Y,q){if(!(Y instanceof q))throw new TypeError("Cannot call a class as a function")})(this,H),g(this,"getOptions",void 0),g(this,"getCaretPosition",void 0),g(this,"getCaretPositionEnd",void 0),g(this,"dispatch",void 0),g(this,"maxLengthReached",void 0),g(this,"isStandardButton",function(Y){return Y&&!(Y[0]==="{"&&Y[Y.length-1]==="}")}),this.getOptions=D,this.getCaretPosition=M,this.getCaretPositionEnd=U,this.dispatch=X,H.bindMethods(H,this)}var L,W,k;return L=H,W=[{key:"getButtonType",value:function($){return $.includes("{")&&$.includes("}")&&$!=="{//}"?"functionBtn":"standardBtn"}},{key:"getButtonClass",value:function($){var D=this.getButtonType($),M=$.replace("{","").replace("}",""),U="";return D!=="standardBtn"&&(U=" hg-button-".concat(M)),"hg-".concat(D).concat(U)}},{key:"getDefaultDiplay",value:function(){return{"{bksp}":"backspace","{backspace}":"backspace","{enter}":"< enter","{shift}":"shift","{shiftleft}":"shift","{shiftright}":"shift","{alt}":"alt","{s}":"shift","{tab}":"tab","{lock}":"caps","{capslock}":"caps","{accept}":"Submit","{space}":" ","{//}":" ","{esc}":"esc","{escape}":"esc","{f1}":"f1","{f2}":"f2","{f3}":"f3","{f4}":"f4","{f5}":"f5","{f6}":"f6","{f7}":"f7","{f8}":"f8","{f9}":"f9","{f10}":"f10","{f11}":"f11","{f12}":"f12","{numpaddivide}":"/","{numlock}":"lock","{arrowup}":"","{arrowleft}":"","{arrowdown}":"","{arrowright}":"","{prtscr}":"print","{scrolllock}":"scroll","{pause}":"pause","{insert}":"ins","{home}":"home","{pageup}":"up","{delete}":"del","{forwarddelete}":"del","{end}":"end","{pagedown}":"down","{numpadmultiply}":"*","{numpadsubtract}":"-","{numpadadd}":"+","{numpadenter}":"enter","{period}":".","{numpaddecimal}":".","{numpad0}":"0","{numpad1}":"1","{numpad2}":"2","{numpad3}":"3","{numpad4}":"4","{numpad5}":"5","{numpad6}":"6","{numpad7}":"7","{numpad8}":"8","{numpad9}":"9"}}},{key:"getButtonDisplayName",value:function($,D){return(D=arguments.length>2&&arguments[2]!==void 0&&arguments[2]?Object.assign({},this.getDefaultDiplay(),D):D||this.getDefaultDiplay())[$]||$}},{key:"getUpdatedInput",value:function($,D,M){var U=arguments.length>3&&arguments[3]!==void 0?arguments[3]:M,X=arguments.length>4&&arguments[4]!==void 0&&arguments[4],Y=this.getOptions(),q=[M,U,X],oe=D;return($==="{bksp}"||$==="{backspace}")&&oe.length>0?oe=this.removeAt.apply(this,[oe].concat(q)):($==="{delete}"||$==="{forwarddelete}")&&oe.length>0?oe=this.removeForwardsAt.apply(this,[oe].concat(q)):$==="{space}"?oe=this.addStringAt.apply(this,[oe," "].concat(q)):$!=="{tab}"||typeof Y.tabCharOnTab=="boolean"&&Y.tabCharOnTab===!1?$!=="{enter}"&&$!=="{numpadenter}"||!Y.newLineOnEnter?$.includes("numpad")&&Number.isInteger(Number($[$.length-2]))?oe=this.addStringAt.apply(this,[oe,$[$.length-2]].concat(q)):$==="{numpaddivide}"?oe=this.addStringAt.apply(this,[oe,"/"].concat(q)):$==="{numpadmultiply}"?oe=this.addStringAt.apply(this,[oe,"*"].concat(q)):$==="{numpadsubtract}"?oe=this.addStringAt.apply(this,[oe,"-"].concat(q)):$==="{numpadadd}"?oe=this.addStringAt.apply(this,[oe,"+"].concat(q)):$==="{numpaddecimal}"?oe=this.addStringAt.apply(this,[oe,"."].concat(q)):$==="{"||$==="}"?oe=this.addStringAt.apply(this,[oe,$].concat(q)):$.includes("{")||$.includes("}")||(oe=this.addStringAt.apply(this,[oe,$].concat(q))):oe=this.addStringAt.apply(this,[oe,`
`].concat(q)):oe=this.addStringAt.apply(this,[oe,"	"].concat(q)),Y.debug&&console.log("Input will be: "+oe),oe}},{key:"updateCaretPos",value:function($){var D=arguments.length>1&&arguments[1]!==void 0&&arguments[1],M=this.updateCaretPosAction($,D);this.dispatch(function(U){U.setCaretPosition(M)})}},{key:"updateCaretPosAction",value:function($){var D=arguments.length>1&&arguments[1]!==void 0&&arguments[1],M=this.getOptions(),U=this.getCaretPosition();return U!=null&&(D?U>0&&(U-=$):U+=$),M.debug&&console.log("Caret at:",U),U}},{key:"addStringAt",value:function($,D){var M,U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$.length,X=arguments.length>3&&arguments[3]!==void 0?arguments[3]:$.length,Y=arguments.length>4&&arguments[4]!==void 0&&arguments[4];return U||U===0?(M=[$.slice(0,U),D,$.slice(X)].join(""),this.isMaxLengthReached()||Y&&this.updateCaretPos(D.length)):M=$+D,M}},{key:"removeAt",value:function($){var D,M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$.length,U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$.length,X=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(M===0&&U===0)return $;if(M===U){var Y=/([\uD800-\uDBFF][\uDC00-\uDFFF])/g;M&&M>=0?$.substring(M-2,M).match(Y)?(D=$.substr(0,M-2)+$.substr(M),X&&this.updateCaretPos(2,!0)):(D=$.substr(0,M-1)+$.substr(M),X&&this.updateCaretPos(1,!0)):$.slice(-2).match(Y)?(D=$.slice(0,-2),X&&this.updateCaretPos(2,!0)):(D=$.slice(0,-1),X&&this.updateCaretPos(1,!0))}else D=$.slice(0,M)+$.slice(U),X&&this.dispatch(function(q){q.setCaretPosition(M)});return D}},{key:"removeForwardsAt",value:function($){var D,M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$.length,U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:$.length,X=arguments.length>3&&arguments[3]!==void 0&&arguments[3];return $!=null&&$.length&&M!==null?(M===U?D=$.substring(M,M+2).match(/([\uD800-\uDBFF][\uDC00-\uDFFF])/g)?$.substr(0,M)+$.substr(M+2):$.substr(0,M)+$.substr(M+1):(D=$.slice(0,M)+$.slice(U),X&&this.dispatch(function(Y){Y.setCaretPosition(M)})),D):$}},{key:"handleMaxLength",value:function($,D){var M=this.getOptions(),U=M.maxLength,X=$[M.inputName||"default"],Y=D.length-1>=U;if(D.length<=X.length)return!1;if(Number.isInteger(U))return M.debug&&console.log("maxLength (num) reached:",Y),Y?(this.maxLengthReached=!0,!0):(this.maxLengthReached=!1,!1);if(f(U)==="object"){var q=D.length-1>=U[M.inputName||"default"];return M.debug&&console.log("maxLength (obj) reached:",q),q?(this.maxLengthReached=!0,!0):(this.maxLengthReached=!1,!1)}}},{key:"isMaxLengthReached",value:function(){return!!this.maxLengthReached}},{key:"isTouchDevice",value:function(){return"ontouchstart"in window||navigator.maxTouchPoints}},{key:"pointerEventsSupported",value:function(){return!!window.PointerEvent}},{key:"camelCase",value:function($){return $?$.toLowerCase().trim().split(/[.\-_\s]/g).reduce(function(D,M){return M.length?D+M[0].toUpperCase()+M.slice(1):D}):""}},{key:"chunkArray",value:function($,D){return c(Array(Math.ceil($.length/D))).map(function(M,U){return $.slice(D*U,D+D*U)})}},{key:"escapeRegex",value:function($){return $.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}},{key:"getRtlOffset",value:function($,D){var M=$,U=D.indexOf("");return U<$&&U!=-1&&M--,D.indexOf("")<$&&U!=-1&&M--,M<0?0:M}}],k=[{key:"bindMethods",value:function($,D){var M,U=function(Y,q){var oe=typeof Symbol<"u"&&Y[Symbol.iterator]||Y["@@iterator"];if(!oe){if(Array.isArray(Y)||(oe=d(Y))||q&&Y&&typeof Y.length=="number"){oe&&(Y=oe);var Be=0,we=function(){};return{s:we,n:function(){return Be>=Y.length?{done:!0}:{done:!1,value:Y[Be++]}},e:function(kt){throw kt},f:we}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Ne,Re=!0,ye=!1;return{s:function(){oe=oe.call(Y)},n:function(){var kt=oe.next();return Re=kt.done,kt},e:function(kt){ye=!0,Ne=kt},f:function(){try{Re||oe.return==null||oe.return()}finally{if(ye)throw Ne}}}}(Object.getOwnPropertyNames($.prototype));try{for(U.s();!(M=U.n()).done;){var X=M.value;X==="constructor"||X==="bindMethods"||(D[X]=D[X].bind(D))}}catch(Y){U.e(Y)}finally{U.f()}}}],W&&p(L.prototype,W),k&&p(L,k),Object.defineProperty(L,"prototype",{writable:!1}),H}();g(y,"noop",function(){});var v=y;function w(H){return w=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},w(H)}function S(H,L){for(var W=0;W<L.length;W++){var k=L[W];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(H,E(k.key),k)}}function C(H,L,W){return(L=E(L))in H?Object.defineProperty(H,L,{value:W,enumerable:!0,configurable:!0,writable:!0}):H[L]=W,H}function E(H){var L=function(W,k){if(w(W)!=="object"||W===null)return W;var $=W[Symbol.toPrimitive];if($!==void 0){var D=$.call(W,k||"default");if(w(D)!=="object")return D;throw new TypeError("@@toPrimitive must return a primitive value.")}return(k==="string"?String:Number)(W)}(H,"string");return w(L)==="symbol"?L:String(L)}var T=function(){function H(k){var $=this,D=k.dispatch,M=k.getOptions;(function(U,X){if(!(U instanceof X))throw new TypeError("Cannot call a class as a function")})(this,H),C(this,"getOptions",void 0),C(this,"dispatch",void 0),C(this,"isMofifierKey",function(U){return U.altKey||U.ctrlKey||U.shiftKey||["Tab","CapsLock","Esc","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(U.code||U.key||$.keyCodeToKey(U==null?void 0:U.keyCode))}),this.dispatch=D,this.getOptions=M,v.bindMethods(H,this)}var L,W;return L=H,(W=[{key:"handleHighlightKeyDown",value:function(k){var $=this.getOptions();$.physicalKeyboardHighlightPreventDefault&&this.isMofifierKey(k)&&(k.preventDefault(),k.stopImmediatePropagation());var D=this.getSimpleKeyboardLayoutKey(k);this.dispatch(function(M){var U,X,Y=M.getButtonElement(D),q=M.getButtonElement("{".concat(D,"}"));if(Y)U=Y,X=D;else{if(!q)return;U=q,X="{".concat(D,"}")}var oe,Be=function(Ne){Ne.style.background=$.physicalKeyboardHighlightBgColor||"#dadce4",Ne.style.color=$.physicalKeyboardHighlightTextColor||"black"};if(U)if(Array.isArray(U)){if(U.forEach(function(Ne){return Be(Ne)}),$.physicalKeyboardHighlightPress)if($.physicalKeyboardHighlightPressUsePointerEvents)(oe=U[0])===null||oe===void 0||oe.onpointerdown();else if($.physicalKeyboardHighlightPressUseClick){var we;(we=U[0])===null||we===void 0||we.click()}else M.handleButtonClicked(X,k)}else Be(U),$.physicalKeyboardHighlightPress&&($.physicalKeyboardHighlightPressUsePointerEvents?U.onpointerdown():$.physicalKeyboardHighlightPressUseClick?U.click():M.handleButtonClicked(X,k))})}},{key:"handleHighlightKeyUp",value:function(k){var $=this.getOptions();$.physicalKeyboardHighlightPreventDefault&&this.isMofifierKey(k)&&(k.preventDefault(),k.stopImmediatePropagation());var D=this.getSimpleKeyboardLayoutKey(k);this.dispatch(function(M){var U,X=M.getButtonElement(D)||M.getButtonElement("{".concat(D,"}")),Y=function(q){q.removeAttribute&&q.removeAttribute("style")};X&&(Array.isArray(X)?(X.forEach(function(q){return Y(q)}),$.physicalKeyboardHighlightPressUsePointerEvents&&((U=X[0])===null||U===void 0||U.onpointerup())):(Y(X),$.physicalKeyboardHighlightPressUsePointerEvents&&X.onpointerup()))})}},{key:"getSimpleKeyboardLayoutKey",value:function(k){var $,D="",M=k.code||k.key||this.keyCodeToKey(k==null?void 0:k.keyCode);return(D=M!=null&&M.includes("Numpad")||M!=null&&M.includes("Shift")||M!=null&&M.includes("Space")||M!=null&&M.includes("Backspace")||M!=null&&M.includes("Control")||M!=null&&M.includes("Alt")||M!=null&&M.includes("Meta")?k.code||"":k.key||this.keyCodeToKey(k==null?void 0:k.keyCode)||"").length>1?($=D)===null||$===void 0?void 0:$.toLowerCase():D}},{key:"keyCodeToKey",value:function(k){return{8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",65:"A",66:"B",67:"C",68:"D",69:"E",70:"F",71:"G",72:"H",73:"I",74:"J",75:"K",76:"L",77:"M",78:"N",79:"O",80:"P",81:"Q",82:"R",83:"S",84:"T",85:"U",86:"V",87:"W",88:"X",89:"Y",90:"Z",91:"Meta",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9",106:"NumpadMultiply",107:"NumpadAdd",109:"NumpadSubtract",110:"NumpadDecimal",111:"NumpadDivide",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}[k]||""}}])&&S(L.prototype,W),Object.defineProperty(L,"prototype",{writable:!1}),H}();function A(H){return A=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},A(H)}function N(H,L){for(var W=0;W<L.length;W++){var k=L[W];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(H,O(k.key),k)}}function R(H,L,W){return(L=O(L))in H?Object.defineProperty(H,L,{value:W,enumerable:!0,configurable:!0,writable:!0}):H[L]=W,H}function O(H){var L=function(W,k){if(A(W)!=="object"||W===null)return W;var $=W[Symbol.toPrimitive];if($!==void 0){var D=$.call(W,k||"default");if(A(D)!=="object")return D;throw new TypeError("@@toPrimitive must return a primitive value.")}return(k==="string"?String:Number)(W)}(H,"string");return A(L)==="symbol"?L:String(L)}var j=function(){function H(k){var $=k.utilities,D=k.options;(function(M,U){if(!(M instanceof U))throw new TypeError("Cannot call a class as a function")})(this,H),R(this,"utilities",void 0),R(this,"options",void 0),R(this,"candidateBoxElement",void 0),R(this,"pageIndex",0),R(this,"pageSize",void 0),this.utilities=$,this.options=D,v.bindMethods(H,this),this.pageSize=this.utilities.getOptions().layoutCandidatesPageSize||5}var L,W;return L=H,W=[{key:"destroy",value:function(){this.candidateBoxElement&&(this.candidateBoxElement.remove(),this.pageIndex=0)}},{key:"show",value:function(k){var $=this,D=k.candidateValue,M=k.targetElement,U=k.onSelect;if(D&&D.length){var X=this.utilities.chunkArray(D.split(" "),this.pageSize);this.renderPage({candidateListPages:X,targetElement:M,pageIndex:this.pageIndex,nbPages:X.length,onItemSelected:function(Y,q){U(Y,q),$.destroy()}})}}},{key:"renderPage",value:function(k){var $,D=this,M=k.candidateListPages,U=k.targetElement,X=k.pageIndex,Y=k.nbPages,q=k.onItemSelected;($=this.candidateBoxElement)===null||$===void 0||$.remove(),this.candidateBoxElement=document.createElement("div"),this.candidateBoxElement.className="hg-candidate-box";var oe=document.createElement("ul");oe.className="hg-candidate-box-list",M[X].forEach(function(zn){var Jo,bi=document.createElement("li"),zs=function(){var Fs=new(D.options.useTouchEvents?TouchEvent:MouseEvent)("click");return Object.defineProperty(Fs,"target",{value:bi}),Fs};bi.className="hg-candidate-box-list-item",bi.innerHTML=((Jo=D.options.display)===null||Jo===void 0?void 0:Jo[zn])||zn,D.options.useTouchEvents?bi.ontouchstart=function(Fs){return q(zn,Fs||zs())}:bi.onclick=function(){var Fs=arguments.length>0&&arguments[0]!==void 0?arguments[0]:zs();return q(zn,Fs)},oe.appendChild(bi)});var Be=X>0,we=document.createElement("div");we.classList.add("hg-candidate-box-prev"),Be&&we.classList.add("hg-candidate-box-btn-active");var Ne=function(){Be&&D.renderPage({candidateListPages:M,targetElement:U,pageIndex:X-1,nbPages:Y,onItemSelected:q})};this.options.useTouchEvents?we.ontouchstart=Ne:we.onclick=Ne,this.candidateBoxElement.appendChild(we),this.candidateBoxElement.appendChild(oe);var Re=X<Y-1,ye=document.createElement("div");ye.classList.add("hg-candidate-box-next"),Re&&ye.classList.add("hg-candidate-box-btn-active");var kt=function(){Re&&D.renderPage({candidateListPages:M,targetElement:U,pageIndex:X+1,nbPages:Y,onItemSelected:q})};this.options.useTouchEvents?ye.ontouchstart=kt:ye.onclick=kt,this.candidateBoxElement.appendChild(ye),U.prepend(this.candidateBoxElement)}}],W&&N(L.prototype,W),Object.defineProperty(L,"prototype",{writable:!1}),H}(),z=j;function I(H){return function(L){if(Array.isArray(L))return G(L)}(H)||function(L){if(typeof Symbol<"u"&&L[Symbol.iterator]!=null||L["@@iterator"]!=null)return Array.from(L)}(H)||function(L,W){if(L){if(typeof L=="string")return G(L,W);var k=Object.prototype.toString.call(L).slice(8,-1);return k==="Object"&&L.constructor&&(k=L.constructor.name),k==="Map"||k==="Set"?Array.from(L):k==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(k)?G(L,W):void 0}}(H)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function G(H,L){(L==null||L>H.length)&&(L=H.length);for(var W=0,k=new Array(L);W<L;W++)k[W]=H[W];return k}function K(H){return K=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(L){return typeof L}:function(L){return L&&typeof Symbol=="function"&&L.constructor===Symbol&&L!==Symbol.prototype?"symbol":typeof L},K(H)}function ee(H,L){var W=Object.keys(H);if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(H);L&&(k=k.filter(function($){return Object.getOwnPropertyDescriptor(H,$).enumerable})),W.push.apply(W,k)}return W}function F(H,L){for(var W=0;W<L.length;W++){var k=L[W];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(H,V(k.key),k)}}function _(H,L,W){return(L=V(L))in H?Object.defineProperty(H,L,{value:W,enumerable:!0,configurable:!0,writable:!0}):H[L]=W,H}function V(H){var L=function(W,k){if(K(W)!=="object"||W===null)return W;var $=W[Symbol.toPrimitive];if($!==void 0){var D=$.call(W,k||"default");if(K(D)!=="object")return D;throw new TypeError("@@toPrimitive must return a primitive value.")}return(k==="string"?String:Number)(W)}(H,"string");return K(L)==="symbol"?L:String(L)}var Z=function(){function H(k,$){var D=this;if(function(we,Ne){if(!(we instanceof Ne))throw new TypeError("Cannot call a class as a function")}(this,H),_(this,"input",void 0),_(this,"options",void 0),_(this,"utilities",void 0),_(this,"caretPosition",void 0),_(this,"caretPositionEnd",void 0),_(this,"keyboardDOM",void 0),_(this,"keyboardPluginClasses",void 0),_(this,"keyboardDOMClass",void 0),_(this,"buttonElements",void 0),_(this,"currentInstanceName",void 0),_(this,"allKeyboardInstances",void 0),_(this,"keyboardInstanceNames",void 0),_(this,"isFirstKeyboardInstance",void 0),_(this,"physicalKeyboard",void 0),_(this,"modules",void 0),_(this,"activeButtonClass",void 0),_(this,"holdInteractionTimeout",void 0),_(this,"holdTimeout",void 0),_(this,"isMouseHold",void 0),_(this,"initialized",void 0),_(this,"candidateBox",void 0),_(this,"keyboardRowsDOM",void 0),_(this,"defaultName","default"),_(this,"activeInputElement",null),_(this,"handleParams",function(we,Ne){var Re,ye,kt;if(typeof we=="string")Re=we.split(".").join(""),ye=document.querySelector(".".concat(Re)),kt=Ne;else if(we instanceof HTMLDivElement){if(!we.className)throw console.warn("Any DOM element passed as parameter must have a class."),new Error("KEYBOARD_DOM_CLASS_ERROR");Re=we.className.split(" ")[0],ye=we,kt=Ne}else Re="simple-keyboard",ye=document.querySelector(".".concat(Re)),kt=we;return{keyboardDOMClass:Re,keyboardDOM:ye,options:kt}}),_(this,"getOptions",function(){return D.options}),_(this,"getCaretPosition",function(){return D.caretPosition}),_(this,"getCaretPositionEnd",function(){return D.caretPositionEnd}),_(this,"registerModule",function(we,Ne){D.modules[we]||(D.modules[we]={}),Ne(D.modules[we])}),_(this,"getKeyboardClassString",function(){for(var we=arguments.length,Ne=new Array(we),Re=0;Re<we;Re++)Ne[Re]=arguments[Re];return[D.keyboardDOMClass].concat(Ne).filter(function(ye){return!!ye}).join(" ")}),typeof window<"u"){var M=this.handleParams(k,$),U=M.keyboardDOMClass,X=M.keyboardDOM,Y=M.options,q=Y===void 0?{}:Y;this.utilities=new v({getOptions:this.getOptions,getCaretPosition:this.getCaretPosition,getCaretPositionEnd:this.getCaretPositionEnd,dispatch:this.dispatch}),this.caretPosition=null,this.caretPositionEnd=null,this.keyboardDOM=X,this.options=function(we){for(var Ne=1;Ne<arguments.length;Ne++){var Re=arguments[Ne]!=null?arguments[Ne]:{};Ne%2?ee(Object(Re),!0).forEach(function(ye){_(we,ye,Re[ye])}):Object.getOwnPropertyDescriptors?Object.defineProperties(we,Object.getOwnPropertyDescriptors(Re)):ee(Object(Re)).forEach(function(ye){Object.defineProperty(we,ye,Object.getOwnPropertyDescriptor(Re,ye))})}return we}({layoutName:"default",theme:"hg-theme-default",inputName:"default",preventMouseDownDefault:!1,enableLayoutCandidates:!0,excludeFromLayout:{}},q),this.keyboardPluginClasses="",v.bindMethods(H,this);var oe=this.options.inputName,Be=oe===void 0?this.defaultName:oe;if(this.input={},this.input[Be]="",this.keyboardDOMClass=U,this.buttonElements={},window.SimpleKeyboardInstances||(window.SimpleKeyboardInstances={}),this.currentInstanceName=this.utilities.camelCase(this.keyboardDOMClass),window.SimpleKeyboardInstances[this.currentInstanceName]=this,this.allKeyboardInstances=window.SimpleKeyboardInstances,this.keyboardInstanceNames=Object.keys(window.SimpleKeyboardInstances),this.isFirstKeyboardInstance=this.keyboardInstanceNames[0]===this.currentInstanceName,this.physicalKeyboard=new T({dispatch:this.dispatch,getOptions:this.getOptions}),this.candidateBox=this.options.enableLayoutCandidates?new z({utilities:this.utilities,options:this.options}):null,!this.keyboardDOM)throw console.warn('".'.concat(U,'" was not found in the DOM.')),new Error("KEYBOARD_DOM_ERROR");this.render(),this.modules={},this.loadModules()}}var L,W;return L=H,W=[{key:"setCaretPosition",value:function(k){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:k;this.caretPosition=k,this.caretPositionEnd=$}},{key:"getInputCandidates",value:function(k){var $=this,D=this.options,M=D.layoutCandidates,U=D.layoutCandidatesCaseSensitiveMatch;if(!M||K(M)!=="object")return{};var X=Object.keys(M).filter(function(oe){var Be=k.substring(0,$.getCaretPositionEnd()||0)||k,we=new RegExp("".concat($.utilities.escapeRegex(oe),"$"),U?"g":"gi");return!!I(Be.matchAll(we)).length});if(X.length>1){var Y=X.sort(function(oe,Be){return Be.length-oe.length})[0];return{candidateKey:Y,candidateValue:M[Y]}}if(X.length){var q=X[0];return{candidateKey:q,candidateValue:M[q]}}return{}}},{key:"showCandidatesBox",value:function(k,$,D){var M=this;this.candidateBox&&this.candidateBox.show({candidateValue:$,targetElement:D,onSelect:function(U,X){var Y=M.options,q=Y.layoutCandidatesCaseSensitiveMatch,oe=Y.disableCandidateNormalization,Be=Y.enableLayoutCandidatesKeyPress,we=U;oe||(we=U.normalize("NFD"));var Ne=M.getInput(M.options.inputName,!0),Re=M.getCaretPositionEnd()||0,ye=Ne.substring(0,Re||0)||Ne,kt=new RegExp("".concat(M.utilities.escapeRegex(k),"$"),q?"g":"gi"),zn=ye.replace(kt,we),Jo=Ne.replace(ye,zn),bi=zn.length-ye.length,zs=(Re||Ne.length)+bi;zs<0&&(zs=0),M.setInput(Jo,M.options.inputName,!0),M.setCaretPosition(zs),Be&&typeof M.options.onKeyPress=="function"&&M.options.onKeyPress(U,X),typeof M.options.onChange=="function"&&M.options.onChange(M.getInput(M.options.inputName,!0),X),typeof M.options.onChangeAll=="function"&&M.options.onChangeAll(M.getAllInputs(),X)}})}},{key:"handleButtonClicked",value:function(k,$){var D=this.options,M=D.inputName,U=M===void 0?this.defaultName:M,X=D.debug;if(k!=="{//}"){this.input[U]||(this.input[U]="");var Y=this.utilities.getUpdatedInput(k,this.input[U],this.caretPosition,this.caretPositionEnd);if(this.utilities.isStandardButton(k)&&this.activeInputElement&&this.input[U]&&this.input[U]===Y&&this.caretPosition===0&&this.caretPositionEnd===Y.length)return this.setInput("",this.options.inputName,!0),this.setCaretPosition(0),this.activeInputElement.value="",this.activeInputElement.setSelectionRange(0,0),void this.handleButtonClicked(k,$);if(typeof this.options.onKeyPress=="function"&&this.options.onKeyPress(k,$),this.input[U]!==Y&&(!this.options.inputPattern||this.options.inputPattern&&this.inputPatternIsValid(Y))){if(this.options.maxLength&&this.utilities.handleMaxLength(this.input,Y))return;var q=this.utilities.getUpdatedInput(k,this.input[U],this.caretPosition,this.caretPositionEnd,!0);if(this.setInput(q,this.options.inputName,!0),X&&console.log("Input changed:",this.getAllInputs()),this.options.debug&&console.log("Caret at: ",this.getCaretPosition(),this.getCaretPositionEnd(),"(".concat(this.keyboardDOMClass,")"),$==null?void 0:$.type),this.options.syncInstanceInputs&&this.syncInstanceInputs(),typeof this.options.onChange=="function"&&this.options.onChange(this.getInput(this.options.inputName,!0),$),typeof this.options.onChangeAll=="function"&&this.options.onChangeAll(this.getAllInputs(),$),$!=null&&$.target&&this.options.enableLayoutCandidates){var oe,Be=this.getInputCandidates(Y),we=Be.candidateKey,Ne=Be.candidateValue;we&&Ne?this.showCandidatesBox(we,Ne,this.keyboardDOM):(oe=this.candidateBox)===null||oe===void 0||oe.destroy()}}this.caretPositionEnd&&this.caretPosition!==this.caretPositionEnd&&(this.setCaretPosition(this.caretPositionEnd,this.caretPositionEnd),this.activeInputElement&&this.activeInputElement.setSelectionRange(this.caretPositionEnd,this.caretPositionEnd),this.options.debug&&console.log("Caret position aligned",this.caretPosition)),X&&console.log("Key pressed:",k)}}},{key:"getMouseHold",value:function(){return this.isMouseHold}},{key:"setMouseHold",value:function(k){this.options.syncInstanceInputs?this.dispatch(function($){$.isMouseHold=k}):this.isMouseHold=k}},{key:"handleButtonMouseDown",value:function(k,$){var D=this;$&&(this.options.preventMouseDownDefault&&$.preventDefault(),this.options.stopMouseDownPropagation&&$.stopPropagation(),$.target.classList.add(this.activeButtonClass)),this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),this.holdTimeout&&clearTimeout(this.holdTimeout),this.setMouseHold(!0),this.options.disableButtonHold||(this.holdTimeout=window.setTimeout(function(){(D.getMouseHold()&&(!k.includes("{")&&!k.includes("}")||k==="{delete}"||k==="{backspace}"||k==="{bksp}"||k==="{space}"||k==="{tab}")||k==="{arrowright}"||k==="{arrowleft}"||k==="{arrowup}"||k==="{arrowdown}")&&(D.options.debug&&console.log("Button held:",k),D.handleButtonHold(k)),clearTimeout(D.holdTimeout)},500))}},{key:"handleButtonMouseUp",value:function(k,$){var D=this;$&&(this.options.preventMouseUpDefault&&$.preventDefault&&$.preventDefault(),this.options.stopMouseUpPropagation&&$.stopPropagation&&$.stopPropagation(),!($.target===this.keyboardDOM||$.target&&this.keyboardDOM.contains($.target)||this.candidateBox&&this.candidateBox.candidateBoxElement&&($.target===this.candidateBox.candidateBoxElement||$.target&&this.candidateBox.candidateBoxElement.contains($.target)))&&this.candidateBox&&this.candidateBox.destroy()),this.recurseButtons(function(M){M.classList.remove(D.activeButtonClass)}),this.setMouseHold(!1),this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),k&&typeof this.options.onKeyReleased=="function"&&this.options.onKeyReleased(k,$)}},{key:"handleKeyboardContainerMouseDown",value:function(k){this.options.preventMouseDownDefault&&k.preventDefault()}},{key:"handleButtonHold",value:function(k){var $=this;this.holdInteractionTimeout&&clearTimeout(this.holdInteractionTimeout),this.holdInteractionTimeout=window.setTimeout(function(){$.getMouseHold()?($.handleButtonClicked(k),$.handleButtonHold(k)):clearTimeout($.holdInteractionTimeout)},100)}},{key:"syncInstanceInputs",value:function(){var k=this;this.dispatch(function($){$.replaceInput(k.input),$.setCaretPosition(k.caretPosition,k.caretPositionEnd)})}},{key:"clearInput",value:function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.inputName||this.defaultName;this.input[k]="",this.setCaretPosition(0),this.options.syncInstanceInputs&&this.syncInstanceInputs()}},{key:"getInput",value:function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.options.inputName||this.defaultName,$=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return this.options.syncInstanceInputs&&!$&&this.syncInstanceInputs(),this.options.rtl?""+this.input[k].replace("","").replace("","")+"":this.input[k]}},{key:"getAllInputs",value:function(){var k=this,$={};return Object.keys(this.input).forEach(function(D){$[D]=k.getInput(D,!0)}),$}},{key:"setInput",value:function(k){var $=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.options.inputName||this.defaultName,D=arguments.length>2?arguments[2]:void 0;this.input[$]=k,!D&&this.options.syncInstanceInputs&&this.syncInstanceInputs()}},{key:"replaceInput",value:function(k){this.input=k}},{key:"setOptions",value:function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},$=this.changedOptions(k);this.options=Object.assign(this.options,k),$.length&&(this.options.debug&&console.log("changedOptions",$),this.onSetOptions($),this.render())}},{key:"changedOptions",value:function(k){var $=this;return Object.keys(k).filter(function(D){return JSON.stringify(k[D])!==JSON.stringify($.options[D])})}},{key:"onSetOptions",value:function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];k.includes("layoutName")&&this.candidateBox&&this.candidateBox.destroy(),(k.includes("layoutCandidatesPageSize")||k.includes("layoutCandidates"))&&this.candidateBox&&(this.candidateBox.destroy(),this.candidateBox=new z({utilities:this.utilities,options:this.options}))}},{key:"resetRows",value:function(){this.keyboardRowsDOM&&this.keyboardRowsDOM.remove(),this.keyboardDOM.className=this.keyboardDOMClass,this.keyboardDOM.setAttribute("data-skInstance",this.currentInstanceName),this.buttonElements={}}},{key:"dispatch",value:function(k){if(!window.SimpleKeyboardInstances)throw console.warn("SimpleKeyboardInstances is not defined. Dispatch cannot be called."),new Error("INSTANCES_VAR_ERROR");return Object.keys(window.SimpleKeyboardInstances).forEach(function($){k(window.SimpleKeyboardInstances[$],$)})}},{key:"addButtonTheme",value:function(k,$){var D=this;$&&k&&(k.split(" ").forEach(function(M){$.split(" ").forEach(function(U){D.options.buttonTheme||(D.options.buttonTheme=[]);var X=!1;D.options.buttonTheme.map(function(Y){if(Y!=null&&Y.class.split(" ").includes(U)){X=!0;var q=Y.buttons.split(" ");q.includes(M)||(X=!0,q.push(M),Y.buttons=q.join(" "))}return Y}),X||D.options.buttonTheme.push({class:U,buttons:k})})}),this.render())}},{key:"removeButtonTheme",value:function(k,$){var D=this;if(!k&&!$)return this.options.buttonTheme=[],void this.render();k&&Array.isArray(this.options.buttonTheme)&&this.options.buttonTheme.length&&(k.split(" ").forEach(function(M){var U;(U=D.options)===null||U===void 0||(U=U.buttonTheme)===null||U===void 0||U.map(function(X,Y){if(X&&$&&$.includes(X.class)||!$){var q,oe,Be=(q=X)===null||q===void 0?void 0:q.buttons.split(" ").filter(function(we){return we!==M});X&&Be!=null&&Be.length?X.buttons=Be.join(" "):((oe=D.options.buttonTheme)===null||oe===void 0||oe.splice(Y,1),X=null)}return X})}),this.render())}},{key:"getButtonElement",value:function(k){var $,D=this.buttonElements[k];return D&&($=D.length>1?D:D[0]),$}},{key:"inputPatternIsValid",value:function(k){var $,D=this.options.inputPattern;if(($=D instanceof RegExp?D:D[this.options.inputName||this.defaultName])&&k){var M=$.test(k);return this.options.debug&&console.log('inputPattern ("'.concat($,'"): ').concat(M?"passed":"did not pass!")),M}return!0}},{key:"setEventListeners",value:function(){if(this.isFirstKeyboardInstance||!this.allKeyboardInstances){this.options.debug&&console.log("Caret handling started (".concat(this.keyboardDOMClass,")"));var k=this.options.physicalKeyboardHighlightPreventDefault,$=k!==void 0&&k;document.addEventListener("keyup",this.handleKeyUp,$),document.addEventListener("keydown",this.handleKeyDown,$),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchend",this.handleTouchEnd),document.addEventListener("selectionchange",this.handleSelectionChange),document.addEventListener("select",this.handleSelect)}}},{key:"handleKeyUp",value:function(k){this.caretEventHandler(k),this.options.physicalKeyboardHighlight&&this.physicalKeyboard.handleHighlightKeyUp(k)}},{key:"handleKeyDown",value:function(k){this.options.physicalKeyboardHighlight&&this.physicalKeyboard.handleHighlightKeyDown(k)}},{key:"handleMouseUp",value:function(k){this.caretEventHandler(k)}},{key:"handleTouchEnd",value:function(k){this.caretEventHandler(k)}},{key:"handleSelect",value:function(k){this.caretEventHandler(k)}},{key:"handleSelectionChange",value:function(k){navigator.userAgent.includes("Firefox")||this.caretEventHandler(k)}},{key:"caretEventHandler",value:function(k){var $,D=this;k.target.tagName&&($=k.target.tagName.toLowerCase()),this.dispatch(function(M){var U=k.target===M.keyboardDOM||k.target&&M.keyboardDOM.contains(k.target);if(D.options.syncInstanceInputs&&Array.isArray(k.path)&&(U=k.path.some(function(q){var oe;return q==null||(oe=q.hasAttribute)===null||oe===void 0?void 0:oe.call(q,"data-skInstance")})),($==="textarea"||$==="input"&&["text","search","url","tel","password"].includes(k.target.type))&&!M.options.disableCaretPositioning){var X=k.target.selectionStart,Y=k.target.selectionEnd;M.options.rtl&&(X=M.utilities.getRtlOffset(X,M.getInput()),Y=M.utilities.getRtlOffset(Y,M.getInput())),M.setCaretPosition(X,Y),D.activeInputElement=k.target,M.options.debug&&console.log("Caret at: ",M.getCaretPosition(),M.getCaretPositionEnd(),k&&k.target.tagName.toLowerCase(),"(".concat(M.keyboardDOMClass,")"),k==null?void 0:k.type)}else!M.options.disableCaretPositioning&&U||(k==null?void 0:k.type)==="selectionchange"||(M.setCaretPosition(null),D.activeInputElement=null,M.options.debug&&console.log('Caret position reset due to "'.concat(k==null?void 0:k.type,'" event'),k))})}},{key:"recurseButtons",value:function(k){var $=this;k&&Object.keys(this.buttonElements).forEach(function(D){return $.buttonElements[D].forEach(k)})}},{key:"destroy",value:function(){this.options.debug&&console.log("Destroying simple-keyboard instance: ".concat(this.currentInstanceName));var k=this.options.physicalKeyboardHighlightPreventDefault,$=k!==void 0&&k;document.removeEventListener("keyup",this.handleKeyUp,$),document.removeEventListener("keydown",this.handleKeyDown,$),document.removeEventListener("mouseup",this.handleMouseUp),document.removeEventListener("touchend",this.handleTouchEnd),document.removeEventListener("select",this.handleSelect),document.removeEventListener("selectionchange",this.handleSelectionChange),document.onpointerup=null,document.ontouchend=null,document.ontouchcancel=null,document.onmouseup=null,this.recurseButtons(function(D){D&&(D.onpointerdown=null,D.onpointerup=null,D.onpointercancel=null,D.ontouchstart=null,D.ontouchend=null,D.ontouchcancel=null,D.onclick=null,D.onmousedown=null,D.onmouseup=null,D.remove(),D=null)}),this.keyboardDOM.onpointerdown=null,this.keyboardDOM.ontouchstart=null,this.keyboardDOM.onmousedown=null,this.resetRows(),this.candidateBox&&(this.candidateBox.destroy(),this.candidateBox=null),this.activeInputElement=null,this.keyboardDOM.removeAttribute("data-skInstance"),this.keyboardDOM.innerHTML="",window.SimpleKeyboardInstances[this.currentInstanceName]=null,delete window.SimpleKeyboardInstances[this.currentInstanceName],this.initialized=!1}},{key:"getButtonThemeClasses",value:function(k){var $=this.options.buttonTheme,D=[];return Array.isArray($)&&$.forEach(function(M){if(M&&M.class&&typeof M.class=="string"&&M.buttons&&typeof M.buttons=="string"){var U=M.class.split(" ");M.buttons.split(" ").includes(k)&&(D=[].concat(I(D),I(U)))}else console.warn('Incorrect "buttonTheme". Please check the documentation.',M)}),D}},{key:"setDOMButtonAttributes",value:function(k,$){var D=this.options.buttonAttributes;Array.isArray(D)&&D.forEach(function(M){M.attribute&&typeof M.attribute=="string"&&M.value&&typeof M.value=="string"&&M.buttons&&typeof M.buttons=="string"?M.buttons.split(" ").includes(k)&&$(M.attribute,M.value):console.warn('Incorrect "buttonAttributes". Please check the documentation.',M)})}},{key:"onTouchDeviceDetected",value:function(){this.processAutoTouchEvents(),this.disableContextualWindow()}},{key:"disableContextualWindow",value:function(){window.oncontextmenu=function(k){if(k.target.classList.contains("hg-button"))return k.preventDefault(),k.stopPropagation(),!1}}},{key:"processAutoTouchEvents",value:function(){this.options.autoUseTouchEvents&&(this.options.useTouchEvents=!0,this.options.debug&&console.log("autoUseTouchEvents: Touch device detected, useTouchEvents enabled."))}},{key:"onInit",value:function(){this.options.debug&&console.log("".concat(this.keyboardDOMClass," Initialized")),this.setEventListeners(),typeof this.options.onInit=="function"&&this.options.onInit(this)}},{key:"beforeFirstRender",value:function(){this.utilities.isTouchDevice()&&this.onTouchDeviceDetected(),typeof this.options.beforeFirstRender=="function"&&this.options.beforeFirstRender(this),this.isFirstKeyboardInstance&&this.utilities.pointerEventsSupported()&&!this.options.useTouchEvents&&!this.options.useMouseEvents&&this.options.debug&&console.log("Using PointerEvents as it is supported by this browser"),this.options.useTouchEvents&&this.options.debug&&console.log("useTouchEvents has been enabled. Only touch events will be used.")}},{key:"beforeRender",value:function(){typeof this.options.beforeRender=="function"&&this.options.beforeRender(this)}},{key:"onRender",value:function(){typeof this.options.onRender=="function"&&this.options.onRender(this)}},{key:"onModulesLoaded",value:function(){typeof this.options.onModulesLoaded=="function"&&this.options.onModulesLoaded(this)}},{key:"loadModules",value:function(){var k=this;Array.isArray(this.options.modules)&&(this.options.modules.forEach(function($){var D=new $(k);D.init&&D.init(k)}),this.keyboardPluginClasses="modules-loaded",this.render(),this.onModulesLoaded())}},{key:"getModuleProp",value:function(k,$){return!!this.modules[k]&&this.modules[k][$]}},{key:"getModulesList",value:function(){return Object.keys(this.modules)}},{key:"parseRowDOMContainers",value:function(k,$,D,M){var U=this,X=Array.from(k.children),Y=0;return X.length&&D.forEach(function(q,oe){var Be=M[oe];if(!(Be&&Be>q))return!1;var we=q-Y,Ne=Be-Y,Re=document.createElement("div");Re.className+="hg-button-container";var ye="".concat(U.options.layoutName,"-r").concat($,"c").concat(oe);Re.setAttribute("data-skUID",ye);var kt=X.splice(we,Ne-we+1);Y=Ne-we,kt.forEach(function(zn){return Re.appendChild(zn)}),X.splice(we,0,Re),k.innerHTML="",X.forEach(function(zn){return k.appendChild(zn)}),U.options.debug&&console.log("rowDOMContainer",kt,we,Ne,Y+1)}),k}},{key:"render",value:function(){var k=this;this.resetRows(),this.initialized||this.beforeFirstRender(),this.beforeRender();var $="hg-layout-".concat(this.options.layoutName),D=this.options.layout||{default:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}",".com @ {space}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}",".com @ {space}"]},M=this.options.useTouchEvents||!1,U=M?"hg-touch-events":"",X=this.options.useMouseEvents||!1,Y=this.options.disableRowButtonContainers;this.keyboardDOM.className=this.getKeyboardClassString(this.options.theme,$,this.keyboardPluginClasses,U),this.keyboardDOM.setAttribute("data-skInstance",this.currentInstanceName),this.keyboardRowsDOM=document.createElement("div"),this.keyboardRowsDOM.className="hg-rows",D[this.options.layoutName||this.defaultName].forEach(function(q,oe){var Be=q.split(" ");k.options.excludeFromLayout&&k.options.excludeFromLayout[k.options.layoutName||k.defaultName]&&(Be=Be.filter(function(ye){return k.options.excludeFromLayout&&!k.options.excludeFromLayout[k.options.layoutName||k.defaultName].includes(ye)}));var we=document.createElement("div");we.className+="hg-row";var Ne=[],Re=[];Be.forEach(function(ye,kt){var zn,Jo=!Y&&typeof ye=="string"&&ye.length>1&&ye.indexOf("[")===0,bi=!Y&&typeof ye=="string"&&ye.length>1&&ye.indexOf("]")===ye.length-1;Jo&&(Ne.push(kt),ye=ye.replace(/\[/g,"")),bi&&(Re.push(kt),ye=ye.replace(/\]/g,""));var zs=k.utilities.getButtonClass(ye),Fs=k.utilities.getButtonDisplayName(ye,k.options.display,k.options.mergeDisplay),xD=k.options.useButtonTag?"button":"div",Qt=document.createElement(xD);Qt.className+="hg-button ".concat(zs),(zn=Qt.classList).add.apply(zn,I(k.getButtonThemeClasses(ye))),k.setDOMButtonAttributes(ye,function(_t,kD){Qt.setAttribute(_t,kD)}),k.activeButtonClass="hg-activeButton",!k.utilities.pointerEventsSupported()||M||X?M?(Qt.ontouchstart=function(_t){k.handleButtonClicked(ye,_t),k.handleButtonMouseDown(ye,_t)},Qt.ontouchend=function(_t){k.handleButtonMouseUp(ye,_t)},Qt.ontouchcancel=function(_t){k.handleButtonMouseUp(ye,_t)}):(Qt.onclick=function(_t){k.setMouseHold(!1),typeof k.options.onKeyReleased!="function"&&k.handleButtonClicked(ye,_t)},Qt.onmousedown=function(_t){typeof k.options.onKeyReleased!="function"||k.isMouseHold||k.handleButtonClicked(ye,_t),k.handleButtonMouseDown(ye,_t)},Qt.onmouseup=function(_t){k.handleButtonMouseUp(ye,_t)}):(Qt.onpointerdown=function(_t){k.handleButtonClicked(ye,_t),k.handleButtonMouseDown(ye,_t)},Qt.onpointerup=function(_t){k.handleButtonMouseUp(ye,_t)},Qt.onpointercancel=function(_t){k.handleButtonMouseUp(ye,_t)}),Qt.setAttribute("data-skBtn",ye);var SD="".concat(k.options.layoutName,"-r").concat(oe,"b").concat(kt);Qt.setAttribute("data-skBtnUID",SD);var uS=document.createElement("span");uS.innerHTML=Fs,Qt.appendChild(uS),k.buttonElements[ye]||(k.buttonElements[ye]=[]),k.buttonElements[ye].push(Qt),we.appendChild(Qt)}),we=k.parseRowDOMContainers(we,oe,Ne,Re),k.keyboardRowsDOM.appendChild(we)}),this.keyboardDOM.appendChild(this.keyboardRowsDOM),this.onRender(),this.initialized||(this.initialized=!0,!this.utilities.pointerEventsSupported()||M||X?M?(document.ontouchend=function(q){return k.handleButtonMouseUp(void 0,q)},document.ontouchcancel=function(q){return k.handleButtonMouseUp(void 0,q)},this.keyboardDOM.ontouchstart=function(q){return k.handleKeyboardContainerMouseDown(q)}):M||(document.onmouseup=function(q){return k.handleButtonMouseUp(void 0,q)},this.keyboardDOM.onmousedown=function(q){return k.handleKeyboardContainerMouseDown(q)}):(document.onpointerup=function(q){return k.handleButtonMouseUp(void 0,q)},this.keyboardDOM.onpointerdown=function(q){return k.handleKeyboardContainerMouseDown(q)}),this.onInit())}}],W&&F(L.prototype,W),Object.defineProperty(L,"prototype",{writable:!1}),H}(),ne=Z,me=ne;return u}()},787:function(a){a.exports=n}},i={};function s(a){var l=i[a];if(l!==void 0)return l.exports;var u=i[a]={exports:{}};return r[a].call(u.exports,u,u.exports,s),u.exports}s.n=function(a){var l=a&&a.__esModule?function(){return a.default}:function(){return a};return s.d(l,{a:l}),l},s.d=function(a,l){for(var u in l)s.o(l,u)&&!s.o(a,u)&&Object.defineProperty(a,u,{enumerable:!0,get:l[u]})},s.o=function(a,l){return Object.prototype.hasOwnProperty.call(a,l)},s.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var o={};return function(){s.r(o),s.d(o,{KeyboardReact:function(){return g},default:function(){return b}});var a=s(787);function l(y){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(v){return typeof v}:function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},l(y)}function u(y,v){var w=Object.keys(y);if(Object.getOwnPropertySymbols){var S=Object.getOwnPropertySymbols(y);v&&(S=S.filter(function(C){return Object.getOwnPropertyDescriptor(y,C).enumerable})),w.push.apply(w,S)}return w}function c(y){for(var v=1;v<arguments.length;v++){var w=arguments[v]!=null?arguments[v]:{};v%2?u(Object(w),!0).forEach(function(S){d(y,S,w[S])}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(w)):u(Object(w)).forEach(function(S){Object.defineProperty(y,S,Object.getOwnPropertyDescriptor(w,S))})}return y}function d(y,v,w){return(v=function(S){var C=function(E,T){if(l(E)!=="object"||E===null)return E;var A=E[Symbol.toPrimitive];if(A!==void 0){var N=A.call(E,T||"default");if(l(N)!=="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return(T==="string"?String:Number)(E)}(S,"string");return l(C)==="symbol"?C:String(C)}(v))in y?Object.defineProperty(y,v,{value:w,enumerable:!0,configurable:!0,writable:!0}):y[v]=w,y}var h=function(y){return c(c({},y),{},{keyboardRef:null})},f=s(689),p=s.n(f),g=function(y){var v=y.baseClass||"react-simple-keyboard",w=a.useRef(null),S=a.useRef(null),C=a.useRef(null),E=a.useRef(y);return a.useEffect(function(){var T=function(j){return c(c({},j),{},{theme:"simple-keyboard ".concat(j.theme||"hg-theme-default")})}(y);if(!w.current){w.current=!0,T.debug&&console.log("ReactSimpleKeyboard: Init");var A=S.current,N=".".concat(v);C.current=new(p())(A||N,T),T.keyboardRef&&T.keyboardRef(C.current)}var R=function(j,z){var I=h(z),G=h(j);return Object.keys(I).filter(function(K){return I[K]!==G[K]})}(E.current,T);if(R.length){var O=C.current;E.current=T,O==null||O.setOptions(T),T.debug&&console.log("ReactSimpleKeyboard - setOptions called due to updated props:",R)}},[w,v,E,y]),a.createElement("div",{className:v,ref:S})},b=g}(),o}()})})(YR);var gK=YR.exports;const yK=Cu(gK),vK={en:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","{lock} a s d f g h j k l ; ' {enter}","{shiftleft} z x c v b n m , . / {shiftright}","{space}"],"en-shift":["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'{lock} A S D F G H J K L : " {enter}',"{shiftleft} Z X C V B N M < > ? {shiftright}","{space}"],es:["| 1 2 3 4 5 6 7 8 9 0 '  {bksp}","{tab} q w e r t y u i o p  +","{lock} a s d f g h j k l  { } {enter}","{shiftleft} < z x c v b n m , . - {shiftright}","{space}"],"es-shift":[' ! " # $ % & / ( ) = ?  {bksp}',"{tab} Q W E R T Y U I O P  *","{lock} A S D F G H J K L  [ ] {enter}","{shiftleft} > Z X C V B N M ; : _ {shiftright}","{space}"],"es-accent":["| 1 2 3 4 5 6 7 8 9 0 '  {bksp}","{tab} q w  r t y    p  +","{lock}  s d f g h j k l  { } {enter}","{shiftleft} < z x c v b n m , . - {shiftright}","{space}"],"es-accent-shift":[' ! " # $ % & / ( ) = ?  {bksp}',"{tab} Q W  R T Y    P  *","{lock}  S D F G H J K L  [ ] {enter}","{shiftleft} > Z X C V B N M ; : _ {shiftright}","{space}"],"es-diaeresis-default":["| 1 2 3 4 5 6 7 8 9 0 '  {bksp}","{tab} q w e r t y  i o p  +","{lock} a s d f g h j k l  { } {enter}","{shiftleft} < z x c v b n m , . - {shiftright}","{space}"],"es-diaeresis-shift":[' ! " # $ % & / ( ) = ?  {bksp}',"{tab} Q W E R T Y  I O P  *","{lock} A S D F G H J K L  [ ] {enter}","{shiftleft} > Z X C V B N M ; : _ {shiftright}","{space}"]},wK={en:{"{bksp}":"Backspace ","{enter}":"Enter ","{shiftleft}":"Shift ","{shiftright}":"Shift ","{tab}":"Tab ","{lock}":"Caps Lock ","{space}":"Space"},es:{"{bksp}":"","{enter}":"Intro ","{shiftleft}":"Shift ","{shiftright}":"Shift ","{tab}":"Tab ","{lock}":"Bloq Mays ","{space}":"Espacio"}},YE="          ",qE="  ";function bK(){const t=a$(),e=lt(),{status:n,dispatch:r,devices:i}=qt(),[s,o]=m.useState("none"),[a,l]=m.useState(!1),[u,c]=m.useState(!1),d=m.useMemo(()=>[t,t==="es"&&(a&&"accent"||u&&"diaeresis"),s!=="none"&&"shift"].filter(Boolean).join("-"),[t,s,a,u]),h=m.useCallback(f=>{i.keyboard&&n.type==="running"&&n.waitingForInput&&r("keyboard.sendChar",f)},[n,r,i.keyboard]);return i.keyboard?x.jsxs("div",{className:"absolute left-[1200px] top-[300px] z-10 h-min w-[500px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[x.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-xl text-white",children:e("computer.keyboard")}),x.jsx(yK,{theme:Me("hg-theme-vonsim",`hg-shift-${s}`,a&&"hg-accentDeadKey",u&&"hg-diaeresisDeadKey"),layoutName:d,layout:vK,display:wK[t],buttonTheme:[{class:"hg-accentDeadKeyButton",buttons:YE},{class:"hg-diaeresisDeadKeyButton",buttons:qE}],disableButtonHold:!0,onKeyPress:f=>{if(f==="{shiftleft}"||f==="{shiftright}"){o(p=>p==="none"?"once":"none");return}if(f==="{lock}"){o(p=>p==="none"?"lock":"none");return}if(t==="es"){if(a){YE.includes(f)&&(l(!1),s==="once"&&o("none"),h(f));return}else if(f===""){l(!0);return}if(u){qE.includes(f)&&(c(!1),s==="once"&&o("none"),h(f));return}else if(f===""){c(!0);return}}s==="once"&&o("none"),h(f==="{bksp}"?"\b":f==="{enter}"?`
`:f==="{tab}"?"	":f==="{space}"?" ":f)}})]}):null}function xK(){const t=lt(),{devices:e}=qt(),n=dn(hx).toArray();return e.leds?x.jsxs("div",{className:"absolute left-[1300px] top-[828px] z-10 h-min w-min rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[x.jsx("span",{className:"block h-min w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.leds")}),x.jsx("div",{className:"flex flex-row-reverse gap-2 p-4",children:n.map((r,i)=>x.jsx("div",{className:Me("relative h-7 w-7 rounded-full transition",r?"bg-mantis-400":"bg-stone-700 shadow-inner shadow-stone-900"),children:x.jsx("div",{className:Me("absolute inset-0 rounded-full bg-mantis-400 blur-sm transition",r?"opacity-100":"opacity-0")})},i))})]}):null}const qR=m.forwardRef(({className:t,type:e,...n},r)=>x.jsx("input",{type:e,className:Me("flex h-10 w-full rounded-md border border-stone-600 bg-stone-900 px-3 py-2 text-sm ring-offset-stone-900 file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-stone-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-stone-600 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n}));qR.displayName="Input";const SK=m.forwardRef((t,e)=>m.createElement(Fe.label,re({},t,{ref:e,onMouseDown:n=>{var r;(r=t.onMouseDown)===null||r===void 0||r.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault()}}))),QR=SK,eM=m.forwardRef(({className:t,...e},n)=>x.jsx(QR,{ref:n,className:Me("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",t),...e}));eM.displayName=QR.displayName;function kK(){const t=lt(),e=dn(CV),n=Math.ceil(e.length/2),[r,i]=Tu(V_),s=m.useId(),[o,a]=m.useState(""),l=m.useCallback(()=>{const u=/^(\d+)[Hh]?$/.exec(o);if(!u||!u[1]){Kn({title:t("computer.memory.address-must-be-integer"),variant:"error"});return}let c=parseInt(u[1],16);if(c===be.MAX_ADDRESS+1)c-=1;else if(!be.inRange(c)){Kn({title:t("computer.memory.address-out-of-range"),variant:"error"});return}i(be.from(c))},[t,o,i]);return x.jsxs("div",{className:"absolute left-[800px] top-0 z-10 h-[460px] w-[250px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[x.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-3xl text-white",children:t("computer.memory.name")}),x.jsxs("div",{className:"mx-4 my-2",children:[x.jsx(eM,{htmlFor:s,children:t("computer.memory.fix-address")}),x.jsxs("div",{className:"relative",children:[x.jsx(qR,{className:"font-mono",placeholder:"2000h",type:"text",enterKeyHint:"go",id:s,value:o,onChange:u=>a(u.currentTarget.value),onKeyDown:u=>{u.key==="Enter"&&l()}}),x.jsx("button",{title:t("computer.memory.unfix-address"),className:Me("absolute right-2 top-3",!r&&"hidden"),onClick:()=>{a(""),i(null)},children:x.jsx("span",{className:"icon-[lucide--x] h-4 w-4 text-stone-500 transition-colors hover:text-stone-300"})})]})]}),x.jsxs("div",{className:"m-4 flex w-min items-start overflow-hidden rounded-lg border border-stone-600",children:[x.jsx("table",{className:"border-r border-stone-600 font-mono text-lg",children:x.jsx("tbody",{children:e.slice(0,n).map((u,c)=>m.createElement(QE,{...u,key:c}))})}),x.jsx("table",{className:"font-mono text-lg",children:x.jsx("tbody",{children:e.slice(n).map((u,c)=>m.createElement(QE,{...u,key:c}))})})]})]})}function QE({address:t,value:e}){const n=lt(),r=dn(Ld),i=n("computer.memory.cell",t);return x.jsxs(ZR,{children:[x.jsx(JR,{asChild:!0,children:x.jsxs(Dt.tr,{title:i,className:"cursor-pointer border-b border-stone-600 odd:bg-stone-900 even:bg-stone-800 last-of-type:border-b-0",style:t.value===r.value?nt("memory.operating-cell"):void 0,children:[x.jsx("td",{className:"border-r border-stone-600 px-2 py-1 font-thin",children:t.toString()}),x.jsx("td",{className:"border-r border-stone-600 px-2 py-1 last-of-type:border-r-0",children:e.toString("hex")})]})}),x.jsxs(Lx,{className:"w-60",children:[x.jsx("p",{className:"px-4 py-2 font-medium text-white",children:i}),x.jsx("hr",{className:"border-stone-600"}),x.jsx("ul",{className:"px-4 py-2 text-sm",children:["hex","bin","uint","int","safe-ascii"].map(s=>x.jsxs("li",{children:[x.jsx("b",{className:"font-medium",children:n(`generics.byte-representation.${s}`)}),":"," ",x.jsx("span",{className:"font-mono text-mantis-400",children:e.toString(s)})]},s))})]})]})}function CK(){const t=lt(),{devices:e}=qt();return e.pic?x.jsxs("div",{className:"absolute left-0 top-[700px] z-10 flex h-[200px] w-[450px] flex-col rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[x.jsxs("div",{className:"flex items-start",children:[x.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.pic")}),x.jsxs("div",{className:"flex h-16 grow items-center justify-evenly",children:[x.jsx(gr,{name:"IMR",title:t("generics.io-register","IMR",33),valueAtom:px,springs:"pic.IMR",emphasis:!0}),x.jsx(gr,{name:"IRR",title:t("generics.io-register","IRR",34),valueAtom:mx,springs:"pic.IRR",emphasis:!0}),x.jsx(gr,{name:"ISR",title:t("generics.io-register","ISR",35),valueAtom:gx,springs:"pic.ISR",emphasis:!0})]})]}),x.jsx("hr",{className:"mb-2 border-stone-600"}),x.jsx("div",{className:"grid h-full w-full grid-cols-4 items-center",children:um.map((n,r)=>x.jsx(gr,{name:`INT${r}`,title:t("generics.io-register",`INT${r}`,36+r),valueAtom:n,springs:`pic.INT${r}`,className:"mx-auto"},r))})]}):null}function EK(){const t=lt(),{devices:e}=qt();return e.pio?x.jsxs("div",{className:"absolute left-[900px] top-[700px] z-10 h-min w-[220px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[x.jsx("span",{className:"mb-2 block h-min w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.pio.name")}),x.jsx("hr",{className:"border-stone-600"}),x.jsxs("div",{className:"flex w-full items-center justify-evenly py-4",children:[x.jsx(gr,{name:"PA",title:t("generics.io-register","PA",48),valueAtom:yx,springs:"pio.PA"}),x.jsx(gr,{name:"CA",title:t("generics.io-register","CA",50),valueAtom:wx,springs:"pio.CA"})]}),x.jsx("hr",{className:"border-stone-600"}),x.jsxs("div",{className:"flex w-full items-center justify-evenly py-4",children:[x.jsx(gr,{name:"PB",title:t("generics.io-register","PB",49),valueAtom:vx,springs:"pio.PB"}),x.jsx(gr,{name:"CB",title:t("generics.io-register","CB",51),valueAtom:bx,springs:"pio.CB"})]})]}):null}const AK="_printer_fbkny_2",PK="_shadow_fbkny_6",TK="_sides_fbkny_11",$K="_front_fbkny_22",NK="_trailContainer_fbkny_27",OK="_trail_fbkny_27",_K="_paper_fbkny_33",ea={printer:AK,shadow:PK,sides:TK,front:$K,trailContainer:NK,trail:OK,paper:_K},RK=Array.from({length:5},(t,e)=>e);function MK(){const t=lt(),{devices:e}=qt(),n=dn(cm),r=dn(dm);return e.printer?x.jsx("div",{className:"absolute left-[1250px] top-[750px] z-10 flex h-min w-80 flex-col rounded-lg border border-stone-600 bg-stone-900 pl-16 [&_*]:z-20",children:x.jsxs("div",{className:ea.printer,title:t("computer.printer.name"),children:[x.jsx("div",{className:ea.shadow}),x.jsx("div",{className:ea.sides}),x.jsxs("div",{className:ea.front,children:[x.jsx("div",{className:ea.trailContainer,children:x.jsx("div",{className:ea.trail,children:x.jsx("pre",{className:ea.paper,children:r})})}),x.jsx("div",{className:"grid grid-cols-5 items-center justify-center",children:RK.map(i=>{const s=n[i]?l$(n[i].unsigned):null;return x.jsx("span",{className:Me("flex h-6 w-full items-center justify-center border-r border-zinc-300 text-center font-mono text-base font-medium leading-none text-white first-of-type:rounded-l-xl last-of-type:rounded-r-xl last-of-type:border-r-0",s===null?"bg-zinc-400":"bg-mantis-500"),children:s},i)})}),x.jsx("div",{className:"mx-auto mt-4 h-1 w-[70%] overflow-hidden rounded-full bg-zinc-600",children:x.jsx(Dt.div,{className:"h-full bg-mantis-400",style:{width:nt("printer.printing.progress").to(i=>`${i*100}%`),opacity:nt("printer.printing.opacity")}})})]})]})}):null}const DK="_screen_1okia_2",IK={screen:DK};function LK(){const t=lt(),{devices:e}=qt(),n=dn(xx);return e.screen?x.jsxs("div",{className:"absolute left-[1200px] top-0 z-10 h-min w-[500px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[x.jsx("span",{className:"block w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-xl text-white",children:t("computer.screen")}),x.jsx("pre",{className:IK.screen,children:n})]}):null}function BK(){const t=lt(),{status:e,dispatch:n,devices:r}=qt(),i=dn(Sx).toArray();return r.switches?x.jsxs("div",{className:"absolute left-[1300px] top-[698px] z-10 h-min w-min rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[x.jsx("span",{className:"block h-min w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.switches")}),x.jsx("div",{className:"flex flex-row-reverse gap-3 p-4",children:i.map((s,o)=>x.jsx("div",{className:"w-6",children:x.jsx(Nx,{checked:s,onCheckedChange:()=>n("switch.toggle",o),className:"-translate-x-3 -rotate-90 data-[state=unchecked]:!bg-stone-800",disabled:e.type!=="running"})},o))})]}):null}function jK(){const t=lt(),{devices:e}=qt();return e.timer?x.jsxs("div",{className:"absolute left-[500px] top-[875px] z-10 flex h-[120px] w-[220px] rounded-lg border border-stone-600 bg-stone-900 [&_*]:z-20",children:[x.jsx("span",{className:"block h-min w-min rounded-br-lg rounded-tl-lg border-b border-r border-stone-600 bg-mantis-500 px-2 py-1 text-2xl text-white",children:t("computer.timer")}),x.jsxs("div",{className:"flex h-full w-full flex-col items-center justify-evenly",children:[x.jsx(gr,{name:"CONT",title:t("generics.io-register","CONT",16),valueAtom:kx,springs:"timer.CONT"}),x.jsx(gr,{name:"COMP",title:t("generics.io-register","COMP",17),valueAtom:Cx,springs:"timer.COMP"})]})]}):null}function tM(){const t=m.useRef(null);return x.jsx("div",{className:"relative h-full w-full",children:x.jsxs(LG,{minScale:.3,initialScale:.75,ref:t,doubleClick:{disabled:!0},panning:{excluded:["input"]},children:[x.jsx(zG,{wrapperClass:"!w-full !h-full",contentClass:"!p-[200px]",children:x.jsxs("div",{className:"relative h-[1300px] w-[1900px]",children:[x.jsx(GG,{}),x.jsx(uK,{}),x.jsx(kK,{}),x.jsx(mK,{}),x.jsx(CK,{}),x.jsx(EK,{}),x.jsx(jK,{}),x.jsx(KG,{}),x.jsx(pK,{}),x.jsx(bK,{}),x.jsx(xK,{}),x.jsx(MK,{}),x.jsx(BK,{}),x.jsx(LK,{})]})}),x.jsx(FG,{wrapperRef:t})]})})}const zK=1024;let FK=0;class gy{constructor(e,n){this.from=e,this.to=n}}let Ke=class{constructor(e={}){this.id=FK++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Ln.match(e)),n=>{let r=e(n);return r===void 0?null:[this,r]}}};Ke.closedBy=new Ke({deserialize:t=>t.split(" ")});Ke.openedBy=new Ke({deserialize:t=>t.split(" ")});Ke.group=new Ke({deserialize:t=>t.split(" ")});Ke.contextHash=new Ke({perNode:!0});Ke.lookAhead=new Ke({perNode:!0});Ke.mounted=new Ke({perNode:!0});const UK=Object.create(null);let Ln=class nM{constructor(e,n,r,i=0){this.name=e,this.props=n,this.id=r,this.flags=i}static define(e){let n=e.props&&e.props.length?Object.create(null):UK,r=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new nM(e.name||"",n,e.id,r);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");n[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let n=this.prop(Ke.group);return n?n.indexOf(e)>-1:!1}return this.id==e}static match(e){let n=Object.create(null);for(let r in e)for(let i of r.split(" "))n[i]=e[r];return r=>{for(let i=r.prop(Ke.group),s=-1;s<(i?i.length:0);s++){let o=n[s<0?r.name:i[s]];if(o)return o}}}};Ln.none=new Ln("",Object.create(null),0,8);class Bx{constructor(e){this.types=e;for(let n=0;n<e.length;n++)if(e[n].id!=n)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let n=[];for(let r of this.types){let i=null;for(let s of e){let o=s(r);o&&(i||(i=Object.assign({},r.props)),i[o[0].id]=o[1])}n.push(i?new Ln(r.name,i,r.id,r.flags):r)}return new Bx(n)}}const lf=new WeakMap,e2=new WeakMap;var Jt;(function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"})(Jt||(Jt={}));let dt=class Fw{constructor(e,n,r,i,s){if(this.type=e,this.children=n,this.positions=r,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,a]of s)this.props[typeof o=="number"?o:o.id]=a}}toString(){let e=this.prop(Ke.mounted);if(e&&!e.overlay)return e.tree.toString();let n="";for(let r of this.children){let i=r.toString();i&&(n&&(n+=","),n+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(n.length?"("+n+")":""):n}cursor(e=0){return new gm(this.topNode,e)}cursorAt(e,n=0,r=0){let i=lf.get(this)||this.topNode,s=new gm(i);return s.moveTo(e,n),lf.set(this,s._tree),s}get topNode(){return new jd(this,0,0,null)}resolve(e,n=0){let r=gu(lf.get(this)||this.topNode,e,n,!1);return lf.set(this,r),r}resolveInner(e,n=0){let r=gu(e2.get(this)||this.topNode,e,n,!0);return e2.set(this,r),r}iterate(e){let{enter:n,leave:r,from:i=0,to:s=this.length}=e,o=e.mode||0,a=(o&Jt.IncludeAnonymous)>0;for(let l=this.cursor(o|Jt.IncludeAnonymous);;){let u=!1;if(l.from<=s&&l.to>=i&&(!a&&l.type.isAnonymous||n(l)!==!1)){if(l.firstChild())continue;u=!0}for(;u&&r&&(a||!l.type.isAnonymous)&&r(l),!l.nextSibling();){if(!l.parent())return;u=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let n in this.props)e.push([+n,this.props[n]]);return e}balance(e={}){return this.children.length<=8?this:zx(Ln.none,this.children,this.positions,0,this.children.length,0,this.length,(n,r,i)=>new Fw(this.type,n,r,i,this.propValues),e.makeTree||((n,r,i)=>new Fw(Ln.none,n,r,i)))}static build(e){return WK(e)}};dt.empty=new dt(Ln.none,[],[],0);let VK=class rM{constructor(e,n){this.buffer=e,this.index=n}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new rM(this.buffer,this.index)}},lh=class iM{constructor(e,n,r){this.buffer=e,this.length=n,this.set=r}get type(){return Ln.none}toString(){let e=[];for(let n=0;n<this.buffer.length;)e.push(this.childString(n)),n=this.buffer[n+3];return e.join(",")}childString(e){let n=this.buffer[e],r=this.buffer[e+3],i=this.set.types[n],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,r==e)return s;let o=[];for(;e<r;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,n,r,i,s){let{buffer:o}=this,a=-1;for(let l=e;l!=n&&!(sM(s,i,o[l+1],o[l+2])&&(a=l,r>0));l=o[l+3]);return a}slice(e,n,r){let i=this.buffer,s=new Uint16Array(n-e),o=0;for(let a=e,l=0;a<n;){s[l++]=i[a++],s[l++]=i[a++]-r;let u=s[l++]=i[a++]-r;s[l++]=i[a++]-e,o=Math.max(o,u)}return new iM(s,o,this.set)}};function sM(t,e,n,r){switch(t){case-2:return n<e;case-1:return r>=e&&n<e;case 0:return n<e&&r>e;case 1:return n<=e&&r>e;case 2:return r>e;case 4:return!0}}function oM(t,e){let n=t.childBefore(e);for(;n;){let r=n.lastChild;if(!r||r.to!=n.to)break;r.type.isError&&r.from==r.to?(t=n,n=r.prevSibling):n=r}return t}function gu(t,e,n,r){for(var i;t.from==t.to||(n<1?t.from>=e:t.from>e)||(n>-1?t.to<=e:t.to<e);){let o=!r&&t instanceof jd&&t.index<0?null:t.parent;if(!o)return t;t=o}let s=r?0:Jt.IgnoreOverlays;if(r)for(let o=t,a=o.parent;a;o=a,a=o.parent)o instanceof jd&&o.index<0&&((i=a.enter(e,n,s))===null||i===void 0?void 0:i.from)!=o.from&&(t=a);for(;;){let o=t.enter(e,n,s);if(!o)return t;t=o}}let jd=class tp{constructor(e,n,r,i){this._tree=e,this.from=n,this.index=r,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,n,r,i,s=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,u=n>0?a.length:-1;e!=u;e+=n){let c=a[e],d=l[e]+o.from;if(sM(i,r,d,d+c.length)){if(c instanceof lh){if(s&Jt.ExcludeBuffers)continue;let h=c.findChild(0,c.buffer.length,n,r-d,i);if(h>-1)return new Uw(new HK(o,c,e,d),null,h)}else if(s&Jt.IncludeAnonymous||!c.type.isAnonymous||jx(c)){let h;if(!(s&Jt.IgnoreMounts)&&c.props&&(h=c.prop(Ke.mounted))&&!h.overlay)return new tp(h.tree,d,e,o);let f=new tp(c,d,e,o);return s&Jt.IncludeAnonymous||!f.type.isAnonymous?f:f.nextChild(n<0?c.children.length-1:0,n,r,i)}}}if(s&Jt.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+n:e=n<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,n,r=0){let i;if(!(r&Jt.IgnoreOverlays)&&(i=this._tree.prop(Ke.mounted))&&i.overlay){let s=e-this.from;for(let{from:o,to:a}of i.overlay)if((n>0?o<=s:o<s)&&(n<0?a>=s:a>s))return new tp(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,n,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new gm(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,n=0){return gu(this,e,n,!1)}resolveInner(e,n=0){return gu(this,e,n,!0)}enterUnfinishedNodesBefore(e){return oM(this,e)}getChild(e,n=null,r=null){let i=pm(this,e,n,r);return i.length?i[0]:null}getChildren(e,n=null,r=null){return pm(this,e,n,r)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return mm(this,e)}};function pm(t,e,n,r){let i=t.cursor(),s=[];if(!i.firstChild())return s;if(n!=null){for(;!i.type.is(n);)if(!i.nextSibling())return s}for(;;){if(r!=null&&i.type.is(r))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return r==null?s:[]}}function mm(t,e,n=e.length-1){for(let r=t.parent;n>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(e[n]&&e[n]!=r.name)return!1;n--}}return!0}let HK=class{constructor(e,n,r,i){this.parent=e,this.buffer=n,this.index=r,this.start=i}},Uw=class yc{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,n,r){this.context=e,this._parent=n,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}child(e,n,r){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,n-this.context.start,r);return s<0?null:new yc(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,n,r=0){if(r&Jt.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],n>0?1:-1,e-this.context.start,n);return s<0?null:new yc(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,n=e.buffer[this.index+3];return n<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new yc(this.context,this._parent,n):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,n=this._parent?this._parent.index+4:0;return this.index==n?this.externalSibling(-1):new yc(this.context,this._parent,e.findChild(n,this.index,-1,0,4))}cursor(e=0){return new gm(this,e)}get tree(){return null}toTree(){let e=[],n=[],{buffer:r}=this.context,i=this.index+4,s=r.buffer[this.index+3];if(s>i){let o=r.buffer[this.index+1];e.push(r.slice(i,s,o)),n.push(0)}return new dt(this.type,e,n,this.to-this.from)}resolve(e,n=0){return gu(this,e,n,!1)}resolveInner(e,n=0){return gu(this,e,n,!0)}enterUnfinishedNodesBefore(e){return oM(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,n=null,r=null){let i=pm(this,e,n,r);return i.length?i[0]:null}getChildren(e,n=null,r=null){return pm(this,e,n,r)}get node(){return this}matchContext(e){return mm(this,e)}},gm=class{get name(){return this.type.name}constructor(e,n=0){if(this.mode=n,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof jd)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let r=e._parent;r;r=r._parent)this.stack.unshift(r.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,n){this.index=e;let{start:r,buffer:i}=this.buffer;return this.type=n||i.set.types[i.buffer[e]],this.from=r+i.buffer[e+1],this.to=r+i.buffer[e+2],!0}yield(e){return e?e instanceof jd?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,n,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,n,r,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,n-this.buffer.start,r);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,n,r=this.mode){return this.buffer?r&Jt.ExcludeBuffers?!1:this.enterChild(1,e,n):this.yield(this._tree.enter(e,n,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Jt.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&Jt.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:n}=this.buffer,r=this.stack.length-1;if(e<0){let i=r<0?0:this.stack[r]+4;if(this.index!=i)return this.yieldBuf(n.findChild(i,this.index,-1,0,4))}else{let i=n.buffer[this.index+3];if(i<(r<0?n.buffer.length:n.buffer[this.stack[r]+3]))return this.yieldBuf(i)}return r<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let n,r,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:n,parent:r}=i)}else({index:n,_parent:r}=this._tree);for(;r;{index:n,_parent:r}=r)if(n>-1)for(let s=n+e,o=e<0?-1:r._tree.children.length;s!=o;s+=e){let a=r._tree.children[s];if(this.mode&Jt.IncludeAnonymous||a instanceof lh||!a.type.isAnonymous||jx(a))return!1}return!0}move(e,n){if(n&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,n=0){for(;(this.from==this.to||(n<1?this.from>=e:this.from>e)||(n>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,n););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,n=null,r=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==i){if(i==this.index)return o;n=o,r=s+1;break e}i=this.stack[--s]}for(let i=r;i<this.stack.length;i++)n=new Uw(this.buffer,n,this.stack[i]);return this.bufferNode=new Uw(this.buffer,n,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,n){for(let r=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){r++;continue}this.type.isAnonymous||(i=!0)}for(;i&&n&&n(this),i=this.type.isAnonymous,!this.nextSibling();){if(!r)return;this.parent(),r--,i=!0}}}matchContext(e){if(!this.buffer)return mm(this.node,e);let{buffer:n}=this.buffer,{types:r}=n.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return mm(this.node,e,i);let o=r[n.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[i]&&e[i]!=o.name)return!1;i--}}return!0}};function jx(t){return t.children.some(e=>e instanceof lh||!e.type.isAnonymous||jx(e))}function WK(t){var e;let{buffer:n,nodeSet:r,maxBufferLength:i=zK,reused:s=[],minRepeatType:o=r.types.length}=t,a=Array.isArray(n)?new VK(n,n.length):n,l=r.types,u=0,c=0;function d(S,C,E,T,A){let{id:N,start:R,end:O,size:j}=a,z=c;for(;j<0;)if(a.next(),j==-1){let F=s[N];E.push(F),T.push(R-S);return}else if(j==-3){u=N;return}else if(j==-4){c=N;return}else throw new RangeError(`Unrecognized record size: ${j}`);let I=l[N],G,K,ee=R-S;if(O-R<=i&&(K=g(a.pos-C,A))){let F=new Uint16Array(K.size-K.skip),_=a.pos-K.size,V=F.length;for(;a.pos>_;)V=b(K.start,F,V);G=new lh(F,O-K.start,r),ee=K.start-S}else{let F=a.pos-j;a.next();let _=[],V=[],Z=N>=o?N:-1,ne=0,me=O;for(;a.pos>F;)Z>=0&&a.id==Z&&a.size>=0?(a.end<=me-i&&(f(_,V,R,ne,a.end,me,Z,z),ne=_.length,me=a.end),a.next()):d(R,F,_,V,Z);if(Z>=0&&ne>0&&ne<_.length&&f(_,V,R,ne,R,me,Z,z),_.reverse(),V.reverse(),Z>-1&&ne>0){let H=h(I);G=zx(I,_,V,0,_.length,0,O-R,H,H)}else G=p(I,_,V,O-R,z-O)}E.push(G),T.push(ee)}function h(S){return(C,E,T)=>{let A=0,N=C.length-1,R,O;if(N>=0&&(R=C[N])instanceof dt){if(!N&&R.type==S&&R.length==T)return R;(O=R.prop(Ke.lookAhead))&&(A=E[N]+R.length+O)}return p(S,C,E,T,A)}}function f(S,C,E,T,A,N,R,O){let j=[],z=[];for(;S.length>T;)j.push(S.pop()),z.push(C.pop()+E-A);S.push(p(r.types[R],j,z,N-A,O-N)),C.push(A-E)}function p(S,C,E,T,A=0,N){if(u){let R=[Ke.contextHash,u];N=N?[R].concat(N):[R]}if(A>25){let R=[Ke.lookAhead,A];N=N?[R].concat(N):[R]}return new dt(S,C,E,T,N)}function g(S,C){let E=a.fork(),T=0,A=0,N=0,R=E.end-i,O={size:0,start:0,skip:0};e:for(let j=E.pos-S;E.pos>j;){let z=E.size;if(E.id==C&&z>=0){O.size=T,O.start=A,O.skip=N,N+=4,T+=4,E.next();continue}let I=E.pos-z;if(z<0||I<j||E.start<R)break;let G=E.id>=o?4:0,K=E.start;for(E.next();E.pos>I;){if(E.size<0)if(E.size==-3)G+=4;else break e;else E.id>=o&&(G+=4);E.next()}A=K,T+=z,N+=G}return(C<0||T==S)&&(O.size=T,O.start=A,O.skip=N),O.size>4?O:void 0}function b(S,C,E){let{id:T,start:A,end:N,size:R}=a;if(a.next(),R>=0&&T<o){let O=E;if(R>4){let j=a.pos-(R-4);for(;a.pos>j;)E=b(S,C,E)}C[--E]=O,C[--E]=N-S,C[--E]=A-S,C[--E]=T}else R==-3?u=T:R==-4&&(c=T);return E}let y=[],v=[];for(;a.pos>0;)d(t.start||0,t.bufferStart||0,y,v,-1);let w=(e=t.length)!==null&&e!==void 0?e:y.length?v[0]+y[0].length:0;return new dt(l[t.topID],y.reverse(),v.reverse(),w)}const t2=new WeakMap;function np(t,e){if(!t.isAnonymous||e instanceof lh||e.type!=t)return 1;let n=t2.get(e);if(n==null){n=1;for(let r of e.children){if(r.type!=t||!(r instanceof dt)){n=1;break}n+=np(t,r)}t2.set(e,n)}return n}function zx(t,e,n,r,i,s,o,a,l){let u=0;for(let p=r;p<i;p++)u+=np(t,e[p]);let c=Math.ceil(u*1.5/8),d=[],h=[];function f(p,g,b,y,v){for(let w=b;w<y;){let S=w,C=g[w],E=np(t,p[w]);for(w++;w<y;w++){let T=np(t,p[w]);if(E+T>=c)break;E+=T}if(w==S+1){if(E>c){let T=p[S];f(T.children,T.positions,0,T.children.length,g[S]+v);continue}d.push(p[S])}else{let T=g[w-1]+p[w-1].length-C;d.push(zx(t,p,g,S,w,C,T,null,l))}h.push(C+v-s)}}return f(e,n,r,i,0),(a||l)(d,h,o)}class fi{constructor(e,n,r,i,s=!1,o=!1){this.from=e,this.to=n,this.tree=r,this.offset=i,this.open=(s?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,n=[],r=!1){let i=[new fi(0,e.length,e,0,!1,r)];for(let s of n)s.to>e.length&&i.push(s);return i}static applyChanges(e,n,r=128){if(!n.length)return e;let i=[],s=1,o=e.length?e[0]:null;for(let a=0,l=0,u=0;;a++){let c=a<n.length?n[a]:null,d=c?c.fromA:1e9;if(d-l>=r)for(;o&&o.from<d;){let h=o;if(l>=h.from||d<=h.to||u){let f=Math.max(h.from,l)-u,p=Math.min(h.to,d)-u;h=f>=p?null:new fi(f,p,h.tree,h.offset+u,a>0,!!c)}if(h&&i.push(h),o.to>d)break;o=s<e.length?e[s++]:null}if(!c)break;l=c.toA,u=c.toA-c.toB}return i}}class Fx{startParse(e,n,r){return typeof e=="string"&&(e=new GK(e)),r=r?r.length?r.map(i=>new gy(i.from,i.to)):[new gy(0,0)]:[new gy(0,e.length)],this.createParse(e,n||[],r)}parse(e,n,r){let i=this.startParse(e,n,r);for(;;){let s=i.advance();if(s)return s}}}class GK{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,n){return this.string.slice(e,n)}}new Ke({perNode:!0});const KK=1024;let XK=0;class St{constructor(e={}){this.id=XK++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Rs.match(e)),n=>{let r=e(n);return r===void 0?null:[this,r]}}}St.closedBy=new St({deserialize:t=>t.split(" ")});St.openedBy=new St({deserialize:t=>t.split(" ")});St.group=new St({deserialize:t=>t.split(" ")});St.contextHash=new St({perNode:!0});St.lookAhead=new St({perNode:!0});St.mounted=new St({perNode:!0});const ZK=Object.create(null);class Rs{constructor(e,n,r,i=0){this.name=e,this.props=n,this.id=r,this.flags=i}static define(e){let n=e.props&&e.props.length?Object.create(null):ZK,r=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),i=new Rs(e.name||"",n,e.id,r);if(e.props){for(let s of e.props)if(Array.isArray(s)||(s=s(i)),s){if(s[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");n[s[0].id]=s[1]}}return i}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let n=this.prop(St.group);return n?n.indexOf(e)>-1:!1}return this.id==e}static match(e){let n=Object.create(null);for(let r in e)for(let i of r.split(" "))n[i]=e[r];return r=>{for(let i=r.prop(St.group),s=-1;s<(i?i.length:0);s++){let o=n[s<0?r.name:i[s]];if(o)return o}}}}Rs.none=new Rs("",Object.create(null),0,8);const uf=new WeakMap,n2=new WeakMap;var wn;(function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"})(wn||(wn={}));class Wi{constructor(e,n,r,i,s){if(this.type=e,this.children=n,this.positions=r,this.length=i,this.props=null,s&&s.length){this.props=Object.create(null);for(let[o,a]of s)this.props[typeof o=="number"?o:o.id]=a}}toString(){let e=this.prop(St.mounted);if(e&&!e.overlay)return e.tree.toString();let n="";for(let r of this.children){let i=r.toString();i&&(n&&(n+=","),n+=i)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(n.length?"("+n+")":""):n}cursor(e=0){return new wm(this.topNode,e)}cursorAt(e,n=0,r=0){let i=uf.get(this)||this.topNode,s=new wm(i);return s.moveTo(e,n),uf.set(this,s._tree),s}get topNode(){return new Cs(this,0,0,null)}resolve(e,n=0){let r=yu(uf.get(this)||this.topNode,e,n,!1);return uf.set(this,r),r}resolveInner(e,n=0){let r=yu(n2.get(this)||this.topNode,e,n,!0);return n2.set(this,r),r}iterate(e){let{enter:n,leave:r,from:i=0,to:s=this.length}=e,o=e.mode||0,a=(o&wn.IncludeAnonymous)>0;for(let l=this.cursor(o|wn.IncludeAnonymous);;){let u=!1;if(l.from<=s&&l.to>=i&&(!a&&l.type.isAnonymous||n(l)!==!1)){if(l.firstChild())continue;u=!0}for(;u&&r&&(a||!l.type.isAnonymous)&&r(l),!l.nextSibling();){if(!l.parent())return;u=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let n in this.props)e.push([+n,this.props[n]]);return e}balance(e={}){return this.children.length<=8?this:Hx(Rs.none,this.children,this.positions,0,this.children.length,0,this.length,(n,r,i)=>new Wi(this.type,n,r,i,this.propValues),e.makeTree||((n,r,i)=>new Wi(Rs.none,n,r,i)))}static build(e){return YK(e)}}Wi.empty=new Wi(Rs.none,[],[],0);class Ux{constructor(e,n){this.buffer=e,this.index=n}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Ux(this.buffer,this.index)}}class Ja{constructor(e,n,r){this.buffer=e,this.length=n,this.set=r}get type(){return Rs.none}toString(){let e=[];for(let n=0;n<this.buffer.length;)e.push(this.childString(n)),n=this.buffer[n+3];return e.join(",")}childString(e){let n=this.buffer[e],r=this.buffer[e+3],i=this.set.types[n],s=i.name;if(/\W/.test(s)&&!i.isError&&(s=JSON.stringify(s)),e+=4,r==e)return s;let o=[];for(;e<r;)o.push(this.childString(e)),e=this.buffer[e+3];return s+"("+o.join(",")+")"}findChild(e,n,r,i,s){let{buffer:o}=this,a=-1;for(let l=e;l!=n&&!(aM(s,i,o[l+1],o[l+2])&&(a=l,r>0));l=o[l+3]);return a}slice(e,n,r){let i=this.buffer,s=new Uint16Array(n-e),o=0;for(let a=e,l=0;a<n;){s[l++]=i[a++],s[l++]=i[a++]-r;let u=s[l++]=i[a++]-r;s[l++]=i[a++]-e,o=Math.max(o,u)}return new Ja(s,o,this.set)}}function aM(t,e,n,r){switch(t){case-2:return n<e;case-1:return r>=e&&n<e;case 0:return n<e&&r>e;case 1:return n<=e&&r>e;case 2:return r>e;case 4:return!0}}function lM(t,e){let n=t.childBefore(e);for(;n;){let r=n.lastChild;if(!r||r.to!=n.to)break;r.type.isError&&r.from==r.to?(t=n,n=r.prevSibling):n=r}return t}function yu(t,e,n,r){for(var i;t.from==t.to||(n<1?t.from>=e:t.from>e)||(n>-1?t.to<=e:t.to<e);){let o=!r&&t instanceof Cs&&t.index<0?null:t.parent;if(!o)return t;t=o}let s=r?0:wn.IgnoreOverlays;if(r)for(let o=t,a=o.parent;a;o=a,a=o.parent)o instanceof Cs&&o.index<0&&((i=a.enter(e,n,s))===null||i===void 0?void 0:i.from)!=o.from&&(t=a);for(;;){let o=t.enter(e,n,s);if(!o)return t;t=o}}class Cs{constructor(e,n,r,i){this._tree=e,this.from=n,this.index=r,this._parent=i}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,n,r,i,s=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,u=n>0?a.length:-1;e!=u;e+=n){let c=a[e],d=l[e]+o.from;if(aM(i,r,d,d+c.length)){if(c instanceof Ja){if(s&wn.ExcludeBuffers)continue;let h=c.findChild(0,c.buffer.length,n,r-d,i);if(h>-1)return new go(new JK(o,c,e,d),null,h)}else if(s&wn.IncludeAnonymous||!c.type.isAnonymous||Vx(c)){let h;if(!(s&wn.IgnoreMounts)&&c.props&&(h=c.prop(St.mounted))&&!h.overlay)return new Cs(h.tree,d,e,o);let f=new Cs(c,d,e,o);return s&wn.IncludeAnonymous||!f.type.isAnonymous?f:f.nextChild(n<0?c.children.length-1:0,n,r,i)}}}if(s&wn.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+n:e=n<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,n,r=0){let i;if(!(r&wn.IgnoreOverlays)&&(i=this._tree.prop(St.mounted))&&i.overlay){let s=e-this.from;for(let{from:o,to:a}of i.overlay)if((n>0?o<=s:o<s)&&(n<0?a>=s:a>s))return new Cs(i.tree,i.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,n,r)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}cursor(e=0){return new wm(this,e)}get tree(){return this._tree}toTree(){return this._tree}resolve(e,n=0){return yu(this,e,n,!1)}resolveInner(e,n=0){return yu(this,e,n,!0)}enterUnfinishedNodesBefore(e){return lM(this,e)}getChild(e,n=null,r=null){let i=ym(this,e,n,r);return i.length?i[0]:null}getChildren(e,n=null,r=null){return ym(this,e,n,r)}toString(){return this._tree.toString()}get node(){return this}matchContext(e){return vm(this,e)}}function ym(t,e,n,r){let i=t.cursor(),s=[];if(!i.firstChild())return s;if(n!=null){for(;!i.type.is(n);)if(!i.nextSibling())return s}for(;;){if(r!=null&&i.type.is(r))return s;if(i.type.is(e)&&s.push(i.node),!i.nextSibling())return r==null?s:[]}}function vm(t,e,n=e.length-1){for(let r=t.parent;n>=0;r=r.parent){if(!r)return!1;if(!r.type.isAnonymous){if(e[n]&&e[n]!=r.name)return!1;n--}}return!0}class JK{constructor(e,n,r,i){this.parent=e,this.buffer=n,this.index=r,this.start=i}}class go{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,n,r){this.context=e,this._parent=n,this.index=r,this.type=e.buffer.set.types[e.buffer.buffer[r]]}child(e,n,r){let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],e,n-this.context.start,r);return s<0?null:new go(this.context,this,s)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,n,r=0){if(r&wn.ExcludeBuffers)return null;let{buffer:i}=this.context,s=i.findChild(this.index+4,i.buffer[this.index+3],n>0?1:-1,e-this.context.start,n);return s<0?null:new go(this.context,this,s)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,n=e.buffer[this.index+3];return n<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new go(this.context,this._parent,n):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,n=this._parent?this._parent.index+4:0;return this.index==n?this.externalSibling(-1):new go(this.context,this._parent,e.findChild(n,this.index,-1,0,4))}cursor(e=0){return new wm(this,e)}get tree(){return null}toTree(){let e=[],n=[],{buffer:r}=this.context,i=this.index+4,s=r.buffer[this.index+3];if(s>i){let o=r.buffer[this.index+1];e.push(r.slice(i,s,o)),n.push(0)}return new Wi(this.type,e,n,this.to-this.from)}resolve(e,n=0){return yu(this,e,n,!1)}resolveInner(e,n=0){return yu(this,e,n,!0)}enterUnfinishedNodesBefore(e){return lM(this,e)}toString(){return this.context.buffer.childString(this.index)}getChild(e,n=null,r=null){let i=ym(this,e,n,r);return i.length?i[0]:null}getChildren(e,n=null,r=null){return ym(this,e,n,r)}get node(){return this}matchContext(e){return vm(this,e)}}class wm{get name(){return this.type.name}constructor(e,n=0){if(this.mode=n,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Cs)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let r=e._parent;r;r=r._parent)this.stack.unshift(r.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,n){this.index=e;let{start:r,buffer:i}=this.buffer;return this.type=n||i.set.types[i.buffer[e]],this.from=r+i.buffer[e+1],this.to=r+i.buffer[e+2],!0}yield(e){return e?e instanceof Cs?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,n,r){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,n,r,this.mode));let{buffer:i}=this.buffer,s=i.findChild(this.index+4,i.buffer[this.index+3],e,n-this.buffer.start,r);return s<0?!1:(this.stack.push(this.index),this.yieldBuf(s))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,n,r=this.mode){return this.buffer?r&wn.ExcludeBuffers?!1:this.enterChild(1,e,n):this.yield(this._tree.enter(e,n,r))}parent(){if(!this.buffer)return this.yieldNode(this.mode&wn.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&wn.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:n}=this.buffer,r=this.stack.length-1;if(e<0){let i=r<0?0:this.stack[r]+4;if(this.index!=i)return this.yieldBuf(n.findChild(i,this.index,-1,0,4))}else{let i=n.buffer[this.index+3];if(i<(r<0?n.buffer.length:n.buffer[this.stack[r]+3]))return this.yieldBuf(i)}return r<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let n,r,{buffer:i}=this;if(i){if(e>0){if(this.index<i.buffer.buffer.length)return!1}else for(let s=0;s<this.index;s++)if(i.buffer.buffer[s+3]<this.index)return!1;({index:n,parent:r}=i)}else({index:n,_parent:r}=this._tree);for(;r;{index:n,_parent:r}=r)if(n>-1)for(let s=n+e,o=e<0?-1:r._tree.children.length;s!=o;s+=e){let a=r._tree.children[s];if(this.mode&wn.IncludeAnonymous||a instanceof Ja||!a.type.isAnonymous||Vx(a))return!1}return!0}move(e,n){if(n&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,n=0){for(;(this.from==this.to||(n<1?this.from>=e:this.from>e)||(n>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,n););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,n=null,r=0;if(e&&e.context==this.buffer)e:for(let i=this.index,s=this.stack.length;s>=0;){for(let o=e;o;o=o._parent)if(o.index==i){if(i==this.index)return o;n=o,r=s+1;break e}i=this.stack[--s]}for(let i=r;i<this.stack.length;i++)n=new go(this.buffer,n,this.stack[i]);return this.bufferNode=new go(this.buffer,n,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,n){for(let r=0;;){let i=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){r++;continue}this.type.isAnonymous||(i=!0)}for(;i&&n&&n(this),i=this.type.isAnonymous,!this.nextSibling();){if(!r)return;this.parent(),r--,i=!0}}}matchContext(e){if(!this.buffer)return vm(this.node,e);let{buffer:n}=this.buffer,{types:r}=n.set;for(let i=e.length-1,s=this.stack.length-1;i>=0;s--){if(s<0)return vm(this.node,e,i);let o=r[n.buffer[this.stack[s]]];if(!o.isAnonymous){if(e[i]&&e[i]!=o.name)return!1;i--}}return!0}}function Vx(t){return t.children.some(e=>e instanceof Ja||!e.type.isAnonymous||Vx(e))}function YK(t){var e;let{buffer:n,nodeSet:r,maxBufferLength:i=KK,reused:s=[],minRepeatType:o=r.types.length}=t,a=Array.isArray(n)?new Ux(n,n.length):n,l=r.types,u=0,c=0;function d(S,C,E,T,A){let{id:N,start:R,end:O,size:j}=a,z=c;for(;j<0;)if(a.next(),j==-1){let F=s[N];E.push(F),T.push(R-S);return}else if(j==-3){u=N;return}else if(j==-4){c=N;return}else throw new RangeError(`Unrecognized record size: ${j}`);let I=l[N],G,K,ee=R-S;if(O-R<=i&&(K=g(a.pos-C,A))){let F=new Uint16Array(K.size-K.skip),_=a.pos-K.size,V=F.length;for(;a.pos>_;)V=b(K.start,F,V);G=new Ja(F,O-K.start,r),ee=K.start-S}else{let F=a.pos-j;a.next();let _=[],V=[],Z=N>=o?N:-1,ne=0,me=O;for(;a.pos>F;)Z>=0&&a.id==Z&&a.size>=0?(a.end<=me-i&&(f(_,V,R,ne,a.end,me,Z,z),ne=_.length,me=a.end),a.next()):d(R,F,_,V,Z);if(Z>=0&&ne>0&&ne<_.length&&f(_,V,R,ne,R,me,Z,z),_.reverse(),V.reverse(),Z>-1&&ne>0){let H=h(I);G=Hx(I,_,V,0,_.length,0,O-R,H,H)}else G=p(I,_,V,O-R,z-O)}E.push(G),T.push(ee)}function h(S){return(C,E,T)=>{let A=0,N=C.length-1,R,O;if(N>=0&&(R=C[N])instanceof Wi){if(!N&&R.type==S&&R.length==T)return R;(O=R.prop(St.lookAhead))&&(A=E[N]+R.length+O)}return p(S,C,E,T,A)}}function f(S,C,E,T,A,N,R,O){let j=[],z=[];for(;S.length>T;)j.push(S.pop()),z.push(C.pop()+E-A);S.push(p(r.types[R],j,z,N-A,O-N)),C.push(A-E)}function p(S,C,E,T,A=0,N){if(u){let R=[St.contextHash,u];N=N?[R].concat(N):[R]}if(A>25){let R=[St.lookAhead,A];N=N?[R].concat(N):[R]}return new Wi(S,C,E,T,N)}function g(S,C){let E=a.fork(),T=0,A=0,N=0,R=E.end-i,O={size:0,start:0,skip:0};e:for(let j=E.pos-S;E.pos>j;){let z=E.size;if(E.id==C&&z>=0){O.size=T,O.start=A,O.skip=N,N+=4,T+=4,E.next();continue}let I=E.pos-z;if(z<0||I<j||E.start<R)break;let G=E.id>=o?4:0,K=E.start;for(E.next();E.pos>I;){if(E.size<0)if(E.size==-3)G+=4;else break e;else E.id>=o&&(G+=4);E.next()}A=K,T+=z,N+=G}return(C<0||T==S)&&(O.size=T,O.start=A,O.skip=N),O.size>4?O:void 0}function b(S,C,E){let{id:T,start:A,end:N,size:R}=a;if(a.next(),R>=0&&T<o){let O=E;if(R>4){let j=a.pos-(R-4);for(;a.pos>j;)E=b(S,C,E)}C[--E]=O,C[--E]=N-S,C[--E]=A-S,C[--E]=T}else R==-3?u=T:R==-4&&(c=T);return E}let y=[],v=[];for(;a.pos>0;)d(t.start||0,t.bufferStart||0,y,v,-1);let w=(e=t.length)!==null&&e!==void 0?e:y.length?v[0]+y[0].length:0;return new Wi(l[t.topID],y.reverse(),v.reverse(),w)}const r2=new WeakMap;function rp(t,e){if(!t.isAnonymous||e instanceof Ja||e.type!=t)return 1;let n=r2.get(e);if(n==null){n=1;for(let r of e.children){if(r.type!=t||!(r instanceof Wi)){n=1;break}n+=rp(t,r)}r2.set(e,n)}return n}function Hx(t,e,n,r,i,s,o,a,l){let u=0;for(let p=r;p<i;p++)u+=rp(t,e[p]);let c=Math.ceil(u*1.5/8),d=[],h=[];function f(p,g,b,y,v){for(let w=b;w<y;){let S=w,C=g[w],E=rp(t,p[w]);for(w++;w<y;w++){let T=rp(t,p[w]);if(E+T>=c)break;E+=T}if(w==S+1){if(E>c){let T=p[S];f(T.children,T.positions,0,T.children.length,g[S]+v);continue}d.push(p[S])}else{let T=g[w-1]+p[w-1].length-C;d.push(Hx(t,p,g,S,w,C,T,null,l))}h.push(C+v-s)}}return f(e,n,r,i,0),(a||l)(d,h,o)}new St({perNode:!0});let qK=0;class nn{constructor(e,n,r){this.set=e,this.base=n,this.modified=r,this.id=qK++}static define(e){if(e!=null&&e.base)throw new Error("Can not derive from a modified tag");let n=new nn([],null,[]);if(n.set.push(n),e)for(let r of e.set)n.set.push(r);return n}static defineModifier(){let e=new bm;return n=>n.modified.indexOf(e)>-1?n:bm.get(n.base||n,n.modified.concat(e).sort((r,i)=>r.id-i.id))}}let QK=0;class bm{constructor(){this.instances=[],this.id=QK++}static get(e,n){if(!n.length)return e;let r=n[0].instances.find(a=>a.base==e&&eX(n,a.modified));if(r)return r;let i=[],s=new nn(i,e,n);for(let a of n)a.instances.push(s);let o=tX(n);for(let a of e.set)if(!a.modified.length)for(let l of o)i.push(bm.get(a,l));return s}}function eX(t,e){return t.length==e.length&&t.every((n,r)=>n==e[r])}function tX(t){let e=[[]];for(let n=0;n<t.length;n++)for(let r=0,i=e.length;r<i;r++)e.push(e[r].concat(t[n]));return e.sort((n,r)=>r.length-n.length)}function uM(t){let e=Object.create(null);for(let n in t){let r=t[n];Array.isArray(r)||(r=[r]);for(let i of n.split(" "))if(i){let s=[],o=2,a=i;for(let d=0;;){if(a=="..."&&d>0&&d+3==i.length){o=1;break}let h=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!h)throw new RangeError("Invalid path: "+i);if(s.push(h[0]=="*"?"":h[0][0]=='"'?JSON.parse(h[0]):h[0]),d+=h[0].length,d==i.length)break;let f=i[d++];if(d==i.length&&f=="!"){o=0;break}if(f!="/")throw new RangeError("Invalid path: "+i);a=i.slice(d)}let l=s.length-1,u=s[l];if(!u)throw new RangeError("Invalid path: "+i);let c=new xm(r,o,l>0?s.slice(0,l):null);e[u]=c.sort(e[u])}}return cM.add(e)}const cM=new St;class xm{constructor(e,n,r,i){this.tags=e,this.mode=n,this.context=r,this.next=i}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}xm.empty=new xm([],2,null);function dM(t,e){let n=Object.create(null);for(let s of t)if(!Array.isArray(s.tag))n[s.tag.id]=s.class;else for(let o of s.tag)n[o.id]=s.class;let{scope:r,all:i=null}=e||{};return{style:s=>{let o=i;for(let a of s)for(let l of a.set){let u=n[l.id];if(u){o=o?o+" "+u:u;break}}return o},scope:r}}function nX(t,e){let n=null;for(let r of t){let i=r.style(e);i&&(n=n?n+" "+i:i)}return n}function rX(t,e,n,r=0,i=t.length){let s=new iX(r,Array.isArray(e)?e:[e],n);s.highlightRange(t.cursor(),r,i,"",s.highlighters),s.flush(i)}class iX{constructor(e,n,r){this.at=e,this.highlighters=n,this.span=r,this.class=""}startSpan(e,n){n!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=n)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,n,r,i,s){let{type:o,from:a,to:l}=e;if(a>=r||l<=n)return;o.isTop&&(s=this.highlighters.filter(f=>!f.scope||f.scope(o)));let u=i,c=sX(e)||xm.empty,d=nX(s,c.tags);if(d&&(u&&(u+=" "),u+=d,c.mode==1&&(i+=(i?" ":"")+d)),this.startSpan(Math.max(n,a),u),c.opaque)return;let h=e.tree&&e.tree.prop(St.mounted);if(h&&h.overlay){let f=e.node.enter(h.overlay[0].from+a,1),p=this.highlighters.filter(b=>!b.scope||b.scope(h.tree.type)),g=e.firstChild();for(let b=0,y=a;;b++){let v=b<h.overlay.length?h.overlay[b]:null,w=v?v.from+a:l,S=Math.max(n,y),C=Math.min(r,w);if(S<C&&g)for(;e.from<C&&(this.highlightRange(e,S,C,i,s),this.startSpan(Math.min(C,e.to),u),!(e.to>=w||!e.nextSibling())););if(!v||w>r)break;y=v.to+a,y>n&&(this.highlightRange(f.cursor(),Math.max(n,v.from+a),Math.min(r,y),"",p),this.startSpan(Math.min(r,y),u))}g&&e.parent()}else if(e.firstChild()){h&&(i="");do if(!(e.to<=n)){if(e.from>=r)break;this.highlightRange(e,n,r,i,s),this.startSpan(Math.min(r,e.to),u)}while(e.nextSibling());e.parent()}}}function sX(t){let e=t.type.prop(cM);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}const ce=nn.define,cf=ce(),Xs=ce(),i2=ce(Xs),s2=ce(Xs),Zs=ce(),df=ce(Zs),yy=ce(Zs),Ei=ce(),ta=ce(Ei),ki=ce(),Ci=ce(),Vw=ce(),tc=ce(Vw),hf=ce(),Oe={comment:cf,lineComment:ce(cf),blockComment:ce(cf),docComment:ce(cf),name:Xs,variableName:ce(Xs),typeName:i2,tagName:ce(i2),propertyName:s2,attributeName:ce(s2),className:ce(Xs),labelName:ce(Xs),namespace:ce(Xs),macroName:ce(Xs),literal:Zs,string:df,docString:ce(df),character:ce(df),attributeValue:ce(df),number:yy,integer:ce(yy),float:ce(yy),bool:ce(Zs),regexp:ce(Zs),escape:ce(Zs),color:ce(Zs),url:ce(Zs),keyword:ki,self:ce(ki),null:ce(ki),atom:ce(ki),unit:ce(ki),modifier:ce(ki),operatorKeyword:ce(ki),controlKeyword:ce(ki),definitionKeyword:ce(ki),moduleKeyword:ce(ki),operator:Ci,derefOperator:ce(Ci),arithmeticOperator:ce(Ci),logicOperator:ce(Ci),bitwiseOperator:ce(Ci),compareOperator:ce(Ci),updateOperator:ce(Ci),definitionOperator:ce(Ci),typeOperator:ce(Ci),controlOperator:ce(Ci),punctuation:Vw,separator:ce(Vw),bracket:tc,angleBracket:ce(tc),squareBracket:ce(tc),paren:ce(tc),brace:ce(tc),content:Ei,heading:ta,heading1:ce(ta),heading2:ce(ta),heading3:ce(ta),heading4:ce(ta),heading5:ce(ta),heading6:ce(ta),contentSeparator:ce(Ei),list:ce(Ei),quote:ce(Ei),emphasis:ce(Ei),strong:ce(Ei),link:ce(Ei),monospace:ce(Ei),strikethrough:ce(Ei),inserted:ce(),deleted:ce(),changed:ce(),invalid:ce(),meta:hf,documentMeta:ce(hf),annotation:ce(hf),processingInstruction:ce(hf),definition:nn.defineModifier(),constant:nn.defineModifier(),function:nn.defineModifier(),standard:nn.defineModifier(),local:nn.defineModifier(),special:nn.defineModifier()};dM([{tag:Oe.link,class:"tok-link"},{tag:Oe.heading,class:"tok-heading"},{tag:Oe.emphasis,class:"tok-emphasis"},{tag:Oe.strong,class:"tok-strong"},{tag:Oe.keyword,class:"tok-keyword"},{tag:Oe.atom,class:"tok-atom"},{tag:Oe.bool,class:"tok-bool"},{tag:Oe.url,class:"tok-url"},{tag:Oe.labelName,class:"tok-labelName"},{tag:Oe.inserted,class:"tok-inserted"},{tag:Oe.deleted,class:"tok-deleted"},{tag:Oe.literal,class:"tok-literal"},{tag:Oe.string,class:"tok-string"},{tag:Oe.number,class:"tok-number"},{tag:[Oe.regexp,Oe.escape,Oe.special(Oe.string)],class:"tok-string2"},{tag:Oe.variableName,class:"tok-variableName"},{tag:Oe.local(Oe.variableName),class:"tok-variableName tok-local"},{tag:Oe.definition(Oe.variableName),class:"tok-variableName tok-definition"},{tag:Oe.special(Oe.variableName),class:"tok-variableName2"},{tag:Oe.definition(Oe.propertyName),class:"tok-propertyName tok-definition"},{tag:Oe.typeName,class:"tok-typeName"},{tag:Oe.namespace,class:"tok-namespace"},{tag:Oe.className,class:"tok-className"},{tag:Oe.macroName,class:"tok-macroName"},{tag:Oe.propertyName,class:"tok-propertyName"},{tag:Oe.operator,class:"tok-operator"},{tag:Oe.comment,class:"tok-comment"},{tag:Oe.meta,class:"tok-meta"},{tag:Oe.invalid,class:"tok-invalid"},{tag:Oe.punctuation,class:"tok-punctuation"}]);var vy;const ff=new Ke,oX=new Ke;let ms=class{constructor(e,n,r=[],i=""){this.data=e,this.name=i,Ue.prototype.hasOwnProperty("tree")||Object.defineProperty(Ue.prototype,"tree",{get(){return vu(this)}}),this.parser=n,this.extension=[wu.of(this),Ue.languageData.of((s,o,a)=>{let l=o2(s,o,a),u=l.type.prop(ff);if(!u)return[];let c=s.facet(u),d=l.type.prop(oX);if(d){let h=l.resolve(o-l.from,a);for(let f of d)if(f.test(h,s)){let p=s.facet(f.facet);return f.type=="replace"?p:p.concat(c)}}return c})].concat(r)}isActiveAt(e,n,r=-1){return o2(e,n,r).type.prop(ff)==this.data}findRegions(e){let n=e.facet(wu);if((n==null?void 0:n.data)==this.data)return[{from:0,to:e.doc.length}];if(!n||!n.allowsNesting)return[];let r=[],i=(s,o)=>{if(s.prop(ff)==this.data){r.push({from:o,to:o+s.length});return}let a=s.prop(Ke.mounted);if(a){if(a.tree.prop(ff)==this.data){if(a.overlay)for(let l of a.overlay)r.push({from:l.from+o,to:l.to+o});else r.push({from:o,to:o+s.length});return}else if(a.overlay){let l=r.length;if(i(a.tree,a.overlay[0].from+o),r.length>l)return}}for(let l=0;l<s.children.length;l++){let u=s.children[l];u instanceof dt&&i(u,s.positions[l]+o)}};return i(vu(e),0),r}get allowsNesting(){return!0}};ms.setState=ze.define();function o2(t,e,n){let r=t.facet(wu),i=vu(t).topNode;if(!r||r.allowsNesting)for(let s=i;s;s=s.enter(e,n,Jt.ExcludeBuffers))s.type.isTop&&(i=s);return i}function vu(t){let e=t.field(ms.state,!1);return e?e.tree:dt.empty}let aX=class{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,n){let r=this.cursorPos-this.string.length;return e<r||n>=this.cursorPos?this.doc.sliceString(e,n):this.string.slice(e-r,n-r)}},nc=null,lX=class Hw{constructor(e,n,r=[],i,s,o,a,l){this.parser=e,this.state=n,this.fragments=r,this.tree=i,this.treeLen=s,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,n,r){return new Hw(e,n,[],dt.empty,0,r,[],null)}startParse(){return this.parser.startParse(new aX(this.state.doc),this.fragments)}work(e,n){return n!=null&&n>=this.state.doc.length&&(n=void 0),this.tree!=dt.empty&&this.isDone(n??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var r;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),n!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>n)&&n<this.state.doc.length&&this.parse.stopAt(n);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(fi.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(r=this.parse.stoppedAt)!==null&&r!==void 0?r:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(n??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,n;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(n=this.parse.advance()););}),this.treeLen=e,this.tree=n,this.fragments=this.withoutTempSkipped(fi.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let n=nc;nc=this;try{return e()}finally{nc=n}}withoutTempSkipped(e){for(let n;n=this.tempSkipped.pop();)e=a2(e,n.from,n.to);return e}changes(e,n){let{fragments:r,tree:i,treeLen:s,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((u,c,d,h)=>l.push({fromA:u,toA:c,fromB:d,toB:h})),r=fi.applyChanges(r,l),i=dt.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let u of this.skipped){let c=e.mapPos(u.from,1),d=e.mapPos(u.to,-1);c<d&&a.push({from:c,to:d})}}}return new Hw(this.parser,n,r,i,s,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let n=this.skipped.length;for(let r=0;r<this.skipped.length;r++){let{from:i,to:s}=this.skipped[r];i<e.to&&s>e.from&&(this.fragments=a2(this.fragments,i,s),this.skipped.splice(r--,1))}return this.skipped.length>=n?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,n){this.skipped.push({from:e,to:n})}static getSkippingParser(e){return new class extends Fx{createParse(n,r,i){let s=i[0].from,o=i[i.length-1].to;return{parsedPos:s,advance(){let l=nc;if(l){for(let u of i)l.tempSkipped.push(u);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new dt(Ln.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let n=this.fragments;return this.treeLen>=e&&n.length&&n[0].from==0&&n[0].to>=e}static get(){return nc}};function a2(t,e,n){return fi.applyChanges(t,[{fromA:e,toA:n,fromB:e,toB:n}])}let Ww=class Gw{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let n=this.context.changes(e.changes,e.state),r=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),n.viewport.to);return n.work(20,r)||n.takeTree(),new Gw(n)}static init(e){let n=Math.min(3e3,e.doc.length),r=lX.create(e.facet(wu).parser,e,{from:0,to:n});return r.work(20,n)||r.takeTree(),new Gw(r)}};ms.state=Cn.define({create:Ww.init,update(t,e){for(let n of e.effects)if(n.is(ms.setState))return n.value;return e.startState.facet(wu)!=e.state.facet(wu)?Ww.init(e.state):t.apply(e)}});let hM=t=>{let e=setTimeout(()=>t(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(hM=t=>{let e=-1,n=setTimeout(()=>{e=requestIdleCallback(t,{timeout:500-100})},100);return()=>e<0?clearTimeout(n):cancelIdleCallback(e)});const wy=typeof navigator<"u"&&(!((vy=navigator.scheduling)===null||vy===void 0)&&vy.isInputPending)?()=>navigator.scheduling.isInputPending():null,uX=hn.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let n=this.view.state.field(ms.state).context;(n.updateViewport(e.view.viewport)||this.view.viewport.to>n.treeLen)&&this.scheduleWork(),e.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(n)}scheduleWork(){if(this.working)return;let{state:e}=this.view,n=e.field(ms.state);(n.tree!=n.context.tree||!n.context.isDone(e.doc.length))&&(this.working=hM(this.work))}work(e){this.working=null;let n=Date.now();if(this.chunkEnd<n&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=n+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:i}}=this.view,s=r.field(ms.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!wy?Math.max(25,e.timeRemaining()-5):1e9),a=s.context.treeLen<i&&r.doc.length>i+1e3,l=s.context.work(()=>wy&&wy()||Date.now()>o,i+(a?0:1e5));this.chunkBudget-=Date.now()-n,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:ms.setState.of(new Ww(s.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(n=>zr(this.view.state,n)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),wu=Se.define({combine(t){return t.length?t[0]:null},enables:t=>[ms.state,uX,Ae.contentAttributes.compute([t],e=>{let n=e.facet(t);return n&&n.name?{"data-language":n.name}:{}})]}),cX=Se.define(),Wx=Se.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some(n=>n!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function Sm(t){let e=t.facet(Wx);return e.charCodeAt(0)==9?t.tabSize*e.length:e.length}function Kw(t,e){let n="",r=t.tabSize,i=t.facet(Wx)[0];if(i=="	"){for(;e>=r;)n+="	",e-=r;i=" "}for(let s=0;s<e;s++)n+=i;return n}function dX(t,e){t instanceof Ue&&(t=new Gx(t));for(let r of t.state.facet(cX)){let i=r(t,e);if(i!==void 0)return i}let n=vu(t.state);return n.length>=e?fX(t,n,e):null}class Gx{constructor(e,n={}){this.state=e,this.options=n,this.unit=Sm(e)}lineAt(e,n=1){let r=this.state.doc.lineAt(e),{simulateBreak:i,simulateDoubleBreak:s}=this.options;return i!=null&&i>=r.from&&i<=r.to?s&&i==e?{text:"",from:e}:(n<0?i<e:i<=e)?{text:r.text.slice(i-r.from),from:i}:{text:r.text.slice(0,i-r.from),from:r.from}:r}textAfterPos(e,n=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:r,from:i}=this.lineAt(e,n);return r.slice(e-i,Math.min(r.length,e+100-i))}column(e,n=1){let{text:r,from:i}=this.lineAt(e,n),s=this.countColumn(r,e-i),o=this.options.overrideIndentation?this.options.overrideIndentation(i):-1;return o>-1&&(s+=o-this.countColumn(r,r.search(/\S|$/))),s}countColumn(e,n=e.length){return cg(e,this.state.tabSize,n)}lineIndent(e,n=1){let{text:r,from:i}=this.lineAt(e,n),s=this.options.overrideIndentation;if(s){let o=s(i);if(o>-1)return o}return this.countColumn(r,r.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const hX=new Ke;function fX(t,e,n){return fM(e.resolveInner(n).enterUnfinishedNodesBefore(n),n,t)}function pX(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}function mX(t){let e=t.type.prop(hX);if(e)return e;let n=t.firstChild,r;if(n&&(r=n.type.prop(Ke.closedBy))){let i=t.lastChild,s=i&&r.indexOf(i.name)>-1;return o=>wX(o,!0,1,void 0,s&&!pX(o)?i.from:void 0)}return t.parent==null?gX:null}function fM(t,e,n){for(;t;t=t.parent){let r=mX(t);if(r)return r(Kx.create(n,e,t))}return null}function gX(){return 0}class Kx extends Gx{constructor(e,n,r){super(e.state,e.options),this.base=e,this.pos=n,this.node=r}static create(e,n,r){return new Kx(e,n,r)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let n=this.state.doc.lineAt(e.from);for(;;){let r=e.resolve(n.from);for(;r.parent&&r.parent.from==r.from;)r=r.parent;if(yX(r,e))break;n=this.state.doc.lineAt(r.from)}return this.lineIndent(n.from)}continue(){let e=this.node.parent;return e?fM(e,this.pos,this.base):0}}function yX(t,e){for(let n=e;n;n=n.parent)if(t==n)return!0;return!1}function vX(t){let e=t.node,n=e.childAfter(e.from),r=e.lastChild;if(!n)return null;let i=t.options.simulateBreak,s=t.state.doc.lineAt(n.from),o=i==null||i<=s.from?s.to:Math.min(s.to,i);for(let a=n.to;;){let l=e.childAfter(a);if(!l||l==r)return null;if(!l.type.isSkipped)return l.from<o?n:null;a=l.to}}function wX(t,e,n,r,i){let s=t.textAfter,o=s.match(/^\s*/)[0].length,a=r&&s.slice(o,o+r.length)==r||i==t.pos+o,l=e?vX(t):null;return l?a?t.column(l.from):t.column(l.to):t.baseIndent+(a?0:t.unit*n)}const bX=1e4,xX="()[]{}",SX=new Ke;function Xw(t,e,n){let r=t.prop(e<0?Ke.openedBy:Ke.closedBy);if(r)return r;if(t.name.length==1){let i=n.indexOf(t.name);if(i>-1&&i%2==(e<0?1:0))return[n[i+e]]}return null}function Zw(t){let e=t.type.prop(SX);return e?e(t.node):t}function pf(t,e,n,r={}){let i=r.maxScanDistance||bX,s=r.brackets||xX,o=vu(t),a=o.resolveInner(e,n);for(let l=a;l;l=l.parent){let u=Xw(l.type,n,s);if(u&&l.from<l.to){let c=Zw(l);if(c&&(n>0?e>=c.from&&e<c.to:e>c.from&&e<=c.to))return kX(t,e,n,l,c,u,s)}}return CX(t,e,n,o,a.type,i,s)}function kX(t,e,n,r,i,s,o){let a=r.parent,l={from:i.from,to:i.to},u=0,c=a==null?void 0:a.cursor();if(c&&(n<0?c.childBefore(r.from):c.childAfter(r.to)))do if(n<0?c.to<=r.from:c.from>=r.to){if(u==0&&s.indexOf(c.type.name)>-1&&c.from<c.to){let d=Zw(c);return{start:l,end:d?{from:d.from,to:d.to}:void 0,matched:!0}}else if(Xw(c.type,n,o))u++;else if(Xw(c.type,-n,o)){if(u==0){let d=Zw(c);return{start:l,end:d&&d.from<d.to?{from:d.from,to:d.to}:void 0,matched:!1}}u--}}while(n<0?c.prevSibling():c.nextSibling());return{start:l,matched:!1}}function CX(t,e,n,r,i,s,o){let a=n<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),l=o.indexOf(a);if(l<0||l%2==0!=n>0)return null;let u={from:n<0?e-1:e,to:n>0?e+1:e},c=t.doc.iterRange(e,n>0?t.doc.length:0),d=0;for(let h=0;!c.next().done&&h<=s;){let f=c.value;n<0&&(h+=f.length);let p=e+h*n;for(let g=n>0?0:f.length-1,b=n>0?f.length:-1;g!=b;g+=n){let y=o.indexOf(f[g]);if(!(y<0||r.resolveInner(p+g,1).type!=i))if(y%2==0==n>0)d++;else{if(d==1)return{start:u,end:{from:p+g,to:p+g+1},matched:y>>1==l>>1};d--}}n>0&&(h+=f.length)}return c.done?{start:u,matched:!1}:null}const EX=Object.create(null),l2=[Ln.none],u2=[],AX=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])AX[t]=PX(EX,e);function by(t,e){u2.indexOf(t)>-1||(u2.push(t),console.warn(e))}function PX(t,e){let n=null;for(let s of e.split(".")){let o=t[s]||Oe[s];o?typeof o=="function"?n?n=o(n):by(s,`Modifier ${s} used at start of tag`):n?by(s,`Tag ${s} used as modifier`):n=o:by(s,`Unknown highlighting tag ${s}`)}if(!n)return 0;let r=e.replace(/ /g,"_"),i=Ln.define({id:l2.length,name:r,props:[uM({[r]:n})]});return l2.push(i),i.id}const TX=t=>{let{state:e}=t,n=e.doc.lineAt(e.selection.main.from),r=Xx(t.state,n.from);return r.line?$X(t):r.block?RX(t):!1};function uh(t,e){return({state:n,dispatch:r})=>{if(n.readOnly)return!1;let i=t(e,n);return i?(r(n.update(i)),!0):!1}}const $X=uh(Zx,0),NX=uh(Zx,1),OX=uh(Zx,2),_X=uh(pM,0),RX=uh((t,e)=>pM(t,e,DX(e)),0);function Xx(t,e){let n=t.languageDataAt("commentTokens",e);return n.length?n[0]:{}}const rc=50;function MX(t,{open:e,close:n},r,i){let s=t.sliceDoc(r-rc,r),o=t.sliceDoc(i,i+rc),a=/\s*$/.exec(s)[0].length,l=/^\s*/.exec(o)[0].length,u=s.length-a;if(s.slice(u-e.length,u)==e&&o.slice(l,l+n.length)==n)return{open:{pos:r-a,margin:a&&1},close:{pos:i+l,margin:l&&1}};let c,d;i-r<=2*rc?c=d=t.sliceDoc(r,i):(c=t.sliceDoc(r,r+rc),d=t.sliceDoc(i-rc,i));let h=/^\s*/.exec(c)[0].length,f=/\s*$/.exec(d)[0].length,p=d.length-f-n.length;return c.slice(h,h+e.length)==e&&d.slice(p,p+n.length)==n?{open:{pos:r+h+e.length,margin:/\s/.test(c.charAt(h+e.length))?1:0},close:{pos:i-f-n.length,margin:/\s/.test(d.charAt(p-1))?1:0}}:null}function DX(t){let e=[];for(let n of t.selection.ranges){let r=t.doc.lineAt(n.from),i=n.to<=r.to?r:t.doc.lineAt(n.to),s=e.length-1;s>=0&&e[s].to>r.from?e[s].to=i.to:e.push({from:r.from+/^\s*/.exec(r.text)[0].length,to:i.to})}return e}function pM(t,e,n=e.selection.ranges){let r=n.map(s=>Xx(e,s.from).block);if(!r.every(s=>s))return null;let i=n.map((s,o)=>MX(e,r[o],s.from,s.to));if(t!=2&&!i.every(s=>s))return{changes:e.changes(n.map((s,o)=>i[o]?[]:[{from:s.from,insert:r[o].open+" "},{from:s.to,insert:" "+r[o].close}]))};if(t!=1&&i.some(s=>s)){let s=[];for(let o=0,a;o<i.length;o++)if(a=i[o]){let l=r[o],{open:u,close:c}=a;s.push({from:u.pos-l.open.length,to:u.pos+u.margin},{from:c.pos-c.margin,to:c.pos+l.close.length})}return{changes:s}}return null}function Zx(t,e,n=e.selection.ranges){let r=[],i=-1;for(let{from:s,to:o}of n){let a=r.length,l=1e9,u=Xx(e,s).line;if(u){for(let c=s;c<=o;){let d=e.doc.lineAt(c);if(d.from>i&&(s==o||o>d.from)){i=d.from;let h=/^\s*/.exec(d.text)[0].length,f=h==d.length,p=d.text.slice(h,h+u.length)==u?h:-1;h<d.text.length&&h<l&&(l=h),r.push({line:d,comment:p,token:u,indent:h,empty:f,single:!1})}c=d.to+1}if(l<1e9)for(let c=a;c<r.length;c++)r[c].indent<r[c].line.text.length&&(r[c].indent=l);r.length==a+1&&(r[a].single=!0)}}if(t!=2&&r.some(s=>s.comment<0&&(!s.empty||s.single))){let s=[];for(let{line:a,token:l,indent:u,empty:c,single:d}of r)(d||!c)&&s.push({from:a.from+u,insert:l+" "});let o=e.changes(s);return{changes:o,selection:e.selection.map(o,1)}}else if(t!=1&&r.some(s=>s.comment>=0)){let s=[];for(let{line:o,comment:a,token:l}of r)if(a>=0){let u=o.from+a,c=u+l.length;o.text[c-o.from]==" "&&c++,s.push({from:u,to:c})}return{changes:s}}return null}const Jw=Bs.define(),IX=Bs.define(),LX=Se.define(),mM=Se.define({combine(t){return Wo(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,n)=>n},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,n)=>(r,i)=>e(r,i)||n(r,i)})}});function BX(t){let e=0;return t.iterChangedRanges((n,r)=>e=r),e}const gM=Cn.define({create(){return Fi.empty},update(t,e){let n=e.state.facet(mM),r=e.annotation(Jw);if(r){let l=e.docChanged?te.single(BX(e.changes)):void 0,u=qn.fromTransaction(e,l),c=r.side,d=c==0?t.undone:t.done;return u?d=km(d,d.length,n.minDepth,u):d=wM(d,e.startState.selection),new Fi(c==0?r.rest:d,c==0?d:r.rest)}let i=e.annotation(IX);if((i=="full"||i=="before")&&(t=t.isolate()),e.annotation(Gt.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let s=qn.fromTransaction(e),o=e.annotation(Gt.time),a=e.annotation(Gt.userEvent);return s?t=t.addChanges(s,o,a,n,e):e.selection&&(t=t.addSelection(e.startState.selection,o,a,n.newGroupDelay)),(i=="full"||i=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new Fi(t.done.map(qn.fromJSON),t.undone.map(qn.fromJSON))}});function jX(t={}){return[gM,mM.of(t),Ae.domEventHandlers({beforeinput(e,n){let r=e.inputType=="historyUndo"?yM:e.inputType=="historyRedo"?Yw:null;return r?(e.preventDefault(),r(n)):!1}})]}function Jx(t,e){return function({state:n,dispatch:r}){if(!e&&n.readOnly)return!1;let i=n.field(gM,!1);if(!i)return!1;let s=i.pop(t,n,e);return s?(r(s),!0):!1}}const yM=Jx(0,!1),Yw=Jx(1,!1),zX=Jx(0,!0);class qn{constructor(e,n,r,i,s){this.changes=e,this.effects=n,this.mapped=r,this.startSelection=i,this.selectionsAfter=s}setSelAfter(e){return new qn(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,n,r;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(n=this.mapped)===null||n===void 0?void 0:n.toJSON(),startSelection:(r=this.startSelection)===null||r===void 0?void 0:r.toJSON(),selectionsAfter:this.selectionsAfter.map(i=>i.toJSON())}}static fromJSON(e){return new qn(e.changes&&Vt.fromJSON(e.changes),[],e.mapped&&Hi.fromJSON(e.mapped),e.startSelection&&te.fromJSON(e.startSelection),e.selectionsAfter.map(te.fromJSON))}static fromTransaction(e,n){let r=Br;for(let i of e.startState.facet(LX)){let s=i(e);s.length&&(r=r.concat(s))}return!r.length&&e.changes.empty?null:new qn(e.changes.invert(e.startState.doc),r,void 0,n||e.startState.selection,Br)}static selection(e){return new qn(void 0,Br,void 0,void 0,e)}}function km(t,e,n,r){let i=e+1>n+20?e-n-1:0,s=t.slice(i,e);return s.push(r),s}function FX(t,e){let n=[],r=!1;return t.iterChangedRanges((i,s)=>n.push(i,s)),e.iterChangedRanges((i,s,o,a)=>{for(let l=0;l<n.length;){let u=n[l++],c=n[l++];a>=u&&o<=c&&(r=!0)}}),r}function UX(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((n,r)=>n.empty!=e.ranges[r].empty).length===0}function vM(t,e){return t.length?e.length?t.concat(e):t:e}const Br=[],VX=200;function wM(t,e){if(t.length){let n=t[t.length-1],r=n.selectionsAfter.slice(Math.max(0,n.selectionsAfter.length-VX));return r.length&&r[r.length-1].eq(e)?t:(r.push(e),km(t,t.length-1,1e9,n.setSelAfter(r)))}else return[qn.selection([e])]}function HX(t){let e=t[t.length-1],n=t.slice();return n[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),n}function xy(t,e){if(!t.length)return t;let n=t.length,r=Br;for(;n;){let i=WX(t[n-1],e,r);if(i.changes&&!i.changes.empty||i.effects.length){let s=t.slice(0,n);return s[n-1]=i,s}else e=i.mapped,n--,r=i.selectionsAfter}return r.length?[qn.selection(r)]:Br}function WX(t,e,n){let r=vM(t.selectionsAfter.length?t.selectionsAfter.map(a=>a.map(e)):Br,n);if(!t.changes)return qn.selection(r);let i=t.changes.map(e),s=e.mapDesc(t.changes,!0),o=t.mapped?t.mapped.composeDesc(s):s;return new qn(i,ze.mapEffects(t.effects,e),o,t.startSelection.map(s),r)}const GX=/^(input\.type|delete)($|\.)/;class Fi{constructor(e,n,r=0,i=void 0){this.done=e,this.undone=n,this.prevTime=r,this.prevUserEvent=i}isolate(){return this.prevTime?new Fi(this.done,this.undone):this}addChanges(e,n,r,i,s){let o=this.done,a=o[o.length-1];return a&&a.changes&&!a.changes.empty&&e.changes&&(!r||GX.test(r))&&(!a.selectionsAfter.length&&n-this.prevTime<i.newGroupDelay&&i.joinToEvent(s,FX(a.changes,e.changes))||r=="input.type.compose")?o=km(o,o.length-1,i.minDepth,new qn(e.changes.compose(a.changes),vM(e.effects,a.effects),a.mapped,a.startSelection,Br)):o=km(o,o.length,i.minDepth,e),new Fi(o,Br,n,r)}addSelection(e,n,r,i){let s=this.done.length?this.done[this.done.length-1].selectionsAfter:Br;return s.length>0&&n-this.prevTime<i&&r==this.prevUserEvent&&r&&/^select($|\.)/.test(r)&&UX(s[s.length-1],e)?this:new Fi(wM(this.done,e),this.undone,n,r)}addMapping(e){return new Fi(xy(this.done,e),xy(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,n,r){let i=e==0?this.done:this.undone;if(i.length==0)return null;let s=i[i.length-1];if(r&&s.selectionsAfter.length)return n.update({selection:s.selectionsAfter[s.selectionsAfter.length-1],annotations:Jw.of({side:e,rest:HX(i)}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(s.changes){let o=i.length==1?Br:i.slice(0,i.length-1);return s.mapped&&(o=xy(o,s.mapped)),n.update({changes:s.changes,selection:s.startSelection,effects:s.effects,annotations:Jw.of({side:e,rest:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Fi.empty=new Fi(Br,Br);function ch(t,e){return te.create(t.ranges.map(e),t.mainIndex)}function Ko(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Ya({state:t,dispatch:e},n){let r=ch(t.selection,n);return r.eq(t.selection)?!1:(e(Ko(t,r)),!0)}function Mg(t,e){return te.cursor(e?t.to:t.from)}function bM(t,e){return Ya(t,n=>n.empty?t.moveByChar(n,e):Mg(n,e))}function Xo(t){return t.textDirectionAt(t.state.selection.main.head)==Tt.LTR}const c2=t=>bM(t,!Xo(t)),d2=t=>bM(t,Xo(t));function xM(t,e){return Ya(t,n=>n.empty?t.moveByGroup(n,e):Mg(n,e))}const KX=t=>xM(t,!Xo(t)),XX=t=>xM(t,Xo(t));function SM(t,e){return Ya(t,n=>{if(!n.empty)return Mg(n,e);let r=t.moveVertically(n,e);return r.head!=n.head?r:t.moveToLineBoundary(n,e)})}const h2=t=>SM(t,!1),f2=t=>SM(t,!0);function kM(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,n=0,r=0,i;if(e){for(let s of t.state.facet(Ae.scrollMargins)){let o=s(t);o!=null&&o.top&&(n=Math.max(o==null?void 0:o.top,n)),o!=null&&o.bottom&&(r=Math.max(o==null?void 0:o.bottom,r))}i=t.scrollDOM.clientHeight-n-r}else i=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:n,marginBottom:r,selfScroll:e,height:Math.max(t.defaultLineHeight,i-5)}}function CM(t,e){let n=kM(t),{state:r}=t,i=ch(r.selection,o=>o.empty?t.moveVertically(o,e,n.height):Mg(o,e));if(i.eq(r.selection))return!1;let s;if(n.selfScroll){let o=t.coordsAtPos(r.selection.main.head),a=t.scrollDOM.getBoundingClientRect(),l=a.top+n.marginTop,u=a.bottom-n.marginBottom;o&&o.top>l&&o.bottom<u&&(s=Ae.scrollIntoView(i.main.head,{y:"start",yMargin:o.top-l}))}return t.dispatch(Ko(r,i),{effects:s}),!0}const Sy=t=>CM(t,!1),ky=t=>CM(t,!0);function Dg(t,e,n){let r=t.lineBlockAt(e.head),i=t.moveToLineBoundary(e,n);if(i.head==e.head&&i.head!=(n?r.to:r.from)&&(i=t.moveToLineBoundary(e,n,!1)),!n&&i.head==r.from&&r.length){let s=/^\s*/.exec(t.state.sliceDoc(r.from,Math.min(r.from+100,r.to)))[0].length;s&&e.head!=r.from+s&&(i=te.cursor(r.from+s))}return i}const p2=t=>Ya(t,e=>Dg(t,e,!0)),m2=t=>Ya(t,e=>Dg(t,e,!1)),ZX=t=>Ya(t,e=>te.cursor(t.lineBlockAt(e.head).from,1)),JX=t=>Ya(t,e=>te.cursor(t.lineBlockAt(e.head).to,-1));function YX(t,e,n){let r=!1,i=ch(t.selection,s=>{let o=pf(t,s.head,-1)||pf(t,s.head,1)||s.head>0&&pf(t,s.head-1,1)||s.head<t.doc.length&&pf(t,s.head+1,-1);if(!o||!o.end)return s;r=!0;let a=o.start.from==s.head?o.end.to:o.end.from;return n?te.range(s.anchor,a):te.cursor(a)});return r?(e(Ko(t,i)),!0):!1}const qX=({state:t,dispatch:e})=>YX(t,e,!1);function Zo(t,e){let n=ch(t.state.selection,r=>{let i=e(r);return te.range(r.anchor,i.head,i.goalColumn,i.bidiLevel||void 0)});return n.eq(t.state.selection)?!1:(t.dispatch(Ko(t.state,n)),!0)}function EM(t,e){return Zo(t,n=>t.moveByChar(n,e))}const g2=t=>EM(t,!Xo(t)),y2=t=>EM(t,Xo(t));function AM(t,e){return Zo(t,n=>t.moveByGroup(n,e))}const QX=t=>AM(t,!Xo(t)),eZ=t=>AM(t,Xo(t));function PM(t,e){return Zo(t,n=>t.moveVertically(n,e))}const v2=t=>PM(t,!1),w2=t=>PM(t,!0);function TM(t,e){return Zo(t,n=>t.moveVertically(n,e,kM(t).height))}const b2=t=>TM(t,!1),x2=t=>TM(t,!0),S2=t=>Zo(t,e=>Dg(t,e,!0)),k2=t=>Zo(t,e=>Dg(t,e,!1)),tZ=t=>Zo(t,e=>te.cursor(t.lineBlockAt(e.head).from)),nZ=t=>Zo(t,e=>te.cursor(t.lineBlockAt(e.head).to)),C2=({state:t,dispatch:e})=>(e(Ko(t,{anchor:0})),!0),E2=({state:t,dispatch:e})=>(e(Ko(t,{anchor:t.doc.length})),!0),A2=({state:t,dispatch:e})=>(e(Ko(t,{anchor:t.selection.main.anchor,head:0})),!0),P2=({state:t,dispatch:e})=>(e(Ko(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),rZ=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),iZ=({state:t,dispatch:e})=>{let n=Lg(t).map(({from:r,to:i})=>te.range(r,Math.min(i+1,t.doc.length)));return e(t.update({selection:te.create(n),userEvent:"select"})),!0};function Ig(t,e){if(t.state.readOnly)return!1;let n="delete.selection",{state:r}=t,i=r.changeByRange(s=>{let{from:o,to:a}=s;if(o==a){let l=e(o);l<o?(n="delete.backward",l=mf(t,l,!1)):l>o&&(n="delete.forward",l=mf(t,l,!0)),o=Math.min(o,l),a=Math.max(a,l)}else o=mf(t,o,!1),a=mf(t,a,!0);return o==a?{range:s}:{changes:{from:o,to:a},range:te.cursor(o)}});return i.changes.empty?!1:(t.dispatch(r.update(i,{scrollIntoView:!0,userEvent:n,effects:n=="delete.selection"?Ae.announce.of(r.phrase("Selection deleted")):void 0})),!0)}function mf(t,e,n){if(t instanceof Ae)for(let r of t.state.facet(Ae.atomicRanges).map(i=>i(t)))r.between(e,e,(i,s)=>{i<e&&s>e&&(e=n?s:i)});return e}const $M=(t,e)=>Ig(t,n=>{let{state:r}=t,i=r.doc.lineAt(n),s,o;if(!e&&n>i.from&&n<i.from+200&&!/[^ \t]/.test(s=i.text.slice(0,n-i.from))){if(s[s.length-1]=="	")return n-1;let a=cg(s,r.tabSize),l=a%Sm(r)||Sm(r);for(let u=0;u<l&&s[s.length-1-u]==" ";u++)n--;o=n}else o=bn(i.text,n-i.from,e,e)+i.from,o==n&&i.number!=(e?r.doc.lines:1)&&(o+=e?1:-1);return o}),Cy=t=>$M(t,!1),T2=t=>$M(t,!0),NM=(t,e)=>Ig(t,n=>{let r=n,{state:i}=t,s=i.doc.lineAt(r),o=i.charCategorizer(r);for(let a=null;;){if(r==(e?s.to:s.from)){r==n&&s.number!=(e?i.doc.lines:1)&&(r+=e?1:-1);break}let l=bn(s.text,r-s.from,e)+s.from,u=s.text.slice(Math.min(r,l)-s.from,Math.max(r,l)-s.from),c=o(u);if(a!=null&&c!=a)break;(u!=" "||r!=n)&&(a=c),r=l}return r}),$2=t=>NM(t,!1),sZ=t=>NM(t,!0),N2=t=>Ig(t,e=>{let n=t.lineBlockAt(e).to;return e<n?n:Math.min(t.state.doc.length,e+1)}),oZ=t=>Ig(t,e=>{let n=t.lineBlockAt(e).from;return e>n?n:Math.max(0,e-1)}),aZ=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:qe.of(["",""])},range:te.cursor(r.from)}));return e(t.update(n,{scrollIntoView:!0,userEvent:"input"})),!0},lZ=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let n=t.changeByRange(r=>{if(!r.empty||r.from==0||r.from==t.doc.length)return{range:r};let i=r.from,s=t.doc.lineAt(i),o=i==s.from?i-1:bn(s.text,i-s.from,!1)+s.from,a=i==s.to?i+1:bn(s.text,i-s.from,!0)+s.from;return{changes:{from:o,to:a,insert:t.doc.slice(i,a).append(t.doc.slice(o,i))},range:te.cursor(a)}});return n.changes.empty?!1:(e(t.update(n,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Lg(t){let e=[],n=-1;for(let r of t.selection.ranges){let i=t.doc.lineAt(r.from),s=t.doc.lineAt(r.to);if(!r.empty&&r.to==s.from&&(s=t.doc.lineAt(r.to-1)),n>=i.number){let o=e[e.length-1];o.to=s.to,o.ranges.push(r)}else e.push({from:i.from,to:s.to,ranges:[r]});n=s.number+1}return e}function OM(t,e,n){if(t.readOnly)return!1;let r=[],i=[];for(let s of Lg(t)){if(n?s.to==t.doc.length:s.from==0)continue;let o=t.doc.lineAt(n?s.to+1:s.from-1),a=o.length+1;if(n){r.push({from:s.to,to:o.to},{from:s.from,insert:o.text+t.lineBreak});for(let l of s.ranges)i.push(te.range(Math.min(t.doc.length,l.anchor+a),Math.min(t.doc.length,l.head+a)))}else{r.push({from:o.from,to:s.from},{from:s.to,insert:t.lineBreak+o.text});for(let l of s.ranges)i.push(te.range(l.anchor-a,l.head-a))}}return r.length?(e(t.update({changes:r,scrollIntoView:!0,selection:te.create(i,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}const uZ=({state:t,dispatch:e})=>OM(t,e,!1),cZ=({state:t,dispatch:e})=>OM(t,e,!0);function _M(t,e,n){if(t.readOnly)return!1;let r=[];for(let i of Lg(t))n?r.push({from:i.from,insert:t.doc.slice(i.from,i.to)+t.lineBreak}):r.push({from:i.to,insert:t.lineBreak+t.doc.slice(i.from,i.to)});return e(t.update({changes:r,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const dZ=({state:t,dispatch:e})=>_M(t,e,!1),hZ=({state:t,dispatch:e})=>_M(t,e,!0),fZ=t=>{if(t.state.readOnly)return!1;let{state:e}=t,n=e.changes(Lg(e).map(({from:i,to:s})=>(i>0?i--:s<e.doc.length&&s++,{from:i,to:s}))),r=ch(e.selection,i=>t.moveVertically(i,!0)).map(n);return t.dispatch({changes:n,selection:r,scrollIntoView:!0,userEvent:"delete.line"}),!0};function pZ(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let n=vu(t).resolveInner(e),r=n.childBefore(e),i=n.childAfter(e),s;return r&&i&&r.to<=e&&i.from>=e&&(s=r.type.prop(St.closedBy))&&s.indexOf(i.name)>-1&&t.doc.lineAt(r.to).from==t.doc.lineAt(i.from).from?{from:r.to,to:i.from}:null}const O2=mZ(!1);function mZ(t){return({state:e,dispatch:n})=>{if(e.readOnly)return!1;let r=e.changeByRange(i=>{let{from:s,to:o}=i,a=e.doc.lineAt(s),l=!t&&s==o&&pZ(e,s);t&&(s=o=(o<=a.to?a:e.doc.lineAt(o)).to);let u=new Gx(e,{simulateBreak:s,simulateDoubleBreak:!!l}),c=dX(u,s);for(c==null&&(c=/^\s*/.exec(e.doc.lineAt(s).text)[0].length);o<a.to&&/\s/.test(a.text[o-a.from]);)o++;l?{from:s,to:o}=l:s>a.from&&s<a.from+100&&!/\S/.test(a.text.slice(0,s))&&(s=a.from);let d=["",Kw(e,c)];return l&&d.push(Kw(e,u.lineIndent(a.from,-1))),{changes:{from:s,to:o,insert:qe.of(d)},range:te.cursor(s+1+d[1].length)}});return n(e.update(r,{scrollIntoView:!0,userEvent:"input"})),!0}}function RM(t,e){let n=-1;return t.changeByRange(r=>{let i=[];for(let o=r.from;o<=r.to;){let a=t.doc.lineAt(o);a.number>n&&(r.empty||r.to>a.from)&&(e(a,i,r),n=a.number),o=a.to+1}let s=t.changes(i);return{changes:i,range:te.range(s.mapPos(r.anchor,1),s.mapPos(r.head,1))}})}const qw=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(RM(t,(n,r)=>{r.push({from:n.from,insert:t.facet(Wx)})}),{userEvent:"input.indent"})),!0),_2=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(RM(t,(n,r)=>{let i=/^\s*/.exec(n.text)[0];if(!i)return;let s=cg(i,t.tabSize),o=0,a=Kw(t,Math.max(0,s-Sm(t)));for(;o<i.length&&o<a.length&&i.charCodeAt(o)==a.charCodeAt(o);)o++;r.push({from:n.from+o,to:n.from+i.length,insert:a.slice(o)})}),{userEvent:"delete.dedent"})),!0);function ut(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,n=arguments[1];if(n&&typeof n=="object"&&n.nodeType==null&&!Array.isArray(n)){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var i=n[r];typeof i=="string"?t.setAttribute(r,i):i!=null&&(t[r]=i)}e++}for(;e<arguments.length;e++)MM(t,arguments[e]);return t}function MM(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var n=0;n<e.length;n++)MM(t,e[n]);else throw new RangeError("Unsupported child node: "+e)}const R2=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t;class zd{constructor(e,n,r=0,i=e.length,s,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(r,i),this.bufferStart=r,this.normalize=s?a=>s(R2(a)):R2,this.query=this.normalize(n)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return $n(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let n=M1(e),r=this.bufferStart+this.bufferPos;this.bufferPos+=ii(e);let i=this.normalize(n);for(let s=0,o=r;;s++){let a=i.charCodeAt(s),l=this.match(a,o);if(s==i.length-1){if(l)return this.value=l,this;break}o==r&&s<n.length&&n.charCodeAt(s)==a&&o++}}}match(e,n){let r=null;for(let i=0;i<this.matches.length;i+=2){let s=this.matches[i],o=!1;this.query.charCodeAt(s)==e&&(s==this.query.length-1?r={from:this.matches[i+1],to:n+1}:(this.matches[i]++,o=!0)),o||(this.matches.splice(i,2),i-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?r={from:n,to:n+1}:this.matches.push(1,n)),r&&this.test&&!this.test(r.from,r.to,this.buffer,this.bufferPos)&&(r=null),r}}typeof Symbol<"u"&&(zd.prototype[Symbol.iterator]=function(){return this});const DM={from:-1,to:-1,match:/.*/.exec("")},Yx="gm"+(/x/.unicode==null?"":"u");class IM{constructor(e,n,r,i=0,s=e.length){if(this.text=e,this.to=s,this.curLine="",this.done=!1,this.value=DM,/\\[sWDnr]|\n|\r|\[\^/.test(n))return new LM(e,n,r,i,s);this.re=new RegExp(n,Yx+(r!=null&&r.ignoreCase?"i":"")),this.test=r==null?void 0:r.test,this.iter=e.iter();let o=e.lineAt(i);this.curLineStart=o.from,this.matchPos=Cm(e,i),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let n=this.matchPos<=this.to&&this.re.exec(this.curLine);if(n){let r=this.curLineStart+n.index,i=r+n[0].length;if(this.matchPos=Cm(this.text,i+(r==i?1:0)),r==this.curLineStart+this.curLine.length&&this.nextLine(),(r<i||r>this.value.to)&&(!this.test||this.test(r,i,n)))return this.value={from:r,to:i,match:n},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const Ey=new WeakMap;class Vl{constructor(e,n){this.from=e,this.text=n}get to(){return this.from+this.text.length}static get(e,n,r){let i=Ey.get(e);if(!i||i.from>=r||i.to<=n){let a=new Vl(n,e.sliceString(n,r));return Ey.set(e,a),a}if(i.from==n&&i.to==r)return i;let{text:s,from:o}=i;return o>n&&(s=e.sliceString(n,o)+s,o=n),i.to<r&&(s+=e.sliceString(i.to,r)),Ey.set(e,new Vl(o,s)),new Vl(n,s.slice(n-o,r-o))}}class LM{constructor(e,n,r,i,s){this.text=e,this.to=s,this.done=!1,this.value=DM,this.matchPos=Cm(e,i),this.re=new RegExp(n,Yx+(r!=null&&r.ignoreCase?"i":"")),this.test=r==null?void 0:r.test,this.flat=Vl.get(e,i,this.chunkEnd(i+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,n=this.re.exec(this.flat.text);if(n&&!n[0]&&n.index==e&&(this.re.lastIndex=e+1,n=this.re.exec(this.flat.text)),n){let r=this.flat.from+n.index,i=r+n[0].length;if((this.flat.to>=this.to||n.index+n[0].length<=this.flat.text.length-10)&&(!this.test||this.test(r,i,n)))return this.value={from:r,to:i,match:n},this.matchPos=Cm(this.text,i+(r==i?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=Vl.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(IM.prototype[Symbol.iterator]=LM.prototype[Symbol.iterator]=function(){return this});function gZ(t){try{return new RegExp(t,Yx),!0}catch{return!1}}function Cm(t,e){if(e>=t.length)return e;let n=t.lineAt(e),r;for(;e<n.to&&(r=n.text.charCodeAt(e-n.from))>=56320&&r<57344;)e++;return e}function Qw(t){let e=ut("input",{class:"cm-textfield",name:"line"}),n=ut("form",{class:"cm-gotoLine",onkeydown:i=>{i.keyCode==27?(i.preventDefault(),t.dispatch({effects:Em.of(!1)}),t.focus()):i.keyCode==13&&(i.preventDefault(),r())},onsubmit:i=>{i.preventDefault(),r()}},ut("label",t.state.phrase("Go to line"),": ",e)," ",ut("button",{class:"cm-button",type:"submit"},t.state.phrase("go")));function r(){let i=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(e.value);if(!i)return;let{state:s}=t,o=s.doc.lineAt(s.selection.main.head),[,a,l,u,c]=i,d=u?+u.slice(1):0,h=l?+l:o.number;if(l&&c){let g=h/100;a&&(g=g*(a=="-"?-1:1)+o.number/s.doc.lines),h=Math.round(s.doc.lines*g)}else l&&a&&(h=h*(a=="-"?-1:1)+o.number);let f=s.doc.line(Math.max(1,Math.min(s.doc.lines,h))),p=te.cursor(f.from+Math.max(0,Math.min(d,f.length)));t.dispatch({effects:[Em.of(!1),Ae.scrollIntoView(p.from,{y:"center"})],selection:p}),t.focus()}return{dom:n}}const Em=ze.define(),M2=Cn.define({create(){return!0},update(t,e){for(let n of e.effects)n.is(Em)&&(t=n.value);return t},provide:t=>Td.from(t,e=>e?Qw:null)}),yZ=t=>{let e=Pd(t,Qw);if(!e){let n=[Em.of(!0)];t.state.field(M2,!1)==null&&n.push(ze.appendConfig.of([M2,vZ])),t.dispatch({effects:n}),e=Pd(t,Qw)}return e&&e.dom.querySelector("input").focus(),!0},vZ=Ae.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),wZ=({state:t,dispatch:e})=>{let{selection:n}=t,r=te.create(n.ranges.map(i=>t.wordAt(i.head)||te.cursor(i.head)),n.mainIndex);return r.eq(n)?!1:(e(t.update({selection:r})),!0)};function bZ(t,e){let{main:n,ranges:r}=t.selection,i=t.wordAt(n.head),s=i&&i.from==n.from&&i.to==n.to;for(let o=!1,a=new zd(t.doc,e,r[r.length-1].to);;)if(a.next(),a.done){if(o)return null;a=new zd(t.doc,e,0,Math.max(0,r[r.length-1].from-1)),o=!0}else{if(o&&r.some(l=>l.from==a.value.from))continue;if(s){let l=t.wordAt(a.value.from);if(!l||l.from!=a.value.from||l.to!=a.value.to)continue}return a.value}}const xZ=({state:t,dispatch:e})=>{let{ranges:n}=t.selection;if(n.some(s=>s.from===s.to))return wZ({state:t,dispatch:e});let r=t.sliceDoc(n[0].from,n[0].to);if(t.selection.ranges.some(s=>t.sliceDoc(s.from,s.to)!=r))return!1;let i=bZ(t,r);return i?(e(t.update({selection:t.selection.addRange(te.range(i.from,i.to),!1),effects:Ae.scrollIntoView(i.to)})),!0):!1},Iu=Se.define({combine(t){return Wo(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new NZ(e),scrollToMatch:e=>Ae.scrollIntoView(e)})}});class BM{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||gZ(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(n,r)=>r=="n"?`
`:r=="r"?"\r":r=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new EZ(this):new kZ(this)}getCursor(e,n=0,r){let i=e.doc?e:Ue.create({doc:e});return r==null&&(r=i.doc.length),this.regexp?cl(this,i,n,r):ul(this,i,n,r)}}class jM{constructor(e){this.spec=e}}function ul(t,e,n,r){return new zd(e.doc,t.unquoted,n,r,t.caseSensitive?void 0:i=>i.toLowerCase(),t.wholeWord?SZ(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function SZ(t,e){return(n,r,i,s)=>((s>n||s+i.length<r)&&(s=Math.max(0,n-2),i=t.sliceString(s,Math.min(t.length,r+2))),(e(Am(i,n-s))!=ln.Word||e(Pm(i,n-s))!=ln.Word)&&(e(Pm(i,r-s))!=ln.Word||e(Am(i,r-s))!=ln.Word))}class kZ extends jM{constructor(e){super(e)}nextMatch(e,n,r){let i=ul(this.spec,e,r,e.doc.length).nextOverlapping();return i.done&&(i=ul(this.spec,e,0,n).nextOverlapping()),i.done?null:i.value}prevMatchInRange(e,n,r){for(let i=r;;){let s=Math.max(n,i-1e4-this.spec.unquoted.length),o=ul(this.spec,e,s,i),a=null;for(;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(s==n)return null;i-=1e4}}prevMatch(e,n,r){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,n){let r=ul(this.spec,e,0,e.doc.length),i=[];for(;!r.next().done;){if(i.length>=n)return null;i.push(r.value)}return i}highlight(e,n,r,i){let s=ul(this.spec,e,Math.max(0,n-this.spec.unquoted.length),Math.min(r+this.spec.unquoted.length,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}function cl(t,e,n,r){return new IM(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?CZ(e.charCategorizer(e.selection.main.head)):void 0},n,r)}function Am(t,e){return t.slice(bn(t,e,!1),e)}function Pm(t,e){return t.slice(e,bn(t,e))}function CZ(t){return(e,n,r)=>!r[0].length||(t(Am(r.input,r.index))!=ln.Word||t(Pm(r.input,r.index))!=ln.Word)&&(t(Pm(r.input,r.index+r[0].length))!=ln.Word||t(Am(r.input,r.index+r[0].length))!=ln.Word)}class EZ extends jM{nextMatch(e,n,r){let i=cl(this.spec,e,r,e.doc.length).next();return i.done&&(i=cl(this.spec,e,0,n).next()),i.done?null:i.value}prevMatchInRange(e,n,r){for(let i=1;;i++){let s=Math.max(n,r-i*1e4),o=cl(this.spec,e,s,r),a=null;for(;!o.next().done;)a=o.value;if(a&&(s==n||a.from>s+10))return a;if(s==n)return null}}prevMatch(e,n,r){return this.prevMatchInRange(e,0,n)||this.prevMatchInRange(e,r,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace.replace(/\$([$&\d+])/g,(n,r)=>r=="$"?"$":r=="&"?e.match[0]:r!="0"&&+r<e.match.length?e.match[r]:n))}matchAll(e,n){let r=cl(this.spec,e,0,e.doc.length),i=[];for(;!r.next().done;){if(i.length>=n)return null;i.push(r.value)}return i}highlight(e,n,r,i){let s=cl(this.spec,e,Math.max(0,n-250),Math.min(r+250,e.doc.length));for(;!s.next().done;)i(s.value.from,s.value.to)}}const Fd=ze.define(),qx=ze.define(),Po=Cn.define({create(t){return new Ay(eb(t).create(),null)},update(t,e){for(let n of e.effects)n.is(Fd)?t=new Ay(n.value.create(),t.panel):n.is(qx)&&(t=new Ay(t.query,n.value?Qx:null));return t},provide:t=>Td.from(t,e=>e.panel)});class Ay{constructor(e,n){this.query=e,this.panel=n}}const AZ=Ze.mark({class:"cm-searchMatch"}),PZ=Ze.mark({class:"cm-searchMatch cm-searchMatch-selected"}),TZ=hn.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(Po))}update(t){let e=t.state.field(Po);(e!=t.startState.field(Po)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return Ze.none;let{view:n}=this,r=new ja;for(let i=0,s=n.visibleRanges,o=s.length;i<o;i++){let{from:a,to:l}=s[i];for(;i<o-1&&l>s[i+1].from-2*250;)l=s[++i].to;t.highlight(n.state,a,l,(u,c)=>{let d=n.state.selection.ranges.some(h=>h.from==u&&h.to==c);r.add(u,c,d?PZ:AZ)})}return r.finish()}},{decorations:t=>t.decorations});function dh(t){return e=>{let n=e.state.field(Po,!1);return n&&n.query.spec.valid?t(e,n):HM(e)}}const D2=dh((t,{query:e})=>{let{to:n}=t.state.selection.main,r=e.nextMatch(t.state,n,n);if(!r)return!1;let i=te.single(r.from,r.to),s=t.state.facet(Iu);return t.dispatch({selection:i,effects:[eS(t,r),s.scrollToMatch(i.main,t)],userEvent:"select.search"}),VM(t),!0}),I2=dh((t,{query:e})=>{let{state:n}=t,{from:r}=n.selection.main,i=e.prevMatch(n,r,r);if(!i)return!1;let s=te.single(i.from,i.to),o=t.state.facet(Iu);return t.dispatch({selection:s,effects:[eS(t,i),o.scrollToMatch(s.main,t)],userEvent:"select.search"}),VM(t),!0}),zM=dh((t,{query:e})=>{let n=e.matchAll(t.state,1e3);return!n||!n.length?!1:(t.dispatch({selection:te.create(n.map(r=>te.range(r.from,r.to))),userEvent:"select.search.matches"}),!0)}),$Z=({state:t,dispatch:e})=>{let n=t.selection;if(n.ranges.length>1||n.main.empty)return!1;let{from:r,to:i}=n.main,s=[],o=0;for(let a=new zd(t.doc,t.sliceDoc(r,i));!a.next().done;){if(s.length>1e3)return!1;a.value.from==r&&(o=s.length),s.push(te.range(a.value.from,a.value.to))}return e(t.update({selection:te.create(s,o),userEvent:"select.search.matches"})),!0},L2=dh((t,{query:e})=>{let{state:n}=t,{from:r,to:i}=n.selection.main;if(n.readOnly)return!1;let s=e.nextMatch(n,r,r);if(!s)return!1;let o=[],a,l,u=[];if(s.from==r&&s.to==i&&(l=n.toText(e.getReplacement(s)),o.push({from:s.from,to:s.to,insert:l}),s=e.nextMatch(n,s.from,s.to),u.push(Ae.announce.of(n.phrase("replaced match on line $",n.doc.lineAt(r).number)+"."))),s){let c=o.length==0||o[0].from>=s.to?0:s.to-s.from-l.length;a=te.single(s.from-c,s.to-c),u.push(eS(t,s)),u.push(n.facet(Iu).scrollToMatch(a.main,t))}return t.dispatch({changes:o,selection:a,effects:u,userEvent:"input.replace"}),!0}),FM=dh((t,{query:e})=>{if(t.state.readOnly)return!1;let n=e.matchAll(t.state,1e9).map(i=>{let{from:s,to:o}=i;return{from:s,to:o,insert:e.getReplacement(i)}});if(!n.length)return!1;let r=t.state.phrase("replaced $ matches",n.length)+".";return t.dispatch({changes:n,effects:Ae.announce.of(r),userEvent:"input.replace.all"}),!0});function Qx(t){return t.state.facet(Iu).createPanel(t)}function eb(t,e){var n,r,i,s,o;let a=t.selection.main,l=a.empty||a.to>a.from+100?"":t.sliceDoc(a.from,a.to);if(e&&!l)return e;let u=t.facet(Iu);return new BM({search:((n=e==null?void 0:e.literal)!==null&&n!==void 0?n:u.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(r=e==null?void 0:e.caseSensitive)!==null&&r!==void 0?r:u.caseSensitive,literal:(i=e==null?void 0:e.literal)!==null&&i!==void 0?i:u.literal,regexp:(s=e==null?void 0:e.regexp)!==null&&s!==void 0?s:u.regexp,wholeWord:(o=e==null?void 0:e.wholeWord)!==null&&o!==void 0?o:u.wholeWord})}function UM(t){let e=Pd(t,Qx);return e&&e.dom.querySelector("[main-field]")}function VM(t){let e=UM(t);e&&e==t.root.activeElement&&e.select()}const HM=t=>{let e=t.state.field(Po,!1);if(e&&e.panel){let n=UM(t);if(n&&n!=t.root.activeElement){let r=eb(t.state,e.query.spec);r.valid&&t.dispatch({effects:Fd.of(r)}),n.focus(),n.select()}}else t.dispatch({effects:[qx.of(!0),e?Fd.of(eb(t.state,e.query.spec)):ze.appendConfig.of(_Z)]});return!0},WM=t=>{let e=t.state.field(Po,!1);if(!e||!e.panel)return!1;let n=Pd(t,Qx);return n&&n.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:qx.of(!1)}),!0};class NZ{constructor(e){this.view=e;let n=this.query=e.state.field(Po).query.spec;this.commit=this.commit.bind(this),this.searchField=ut("input",{value:n.search,placeholder:ir(e,"Find"),"aria-label":ir(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=ut("input",{value:n.replace,placeholder:ir(e,"Replace"),"aria-label":ir(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=ut("input",{type:"checkbox",name:"case",form:"",checked:n.caseSensitive,onchange:this.commit}),this.reField=ut("input",{type:"checkbox",name:"re",form:"",checked:n.regexp,onchange:this.commit}),this.wordField=ut("input",{type:"checkbox",name:"word",form:"",checked:n.wholeWord,onchange:this.commit});function r(i,s,o){return ut("button",{class:"cm-button",name:i,onclick:s,type:"button"},o)}this.dom=ut("div",{onkeydown:i=>this.keydown(i),class:"cm-search"},[this.searchField,r("next",()=>D2(e),[ir(e,"next")]),r("prev",()=>I2(e),[ir(e,"previous")]),r("select",()=>zM(e),[ir(e,"all")]),ut("label",null,[this.caseField,ir(e,"match case")]),ut("label",null,[this.reField,ir(e,"regexp")]),ut("label",null,[this.wordField,ir(e,"by word")]),...e.state.readOnly?[]:[ut("br"),this.replaceField,r("replace",()=>L2(e),[ir(e,"replace")]),r("replaceAll",()=>FM(e),[ir(e,"replace all")])],ut("button",{name:"close",onclick:()=>WM(e),"aria-label":ir(e,"close"),type:"button"},[""])])}commit(){let e=new BM({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:Fd.of(e)}))}keydown(e){mj(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?I2:D2)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),L2(this.view))}update(e){for(let n of e.transactions)for(let r of n.effects)r.is(Fd)&&!r.value.eq(this.query)&&this.setQuery(r.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Iu).top}}function ir(t,e){return t.state.phrase(e)}const gf=30,yf=/[\s\.,:;?!]/;function eS(t,{from:e,to:n}){let r=t.state.doc.lineAt(e),i=t.state.doc.lineAt(n).to,s=Math.max(r.from,e-gf),o=Math.min(i,n+gf),a=t.state.sliceDoc(s,o);if(s!=r.from){for(let l=0;l<gf;l++)if(!yf.test(a[l+1])&&yf.test(a[l])){a=a.slice(l);break}}if(o!=i){for(let l=a.length-1;l>a.length-gf;l--)if(!yf.test(a[l-1])&&yf.test(a[l])){a=a.slice(0,l);break}}return Ae.announce.of(`${t.state.phrase("current match")}. ${a} ${t.state.phrase("on line")} ${r.number}.`)}const OZ=Ae.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),_Z=[Po,qd.lowest(TZ),OZ];var Py;const Al=new Ke;function RZ(t){return Se.define({combine:t?e=>e.concat(t):void 0})}const MZ=new Ke;class ai{constructor(e,n,r=[],i=""){this.data=e,this.name=i,Ue.prototype.hasOwnProperty("tree")||Object.defineProperty(Ue.prototype,"tree",{get(){return Fo(this)}}),this.parser=n,this.extension=[Su.of(this),Ue.languageData.of((s,o,a)=>{let l=B2(s,o,a),u=l.type.prop(Al);if(!u)return[];let c=s.facet(u),d=l.type.prop(MZ);if(d){let h=l.resolve(o-l.from,a);for(let f of d)if(f.test(h,s)){let p=s.facet(f.facet);return f.type=="replace"?p:p.concat(c)}}return c})].concat(r)}isActiveAt(e,n,r=-1){return B2(e,n,r).type.prop(Al)==this.data}findRegions(e){let n=e.facet(Su);if((n==null?void 0:n.data)==this.data)return[{from:0,to:e.doc.length}];if(!n||!n.allowsNesting)return[];let r=[],i=(s,o)=>{if(s.prop(Al)==this.data){r.push({from:o,to:o+s.length});return}let a=s.prop(Ke.mounted);if(a){if(a.tree.prop(Al)==this.data){if(a.overlay)for(let l of a.overlay)r.push({from:l.from+o,to:l.to+o});else r.push({from:o,to:o+s.length});return}else if(a.overlay){let l=r.length;if(i(a.tree,a.overlay[0].from+o),r.length>l)return}}for(let l=0;l<s.children.length;l++){let u=s.children[l];u instanceof dt&&i(u,s.positions[l]+o)}};return i(Fo(e),0),r}get allowsNesting(){return!0}}ai.setState=ze.define();function B2(t,e,n){let r=t.facet(Su),i=Fo(t).topNode;if(!r||r.allowsNesting)for(let s=i;s;s=s.enter(e,n,Jt.ExcludeBuffers))s.type.isTop&&(i=s);return i}function Fo(t){let e=t.field(ai.state,!1);return e?e.tree:dt.empty}class DZ{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,n){let r=this.cursorPos-this.string.length;return e<r||n>=this.cursorPos?this.doc.sliceString(e,n):this.string.slice(e-r,n-r)}}let ic=null;class bu{constructor(e,n,r=[],i,s,o,a,l){this.parser=e,this.state=n,this.fragments=r,this.tree=i,this.treeLen=s,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,n,r){return new bu(e,n,[],dt.empty,0,r,[],null)}startParse(){return this.parser.startParse(new DZ(this.state.doc),this.fragments)}work(e,n){return n!=null&&n>=this.state.doc.length&&(n=void 0),this.tree!=dt.empty&&this.isDone(n??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var r;if(typeof e=="number"){let i=Date.now()+e;e=()=>Date.now()>i}for(this.parse||(this.parse=this.startParse()),n!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>n)&&n<this.state.doc.length&&this.parse.stopAt(n);;){let i=this.parse.advance();if(i)if(this.fragments=this.withoutTempSkipped(fi.addTree(i,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(r=this.parse.stoppedAt)!==null&&r!==void 0?r:this.state.doc.length,this.tree=i,this.parse=null,this.treeLen<(n??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,n;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(n=this.parse.advance()););}),this.treeLen=e,this.tree=n,this.fragments=this.withoutTempSkipped(fi.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let n=ic;ic=this;try{return e()}finally{ic=n}}withoutTempSkipped(e){for(let n;n=this.tempSkipped.pop();)e=j2(e,n.from,n.to);return e}changes(e,n){let{fragments:r,tree:i,treeLen:s,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((u,c,d,h)=>l.push({fromA:u,toA:c,fromB:d,toB:h})),r=fi.applyChanges(r,l),i=dt.empty,s=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let u of this.skipped){let c=e.mapPos(u.from,1),d=e.mapPos(u.to,-1);c<d&&a.push({from:c,to:d})}}}return new bu(this.parser,n,r,i,s,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let n=this.skipped.length;for(let r=0;r<this.skipped.length;r++){let{from:i,to:s}=this.skipped[r];i<e.to&&s>e.from&&(this.fragments=j2(this.fragments,i,s),this.skipped.splice(r--,1))}return this.skipped.length>=n?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,n){this.skipped.push({from:e,to:n})}static getSkippingParser(e){return new class extends Fx{createParse(n,r,i){let s=i[0].from,o=i[i.length-1].to;return{parsedPos:s,advance(){let l=ic;if(l){for(let u of i)l.tempSkipped.push(u);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new dt(Ln.none,[],[],o-s)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let n=this.fragments;return this.treeLen>=e&&n.length&&n[0].from==0&&n[0].to>=e}static get(){return ic}}function j2(t,e,n){return fi.applyChanges(t,[{fromA:e,toA:n,fromB:e,toB:n}])}class xu{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let n=this.context.changes(e.changes,e.state),r=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),n.viewport.to);return n.work(20,r)||n.takeTree(),new xu(n)}static init(e){let n=Math.min(3e3,e.doc.length),r=bu.create(e.facet(Su).parser,e,{from:0,to:n});return r.work(20,n)||r.takeTree(),new xu(r)}}ai.state=Cn.define({create:xu.init,update(t,e){for(let n of e.effects)if(n.is(ai.setState))return n.value;return e.startState.facet(Su)!=e.state.facet(Su)?xu.init(e.state):t.apply(e)}});let GM=t=>{let e=setTimeout(()=>t(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(GM=t=>{let e=-1,n=setTimeout(()=>{e=requestIdleCallback(t,{timeout:500-100})},100);return()=>e<0?clearTimeout(n):cancelIdleCallback(e)});const Ty=typeof navigator<"u"&&(!((Py=navigator.scheduling)===null||Py===void 0)&&Py.isInputPending)?()=>navigator.scheduling.isInputPending():null,IZ=hn.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let n=this.view.state.field(ai.state).context;(n.updateViewport(e.view.viewport)||this.view.viewport.to>n.treeLen)&&this.scheduleWork(),e.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(n)}scheduleWork(){if(this.working)return;let{state:e}=this.view,n=e.field(ai.state);(n.tree!=n.context.tree||!n.context.isDone(e.doc.length))&&(this.working=GM(this.work))}work(e){this.working=null;let n=Date.now();if(this.chunkEnd<n&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=n+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:r,viewport:{to:i}}=this.view,s=r.field(ai.state);if(s.tree==s.context.tree&&s.context.isDone(i+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Ty?Math.max(25,e.timeRemaining()-5):1e9),a=s.context.treeLen<i&&r.doc.length>i+1e3,l=s.context.work(()=>Ty&&Ty()||Date.now()>o,i+(a?0:1e5));this.chunkBudget-=Date.now()-n,(l||this.chunkBudget<=0)&&(s.context.takeTree(),this.view.dispatch({effects:ai.setState.of(new xu(s.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(s.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(n=>zr(this.view.state,n)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Su=Se.define({combine(t){return t.length?t[0]:null},enables:t=>[ai.state,IZ,Ae.contentAttributes.compute([t],e=>{let n=e.facet(t);return n&&n.name?{"data-language":n.name}:{}})]});class LZ{constructor(e,n=[]){this.language=e,this.support=n,this.extension=[e,n]}}const BZ=Se.define(),jZ=Se.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some(n=>n!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function tb(t){let e=t.facet(jZ);return e.charCodeAt(0)==9?t.tabSize*e.length:e.length}const zZ=Se.define(),FZ=new Ke;function UZ(t,e,n){let r=Fo(t);if(r.length<n)return null;let i=r.resolveInner(n,1),s=null;for(let o=i;o;o=o.parent){if(o.to<=n||o.from>n)continue;if(s&&o.from<e)break;let a=o.type.prop(FZ);if(a&&(o.to<r.length-50||r.length==t.doc.length||!VZ(o))){let l=a(o,t);l&&l.from<=n&&l.from>=e&&l.to>n&&(s=l)}}return s}function VZ(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}function KM(t,e,n){for(let r of t.facet(zZ)){let i=r(t,e,n);if(i)return i}return UZ(t,e,n)}function XM(t,e){let n=e.mapPos(t.from,1),r=e.mapPos(t.to,-1);return n>=r?void 0:{from:n,to:r}}const tS=ze.define({map:XM}),Bg=ze.define({map:XM});function ZM(t){let e=[];for(let{head:n}of t.state.selection.ranges)e.some(r=>r.from<=n&&r.to>=n)||e.push(t.lineBlockAt(n));return e}const hh=Cn.define({create(){return Ze.none},update(t,e){t=t.map(e.changes);for(let n of e.effects)n.is(tS)&&!HZ(t,n.value.from,n.value.to)?t=t.update({add:[z2.range(n.value.from,n.value.to)]}):n.is(Bg)&&(t=t.update({filter:(r,i)=>n.value.from!=r||n.value.to!=i,filterFrom:n.value.from,filterTo:n.value.to}));if(e.selection){let n=!1,{head:r}=e.selection.main;t.between(r,r,(i,s)=>{i<r&&s>r&&(n=!0)}),n&&(t=t.update({filterFrom:r,filterTo:r,filter:(i,s)=>s<=r||i>=r}))}return t},provide:t=>Ae.decorations.from(t),toJSON(t,e){let n=[];return t.between(0,e.doc.length,(r,i)=>{n.push(r,i)}),n},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let n=0;n<t.length;){let r=t[n++],i=t[n++];if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid JSON for fold state");e.push(z2.range(r,i))}return Ze.set(e,!0)}});function JM(t,e,n){var r;let i=null;return(r=t.field(hh,!1))===null||r===void 0||r.between(e,n,(s,o)=>{(!i||i.from>s)&&(i={from:s,to:o})}),i}function HZ(t,e,n){let r=!1;return t.between(e,e,(i,s)=>{i==e&&s==n&&(r=!0)}),r}function YM(t,e){return t.field(hh,!1)?e:e.concat(ze.appendConfig.of(JZ()))}const WZ=t=>{for(let e of ZM(t)){let n=KM(t.state,e.from,e.to);if(n)return t.dispatch({effects:YM(t.state,[tS.of(n),qM(t,n)])}),!0}return!1},GZ=t=>{if(!t.state.field(hh,!1))return!1;let e=[];for(let n of ZM(t)){let r=JM(t.state,n.from,n.to);r&&e.push(Bg.of(r),qM(t,r,!1))}return e.length&&t.dispatch({effects:e}),e.length>0};function qM(t,e,n=!0){let r=t.state.doc.lineAt(e.from).number,i=t.state.doc.lineAt(e.to).number;return Ae.announce.of(`${t.state.phrase(n?"Folded lines":"Unfolded lines")} ${r} ${t.state.phrase("to")} ${i}.`)}const KZ=t=>{let{state:e}=t,n=[];for(let r=0;r<e.doc.length;){let i=t.lineBlockAt(r),s=KM(e,i.from,i.to);s&&n.push(tS.of(s)),r=(s?t.lineBlockAt(s.to):i).to+1}return n.length&&t.dispatch({effects:YM(t.state,n)}),!!n.length},XZ=t=>{let e=t.state.field(hh,!1);if(!e||!e.size)return!1;let n=[];return e.between(0,t.state.doc.length,(r,i)=>{n.push(Bg.of({from:r,to:i}))}),t.dispatch({effects:n}),!0},ZZ={placeholderDOM:null,placeholderText:""},QM=Se.define({combine(t){return Wo(t,ZZ)}});function JZ(t){let e=[hh,YZ];return t&&e.push(QM.of(t)),e}const z2=Ze.replace({widget:new class extends Xa{toDOM(t){let{state:e}=t,n=e.facet(QM),r=s=>{let o=t.lineBlockAt(t.posAtDOM(s.target)),a=JM(t.state,o.from,o.to);a&&t.dispatch({effects:Bg.of(a)}),s.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(t,r);let i=document.createElement("span");return i.textContent=n.placeholderText,i.setAttribute("aria-label",e.phrase("folded code")),i.title=e.phrase("unfold"),i.className="cm-foldPlaceholder",i.onclick=r,i}}}),YZ=Ae.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class jg{constructor(e,n){this.specs=e;let r;function i(a){let l=Do.newName();return(r||(r=Object.create(null)))["."+l]=a,l}const s=typeof n.all=="string"?n.all:n.all?i(n.all):void 0,o=n.scope;this.scope=o instanceof ai?a=>a.prop(Al)==o.data:o?a=>a==o:void 0,this.style=dM(e.map(a=>({tag:a.tag,class:a.class||i(Object.assign({},a,{tag:null}))})),{all:s}).style,this.module=r?new Do(r):null,this.themeType=n.themeType}static define(e,n){return new jg(e,n||{})}}const nb=Se.define(),eD=Se.define({combine(t){return t.length?[t[0]]:null}});function $y(t){let e=t.facet(nb);return e.length?e:t.facet(eD)}function qZ(t,e){let n=[eJ],r;return t instanceof jg&&(t.module&&n.push(Ae.styleModule.of(t.module)),r=t.themeType),e!=null&&e.fallback?n.push(eD.of(t)):r?n.push(nb.computeN([Ae.darkTheme],i=>i.facet(Ae.darkTheme)==(r=="dark")?[t]:[])):n.push(nb.of(t)),n}class QZ{constructor(e){this.markCache=Object.create(null),this.tree=Fo(e.state),this.decorations=this.buildDeco(e,$y(e.state))}update(e){let n=Fo(e.state),r=$y(e.state),i=r!=$y(e.startState);n.length<e.view.viewport.to&&!i&&n.type==this.tree.type?this.decorations=this.decorations.map(e.changes):(n!=this.tree||e.viewportChanged||i)&&(this.tree=n,this.decorations=this.buildDeco(e.view,r))}buildDeco(e,n){if(!n||!this.tree.length)return Ze.none;let r=new ja;for(let{from:i,to:s}of e.visibleRanges)rX(this.tree,n,(o,a,l)=>{r.add(o,a,this.markCache[l]||(this.markCache[l]=Ze.mark({class:l})))},i,s);return r.finish()}}const eJ=qd.high(hn.fromClass(QZ,{decorations:t=>t.decorations}));function F2(t,e,n,r=0,i=0){e==null&&(e=t.search(/[^\s\u00a0]/),e==-1&&(e=t.length));let s=i;for(let o=r;o<e;o++)t.charCodeAt(o)==9?s+=n-s%n:s++;return s}class tD{constructor(e,n,r,i){this.string=e,this.tabSize=n,this.indentUnit=r,this.overrideIndent=i,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(e){let n=this.string.charAt(this.pos),r;if(typeof e=="string"?r=n==e:r=n&&(e instanceof RegExp?e.test(n):e(n)),r)return++this.pos,n}eatWhile(e){let n=this.pos;for(;this.eat(e););return this.pos>n}eatSpace(){let e=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e}skipToEnd(){this.pos=this.string.length}skipTo(e){let n=this.string.indexOf(e,this.pos);if(n>-1)return this.pos=n,!0}backUp(e){this.pos-=e}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=F2(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var e;return(e=this.overrideIndent)!==null&&e!==void 0?e:F2(this.string,null,this.tabSize)}match(e,n,r){if(typeof e=="string"){let i=o=>r?o.toLowerCase():o,s=this.string.substr(this.pos,e.length);return i(s)==i(e)?(n!==!1&&(this.pos+=e.length),!0):null}else{let i=this.string.slice(this.pos).match(e);return i&&i.index>0?null:(i&&n!==!1&&(this.pos+=i[0].length),i)}}current(){return this.string.slice(this.start,this.pos)}}function tJ(t){return{name:t.name||"",token:t.token,blankLine:t.blankLine||(()=>{}),startState:t.startState||(()=>!0),copyState:t.copyState||nJ,indent:t.indent||(()=>null),languageData:t.languageData||{},tokenTable:t.tokenTable||iS}}function nJ(t){if(typeof t!="object")return t;let e={};for(let n in t){let r=t[n];e[n]=r instanceof Array?r.slice():r}return e}const U2=new WeakMap;class nS extends ai{constructor(e){let n=RZ(e.languageData),r=tJ(e),i,s=new class extends Fx{createParse(o,a,l){return new iJ(i,o,a,l)}};super(n,s,[BZ.of((o,a)=>this.getIndent(o,a))],e.name),this.topNode=aJ(n),i=this,this.streamParser=r,this.stateAfter=new Ke({perNode:!0}),this.tokenTable=e.tokenTable?new sD(r.tokenTable):oJ}static define(e){return new nS(e)}getIndent(e,n){let r=Fo(e.state),i=r.resolve(n);for(;i&&i.type!=this.topNode;)i=i.parent;if(!i)return null;let s,{overrideIndentation:o}=e.options;o&&(s=U2.get(e.state),s!=null&&s<n-1e4&&(s=void 0));let a=rS(this,r,0,i.from,s??n),l,u;if(a?(u=a.state,l=a.pos+1):(u=this.streamParser.startState(e.unit),l=0),n-l>1e4)return null;for(;l<n;){let d=e.state.doc.lineAt(l),h=Math.min(n,d.to);if(d.length){let f=o?o(d.from):-1,p=new tD(d.text,e.state.tabSize,e.unit,f<0?void 0:f);for(;p.pos<h-d.from;)rD(this.streamParser.token,p,u)}else this.streamParser.blankLine(u,e.unit);if(h==n)break;l=d.to+1}let c=e.lineAt(n);return o&&s==null&&U2.set(e.state,c.from),this.streamParser.indent(u,/^\s*(.*)/.exec(c.text)[1],e)}get allowsNesting(){return!1}}function rS(t,e,n,r,i){let s=n>=r&&n+e.length<=i&&e.prop(t.stateAfter);if(s)return{state:t.streamParser.copyState(s),pos:n+e.length};for(let o=e.children.length-1;o>=0;o--){let a=e.children[o],l=n+e.positions[o],u=a instanceof dt&&l<i&&rS(t,a,l,r,i);if(u)return u}return null}function nD(t,e,n,r,i){if(i&&n<=0&&r>=e.length)return e;!i&&e.type==t.topNode&&(i=!0);for(let s=e.children.length-1;s>=0;s--){let o=e.positions[s],a=e.children[s],l;if(o<r&&a instanceof dt){if(!(l=nD(t,a,n-o,r-o,i)))break;return i?new dt(e.type,e.children.slice(0,s).concat(l),e.positions.slice(0,s+1),o+l.length):l}}return null}function rJ(t,e,n,r){for(let i of e){let s=i.from+(i.openStart?25:0),o=i.to-(i.openEnd?25:0),a=s<=n&&o>n&&rS(t,i.tree,0-i.offset,n,o),l;if(a&&(l=nD(t,i.tree,n+i.offset,a.pos+i.offset,!1)))return{state:a.state,tree:l}}return{state:t.streamParser.startState(r?tb(r):4),tree:dt.empty}}class iJ{constructor(e,n,r,i){this.lang=e,this.input=n,this.fragments=r,this.ranges=i,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=i[i.length-1].to;let s=bu.get(),o=i[0].from,{state:a,tree:l}=rJ(e,r,o,s==null?void 0:s.state);this.state=a,this.parsedPos=this.chunkStart=o+l.length;for(let u=0;u<l.children.length;u++)this.chunks.push(l.children[u]),this.chunkPos.push(l.positions[u]);s&&this.parsedPos<s.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(tb(s.state)),s.skipUntilInView(this.parsedPos,s.viewport.from),this.parsedPos=s.viewport.from),this.moveRangeIndex()}advance(){let e=bu.get(),n=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),r=Math.min(n,this.chunkStart+2048);for(e&&(r=Math.min(r,e.viewport.to));this.parsedPos<r;)this.parseLine(e);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=n?this.finish():e&&this.parsedPos>=e.viewport.to?(e.skipUntilInView(this.parsedPos,n),this.finish()):null}stopAt(e){this.stoppedAt=e}lineAfter(e){let n=this.input.chunk(e);if(this.input.lineChunks)n==`
`&&(n="");else{let r=n.indexOf(`
`);r>-1&&(n=n.slice(0,r))}return e+n.length<=this.to?n:n.slice(0,this.to-e)}nextLine(){let e=this.parsedPos,n=this.lineAfter(e),r=e+n.length;for(let i=this.rangeIndex;;){let s=this.ranges[i].to;if(s>=r||(n=n.slice(0,s-(r-n.length)),i++,i==this.ranges.length))break;let o=this.ranges[i].from,a=this.lineAfter(o);n+=a,r=o+a.length}return{line:n,end:r}}skipGapsTo(e,n,r){for(;;){let i=this.ranges[this.rangeIndex].to,s=e+n;if(r>0?i>s:i>=s)break;let o=this.ranges[++this.rangeIndex].from;n+=o-i}return n}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(e,n,r,i,s){if(this.ranges.length>1){s=this.skipGapsTo(n,s,1),n+=s;let o=this.chunk.length;s=this.skipGapsTo(r,s,-1),r+=s,i+=this.chunk.length-o}return this.chunk.push(e,n,r,i),s}parseLine(e){let{line:n,end:r}=this.nextLine(),i=0,{streamParser:s}=this.lang,o=new tD(n,e?e.state.tabSize:4,e?tb(e.state):2);if(o.eol())s.blankLine(this.state,o.indentUnit);else for(;!o.eol();){let a=rD(s.token,o,this.state);if(a&&(i=this.emitToken(this.lang.tokenTable.resolve(a),this.parsedPos+o.start,this.parsedPos+o.pos,4,i)),o.start>1e4)break}this.parsedPos=r,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let e=dt.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:sJ,topID:0,maxBufferLength:2048,reused:this.chunkReused});e=new dt(e.type,e.children,e.positions,e.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(e),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new dt(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function rD(t,e,n){e.start=e.pos;for(let r=0;r<10;r++){let i=t(e,n);if(e.pos>e.start)return i}throw new Error("Stream parser failed to advance stream.")}const iS=Object.create(null),Ud=[Ln.none],sJ=new Bx(Ud),V2=[],iD=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])iD[t]=oD(iS,e);class sD{constructor(e){this.extra=e,this.table=Object.assign(Object.create(null),iD)}resolve(e){return e?this.table[e]||(this.table[e]=oD(this.extra,e)):0}}const oJ=new sD(iS);function Ny(t,e){V2.indexOf(t)>-1||(V2.push(t),console.warn(e))}function oD(t,e){let n=null;for(let s of e.split(".")){let o=t[s]||Oe[s];o?typeof o=="function"?n?n=o(n):Ny(s,`Modifier ${s} used at start of tag`):n?Ny(s,`Tag ${s} used as modifier`):n=o:Ny(s,`Unknown highlighting tag ${s}`)}if(!n)return 0;let r=e.replace(/ /g,"_"),i=Ln.define({id:Ud.length,name:r,props:[uM({[r]:n})]});return Ud.push(i),i.id}function aJ(t){let e=Ln.define({id:Ud.length,name:"Document",props:[Al.add(()=>t)]});return Ud.push(e),e}class lJ{constructor(e,n,r){this.state=e,this.pos=n,this.explicit=r,this.abortListeners=[]}tokenBefore(e){let n=Fo(this.state).resolveInner(this.pos,-1);for(;n&&e.indexOf(n.name)<0;)n=n.parent;return n?{from:n.from,to:this.pos,text:this.state.sliceDoc(n.from,this.pos),type:n.type}:null}matchBefore(e){let n=this.state.doc.lineAt(this.pos),r=Math.max(n.from,this.pos-250),i=n.text.slice(r-n.from,this.pos-n.from),s=i.search(aD(e,!1));return s<0?null:{from:r+s,to:this.pos,text:i.slice(s)}}get aborted(){return this.abortListeners==null}addEventListener(e,n){e=="abort"&&this.abortListeners&&this.abortListeners.push(n)}}function H2(t){let e=Object.keys(t).join(""),n=/\w/.test(e);return n&&(e=e.replace(/\w/g,"")),`[${n?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function uJ(t){let e=Object.create(null),n=Object.create(null);for(let{label:i}of t){e[i[0]]=!0;for(let s=1;s<i.length;s++)n[i[s]]=!0}let r=H2(e)+H2(n)+"*$";return[new RegExp("^"+r),new RegExp(r)]}function cJ(t){let e=t.map(i=>typeof i=="string"?{label:i}:i),[n,r]=e.every(i=>/^\w+$/.test(i.label))?[/\w*$/,/\w+$/]:uJ(e);return i=>{let s=i.matchBefore(r);return s||i.explicit?{from:s?s.from:i.pos,options:e,validFor:n}:null}}class W2{constructor(e,n,r,i){this.completion=e,this.source=n,this.match=r,this.score=i}}function Hl(t){return t.selection.main.from}function aD(t,e){var n;let{source:r}=t,i=e&&r[0]!="^",s=r[r.length-1]!="$";return!i&&!s?t:new RegExp(`${i?"^":""}(?:${r})${s?"$":""}`,(n=t.flags)!==null&&n!==void 0?n:t.ignoreCase?"i":"")}const dJ=Bs.define();function hJ(t,e,n,r){let{main:i}=t.selection,s=n-i.from,o=r-i.from;return Object.assign(Object.assign({},t.changeByRange(a=>a!=i&&n!=r&&t.sliceDoc(a.from+s,a.from+o)!=t.sliceDoc(n,r)?{range:a}:{changes:{from:a.from+s,to:r==i.from?a.to:a.from+o,insert:e},range:te.cursor(a.from+s+e.length)})),{userEvent:"input.complete"})}const G2=new WeakMap;function fJ(t){if(!Array.isArray(t))return t;let e=G2.get(t);return e||G2.set(t,e=cJ(t)),e}const lD=ze.define(),sS=ze.define();class pJ{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let n=0;n<e.length;){let r=$n(e,n),i=ii(r);this.chars.push(r);let s=e.slice(n,n+i),o=s.toUpperCase();this.folded.push($n(o==s?s.toLowerCase():o,0)),n+=i}this.astral=e.length!=this.chars.length}ret(e,n){return this.score=e,this.matched=n,!0}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return!1;let{chars:n,folded:r,any:i,precise:s,byWord:o}=this;if(n.length==1){let v=$n(e,0),w=ii(v),S=w==e.length?0:-100;if(v!=n[0])if(v==r[0])S+=-200;else return!1;return this.ret(S,[0,w])}let a=e.indexOf(this.pattern);if(a==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=n.length,u=0;if(a<0){for(let v=0,w=Math.min(e.length,200);v<w&&u<l;){let S=$n(e,v);(S==n[u]||S==r[u])&&(i[u++]=v),v+=ii(S)}if(u<l)return!1}let c=0,d=0,h=!1,f=0,p=-1,g=-1,b=/[a-z]/.test(e),y=!0;for(let v=0,w=Math.min(e.length,200),S=0;v<w&&d<l;){let C=$n(e,v);a<0&&(c<l&&C==n[c]&&(s[c++]=v),f<l&&(C==n[f]||C==r[f]?(f==0&&(p=v),g=v+1,f++):f=0));let E,T=C<255?C>=48&&C<=57||C>=97&&C<=122?2:C>=65&&C<=90?1:0:(E=M1(C))!=E.toLowerCase()?1:E!=E.toUpperCase()?2:0;(!v||T==1&&b||S==0&&T!=0)&&(n[d]==C||r[d]==C&&(h=!0)?o[d++]=v:o.length&&(y=!1)),S=T,v+=ii(C)}return d==l&&o[0]==0&&y?this.result(-100+(h?-200:0),o,e):f==l&&p==0?this.ret(-200-e.length+(g==e.length?0:-100),[0,g]):a>-1?this.ret(-700-e.length,[a,a+this.pattern.length]):f==l?this.ret(-200+-700-e.length,[p,g]):d==l?this.result(-100+(h?-200:0)+-700+(y?0:-1100),o,e):n.length==2?!1:this.result((i[0]?-700:0)+-200+-1100,i,e)}result(e,n,r){let i=[],s=0;for(let o of n){let a=o+(this.astral?ii($n(r,o)):1);s&&i[s-1]==o?i[s-1]=a:(i[s++]=o,i[s++]=a)}return this.ret(e-r.length,i)}}const gs=Se.define({combine(t){return Wo(t,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:mJ,compareCompletions:(e,n)=>e.label.localeCompare(n.label),interactionDelay:75},{defaultKeymap:(e,n)=>e&&n,closeOnBlur:(e,n)=>e&&n,icons:(e,n)=>e&&n,tooltipClass:(e,n)=>r=>K2(e(r),n(r)),optionClass:(e,n)=>r=>K2(e(r),n(r)),addToOptions:(e,n)=>e.concat(n)})}});function K2(t,e){return t?e?t+" "+e:t:e}function mJ(t,e,n,r,i){let s=t.textDirection==Tt.RTL,o=s,a=!1,l="top",u,c,d=e.left-i.left,h=i.right-e.right,f=r.right-r.left,p=r.bottom-r.top;if(o&&d<Math.min(f,h)?o=!1:!o&&h<Math.min(f,d)&&(o=!0),f<=(o?d:h))u=Math.max(i.top,Math.min(n.top,i.bottom-p))-e.top,c=Math.min(400,o?d:h);else{a=!0,c=Math.min(400,(s?e.right:i.right-e.left)-30);let g=i.bottom-e.bottom;g>=p||g>e.top?u=n.bottom-e.top:(l="bottom",u=e.bottom-n.top)}return{style:`${l}: ${u}px; max-width: ${c}px`,class:"cm-completionInfo-"+(a?s?"left-narrow":"right-narrow":o?"left":"right")}}function gJ(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(n){let r=document.createElement("div");return r.classList.add("cm-completionIcon"),n.type&&r.classList.add(...n.type.split(/\s+/g).map(i=>"cm-completionIcon-"+i)),r.setAttribute("aria-hidden","true"),r},position:20}),e.push({render(n,r,i){let s=document.createElement("span");s.className="cm-completionLabel";let o=n.displayLabel||n.label,a=0;for(let l=0;l<i.length;){let u=i[l++],c=i[l++];u>a&&s.appendChild(document.createTextNode(o.slice(a,u)));let d=s.appendChild(document.createElement("span"));d.appendChild(document.createTextNode(o.slice(u,c))),d.className="cm-completionMatchedText",a=c}return a<o.length&&s.appendChild(document.createTextNode(o.slice(a))),s},position:50},{render(n){if(!n.detail)return null;let r=document.createElement("span");return r.className="cm-completionDetail",r.textContent=n.detail,r},position:80}),e.sort((n,r)=>n.position-r.position).map(n=>n.render)}function X2(t,e,n){if(t<=n)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let i=Math.floor(e/n);return{from:i*n,to:(i+1)*n}}let r=Math.floor((t-e)/n);return{from:t-(r+1)*n,to:t-r*n}}class yJ{constructor(e,n,r){this.view=e,this.stateField=n,this.applyCompletion=r,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let i=e.state.field(n),{options:s,selected:o}=i.open,a=e.state.facet(gs);this.optionContent=gJ(a),this.optionClass=a.optionClass,this.tooltipClass=a.tooltipClass,this.range=X2(s.length,o,a.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{for(let u=l.target,c;u&&u!=this.dom;u=u.parentNode)if(u.nodeName=="LI"&&(c=/-(\d+)$/.exec(u.id))&&+c[1]<s.length){this.applyCompletion(e,s[+c[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let u=e.state.field(this.stateField,!1);u&&u.tooltip&&e.state.facet(gs).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:sS.of(null)})}),this.list=this.dom.appendChild(this.createListBox(s,i.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}mount(){this.updateSel()}update(e){var n,r,i;let s=e.state.field(this.stateField),o=e.startState.field(this.stateField);this.updateTooltipClass(e.state),s!=o&&(this.updateSel(),((n=s.open)===null||n===void 0?void 0:n.disabled)!=((r=o.open)===null||r===void 0?void 0:r.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!(!((i=s.open)===null||i===void 0)&&i.disabled)))}updateTooltipClass(e){let n=this.tooltipClass(e);if(n!=this.currentClass){for(let r of this.currentClass.split(" "))r&&this.dom.classList.remove(r);for(let r of n.split(" "))r&&this.dom.classList.add(r);this.currentClass=n}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),n=e.open;if((n.selected>-1&&n.selected<this.range.from||n.selected>=this.range.to)&&(this.range=X2(n.options.length,n.selected,this.view.state.facet(gs).maxRenderedOptions),this.list.remove(),this.list=this.dom.appendChild(this.createListBox(n.options,e.id,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})),this.updateSelectedOption(n.selected)){this.destroyInfo();let{completion:r}=n.options[n.selected],{info:i}=r;if(!i)return;let s=typeof i=="string"?document.createTextNode(i):i(r);if(!s)return;"then"in s?s.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,r)}).catch(o=>zr(this.view.state,o,"completion info")):this.addInfoPane(s,r)}}addInfoPane(e,n){this.destroyInfo();let r=this.info=document.createElement("div");if(r.className="cm-tooltip cm-completionInfo",e.nodeType!=null)r.appendChild(e),this.infoDestroy=null;else{let{dom:i,destroy:s}=e;r.appendChild(i),this.infoDestroy=s||null}this.dom.appendChild(r),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let n=null;for(let r=this.list.firstChild,i=this.range.from;r;r=r.nextSibling,i++)r.nodeName!="LI"||!r.id?i--:i==e?r.hasAttribute("aria-selected")||(r.setAttribute("aria-selected","true"),n=r):r.hasAttribute("aria-selected")&&r.removeAttribute("aria-selected");return n&&wJ(this.list,n),n}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let n=this.dom.getBoundingClientRect(),r=this.info.getBoundingClientRect(),i=e.getBoundingClientRect(),s=this.space;if(!s){let o=this.dom.ownerDocument.defaultView||window;s={left:0,top:0,right:o.innerWidth,bottom:o.innerHeight}}return i.top>Math.min(s.bottom,n.bottom)-10||i.bottom<Math.max(s.top,n.top)+10?null:this.view.state.facet(gs).positionInfo(this.view,n,i,r,s)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,n,r){const i=document.createElement("ul");i.id=n,i.setAttribute("role","listbox"),i.setAttribute("aria-expanded","true"),i.setAttribute("aria-label",this.view.state.phrase("Completions"));let s=null;for(let o=r.from;o<r.to;o++){let{completion:a,match:l}=e[o],{section:u}=a;if(u){let h=typeof u=="string"?u:u.name;if(h!=s&&(o>r.from||r.from==0))if(s=h,typeof u!="string"&&u.header)i.appendChild(u.header(u));else{let f=i.appendChild(document.createElement("completion-section"));f.textContent=h}}const c=i.appendChild(document.createElement("li"));c.id=n+"-"+o,c.setAttribute("role","option");let d=this.optionClass(a);d&&(c.className=d);for(let h of this.optionContent){let f=h(a,this.view.state,l);f&&c.appendChild(f)}}return r.from&&i.classList.add("cm-completionListIncompleteTop"),r.to<e.length&&i.classList.add("cm-completionListIncompleteBottom"),i}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function vJ(t,e){return n=>new yJ(n,t,e)}function wJ(t,e){let n=t.getBoundingClientRect(),r=e.getBoundingClientRect();r.top<n.top?t.scrollTop-=n.top-r.top:r.bottom>n.bottom&&(t.scrollTop+=r.bottom-n.bottom)}function Z2(t){return(t.boost||0)*100+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}function bJ(t,e){let n=[],r=null,i=l=>{n.push(l);let{section:u}=l.completion;if(u){r||(r=[]);let c=typeof u=="string"?u:u.name;r.some(d=>d.name==c)||r.push(typeof u=="string"?{name:c}:u)}};for(let l of t)if(l.hasResult()){let u=l.result.getMatch;if(l.result.filter===!1)for(let c of l.result.options)i(new W2(c,l.source,u?u(c):[],1e9-n.length));else{let c=new pJ(e.sliceDoc(l.from,l.to));for(let d of l.result.options)if(c.match(d.label)){let h=d.displayLabel?u?u(d,c.matched):[]:c.matched;i(new W2(d,l.source,h,c.score+(d.boost||0)))}}}if(r){let l=Object.create(null),u=0,c=(d,h)=>{var f,p;return((f=d.rank)!==null&&f!==void 0?f:1e9)-((p=h.rank)!==null&&p!==void 0?p:1e9)||(d.name<h.name?-1:1)};for(let d of r.sort(c))u-=1e5,l[d.name]=u;for(let d of n){let{section:h}=d.completion;h&&(d.score+=l[typeof h=="string"?h:h.name])}}let s=[],o=null,a=e.facet(gs).compareCompletions;for(let l of n.sort((u,c)=>c.score-u.score||a(u.completion,c.completion))){let u=l.completion;!o||o.label!=u.label||o.detail!=u.detail||o.type!=null&&u.type!=null&&o.type!=u.type||o.apply!=u.apply||o.boost!=u.boost?s.push(l):Z2(l.completion)>Z2(o)&&(s[s.length-1]=l),o=l.completion}return s}class Pl{constructor(e,n,r,i,s,o){this.options=e,this.attrs=n,this.tooltip=r,this.timestamp=i,this.selected=s,this.disabled=o}setSelected(e,n){return e==this.selected||e>=this.options.length?this:new Pl(this.options,J2(n,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,n,r,i,s){let o=bJ(e,n);if(!o.length)return i&&e.some(l=>l.state==1)?new Pl(i.options,i.attrs,i.tooltip,i.timestamp,i.selected,!0):null;let a=n.facet(gs).selectOnOpen?0:-1;if(i&&i.selected!=a&&i.selected!=-1){let l=i.options[i.selected].completion;for(let u=0;u<o.length;u++)if(o[u].completion==l){a=u;break}}return new Pl(o,J2(r,a),{pos:e.reduce((l,u)=>u.hasResult()?Math.min(l,u.from):l,1e8),create:vJ(Lu,cD),above:s.aboveCursor},i?i.timestamp:Date.now(),a,!1)}map(e){return new Pl(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class Tm{constructor(e,n,r){this.active=e,this.id=n,this.open=r}static start(){return new Tm(kJ,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:n}=e,r=n.facet(gs),s=(r.override||n.languageDataAt("autocomplete",Hl(n)).map(fJ)).map(a=>(this.active.find(u=>u.source==a)||new hr(a,this.active.some(u=>u.state!=0)?1:0)).update(e,r));s.length==this.active.length&&s.every((a,l)=>a==this.active[l])&&(s=this.active);let o=this.open;o&&e.docChanged&&(o=o.map(e.changes)),e.selection||s.some(a=>a.hasResult()&&e.changes.touchesRange(a.from,a.to))||!xJ(s,this.active)?o=Pl.build(s,n,this.id,o,r):o&&o.disabled&&!s.some(a=>a.state==1)&&(o=null),!o&&s.every(a=>a.state!=1)&&s.some(a=>a.hasResult())&&(s=s.map(a=>a.hasResult()?new hr(a.source,0):a));for(let a of e.effects)a.is(uD)&&(o=o&&o.setSelected(a.value,this.id));return s==this.active&&o==this.open?this:new Tm(s,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:SJ}}function xJ(t,e){if(t==e)return!0;for(let n=0,r=0;;){for(;n<t.length&&!t[n].hasResult;)n++;for(;r<e.length&&!e[r].hasResult;)r++;let i=n==t.length,s=r==e.length;if(i||s)return i==s;if(t[n++].result!=e[r++].result)return!1}}const SJ={"aria-autocomplete":"list"};function J2(t,e){let n={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(n["aria-activedescendant"]=t+"-"+e),n}const kJ=[];function CJ(t){return t.isUserEvent("input.type")?"input":t.isUserEvent("delete.backward")?"delete":null}class hr{constructor(e,n,r=-1){this.source=e,this.state=n,this.explicitPos=r}hasResult(){return!1}update(e,n){let r=CJ(e),i=this;r?i=i.handleUserEvent(e,r,n):e.docChanged?i=i.handleChange(e):e.selection&&i.state!=0&&(i=new hr(i.source,0));for(let s of e.effects)if(s.is(lD))i=new hr(i.source,1,s.value?Hl(e.state):-1);else if(s.is(sS))i=new hr(i.source,0);else if(s.is(AJ))for(let o of s.value)o.source==i.source&&(i=o);return i}handleUserEvent(e,n,r){return n=="delete"||!r.activateOnTyping?this.map(e.changes):new hr(this.source,1)}handleChange(e){return e.changes.touchesRange(Hl(e.startState))?new hr(this.source,0):this.map(e.changes)}map(e){return e.empty||this.explicitPos<0?this:new hr(this.source,this.state,e.mapPos(this.explicitPos))}}class Lc extends hr{constructor(e,n,r,i,s){super(e,2,n),this.result=r,this.from=i,this.to=s}hasResult(){return!0}handleUserEvent(e,n,r){var i;let s=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),a=Hl(e.state);if((this.explicitPos<0?a<=s:a<this.from)||a>o||n=="delete"&&Hl(e.startState)==this.from)return new hr(this.source,n=="input"&&r.activateOnTyping?1:0);let l=this.explicitPos<0?-1:e.changes.mapPos(this.explicitPos),u;return EJ(this.result.validFor,e.state,s,o)?new Lc(this.source,l,this.result,s,o):this.result.update&&(u=this.result.update(this.result,s,o,new lJ(e.state,a,l>=0)))?new Lc(this.source,l,u,u.from,(i=u.to)!==null&&i!==void 0?i:Hl(e.state)):new hr(this.source,1,l)}handleChange(e){return e.changes.touchesRange(this.from,this.to)?new hr(this.source,0):this.map(e.changes)}map(e){return e.empty?this:new Lc(this.source,this.explicitPos<0?-1:e.mapPos(this.explicitPos),this.result,e.mapPos(this.from),e.mapPos(this.to,1))}}function EJ(t,e,n,r){if(!t)return!1;let i=e.sliceDoc(n,r);return typeof t=="function"?t(i,n,r,e):aD(t,!0).test(i)}const AJ=ze.define({map(t,e){return t.map(n=>n.map(e))}}),uD=ze.define(),Lu=Cn.define({create(){return Tm.start()},update(t,e){return t.update(e)},provide:t=>[H1.from(t,e=>e.tooltip),Ae.contentAttributes.from(t,e=>e.attrs)]});function cD(t,e){const n=e.completion.apply||e.completion.label;let r=t.state.field(Lu).active.find(i=>i.source==e.source);return r instanceof Lc?(typeof n=="string"?t.dispatch(Object.assign(Object.assign({},hJ(t.state,n,r.from,r.to)),{annotations:dJ.of(e.completion)})):n(t,e.completion,r.from,r.to),!0):!1}function vf(t,e="option"){return n=>{let r=n.state.field(Lu,!1);if(!r||!r.open||r.open.disabled||Date.now()-r.open.timestamp<n.state.facet(gs).interactionDelay)return!1;let i=1,s;e=="page"&&(s=Gj(n,r.open.tooltip))&&(i=Math.max(2,Math.floor(s.dom.offsetHeight/s.dom.querySelector("li").offsetHeight)-1));let{length:o}=r.open.options,a=r.open.selected>-1?r.open.selected+i*(t?1:-1):t?0:o-1;return a<0?a=e=="page"?0:o-1:a>=o&&(a=e=="page"?o-1:0),n.dispatch({effects:uD.of(a)}),!0}}const Y2=t=>{let e=t.state.field(Lu,!1);return t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(gs).interactionDelay?!1:cD(t,e.open.options[e.open.selected])},PJ=t=>t.state.field(Lu,!1)?(t.dispatch({effects:lD.of(!0)}),!0):!1,TJ=t=>{let e=t.state.field(Lu,!1);return!e||!e.active.some(n=>n.state!=0)?!1:(t.dispatch({effects:sS.of(null)}),!0)},dD={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},hD=new class extends Ba{};hD.startSide=1;hD.endSide=-1;const Oy="()[]{}<>";function $J(t){for(let e=0;e<Oy.length;e+=2)if(Oy.charCodeAt(e)==t)return Oy.charAt(e+1);return M1(t<128?t:t+1)}function NJ(t,e){return t.languageDataAt("closeBrackets",e)[0]||dD}const OJ=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=NJ(t,t.selection.main.head).brackets||dD.brackets,i=null,s=t.changeByRange(o=>{if(o.empty){let a=RJ(t.doc,o.head);for(let l of r)if(l==a&&_J(t.doc,o.head)==$J($n(l,0)))return{changes:{from:o.head-l.length,to:o.head+l.length},range:te.cursor(o.head-l.length)}}return{range:i=o}});return i||e(t.update(s,{scrollIntoView:!0,userEvent:"delete.backward"})),!i};function _J(t,e){let n=t.sliceString(e,e+2);return n.slice(0,ii($n(n,0)))}function RJ(t,e){let n=t.sliceString(e-2,e);return ii($n(n,0))==n.length?n:n.slice(1)}class MJ{constructor(e,n,r){this.from=e,this.to=n,this.diagnostic=r}}class ca{constructor(e,n,r){this.diagnostics=e,this.panel=n,this.selected=r}static init(e,n,r){let i=e,s=r.facet(ya).markerFilter;s&&(i=s(i));let o=Ze.set(i.map(a=>a.from==a.to||a.from==a.to-1&&r.doc.lineAt(a.from).to==a.from?Ze.widget({widget:new HJ(a),diagnostic:a}).range(a.from):Ze.mark({attributes:{class:"cm-lintRange cm-lintRange-"+a.severity+(a.markClass?" "+a.markClass:"")},diagnostic:a}).range(a.from,a.to)),!0);return new ca(o,n,ku(o))}}function ku(t,e=null,n=0){let r=null;return t.between(n,1e9,(i,s,{spec:o})=>{if(!(e&&o.diagnostic!=e))return r=new MJ(i,s,o.diagnostic),!1}),r}function DJ(t,e){let n=t.startState.doc.lineAt(e.pos);return!!(t.effects.some(r=>r.is(oS))||t.changes.touchesRange(n.from,n.to))}function fD(t,e){return t.field(yr,!1)?e:e.concat(ze.appendConfig.of(yD))}function IJ(t,e){return{effects:fD(t,[oS.of(e)])}}const oS=ze.define(),aS=ze.define(),pD=ze.define(),yr=Cn.define({create(){return new ca(Ze.none,null,null)},update(t,e){if(e.docChanged){let n=t.diagnostics.map(e.changes),r=null;if(t.selected){let i=e.changes.mapPos(t.selected.from,1);r=ku(n,t.selected.diagnostic,i)||ku(n,null,i)}t=new ca(n,t.panel,r)}for(let n of e.effects)n.is(oS)?t=ca.init(n.value,t.panel,e.state):n.is(aS)?t=new ca(t.diagnostics,n.value?zg.open:null,t.selected):n.is(pD)&&(t=new ca(t.diagnostics,t.panel,n.value));return t},provide:t=>[Td.from(t,e=>e.panel),Ae.decorations.from(t,e=>e.diagnostics)]}),LJ=Ze.mark({class:"cm-lintRange cm-lintRange-active"});function BJ(t,e,n){let{diagnostics:r}=t.state.field(yr),i=[],s=2e8,o=0;r.between(e-(n<0?1:0),e+(n>0?1:0),(l,u,{spec:c})=>{e>=l&&e<=u&&(l==u||(e>l||n>0)&&(e<u||n<0))&&(i.push(c.diagnostic),s=Math.min(l,s),o=Math.max(u,o))});let a=t.state.facet(ya).tooltipFilter;return a&&(i=a(i)),i.length?{pos:s,end:o,above:t.state.doc.lineAt(s).to<o,create(){return{dom:jJ(t,i)}}}:null}function jJ(t,e){return ut("ul",{class:"cm-tooltip-lint"},e.map(n=>gD(t,n,!1)))}const zJ=t=>{let e=t.state.field(yr,!1);(!e||!e.panel)&&t.dispatch({effects:fD(t.state,[aS.of(!0)])});let n=Pd(t,zg.open);return n&&n.dom.querySelector(".cm-panel-lint ul").focus(),!0},q2=t=>{let e=t.state.field(yr,!1);return!e||!e.panel?!1:(t.dispatch({effects:aS.of(!1)}),!0)},FJ=t=>{let e=t.state.field(yr,!1);if(!e)return!1;let n=t.state.selection.main,r=e.diagnostics.iter(n.to+1);return!r.value&&(r=e.diagnostics.iter(0),!r.value||r.from==n.from&&r.to==n.to)?!1:(t.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0}),!0)},UJ=hn.fromClass(class{constructor(t){this.view=t,this.timeout=-1,this.set=!0;let{delay:e}=t.state.facet(ya);this.lintTime=Date.now()+e,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,e)}run(){let t=Date.now();if(t<this.lintTime-10)setTimeout(this.run,this.lintTime-t);else{this.set=!1;let{state:e}=this.view,{sources:n}=e.facet(ya);Promise.all(n.map(r=>Promise.resolve(r(this.view)))).then(r=>{let i=r.reduce((s,o)=>s.concat(o));this.view.state.doc==e.doc&&this.view.dispatch(IJ(this.view.state,i))},r=>{zr(this.view.state,r)})}}update(t){let e=t.state.facet(ya);(t.docChanged||e!=t.startState.facet(ya)||e.needsRefresh&&e.needsRefresh(t))&&(this.lintTime=Date.now()+e.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,e.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}}),ya=Se.define({combine(t){return Object.assign({sources:t.map(e=>e.source)},Wo(t.map(e=>e.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(e,n)=>e?n?r=>e(r)||n(r):e:n}))}});function VJ(t,e={}){return[ya.of({source:t,config:e}),UJ,yD]}function mD(t){let e=[];if(t)e:for(let{name:n}of t){for(let r=0;r<n.length;r++){let i=n[r];if(/[a-zA-Z]/.test(i)&&!e.some(s=>s.toLowerCase()==i.toLowerCase())){e.push(i);continue e}}e.push("")}return e}function gD(t,e,n){var r;let i=n?mD(e.actions):[];return ut("li",{class:"cm-diagnostic cm-diagnostic-"+e.severity},ut("span",{class:"cm-diagnosticText"},e.renderMessage?e.renderMessage():e.message),(r=e.actions)===null||r===void 0?void 0:r.map((s,o)=>{let a=!1,l=h=>{if(h.preventDefault(),a)return;a=!0;let f=ku(t.state.field(yr).diagnostics,e);f&&s.apply(t,f.from,f.to)},{name:u}=s,c=i[o]?u.indexOf(i[o]):-1,d=c<0?u:[u.slice(0,c),ut("u",u.slice(c,c+1)),u.slice(c+1)];return ut("button",{type:"button",class:"cm-diagnosticAction",onclick:l,onmousedown:l,"aria-label":` Action: ${u}${c<0?"":` (access key "${i[o]})"`}.`},d)}),e.source&&ut("div",{class:"cm-diagnosticSource"},e.source))}class HJ extends Xa{constructor(e){super(),this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return ut("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Q2{constructor(e,n){this.diagnostic=n,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=gD(e,n,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class zg{constructor(e){this.view=e,this.items=[];let n=i=>{if(i.keyCode==27)q2(this.view),this.view.focus();else if(i.keyCode==38||i.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(i.keyCode==40||i.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(i.keyCode==36)this.moveSelection(0);else if(i.keyCode==35)this.moveSelection(this.items.length-1);else if(i.keyCode==13)this.view.focus();else if(i.keyCode>=65&&i.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:s}=this.items[this.selectedIndex],o=mD(s.actions);for(let a=0;a<o.length;a++)if(o[a].toUpperCase().charCodeAt(0)==i.keyCode){let l=ku(this.view.state.field(yr).diagnostics,s);l&&s.actions[a].apply(e,l.from,l.to)}}else return;i.preventDefault()},r=i=>{for(let s=0;s<this.items.length;s++)this.items[s].dom.contains(i.target)&&this.moveSelection(s)};this.list=ut("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:n,onclick:r}),this.dom=ut("div",{class:"cm-panel-lint"},this.list,ut("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>q2(this.view)},"")),this.update()}get selectedIndex(){let e=this.view.state.field(yr).selected;if(!e)return-1;for(let n=0;n<this.items.length;n++)if(this.items[n].diagnostic==e.diagnostic)return n;return-1}update(){let{diagnostics:e,selected:n}=this.view.state.field(yr),r=0,i=!1,s=null;for(e.between(0,this.view.state.doc.length,(o,a,{spec:l})=>{let u=-1,c;for(let d=r;d<this.items.length;d++)if(this.items[d].diagnostic==l.diagnostic){u=d;break}u<0?(c=new Q2(this.view,l.diagnostic),this.items.splice(r,0,c),i=!0):(c=this.items[u],u>r&&(this.items.splice(r,u-r),i=!0)),n&&c.diagnostic==n.diagnostic?c.dom.hasAttribute("aria-selected")||(c.dom.setAttribute("aria-selected","true"),s=c):c.dom.hasAttribute("aria-selected")&&c.dom.removeAttribute("aria-selected"),r++});r<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)i=!0,this.items.pop();this.items.length==0&&(this.items.push(new Q2(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),i=!0),s?(this.list.setAttribute("aria-activedescendant",s.id),this.view.requestMeasure({key:this,read:()=>({sel:s.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:o,panel:a})=>{o.top<a.top?this.list.scrollTop-=a.top-o.top:o.bottom>a.bottom&&(this.list.scrollTop+=o.bottom-a.bottom)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),i&&this.sync()}sync(){let e=this.list.firstChild;function n(){let r=e;e=r.nextSibling,r.remove()}for(let r of this.items)if(r.dom.parentNode==this.list){for(;e!=r.dom;)n();e=r.dom.nextSibling}else this.list.insertBefore(r.dom,e);for(;e;)n()}moveSelection(e){if(this.selectedIndex<0)return;let n=this.view.state.field(yr),r=ku(n.diagnostics,this.items[e].diagnostic);r&&this.view.dispatch({selection:{anchor:r.from,head:r.to},scrollIntoView:!0,effects:pD.of(r)})}static open(e){return new zg(e)}}function WJ(t,e='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${e}>${encodeURIComponent(t)}</svg>')`}function wf(t){return WJ(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${t}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const GJ=Ae.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:wf("#d11")},".cm-lintRange-warning":{backgroundImage:wf("orange")},".cm-lintRange-info":{backgroundImage:wf("#999")},".cm-lintRange-hint":{backgroundImage:wf("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}}),yD=[yr,Ae.decorations.compute([yr],t=>{let{selected:e,panel:n}=t.field(yr);return!e||!n||e.from==e.to?Ze.none:Ze.set([LJ.range(e.from,e.to)])}),Wj(BJ,{hideOn:DJ}),GJ],vD=t=>e=>{const n=t==="down";let r=e.state.selection;for(const i of r.ranges)r=r.addRange(e.moveVertically(i,n));return e.dispatch({selection:r}),!0},KJ=vD("up"),XJ=vD("down"),ZJ=t=>{let e=null;for(const n of t.state.selection.ranges)if(!n.empty)for(let r=n.from;r<=n.to;){const i=t.state.doc.lineAt(r),s=Math.min(i.to,n.to);e?e=e.addRange(te.range(s,s)):e=te.single(s),r=i.to+1}return e?(t.dispatch({selection:e}),!0):!1},JJ=[{key:"Ctrl-Space",run:PJ},{key:"Escape",run:TJ},{key:"ArrowDown",run:vf(!0)},{key:"ArrowUp",run:vf(!1)},{key:"PageDown",run:vf(!0,"page")},{key:"PageUp",run:vf(!1,"page")},{key:"Enter",run:Y2},{key:"Tab",run:Y2},{key:"Mod-f",run:HM,scope:"editor search-panel"},{key:"Escape",run:WM,scope:"editor search-panel"},{key:"Alt-Enter",run:zM,scope:"editor search-panel"},{key:"Mod-Alt-Enter",run:FM,scope:"editor search-panel"},{key:"Ctrl-g",run:yZ},{key:"Mod-d",run:xZ,preventDefault:!0},{key:"Shift-Mod-l",run:$Z},{key:"Enter",run:O2,shift:O2},{key:"ArrowLeft",run:c2,shift:g2,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:KX,shift:QX},{key:"ArrowRight",run:d2,shift:y2,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:XX,shift:eZ},{key:"ArrowUp",run:h2,shift:v2,preventDefault:!0},{key:"ArrowDown",run:f2,shift:w2,preventDefault:!0},{key:"Home",run:m2,shift:k2},{mac:"Cmd-ArrowLeft",run:m2,shift:k2},{key:"Mod-Home",run:C2,shift:A2},{mac:"Cmd-ArrowUp",run:C2,shift:A2},{key:"PageUp",run:Sy,shift:b2},{mac:"Ctrl-ArrowUp",run:Sy,shift:b2},{key:"PageDown",run:ky,shift:x2},{mac:"Ctrl-ArrowDown",run:ky,shift:x2},{key:"End",run:p2,shift:S2},{mac:"Cmd-ArrowRight",run:p2,shift:S2},{key:"Mod-Alt-ArrowUp",linux:"Shift-Alt-ArrowUp",run:KJ,preventDefault:!0},{key:"Mod-Alt-ArrowDown",linux:"Shift-Alt-ArrowDown",run:XJ,preventDefault:!0},{key:"Shift-Alt-i",run:ZJ},{key:"Mod-End",run:E2,shift:P2},{mac:"Cmd-ArrowDown",run:E2,shift:P2},{key:"Mod-a",run:rZ},{key:"Backspace",run:OJ},{key:"Backspace",run:Cy,shift:Cy},{key:"Delete",run:T2},{key:"Mod-Backspace",mac:"Alt-Backspace",run:$2},{key:"Mod-Delete",mac:"Alt-Delete",run:sZ},{mac:"Mod-Backspace",run:oZ},{mac:"Mod-Delete",run:N2},{mac:"Ctrl-b",run:c2,shift:g2,preventDefault:!0},{mac:"Ctrl-f",run:d2,shift:y2},{mac:"Ctrl-p",run:h2,shift:v2},{mac:"Ctrl-n",run:f2,shift:w2},{mac:"Ctrl-a",run:ZX,shift:tZ},{mac:"Ctrl-e",run:JX,shift:nZ},{mac:"Ctrl-d",run:T2},{mac:"Ctrl-h",run:Cy},{mac:"Ctrl-k",run:N2},{mac:"Ctrl-Alt-h",run:$2},{mac:"Ctrl-o",run:aZ},{mac:"Ctrl-t",run:lZ},{mac:"Ctrl-v",run:ky},{mac:"Alt-v",run:Sy},{key:"Shift-Mod-k",run:fZ},{key:"Alt-ArrowDown",run:cZ},{key:"Alt-ArrowUp",run:uZ},{win:"Shift-Alt-ArrowDown",mac:"Shift-Alt-ArrowDown",run:hZ},{win:"Shift-Alt-ArrowUp",mac:"Shift-Alt-ArrowUp",run:dZ},{key:"Mod-l",run:iZ,preventDefault:!0},{key:"Shift-Mod-\\",run:qX},{key:"Tab",run:qw,shift:_2,preventDefault:!0},{key:"Mod-[",run:_2},{key:"Mod-]",run:qw},{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:WZ},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:GZ},{key:"Mod-k Mod-0",run:KZ},{key:"Mod-k Mod-j",run:XZ},{key:"Mod-k Mod-c",run:NX},{key:"Mod-k Mod-u",run:OX},{key:"Mod-/",run:TX},{key:"Shift-Alt-a",run:_X},{key:"Mod-z",run:yM,preventDefault:!0},{key:"Mod-y",run:Yw,preventDefault:!0},{key:"Mod-Shift-z",run:Yw,preventDefault:!0},{key:"Mod-u",run:zX,preventDefault:!0},{key:"Mod-Shift-m",run:zJ},{key:"F8",run:FJ}],lS=JT("vonsim-program",eg(gi().language,"editor.example"),void 0,{unstable_getOnInit:!0}),YJ=()=>Q.get(lS),qJ=hn.fromClass(class{constructor(t){this.view=t}update(t){t.docChanged&&Q.set(lS,this.view.state.doc.toString())}}),sc="showSaveFilePicker"in window,QJ=Ce(null),wD=Ce(""),eY=Ce(t=>t(wD)!==t(lS));function tY(){const t=lt(),[e,n]=Tu(QJ),r=dn(eY),i=RT(wD),s=e&&r,o=m.useCallback(async()=>{if(!sc){Kn({title:t("editor.files.unsupported"),variant:"error"});return}if(!(s&&!confirm(t("editor.files.unsaved"))))try{const[d]=await window.showOpenFilePicker({multiple:!1,excludeAcceptAllOption:!0,types:[{accept:{"text/plain":[".txt",".asm",".vonsim"]}}]});await d.requestPermission({mode:"readwrite"})==="granted"&&n(d);const p=await(await d.getFile()).text();i(p),window.codemirror.dispatch({changes:{from:0,to:window.codemirror.state.doc.length,insert:p}})}catch(d){console.error(d),Kn({title:t("editor.files.open-error"),variant:"error"})}},[t,s,n,i]);xa(d=>d.ctrlKey&&d.key==="o",d=>{d.preventDefault(),o()},void 0,[o]);const a=m.useCallback(async d=>{var f,p;if(d.stopPropagation(),d.preventDefault(),!sc){Kn({title:t("editor.files.unsupported"),variant:"error"});return}const h=(p=(f=d.dataTransfer)==null?void 0:f.items)==null?void 0:p[0];if(!(!h||h.kind!=="file")&&!(s&&!confirm(t("editor.files.unsaved"))))try{const g=await h.getAsFileSystemHandle();if(!g)throw new Error("File handle not found");await g.requestPermission({mode:"readwrite"})==="granted"&&n(g);const v=await(await g.getFile()).text();i(v),window.codemirror.dispatch({changes:{from:0,to:window.codemirror.state.doc.length,insert:v}})}catch(g){console.error(g),Kn({title:t("editor.files.open-error"),variant:"error"})}},[n,i,t,s]);Rf("drop",a,window),Rf("dragover",d=>{d.preventDefault(),d.stopPropagation()},window);const l=m.useCallback(async()=>{if(!sc){Kn({title:t("editor.files.unsupported"),variant:"error"});return}if(s)try{const d=window.codemirror.state.doc.toString(),h=await e.createWritable({keepExistingData:!1});await h.write(d),await h.close(),i(d)}catch(d){console.error(d),Kn({title:t("editor.files.save-error"),variant:"error"})}},[t,s,e,i]),u=m.useCallback(async()=>{const d=window.codemirror.state.doc.toString(),h=(e==null?void 0:e.name)||`vonsim-${new Date().toISOString().slice(0,10)}.asm`;if(sc)try{const f=await window.showSaveFilePicker({suggestedName:h,excludeAcceptAllOption:!0,types:[{accept:{"text/plain":[".txt",".asm",".vonsim"]}}]}),p=await f.requestPermission({mode:"readwrite"});if(p!=="granted")throw new Error(`Permission denied: ${p}`);n(f);const g=await f.createWritable({keepExistingData:!1});await g.write(d),await g.close(),i(d)}catch(f){console.error(f),Kn({title:t("editor.files.save-error"),variant:"error"})}else{const f=new Blob([d],{type:"text/plain"}),p=URL.createObjectURL(f),g=document.createElement("a");g.style.display="none",g.href=p,g.download=h,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(p)}},[t,e,n,i]);xa(d=>d.ctrlKey&&d.key==="s",d=>{d.preventDefault(),sc&&(e?l():u())},void 0,[e,l,u]),xa(d=>d.ctrlKey&&d.shiftKey&&d.key==="S",d=>{d.preventDefault(),u()},void 0,[u]);const c=m.useCallback(d=>{s&&(d.preventDefault(),d.returnValue=t("editor.files.unsaved"))},[t,s]);return Rf("beforeunload",c,window),x.jsxs(sN,{children:[x.jsx(oN,{asChild:!0,children:x.jsxs("button",{className:Me("flex items-center transition-colors hover:text-white",e&&"text-white"),children:[e?e.name:t("editor.files.no-file"),s&&x.jsx("span",{className:"ml-1 h-2 w-2 rounded-full bg-current"})]})}),x.jsxs(C1,{className:"w-64",align:"start",children:[x.jsxs(ka,{onClick:o,children:[x.jsx("span",{className:"icon-[lucide--file-search-2] mr-2 h-4 w-4"}),t("editor.files.open"),x.jsx("div",{className:"grow"}),x.jsx("kbd",{className:"text-stone-600",children:"Ctrl+O"})]}),x.jsxs(ka,{disabled:!s,onClick:l,children:[x.jsx("span",{className:"icon-[lucide--save] mr-2 h-4 w-4"}),t("editor.files.save"),x.jsx("div",{className:"grow"}),x.jsx("kbd",{className:"text-stone-600",children:"Ctrl+S"})]}),x.jsxs(ka,{onClick:u,children:[x.jsx("span",{className:"icon-[lucide--save-all] mr-2 h-4 w-4"}),t("editor.files.save-as"),x.jsx("div",{className:"grow"}),x.jsx("kbd",{className:"text-stone-600",children:"Ctrl+Shift+S"})]})]})]})}const rb=Ce(0);function nY(){const t=lt(),e=dn(rb);return x.jsxs("div",{className:"flex items-center justify-between border-t border-stone-600 bg-stone-800 px-3 font-sans text-xs tracking-wider text-stone-400",children:[x.jsx(tY,{}),x.jsx("span",{className:Me(e>0&&"font-semibold text-red-400"),children:t("editor.lintSummary",e)})]})}const Un={character:Oe.character,comment:Oe.comment,"data-directive":nn.define(),identifier:Oe.variableName,instruction:nn.define(),label:Oe.labelName,number:Oe.number,operator:Oe.operator,offset:nn.define(),"ptr-size":nn.define(),punctuation:Oe.punctuation,register:nn.define(),special:nn.define(),string:Oe.string,unassigned:nn.define()},rY=nS.define({name:"vonsim",token:t=>{if(t.eatSpace())return null;if(t.match(/[01]+b\b/i)||t.match(/\d[a-f\d]*h\b/i)||t.match(/\d+\b/))return"number";if(t.match(/'[^'\n]'/))return"character";if(t.eat('"'))return t.eatWhile(/[^"\n]/),t.eat('"'),"string";if(t.eat(/[*+-]/))return"operator";if(t.eat(/[(),[\]]/))return"punctuation";if(t.eat("?"))return"unassigned";if(t.eat(";"))return t.skipToEnd(),"comment";if(t.eat(/[a-z_]/i)){t.eatWhile(/\w/);const e=t.current().toUpperCase();return e==="ORG"||e==="END"?"special":e==="OFFSET"?"offset":e==="BYTE"||e==="WORD"||e==="PTR"?"ptr-size":E1.includes(e)?"data-directive":A1.includes(e)?"instruction":Wp.includes(e)?"register":t.eat(":")?"label":"identifier"}return t.next(),null},languageData:{commentTokens:{line:";"},closeBrackets:{brackets:["(","[",'"']}},tokenTable:Un}),iY=qZ(jg.define([{tag:Un.character,class:"text-orange-300"},{tag:Un.comment,class:"text-stone-500 italic"},{tag:Un["data-directive"],class:"text-rose-400/80"},{tag:Un.instruction,class:"text-mantis-400"},{tag:Un.number,class:"text-cyan-300/60"},{tag:Un.operator,class:"text-rose-300"},{tag:Un.offset,class:"text-rose-400/80 italic"},{tag:Un["ptr-size"],class:"text-rose-400/80 italic"},{tag:Un.punctuation,class:"text-stone-600"},{tag:Un.register,class:"text-emerald-400/80"},{tag:Un.special,class:"text-yellow-300/80"},{tag:Un.string,class:"text-orange-300"},{tag:Un.unassigned,class:"text-rose-400/80"}])),sY=VJ(t=>{const e=t.state.doc.toString(),n=uN(e);if(n.success)return Q.set(rb,0),[];const r=gi().language,i=n.errors.map(s=>{var l,u;const o=((l=s.position)==null?void 0:l.start)??0,a=((u=s.position)==null?void 0:u.end)??e.length;return{message:s.translate(r),severity:"error",from:o,to:a}});return Q.set(rb,i.length),i},{delay:200});function oY(){return new LZ(rY,[iY,sY])}function bD({className:t}){const[e,n]=m.useState(),r=m.useCallback(i=>{i&&n(i)},[]);return m.useEffect(()=>{if(e)return window.codemirror=new Ae({state:Ue.create({doc:YJ(),extensions:[Ue.tabSize.of(2),IO.of(Ue.readOnly.of(!1)),qJ,ez(),iz,rz(),Nj(),jX(),xj(),Ae.domEventHandlers({drop:i=>i.preventDefault()}),Ue.allowMultipleSelections.of(!0),Ij(),CO.of([{key:"Escape",run:i=>(i.dispatch({selection:te.create([i.state.selection.main],0)}),!0)},{key:"Tab",run:i=>i.state.selection.ranges.some(s=>!s.empty)?qw(i):(i.dispatch(i.state.update(i.state.replaceSelection(" ".repeat(i.state.tabSize)),{scrollIntoView:!0,userEvent:"input"})),!0)},...JJ]),oY()]}),parent:e}),()=>{var i;return(i=window.codemirror)==null?void 0:i.destroy()}},[e]),x.jsxs("div",{className:Me("flex flex-col",t),children:[x.jsx("div",{ref:r,className:"grow overflow-auto font-mono"}),x.jsx(nY,{})]})}function aY(){const t=lt(),e=d5("(max-width: 640px)"),{updateServiceWorker:n}=g5({onNeedRefresh(){Kn({title:t("update.update-available"),action:x.jsx(AR,{altText:t("update.reload"),onClick:()=>n(!0),children:t("update.reload")}),duration:1/0})}});return x.jsxs("div",{className:"flex h-screen w-screen flex-col bg-stone-900 text-white",children:[x.jsx(rW,{}),e?x.jsx(uY,{}):x.jsx(lY,{}),x.jsx(R6,{})]})}function lY(){const[t]=Tu(Ox);return x.jsxs(GT,{autoSaveId:"layout",direction:"horizontal",units:"pixels",tagName:"main",className:"overflow-auto px-2",children:[x.jsx(_f,{id:"panel-editor",order:1,minSize:250,tagName:"section",className:"rounded-lg border border-stone-600 bg-stone-800",children:x.jsx(bD,{className:"h-full w-full"})}),x.jsx(Ov,{className:"w-2"}),x.jsx(_f,{id:"panel-computer",order:2,tagName:"section",className:"computer-background rounded-lg border border-stone-600",children:x.jsx(tM,{})}),t&&x.jsxs(x.Fragment,{children:[x.jsx(Ov,{className:"w-2"}),x.jsx(_f,{id:"panel-settings",order:3,minSize:450,tagName:"section",className:"rounded-lg border border-stone-600 bg-stone-800",children:x.jsx(uR,{className:"h-full w-full"})})]})]})}function uY(){const t=lt(),[e,n]=m.useState("editor"),[r,i]=Tu(Ox),s=r?"settings":e,o=a=>{r&&i(!1),n(a)};return x.jsx(AL,{value:s,onValueChange:o,asChild:!0,children:x.jsxs(x.Fragment,{children:[x.jsx(m0,{value:"editor",asChild:!0,children:x.jsx("section",{className:"mx-2 grow overflow-hidden rounded-lg border border-stone-600 bg-stone-800 data-[state=inactive]:hidden",children:x.jsx(bD,{className:"h-full w-full"})})}),x.jsx(m0,{value:"computer",asChild:!0,children:x.jsx("section",{className:"computer-background mx-2 grow overflow-hidden rounded-lg border border-stone-600 bg-stone-800 data-[state=inactive]:hidden",children:x.jsx(tM,{})})}),x.jsx(m0,{value:"settings",asChild:!0,children:x.jsx("section",{className:"mx-2 grow overflow-hidden rounded-lg border border-stone-600 bg-stone-800 data-[state=inactive]:hidden",children:x.jsx(uR,{className:"h-full w-full"})})}),x.jsxs(TL,{className:"grid grid-cols-2 gap-2 p-2",children:[x.jsxs(wk,{value:"editor",className:"inline-flex items-center justify-center rounded-lg py-2 text-sm font-semibold text-stone-400 transition-colors hover:bg-stone-800 hover:text-white data-[state=active]:bg-stone-700 data-[state=active]:text-white",children:[x.jsx("span",{className:"icon-[lucide--file-terminal] mr-2 h-4 w-4"}),t("control.tabs.editor")]}),x.jsxs(wk,{value:"computer",className:"inline-flex items-center justify-center rounded-lg py-2 text-sm font-semibold text-stone-400 transition-colors hover:bg-stone-800 hover:text-white data-[state=active]:bg-stone-700 data-[state=active]:text-white",children:[x.jsx("span",{className:"icon-[lucide--computer] mr-2 h-4 w-4"}),t("control.tabs.computer")]})]})]})})}function cY(){const{toastList:t}=uz();return x.jsxs(PW,{children:[t.map(({id:e,title:n,description:r,action:i,variant:s,otherProps:o})=>x.jsxs(ER,{...o,variant:s,children:[x.jsxs("div",{className:"grid gap-1",children:[n&&x.jsx(TR,{children:n}),r&&x.jsx($R,{children:r})]}),i,x.jsx(PR,{})]},e)),x.jsx(CR,{})]})}window.codemirror=null;_y.createRoot(document.getElementById("root")).render(x.jsxs(Lt.StrictMode,{children:[x.jsx(x5,{children:x.jsx(aY,{})}),x.jsx(cY,{})]}));
